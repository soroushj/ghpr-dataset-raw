{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "NONE",
  "body": "*Description*:\r\nI decided to use the v2 file format for some internal testing.  Unfortunately I found that while there seems to be decent info on how to add fault filters to your config file for v1, examples for the v2 format were lacking.  This is unfortunate because all of the variable names have changed.  \r\n\r\nExample: In v1 the delay filter would use variables \"fixed_delay_percent\" and \"fixed_duration_ms\", but in v2 these are \"percent\" and \"fixed_delay\".  \r\n\r\n\r\nThe error message generated for an incorrectly defined \"delay\" is unhelpful as well, since it refers to a \"fault_delay_secifier\".  \r\n\r\n```\r\nerror initializing configuration '/etc/envoy.yaml': Proto constraint validation failed (HTTPFaultValidationError.Delay: [\"embedded message failed validation\"] | caused by field: \"fault_delay_secifier\", reason: is required): delay {\r\n}\r\n```\r\n\r\n[optional *Relevant Links*:]\r\nhttps://www.envoyproxy.io/docs/envoy/latest/configuration/http_filters/fault_filter \r\nCurrent documentation only shows the v1 variable names.  Fault filters are not included in any of the v2 example configs either.  \r\n\r\n\r\n*Config*:\r\nHere is an example config with the correct v2 naming.  Maybe someone will find this useful until the docs are updated.\r\n\r\n```\r\nstatic_resources:\r\n  listeners:\r\n  - address:\r\n      socket_address: { address: 0.0.0.0, port_value: 80 }\r\n    filter_chains:\r\n    - filters:\r\n      - name: envoy.http_connection_manager\r\n        config:\r\n          codec_type: auto\r\n          stat_prefix: ingress_http\r\n          route_config:\r\n            name: local_route\r\n            virtual_hosts:\r\n            - name: backend\r\n              domains: [\"*\"]\r\n              routes:\r\n              - match: { path: \"/websocket\" }\r\n                route: { cluster: service1 , use_websocket: true }\r\n              - match: { path: \"/example\" }\r\n                route: { cluster: service1 }\r\n          http_filters:\r\n          - name: envoy.fault\r\n            config: \r\n              delay: { fixed_delay: 20s, percent: 50 } \r\n              upstream_cluster: service1\r\n              abort: { percent: 50, http_status: 555 }\r\n              upstream_cluster: service1\r\n          - name: envoy.router\r\n  clusters:\r\n  - name: service1\r\n    connect_timeout: 0.25s\r\n    type: strict_dns\r\n    lb_policy: round_robin\r\n    hosts:\r\n    - socket_address: { address: 127.0.0.1, port_value: 8000 }\r\nadmin:\r\n  access_log_path: /tmp/admin_access.log\r\n  address: { socket_address: { address: 0.0.0.0, port_value: 80 }}\r\n```\r\n\r\n\r\n",
  "closed_at": "2018-10-10T22:27:40Z",
  "closed_by": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/6305260?v=4",
    "events_url": "https://api.github.com/users/mattklein123/events{/privacy}",
    "followers_url": "https://api.github.com/users/mattklein123/followers",
    "following_url": "https://api.github.com/users/mattklein123/following{/other_user}",
    "gists_url": "https://api.github.com/users/mattklein123/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/mattklein123",
    "id": 6305260,
    "login": "mattklein123",
    "node_id": "MDQ6VXNlcjYzMDUyNjA=",
    "organizations_url": "https://api.github.com/users/mattklein123/orgs",
    "received_events_url": "https://api.github.com/users/mattklein123/received_events",
    "repos_url": "https://api.github.com/users/mattklein123/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/mattklein123/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mattklein123/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/mattklein123"
  },
  "comments": 1,
  "comments_url": "https://api.github.com/repos/envoyproxy/envoy/issues/3902/comments",
  "created_at": "2018-07-19T15:23:07Z",
  "events_url": "https://api.github.com/repos/envoyproxy/envoy/issues/3902/events",
  "html_url": "https://github.com/envoyproxy/envoy/issues/3902",
  "id": 342776760,
  "labels": [
    {
      "color": "b60205",
      "default": false,
      "description": "",
      "id": 446541096,
      "name": "area/docs",
      "node_id": "MDU6TGFiZWw0NDY1NDEwOTY=",
      "url": "https://api.github.com/repos/envoyproxy/envoy/labels/area/docs"
    },
    {
      "color": "fbca04",
      "default": true,
      "description": "Needs help!",
      "id": 645516726,
      "name": "help wanted",
      "node_id": "MDU6TGFiZWw2NDU1MTY3MjY=",
      "url": "https://api.github.com/repos/envoyproxy/envoy/labels/help%20wanted"
    }
  ],
  "labels_url": "https://api.github.com/repos/envoyproxy/envoy/issues/3902/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUzNDI3NzY3NjA=",
  "number": 3902,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/envoyproxy/envoy",
  "state": "closed",
  "title": "Update Documentation on v2 fault injection",
  "updated_at": "2018-10-10T22:27:40Z",
  "url": "https://api.github.com/repos/envoyproxy/envoy/issues/3902",
  "user": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/14791799?v=4",
    "events_url": "https://api.github.com/users/willrichboa/events{/privacy}",
    "followers_url": "https://api.github.com/users/willrichboa/followers",
    "following_url": "https://api.github.com/users/willrichboa/following{/other_user}",
    "gists_url": "https://api.github.com/users/willrichboa/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/willrichboa",
    "id": 14791799,
    "login": "willrichboa",
    "node_id": "MDQ6VXNlcjE0NzkxNzk5",
    "organizations_url": "https://api.github.com/users/willrichboa/orgs",
    "received_events_url": "https://api.github.com/users/willrichboa/received_events",
    "repos_url": "https://api.github.com/users/willrichboa/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/willrichboa/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/willrichboa/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/willrichboa"
  }
}