{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "CONTRIBUTOR",
  "body": "**Rational**\r\n\r\nUsing subdomains for tenant-id in a multi-tenant application is a relatively popular strategy, our own MediaWiki (the software behind Wikipedia) uses `Host` header to distinguish between different language wikis. Ability to rewrite `Host` based on path would provide flexibility in moving the tenant-id from subdomain to path when deploying existing software behind the proxy.\r\n\r\n**Proposal**\r\n\r\nIntroduce a new `host_rewrite_path` option in `RouteAction:host_rewrite_specifier`. \r\n\r\n```\r\n// Indicates that during forwarding, the host header will be swapped with the result of the\r\n// given regex substitution run agains the request path. \r\ntype.matcher.v3.RegexMatchAndSubstitute host_rewrite_path = 36;\r\n```\r\n\r\nThe behavior of the new property would be the following: `Host` header will be set to the result of the `RegexMatchAndSubstitute`, executed agains the path. However, this would need to be applied with care, since the regex matcher needs to be guaranteed to match the whole path string. Alternatively, a new `RegexMatchAndReplace` message could introduced, where the result would replace the input string with capture groups applied, or null if the regex did not match the input - in that case the host header would not be swapped if the regex did not match.\r\n\r\nWe are going to provide implementation and testing. Seeking approval from the maintainers and guidance on whether to reuse `RegexMatchAndSubstitute` or introduce a new message type.",
  "closed_at": "2020-08-11T12:30:16Z",
  "closed_by": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/10914751?v=4",
    "events_url": "https://api.github.com/users/htuch/events{/privacy}",
    "followers_url": "https://api.github.com/users/htuch/followers",
    "following_url": "https://api.github.com/users/htuch/following{/other_user}",
    "gists_url": "https://api.github.com/users/htuch/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/htuch",
    "id": 10914751,
    "login": "htuch",
    "node_id": "MDQ6VXNlcjEwOTE0NzUx",
    "organizations_url": "https://api.github.com/users/htuch/orgs",
    "received_events_url": "https://api.github.com/users/htuch/received_events",
    "repos_url": "https://api.github.com/users/htuch/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/htuch/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/htuch/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/htuch"
  },
  "comments": 3,
  "comments_url": "https://api.github.com/repos/envoyproxy/envoy/issues/12430/comments",
  "created_at": "2020-08-02T15:58:05Z",
  "events_url": "https://api.github.com/repos/envoyproxy/envoy/issues/12430/events",
  "html_url": "https://github.com/envoyproxy/envoy/issues/12430",
  "id": 671641480,
  "labels": [
    {
      "color": "d4c5f9",
      "default": false,
      "description": "",
      "id": 1715341036,
      "name": "area/http",
      "node_id": "MDU6TGFiZWwxNzE1MzQxMDM2",
      "url": "https://api.github.com/repos/envoyproxy/envoy/labels/area/http"
    },
    {
      "color": "c5def5",
      "default": false,
      "description": "Needs design doc/proposal before implementation",
      "id": 620444894,
      "name": "design proposal",
      "node_id": "MDU6TGFiZWw2MjA0NDQ4OTQ=",
      "url": "https://api.github.com/repos/envoyproxy/envoy/labels/design%20proposal"
    },
    {
      "color": "fbca04",
      "default": true,
      "description": "Needs help!",
      "id": 645516726,
      "name": "help wanted",
      "node_id": "MDU6TGFiZWw2NDU1MTY3MjY=",
      "url": "https://api.github.com/repos/envoyproxy/envoy/labels/help%20wanted"
    }
  ],
  "labels_url": "https://api.github.com/repos/envoyproxy/envoy/issues/12430/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU2NzE2NDE0ODA=",
  "number": 12430,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/envoyproxy/envoy",
  "state": "closed",
  "title": "Proposal: Introduce host_rewrite_path support in route config",
  "updated_at": "2020-08-11T12:30:16Z",
  "url": "https://api.github.com/repos/envoyproxy/envoy/issues/12430",
  "user": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/814754?v=4",
    "events_url": "https://api.github.com/users/Pchelolo/events{/privacy}",
    "followers_url": "https://api.github.com/users/Pchelolo/followers",
    "following_url": "https://api.github.com/users/Pchelolo/following{/other_user}",
    "gists_url": "https://api.github.com/users/Pchelolo/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/Pchelolo",
    "id": 814754,
    "login": "Pchelolo",
    "node_id": "MDQ6VXNlcjgxNDc1NA==",
    "organizations_url": "https://api.github.com/users/Pchelolo/orgs",
    "received_events_url": "https://api.github.com/users/Pchelolo/received_events",
    "repos_url": "https://api.github.com/users/Pchelolo/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/Pchelolo/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Pchelolo/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/Pchelolo"
  }
}