{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "CONTRIBUTOR",
  "body": "*Title*: ares_library_cleanup() won't be called if an exception occurs in MainCommonBase constructor.\r\n\r\n*Description*:\r\nThe MainCommonBase constructor sets up some global state; specifically, it calls ares_library_init() as its first line.  That global state is reset in ~MainCommonBase via ares_library_cleanup().   If an exception is thrown from a function called from the MainCommonBase constructor (as happens if there is an envoy configuration error), the init function will be called by the cleanup function won't be.  That may be problematic for tests that use MainCommonBase which may be testing invalid envoy configs--there will be global state droppings in place after a construction attempt that throws.\r\n\r\n(I don't know the ares library so I don't now how important this is--I ran into this tracing a similar problem with the thread singleton factory, but I expect that problem to be fixed by pull request #6658 .]\r\n\r\nhttps://github.com/envoyproxy/envoy/blob/master/source/exe/main_common.cc#L53\r\nhttps://github.com/envoyproxy/envoy/blob/master/source/exe/main_common.cc#L101\r\n\r\n@jmarantz ",
  "closed_at": "2019-05-09T14:17:05Z",
  "closed_by": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/10914751?v=4",
    "events_url": "https://api.github.com/users/htuch/events{/privacy}",
    "followers_url": "https://api.github.com/users/htuch/followers",
    "following_url": "https://api.github.com/users/htuch/following{/other_user}",
    "gists_url": "https://api.github.com/users/htuch/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/htuch",
    "id": 10914751,
    "login": "htuch",
    "node_id": "MDQ6VXNlcjEwOTE0NzUx",
    "organizations_url": "https://api.github.com/users/htuch/orgs",
    "received_events_url": "https://api.github.com/users/htuch/received_events",
    "repos_url": "https://api.github.com/users/htuch/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/htuch/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/htuch/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/htuch"
  },
  "comments": 7,
  "comments_url": "https://api.github.com/repos/envoyproxy/envoy/issues/6689/comments",
  "created_at": "2019-04-23T23:20:25Z",
  "events_url": "https://api.github.com/repos/envoyproxy/envoy/issues/6689/events",
  "html_url": "https://github.com/envoyproxy/envoy/issues/6689",
  "id": 436430271,
  "labels": [
    {
      "color": "bfdadc",
      "default": false,
      "description": "Good starter issues!",
      "id": 733818075,
      "name": "beginner",
      "node_id": "MDU6TGFiZWw3MzM4MTgwNzU=",
      "url": "https://api.github.com/repos/envoyproxy/envoy/labels/beginner"
    },
    {
      "color": "ee0701",
      "default": true,
      "description": null,
      "id": 421403907,
      "name": "bug",
      "node_id": "MDU6TGFiZWw0MjE0MDM5MDc=",
      "url": "https://api.github.com/repos/envoyproxy/envoy/labels/bug"
    },
    {
      "color": "fbca04",
      "default": true,
      "description": "Needs help!",
      "id": 645516726,
      "name": "help wanted",
      "node_id": "MDU6TGFiZWw2NDU1MTY3MjY=",
      "url": "https://api.github.com/repos/envoyproxy/envoy/labels/help%20wanted"
    }
  ],
  "labels_url": "https://api.github.com/repos/envoyproxy/envoy/issues/6689/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU0MzY0MzAyNzE=",
  "number": 6689,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/envoyproxy/envoy",
  "state": "closed",
  "title": "ares_library_cleanup() won't be called if an exception occurs in MainCommonBase constructor.",
  "updated_at": "2019-05-09T14:17:05Z",
  "url": "https://api.github.com/repos/envoyproxy/envoy/issues/6689",
  "user": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/252255?v=4",
    "events_url": "https://api.github.com/users/curiouserrandy/events{/privacy}",
    "followers_url": "https://api.github.com/users/curiouserrandy/followers",
    "following_url": "https://api.github.com/users/curiouserrandy/following{/other_user}",
    "gists_url": "https://api.github.com/users/curiouserrandy/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/curiouserrandy",
    "id": 252255,
    "login": "curiouserrandy",
    "node_id": "MDQ6VXNlcjI1MjI1NQ==",
    "organizations_url": "https://api.github.com/users/curiouserrandy/orgs",
    "received_events_url": "https://api.github.com/users/curiouserrandy/received_events",
    "repos_url": "https://api.github.com/users/curiouserrandy/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/curiouserrandy/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/curiouserrandy/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/curiouserrandy"
  }
}