{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "NONE",
  "body": "*Title*: *Unwanted characters coming while adding response_headers_to_add*\r\n\r\n*Description*:\r\n> I've a gRPC server and an HTTP client (browser). I'm trying to send an html file from gRPC server to HTTP client (browser) and I want it to be rendered on browser itself. I've added following lines in config file but it is throwing some noisy data along with data which is required. \r\n```\r\nresponse_headers_to_add:\r\n                            header: { key: \"Content-Type\", value: \"text/html\" }\r\n                            append: false\r\n```\r\n\r\n*Config*:\r\n\r\n```\r\nstatic_resources:\r\n  listeners:\r\n  - address:\r\n      socket_address:\r\n        address: 0.0.0.0\r\n        port_value: 3000\r\n    filter_chains:\r\n    - filters:\r\n      - name: envoy.http_connection_manager\r\n        config:\r\n          codec_type: auto\r\n          stat_prefix: ingress_http\r\n          route_config:\r\n            name: local_route\r\n            virtual_hosts:\r\n            - name: backend\r\n              domains:\r\n              - \"*\"\r\n              routes:\r\n              - match: { prefix: \"/serverSide.FileSender/sendfile\" }   # Here pulseiot, CampaignService and createCampaign is the name of package, Service and rpc Call we defined in proto file\r\n                route:\r\n                    response_headers_to_add:\r\n                            header: { key: \"Content-Type\", value: \"text/html\" }\r\n                            append: false\r\n                    cluster: cluster1\r\n          http_filters:\r\n            - name: envoy.grpc_json_transcoder\r\n              config: { proto_descriptor: \"/etc/proto.pb\", services: [\"serverSide.FileSender\"]}\r\n            - name: envoy.router\r\n              config: {}\r\n\r\n  clusters:\r\n  - name: cluster1\r\n    connect_timeout: 11.25s\r\n    type: static\r\n    lb_policy: round_robin\r\n    http2_protocol_options: {}\r\n    hosts:\r\n    - socket_address:\r\n        address: 10.112.82.129\r\n        port_value: 15001\r\n\r\nadmin:\r\n  access_log_path: \"/tmp/admin_access.log\"\r\n  address:\r\n    socket_address:\r\n      address: 0.0.0.0\r\n      port_value: 9902\r\n\r\n```\r\n\r\nISSUE: Noise at starting of html file. I've tried with other files also but facing same issues with every file.\r\n```\r\n\u0001\u0010\r\n\ufffd\u0002\r\n<!DOCTYPE html>\r\n<html>\r\n    <head>\r\n        <script type=\"application/javascript\">\r\nfunction msg(){\r\n alert(\"Hello Javatpoint\");\r\n}\r\n</script>\r\n    </head>\r\n    <body>\r\n        <p>Welcome to JavaScript</p>\r\n        <form>\r\n            <input type=\"button\" value=\"click\" onclick=\"msg()\"/>\r\n        </form>\r\n    </body>\r\n</html>\r\n```\r\n\r\n\r\n\r\n\r\n*Logs*:\r\n>[2018-04-25 11:11:46.671][11][debug][main] source/server/connection_handler_impl.cc:195] [C1] new connection\r\n[2018-04-25 11:11:46.671][11][debug][http] source/common/http/conn_manager_impl.cc:186] [C1] new stream\r\n[2018-04-25 11:11:46.672][11][debug][http] source/common/http/conn_manager_impl.cc:790] [C1][S2066557439932801438] request end stream\r\n[2018-04-25 11:11:46.672][11][debug][http] source/common/http/conn_manager_impl.cc:455] [C1][S2066557439932801438] request headers complete (end_stream=true):\r\n[2018-04-25 11:11:46.672][11][debug][http] source/common/http/conn_manager_impl.cc:460] [C1][S2066557439932801438]   ':authority':'localhost:3000'\r\n[2018-04-25 11:11:46.672][11][debug][http] source/common/http/conn_manager_impl.cc:460] [C1][S2066557439932801438]   'connection':'keep-alive'\r\n[2018-04-25 11:11:46.672][11][debug][http] source/common/http/conn_manager_impl.cc:460] [C1][S2066557439932801438]   'upgrade-insecure-requests':'1'\r\n[2018-04-25 11:11:46.672][11][debug][http] source/common/http/conn_manager_impl.cc:460] [C1][S2066557439932801438]   'user-agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36'\r\n[2018-04-25 11:11:46.672][11][debug][http] source/common/http/conn_manager_impl.cc:460] [C1][S2066557439932801438]   'accept':'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8'\r\n[2018-04-25 11:11:46.672][11][debug][http] source/common/http/conn_manager_impl.cc:460] [C1][S2066557439932801438]   'accept-encoding':'gzip, deflate, br'\r\n[2018-04-25 11:11:46.672][11][debug][http] source/common/http/conn_manager_impl.cc:460] [C1][S2066557439932801438]   'accept-language':'en-US,en;q=0.9'\r\n[2018-04-25 11:11:46.672][11][debug][http] source/common/http/conn_manager_impl.cc:460] [C1][S2066557439932801438]   ':path':'/getfile'\r\n[2018-04-25 11:11:46.672][11][debug][http] source/common/http/conn_manager_impl.cc:460] [C1][S2066557439932801438]   ':method':'GET'\r\n[2018-04-25 11:11:46.672][11][debug][router] source/common/router/router.cc:250] [C1][S2066557439932801438] cluster 'cluster1' match for URL '/serverSide.FileSender/sendfile'\r\n[2018-04-25 11:11:46.672][11][debug][router] source/common/router/router.cc:298] [C1][S2066557439932801438]   ':authority':'localhost:3000'\r\n[2018-04-25 11:11:46.672][11][debug][router] source/common/router/router.cc:298] [C1][S2066557439932801438]   'upgrade-insecure-requests':'1'\r\n[2018-04-25 11:11:46.672][11][debug][router] source/common/router/router.cc:298] [C1][S2066557439932801438]   'user-agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36'\r\n[2018-04-25 11:11:46.672][11][debug][router] source/common/router/router.cc:298] [C1][S2066557439932801438]   'accept':'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8'\r\n[2018-04-25 11:11:46.672][11][debug][router] source/common/router/router.cc:298] [C1][S2066557439932801438]   'accept-encoding':'gzip, deflate, br'\r\n[2018-04-25 11:11:46.672][11][debug][router] source/common/router/router.cc:298] [C1][S2066557439932801438]   'accept-language':'en-US,en;q=0.9'\r\n[2018-04-25 11:11:46.672][11][debug][router] source/common/router/router.cc:298] [C1][S2066557439932801438]   ':path':'/serverSide.FileSender/sendfile'\r\n[2018-04-25 11:11:46.672][11][debug][router] source/common/router/router.cc:298] [C1][S2066557439932801438]   ':method':'POST'\r\n[2018-04-25 11:11:46.672][11][debug][router] source/common/router/router.cc:298] [C1][S2066557439932801438]   'x-forwarded-proto':'http'\r\n[2018-04-25 11:11:46.672][11][debug][router] source/common/router/router.cc:298] [C1][S2066557439932801438]   'x-request-id':'d6a83655-3068-4366-84c4-c0e0a1a4cdc4'\r\n[2018-04-25 11:11:46.672][11][debug][router] source/common/router/router.cc:298] [C1][S2066557439932801438]   'content-type':'application/grpc'\r\n[2018-04-25 11:11:46.672][11][debug][router] source/common/router/router.cc:298] [C1][S2066557439932801438]   'x-envoy-original-path':'/getfile'\r\n[2018-04-25 11:11:46.672][11][debug][router] source/common/router/router.cc:298] [C1][S2066557439932801438]   'te':'trailers'\r\n[2018-04-25 11:11:46.672][11][debug][router] source/common/router/router.cc:298] [C1][S2066557439932801438]   'x-envoy-expected-rq-timeout-ms':'15000'\r\n[2018-04-25 11:11:46.672][11][debug][router] source/common/router/router.cc:298] [C1][S2066557439932801438]   ':scheme':'http'\r\n[2018-04-25 11:11:46.672][11][debug][client] source/common/http/codec_client.cc:25] [C2] connecting\r\n[2018-04-25 11:11:46.672][11][debug][connection] source/common/network/connection_impl.cc:568] [C2] connecting to 192.168.137.1:15001\r\n[2018-04-25 11:11:46.672][11][debug][connection] source/common/network/connection_impl.cc:577] [C2] connection in progress\r\n[2018-04-25 11:11:46.672][11][debug][http2] source/common/http/http2/codec_impl.cc:624] [C2] setting stream-level initial window size to 268435456\r\n[2018-04-25 11:11:46.672][11][debug][http2] source/common/http/http2/codec_impl.cc:648] [C2] updating connection-level initial window size to 268435456\r\n[2018-04-25 11:11:46.672][11][debug][pool] source/common/http/http2/conn_pool.cc:97] [C2] creating stream\r\n[2018-04-25 11:11:46.672][11][debug][router] source/common/router/router.cc:966] [C1][S2066557439932801438] pool ready\r\n[2018-04-25 11:11:46.686][11][debug][connection] source/common/network/connection_impl.cc:464] [C2] connected\r\n[2018-04-25 11:11:46.686][11][debug][client] source/common/http/codec_client.cc:63] [C2] connected\r\n[2018-04-25 11:11:46.709][12][debug][main] source/server/connection_handler_impl.cc:195] [C3] new connection\r\n[2018-04-25 11:11:47.380][11][debug][router] source/common/router/router.cc:590] [C1][S2066557439932801438] upstream headers complete: end_stream=false\r\n[2018-04-25 11:11:47.380][11][debug][http] source/common/http/conn_manager_impl.cc:963] [C1][S2066557439932801438] encoding headers via codec (end_stream=false):\r\n[2018-04-25 11:11:47.381][11][debug][http] source/common/http/conn_manager_impl.cc:968] [C1][S2066557439932801438]   ':status':'200'\r\n[2018-04-25 11:11:47.381][11][debug][http] source/common/http/conn_manager_impl.cc:968] [C1][S2066557439932801438]   'grpc-encoding':'identity'\r\n[2018-04-25 11:11:47.381][11][debug][http] source/common/http/conn_manager_impl.cc:968] [C1][S2066557439932801438]   'grpc-accept-encoding':'gzip'\r\n[2018-04-25 11:11:47.381][11][debug][http] source/common/http/conn_manager_impl.cc:968] [C1][S2066557439932801438]   'x-envoy-upstream-service-time':'708'\r\n[2018-04-25 11:11:47.381][11][debug][http] source/common/http/conn_manager_impl.cc:968] [C1][S2066557439932801438]   'content-type':'text/html; charset=utf-8'\r\n[2018-04-25 11:11:47.381][11][debug][http] source/common/http/conn_manager_impl.cc:968] [C1][S2066557439932801438]   'date':'Wed, 25 Apr 2018 11:11:47 GMT'\r\n[2018-04-25 11:11:47.381][11][debug][http] source/common/http/conn_manager_impl.cc:968] [C1][S2066557439932801438]   'server':'envoy'\r\n[2018-04-25 11:11:47.450][11][debug][client] source/common/http/codec_client.cc:94] [C2] response complete\r\n[2018-04-25 11:11:47.450][11][debug][pool] source/common/http/http2/conn_pool.cc:189] [C2] destroying stream: 0 remaining\r\n[2018-04-25 11:11:47.450][11][debug][http] source/common/http/conn_manager_impl.cc:1049] [C1][S2066557439932801438] encoding trailers via codec\r\n[2018-04-25 11:11:47.450][11][debug][http] source/common/http/conn_manager_impl.cc:1054] [C1][S2066557439932801438]   'grpc-status':'0'\r\n[2018-04-25 11:11:47.450][11][debug][http2] source/common/http/http2/codec_impl.cc:517] [C2] stream closed: 0\r\n[2018-04-25 11:11:48.114][6][debug][main] source/server/server.cc:130] flushing stats\r\n[2018-04-25 11:11:48.321][11][debug][http] source/common/http/conn_manager_impl.cc:186] [C1] new stream\r\n[2018-04-25 11:11:48.321][11][debug][http] source/common/http/conn_manager_impl.cc:790] [C1][S5174642106963361548] request end stream\r\n[2018-04-25 11:11:48.321][11][debug][http] source/common/http/conn_manager_impl.cc:455] [C1][S5174642106963361548] request headers complete (end_stream=true):\r\n[2018-04-25 11:11:48.321][11][debug][http] source/common/http/conn_manager_impl.cc:460] [C1][S5174642106963361548]   ':authority':'localhost:3000'\r\n[2018-04-25 11:11:48.321][11][debug][http] source/common/http/conn_manager_impl.cc:460] [C1][S5174642106963361548]   'connection':'keep-alive'\r\n[2018-04-25 11:11:48.321][11][debug][http] source/common/http/conn_manager_impl.cc:460] [C1][S5174642106963361548]   'user-agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36'\r\n[2018-04-25 11:11:48.321][11][debug][http] source/common/http/conn_manager_impl.cc:460] [C1][S5174642106963361548]   'accept':'image/webp,image/apng,image/*,*/*;q=0.8'\r\n[2018-04-25 11:11:48.321][11][debug][http] source/common/http/conn_manager_impl.cc:460] [C1][S5174642106963361548]   'referer':'http://localhost:3000/getfile'\r\n[2018-04-25 11:11:48.321][11][debug][http] source/common/http/conn_manager_impl.cc:460] [C1][S5174642106963361548]   'accept-encoding':'gzip, deflate, br'\r\n[2018-04-25 11:11:48.321][11][debug][http] source/common/http/conn_manager_impl.cc:460] [C1][S5174642106963361548]   'accept-language':'en-US,en;q=0.9'\r\n[2018-04-25 11:11:48.321][11][debug][http] source/common/http/conn_manager_impl.cc:460] [C1][S5174642106963361548]   ':path':'/favicon.ico'\r\n[2018-04-25 11:11:48.321][11][debug][http] source/common/http/conn_manager_impl.cc:460] [C1][S5174642106963361548]   ':method':'GET'\r\n[2018-04-25 11:11:48.321][11][debug][router] source/common/router/router.cc:204] [C1][S5174642106963361548] no cluster match for URL '/favicon.ico'\r\n[2018-04-25 11:11:48.321][11][debug][http] source/common/http/conn_manager_impl.cc:963] [C1][S5174642106963361548] encoding headers via codec (end_stream=true):\r\n[2018-04-25 11:11:48.321][11][debug][http] source/common/http/conn_manager_impl.cc:968] [C1][S5174642106963361548]   ':status':'404'\r\n[2018-04-25 11:11:48.321][11][debug][http] source/common/http/conn_manager_impl.cc:968] [C1][S5174642106963361548]   'date':'Wed, 25 Apr 2018 11:11:48 GMT'\r\n[2018-04-25 11:11:48.321][11][debug][http] source/common/http/conn_manager_impl.cc:968] [C1][S5174642106963361548]   'server':'envoy'\r\n",
  "closed_at": "2018-07-13T14:18:02Z",
  "closed_by": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/10914751?v=4",
    "events_url": "https://api.github.com/users/htuch/events{/privacy}",
    "followers_url": "https://api.github.com/users/htuch/followers",
    "following_url": "https://api.github.com/users/htuch/following{/other_user}",
    "gists_url": "https://api.github.com/users/htuch/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/htuch",
    "id": 10914751,
    "login": "htuch",
    "node_id": "MDQ6VXNlcjEwOTE0NzUx",
    "organizations_url": "https://api.github.com/users/htuch/orgs",
    "received_events_url": "https://api.github.com/users/htuch/received_events",
    "repos_url": "https://api.github.com/users/htuch/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/htuch/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/htuch/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/htuch"
  },
  "comments": 4,
  "comments_url": "https://api.github.com/repos/envoyproxy/envoy/issues/3205/comments",
  "created_at": "2018-04-25T11:20:07Z",
  "events_url": "https://api.github.com/repos/envoyproxy/envoy/issues/3205/events",
  "html_url": "https://github.com/envoyproxy/envoy/issues/3205",
  "id": 317584663,
  "labels": [
    {
      "color": "84b6eb",
      "default": true,
      "description": "Feature requests. Not bugs or questions.",
      "id": 421403909,
      "name": "enhancement",
      "node_id": "MDU6TGFiZWw0MjE0MDM5MDk=",
      "url": "https://api.github.com/repos/envoyproxy/envoy/labels/enhancement"
    },
    {
      "color": "fbca04",
      "default": true,
      "description": "Needs help!",
      "id": 645516726,
      "name": "help wanted",
      "node_id": "MDU6TGFiZWw2NDU1MTY3MjY=",
      "url": "https://api.github.com/repos/envoyproxy/envoy/labels/help%20wanted"
    }
  ],
  "labels_url": "https://api.github.com/repos/envoyproxy/envoy/issues/3205/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUzMTc1ODQ2NjM=",
  "number": 3205,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/envoyproxy/envoy",
  "state": "closed",
  "title": "grpc transcoder: support HttpBody proto",
  "updated_at": "2018-07-13T14:18:02Z",
  "url": "https://api.github.com/repos/envoyproxy/envoy/issues/3205",
  "user": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/6998145?v=4",
    "events_url": "https://api.github.com/users/lps0535/events{/privacy}",
    "followers_url": "https://api.github.com/users/lps0535/followers",
    "following_url": "https://api.github.com/users/lps0535/following{/other_user}",
    "gists_url": "https://api.github.com/users/lps0535/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/lps0535",
    "id": 6998145,
    "login": "lps0535",
    "node_id": "MDQ6VXNlcjY5OTgxNDU=",
    "organizations_url": "https://api.github.com/users/lps0535/orgs",
    "received_events_url": "https://api.github.com/users/lps0535/received_events",
    "repos_url": "https://api.github.com/users/lps0535/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/lps0535/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/lps0535/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/lps0535"
  }
}