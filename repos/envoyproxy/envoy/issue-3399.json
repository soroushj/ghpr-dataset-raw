{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/2023366?v=4",
    "events_url": "https://api.github.com/users/snowp/events{/privacy}",
    "followers_url": "https://api.github.com/users/snowp/followers",
    "following_url": "https://api.github.com/users/snowp/following{/other_user}",
    "gists_url": "https://api.github.com/users/snowp/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/snowp",
    "id": 2023366,
    "login": "snowp",
    "node_id": "MDQ6VXNlcjIwMjMzNjY=",
    "organizations_url": "https://api.github.com/users/snowp/orgs",
    "received_events_url": "https://api.github.com/users/snowp/received_events",
    "repos_url": "https://api.github.com/users/snowp/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/snowp/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/snowp/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/snowp"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars3.githubusercontent.com/u/2023366?v=4",
      "events_url": "https://api.github.com/users/snowp/events{/privacy}",
      "followers_url": "https://api.github.com/users/snowp/followers",
      "following_url": "https://api.github.com/users/snowp/following{/other_user}",
      "gists_url": "https://api.github.com/users/snowp/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/snowp",
      "id": 2023366,
      "login": "snowp",
      "node_id": "MDQ6VXNlcjIwMjMzNjY=",
      "organizations_url": "https://api.github.com/users/snowp/orgs",
      "received_events_url": "https://api.github.com/users/snowp/received_events",
      "repos_url": "https://api.github.com/users/snowp/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/snowp/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/snowp/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/snowp"
    }
  ],
  "author_association": "CONTRIBUTOR",
  "body": "Using envoy at 71c0fd695e992e21d2e0439eb14b449fa0b8aea4 and java-control-plane we've run into an issue where envoy fails to load all the RDS resources at boot. \r\n\r\nEnvoy is configured with two listeners, using two route tables (`standard_egress`/`standard_ingress`). Envoy begins by requesting the routes for *just* `standard_egress`, and gets this back with version = X. Following this it requests `[standard_egress, standard_ingress]` but since the nonce is the same the control plane ignores the request. Finally, envoy requests `[standard_egress, standard_ingress]` again with version X. Because the version matches what the control plane has, it doesn't send the requested resources right away, instead waiting for the next time the resources are updated. This leaves Envoy without a route table for `standard_ingress`, resulting in 404s.\r\n\r\nRaw logs from the control plane: \r\n```\r\n2018-05-16T08:10:52,156  INFO [rpc-server-dispatcher-9] server.DiscoveryServer - [1] request type.googleapis.com/envoy.api.v2.RouteConfiguration[standard_egress] with nonce  from version\r\n2018-05-16T08:10:52,158  INFO [rpc-server-dispatcher-9] cache.SimpleCache - responding for type.googleapis.com/envoy.api.v2.RouteConfiguration from node slug--LOCAL at version  with version 0f9e47ac-faba-4b9f-a3bd-5e94c6b7dc35\r\n2018-05-16T08:10:52,158  INFO [rpc-server-dispatcher-9] server.DiscoveryServer - [1] response type.googleapis.com/envoy.api.v2.RouteConfiguration with nonce 1 version 0f9e47ac-faba-4b9f-a3bd-5e94c6b7dc35\r\n2018-05-16T08:10:52,162  INFO [rpc-server-dispatcher-10] server.DiscoveryServer - [1] request type.googleapis.com/envoy.api.v2.RouteConfiguration[standard_ingress, standard_egress] with nonce  from version\r\n2018-05-16T08:10:52,168  INFO [rpc-server-dispatcher-12] server.DiscoveryServer - [1] request type.googleapis.com/envoy.api.v2.RouteConfiguration[standard_ingress, standard_egress] with nonce 1 from version 0f9e47ac-faba-4b9f-a3bd-5e94c6b7dc35\r\n2018-05-16T08:10:52,170  INFO [rpc-server-dispatcher-12] cache.SimpleCache - open watch 5 for type.googleapis.com/envoy.api.v2.RouteConfiguration[standard_ingress, standard_egress] from node slug--LOCAL for version 0f9e47ac-faba-4b9f-a3bd-5e94c6b7dc35\r\n```\r\n\r\nWhat is the expected way of handling this? Not clear to me whether this is a control plane bug or an envoy bug - should the control plane update its version when new resources are requested? Or should envoy reset its version when it sends a request with new resources? or maybe wait until it knows what resources to request before sending the xDS request?\r\n\r\n",
  "closed_at": "2018-05-22T10:35:10Z",
  "closed_by": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/10914751?v=4",
    "events_url": "https://api.github.com/users/htuch/events{/privacy}",
    "followers_url": "https://api.github.com/users/htuch/followers",
    "following_url": "https://api.github.com/users/htuch/following{/other_user}",
    "gists_url": "https://api.github.com/users/htuch/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/htuch",
    "id": 10914751,
    "login": "htuch",
    "node_id": "MDQ6VXNlcjEwOTE0NzUx",
    "organizations_url": "https://api.github.com/users/htuch/orgs",
    "received_events_url": "https://api.github.com/users/htuch/received_events",
    "repos_url": "https://api.github.com/users/htuch/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/htuch/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/htuch/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/htuch"
  },
  "comments": 9,
  "comments_url": "https://api.github.com/repos/envoyproxy/envoy/issues/3399/comments",
  "created_at": "2018-05-16T12:50:39Z",
  "events_url": "https://api.github.com/repos/envoyproxy/envoy/issues/3399/events",
  "html_url": "https://github.com/envoyproxy/envoy/issues/3399",
  "id": 323606400,
  "labels": [
    {
      "color": "ee0701",
      "default": true,
      "description": null,
      "id": 421403907,
      "name": "bug",
      "node_id": "MDU6TGFiZWw0MjE0MDM5MDc=",
      "url": "https://api.github.com/repos/envoyproxy/envoy/labels/bug"
    }
  ],
  "labels_url": "https://api.github.com/repos/envoyproxy/envoy/issues/3399/labels{/name}",
  "locked": false,
  "milestone": {
    "closed_at": "2018-06-23T16:17:31Z",
    "closed_issues": 70,
    "created_at": "2018-03-05T22:43:00Z",
    "creator": {
      "avatar_url": "https://avatars3.githubusercontent.com/u/6305260?v=4",
      "events_url": "https://api.github.com/users/mattklein123/events{/privacy}",
      "followers_url": "https://api.github.com/users/mattklein123/followers",
      "following_url": "https://api.github.com/users/mattklein123/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattklein123/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mattklein123",
      "id": 6305260,
      "login": "mattklein123",
      "node_id": "MDQ6VXNlcjYzMDUyNjA=",
      "organizations_url": "https://api.github.com/users/mattklein123/orgs",
      "received_events_url": "https://api.github.com/users/mattklein123/received_events",
      "repos_url": "https://api.github.com/users/mattklein123/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mattklein123/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattklein123/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mattklein123"
    },
    "description": "",
    "due_on": null,
    "html_url": "https://github.com/envoyproxy/envoy/milestone/6",
    "id": 3163642,
    "labels_url": "https://api.github.com/repos/envoyproxy/envoy/milestones/6/labels",
    "node_id": "MDk6TWlsZXN0b25lMzE2MzY0Mg==",
    "number": 6,
    "open_issues": 0,
    "state": "closed",
    "title": "1.7.0",
    "updated_at": "2018-06-23T16:17:31Z",
    "url": "https://api.github.com/repos/envoyproxy/envoy/milestones/6"
  },
  "node_id": "MDU6SXNzdWUzMjM2MDY0MDA=",
  "number": 3399,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/envoyproxy/envoy",
  "state": "closed",
  "title": "RDS update stuck on boot",
  "updated_at": "2018-05-22T10:35:10Z",
  "url": "https://api.github.com/repos/envoyproxy/envoy/issues/3399",
  "user": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/2023366?v=4",
    "events_url": "https://api.github.com/users/snowp/events{/privacy}",
    "followers_url": "https://api.github.com/users/snowp/followers",
    "following_url": "https://api.github.com/users/snowp/following{/other_user}",
    "gists_url": "https://api.github.com/users/snowp/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/snowp",
    "id": 2023366,
    "login": "snowp",
    "node_id": "MDQ6VXNlcjIwMjMzNjY=",
    "organizations_url": "https://api.github.com/users/snowp/orgs",
    "received_events_url": "https://api.github.com/users/snowp/received_events",
    "repos_url": "https://api.github.com/users/snowp/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/snowp/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/snowp/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/snowp"
  }
}