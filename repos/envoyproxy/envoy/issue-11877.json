{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/10914751?v=4",
    "events_url": "https://api.github.com/users/htuch/events{/privacy}",
    "followers_url": "https://api.github.com/users/htuch/followers",
    "following_url": "https://api.github.com/users/htuch/following{/other_user}",
    "gists_url": "https://api.github.com/users/htuch/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/htuch",
    "id": 10914751,
    "login": "htuch",
    "node_id": "MDQ6VXNlcjEwOTE0NzUx",
    "organizations_url": "https://api.github.com/users/htuch/orgs",
    "received_events_url": "https://api.github.com/users/htuch/received_events",
    "repos_url": "https://api.github.com/users/htuch/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/htuch/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/htuch/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/htuch"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars1.githubusercontent.com/u/10914751?v=4",
      "events_url": "https://api.github.com/users/htuch/events{/privacy}",
      "followers_url": "https://api.github.com/users/htuch/followers",
      "following_url": "https://api.github.com/users/htuch/following{/other_user}",
      "gists_url": "https://api.github.com/users/htuch/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/htuch",
      "id": 10914751,
      "login": "htuch",
      "node_id": "MDQ6VXNlcjEwOTE0NzUx",
      "organizations_url": "https://api.github.com/users/htuch/orgs",
      "received_events_url": "https://api.github.com/users/htuch/received_events",
      "repos_url": "https://api.github.com/users/htuch/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/htuch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/htuch/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/htuch"
    }
  ],
  "author_association": "CONTRIBUTOR",
  "body": "We've noticed a segfault in our envoys when updating a cluster via CDS from using plain TCP to TLS with validation context provided via SDS.\r\n\r\nAttached are the initial version, the update that caused the segfault and the printed stack, the only thing added is the transport socket configuration pointing to SDS.\r\n[previous_version.txt](https://github.com/envoyproxy/envoy/files/4866371/previous_version.txt)\r\n[updated_version.txt](https://github.com/envoyproxy/envoy/files/4866372/updated_version.txt)\r\n[stack.txt](https://github.com/envoyproxy/envoy/files/4866381/stack.txt)\r\n\r\n\r\nSome comments:\r\n- Crashing envoys are registered to updates of this cluster but not all are actively handling traffic for this cluster\r\n- Not all our envoys subscribed to this cluster crash, haven't found a relation yet.\r\n- We've had this happen in envoys running 1.14.1 and 1.15 from master, but we've seen similar issues since envoy 1.12 I recall.\r\n- We're using DeltaXds with ADS and everything in v3.\r\n- The SDS resource named \"validation_context\" is used by multiple clusters and is actually loaded statically by envoy during bootstrap\r\n- The logs are from an envoy running 1.15 built from master, our logging system looses order, so the logs could be somehow unordered.\r\n- Envoy was not built with debugging symbols so we cannot translate to lines, but we'll try to reproduce this.",
  "closed_at": "2020-07-24T04:10:51Z",
  "closed_by": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/10914751?v=4",
    "events_url": "https://api.github.com/users/htuch/events{/privacy}",
    "followers_url": "https://api.github.com/users/htuch/followers",
    "following_url": "https://api.github.com/users/htuch/following{/other_user}",
    "gists_url": "https://api.github.com/users/htuch/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/htuch",
    "id": 10914751,
    "login": "htuch",
    "node_id": "MDQ6VXNlcjEwOTE0NzUx",
    "organizations_url": "https://api.github.com/users/htuch/orgs",
    "received_events_url": "https://api.github.com/users/htuch/received_events",
    "repos_url": "https://api.github.com/users/htuch/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/htuch/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/htuch/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/htuch"
  },
  "comments": 22,
  "comments_url": "https://api.github.com/repos/envoyproxy/envoy/issues/11877/comments",
  "created_at": "2020-07-02T19:59:06Z",
  "events_url": "https://api.github.com/repos/envoyproxy/envoy/issues/11877/events",
  "html_url": "https://github.com/envoyproxy/envoy/issues/11877",
  "id": 650172506,
  "labels": [
    {
      "color": "bcdbf4",
      "default": false,
      "description": "SDS related",
      "id": 2054167604,
      "name": "area/sds",
      "node_id": "MDU6TGFiZWwyMDU0MTY3NjA0",
      "url": "https://api.github.com/repos/envoyproxy/envoy/labels/area/sds"
    },
    {
      "color": "ee0701",
      "default": true,
      "description": null,
      "id": 421403907,
      "name": "bug",
      "node_id": "MDU6TGFiZWw0MjE0MDM5MDc=",
      "url": "https://api.github.com/repos/envoyproxy/envoy/labels/bug"
    }
  ],
  "labels_url": "https://api.github.com/repos/envoyproxy/envoy/issues/11877/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU2NTAxNzI1MDY=",
  "number": 11877,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/envoyproxy/envoy",
  "state": "closed",
  "title": "Segfault when updating cluster to TLS with SDS",
  "updated_at": "2020-07-24T04:10:51Z",
  "url": "https://api.github.com/repos/envoyproxy/envoy/issues/11877",
  "user": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/3072509?v=4",
    "events_url": "https://api.github.com/users/sschepens/events{/privacy}",
    "followers_url": "https://api.github.com/users/sschepens/followers",
    "following_url": "https://api.github.com/users/sschepens/following{/other_user}",
    "gists_url": "https://api.github.com/users/sschepens/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/sschepens",
    "id": 3072509,
    "login": "sschepens",
    "node_id": "MDQ6VXNlcjMwNzI1MDk=",
    "organizations_url": "https://api.github.com/users/sschepens/orgs",
    "received_events_url": "https://api.github.com/users/sschepens/received_events",
    "repos_url": "https://api.github.com/users/sschepens/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/sschepens/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/sschepens/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/sschepens"
  }
}