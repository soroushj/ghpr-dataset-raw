{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "MEMBER",
  "body": "*Title*: build: clang-8 failures on async_client_impl.cc\r\n\r\n*Description*:\r\nAfter upgrading to clang-8 tooling, I'm unable to compile parts of Envoy due to some build errors regarding implicitly deleted default constructors. I'm not sure if this is an environment error or not but I was able to compile things correctly prior to merging master recently. I can try to fix these, but I'd like to understand if others are seeing the same errors and if the potential suggestions in the error log even make sense. \r\n\r\nbazel build --action_env=CXX=clang++ --action_env=CC=clang --linkopt=-fuse-ld=lld  //source/common/grpc:async_client_lib\r\n\r\n```\r\nclang --version 8.0.0\r\nbazel version 0.24.1\r\n```\r\n\r\nerror log\r\n\r\n```\r\nUse --sandbox_debug to see verbose messages from the sandbox.\r\nsource/common/http/async_client_impl.cc:22:73: error: call to implicitly-deleted default constructor of 'const AsyncStreamImpl::NullRetryPolicy'\r\nconst AsyncStreamImpl::NullRetryPolicy AsyncStreamImpl::RouteEntryImpl::retry_policy_;\r\n                                                                        ^\r\nbazel-out/k8-fastbuild/bin/source/common/http/_virtual_includes/async_client_lib/common/http/async_client_impl.h:152:33: note: default constructor of 'NullRetryPolicy' is implicitly deleted because field 'retriable_status_codes_' of const-qualified type 'const std::vector<uint32_t>' (aka 'const vector<unsigned int>') would not be initialized\r\n    const std::vector<uint32_t> retriable_status_codes_;\r\n                                ^\r\nIn file included from source/common/http/async_client_impl.cc:1:\r\nIn file included from bazel-out/k8-fastbuild/bin/source/common/http/_virtual_includes/async_client_lib/common/http/async_client_impl.h:19:\r\nIn file included from bazel-out/k8-fastbuild/bin/include/envoy/router/_virtual_includes/router_interface/envoy/router/router.h:19:\r\nIn file included from bazel-out/k8-fastbuild/bin/include/envoy/upstream/_virtual_includes/retry_interface/envoy/upstream/retry.h:4:\r\nIn file included from bazel-out/k8-fastbuild/bin/include/envoy/upstream/_virtual_includes/upstream_interface/envoy/upstream/upstream.h:22:\r\nIn file included from bazel-out/k8-fastbuild/bin/include/envoy/upstream/_virtual_includes/locality_lib/envoy/upstream/locality.h:5:\r\nIn file included from bazel-out/k8-fastbuild/bin/source/common/protobuf/_virtual_includes/utility_lib/common/protobuf/utility.h:15:\r\nbazel-out/k8-fastbuild/bin/source/common/singleton/_virtual_includes/const_singleton/common/singleton/const_singleton.h:18:30: error: call to implicitly-deleted default constructor of 'Envoy::Tracing::EgressConfigImpl'\r\n    static T* instance = new T();\r\n                             ^\r\nsource/common/http/async_client_impl.cc:81:46: note: in instantiation of member function 'Envoy::ConstSingleton<Envoy::Tracing::EgressConfigImpl>::get' requested here\r\n      tracing_config_(Tracing::EgressConfig::get()),\r\n                                             ^\r\nbazel-out/k8-fastbuild/bin/source/common/tracing/_virtual_includes/http_tracer_lib/common/tracing/http_tracer_impl.h:120:44: note: default constructor of 'EgressConfigImpl' is implicitly deleted because field 'request_headers_for_tags_' of const-qualified type 'const std::vector<Http::LowerCaseString>' would not be initialized\r\n  const std::vector<Http::LowerCaseString> request_headers_for_tags_;\r\n                                           ^\r\n2 errors generated.\r\nUse --sandbox_debug to see verbose messages from the sandbox.\r\nIn file included from source/common/grpc/async_client_impl.cc:1:\r\nIn file included from bazel-out/k8-fastbuild/bin/source/common/grpc/_virtual_includes/async_client_lib/common/grpc/async_client_impl.h:7:\r\nIn file included from bazel-out/k8-fastbuild/bin/source/common/http/_virtual_includes/async_client_lib/common/http/async_client_impl.h:19:\r\nIn file included from bazel-out/k8-fastbuild/bin/include/envoy/router/_virtual_includes/router_interface/envoy/router/router.h:19:\r\nIn file included from bazel-out/k8-fastbuild/bin/include/envoy/upstream/_virtual_includes/retry_interface/envoy/upstream/retry.h:4:\r\nIn file included from bazel-out/k8-fastbuild/bin/include/envoy/upstream/_virtual_includes/upstream_interface/envoy/upstream/upstream.h:22:\r\nIn file included from bazel-out/k8-fastbuild/bin/include/envoy/upstream/_virtual_includes/locality_lib/envoy/upstream/locality.h:5:\r\nIn file included from bazel-out/k8-fastbuild/bin/source/common/protobuf/_virtual_includes/utility_lib/common/protobuf/utility.h:15:\r\nbazel-out/k8-fastbuild/bin/source/common/singleton/_virtual_includes/const_singleton/common/singleton/const_singleton.h:18:30: error: call to implicitly-deleted default constructor of 'Envoy::Tracing::EgressConfigImpl'\r\n    static T* instance = new T();\r\n                             ^\r\nsource/common/grpc/async_client_impl.cc:212:65: note: in instantiation of member function 'Envoy::ConstSingleton<Envoy::Tracing::EgressConfigImpl>::get' requested here\r\n  current_span_ = parent_span.spawnChild(Tracing::EgressConfig::get(),\r\n                                                                ^\r\nbazel-out/k8-fastbuild/bin/source/common/tracing/_virtual_includes/http_tracer_lib/common/tracing/http_tracer_impl.h:120:44: note: default constructor of 'EgressConfigImpl' is implicitly deleted because field 'request_headers_for_tags_' of const-qualified type 'const std::vector<Http::LowerCaseString>' would not be initialized\r\n  const std::vector<Http::LowerCaseString> request_headers_for_tags_;\r\n                                           ^\r\n1 error generated.\r\nAspect @intellij_aspect//:intellij_info_bundled.bzl%intellij_info_aspect of //source/common/grpc:async_client_lib failed to build\r\nINFO: Elapsed time: 7.432s, Critical Path: 7.22s\r\nINFO: 0 processes.\r\nMake failed\r\n```\r\n\r\n",
  "closed_at": "2019-04-17T03:29:13Z",
  "closed_by": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/10914751?v=4",
    "events_url": "https://api.github.com/users/htuch/events{/privacy}",
    "followers_url": "https://api.github.com/users/htuch/followers",
    "following_url": "https://api.github.com/users/htuch/following{/other_user}",
    "gists_url": "https://api.github.com/users/htuch/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/htuch",
    "id": 10914751,
    "login": "htuch",
    "node_id": "MDQ6VXNlcjEwOTE0NzUx",
    "organizations_url": "https://api.github.com/users/htuch/orgs",
    "received_events_url": "https://api.github.com/users/htuch/received_events",
    "repos_url": "https://api.github.com/users/htuch/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/htuch/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/htuch/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/htuch"
  },
  "comments": 1,
  "comments_url": "https://api.github.com/repos/envoyproxy/envoy/issues/6584/comments",
  "created_at": "2019-04-15T19:55:47Z",
  "events_url": "https://api.github.com/repos/envoyproxy/envoy/issues/6584/events",
  "html_url": "https://github.com/envoyproxy/envoy/issues/6584",
  "id": 433452046,
  "labels": [
    {
      "color": "5319e7",
      "default": false,
      "description": "",
      "id": 545563713,
      "name": "area/build",
      "node_id": "MDU6TGFiZWw1NDU1NjM3MTM=",
      "url": "https://api.github.com/repos/envoyproxy/envoy/labels/area/build"
    }
  ],
  "labels_url": "https://api.github.com/repos/envoyproxy/envoy/issues/6584/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU0MzM0NTIwNDY=",
  "number": 6584,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/envoyproxy/envoy",
  "state": "closed",
  "title": "build: clang-8 failures on async_client_impl.cc",
  "updated_at": "2019-04-17T03:29:13Z",
  "url": "https://api.github.com/repos/envoyproxy/envoy/issues/6584",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/4790487?v=4",
    "events_url": "https://api.github.com/users/cmluciano/events{/privacy}",
    "followers_url": "https://api.github.com/users/cmluciano/followers",
    "following_url": "https://api.github.com/users/cmluciano/following{/other_user}",
    "gists_url": "https://api.github.com/users/cmluciano/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/cmluciano",
    "id": 4790487,
    "login": "cmluciano",
    "node_id": "MDQ6VXNlcjQ3OTA0ODc=",
    "organizations_url": "https://api.github.com/users/cmluciano/orgs",
    "received_events_url": "https://api.github.com/users/cmluciano/received_events",
    "repos_url": "https://api.github.com/users/cmluciano/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/cmluciano/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cmluciano/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/cmluciano"
  }
}