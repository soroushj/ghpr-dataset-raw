{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "CONTRIBUTOR",
  "body": "**Issue Template**\r\n\r\n*Title*: Address::Instance equality implemented through string compare\r\n\r\n*Description*:\r\nThe currently implementations of Address::Instance (Ipv4instance, Ipv6Instance, and PipeInstance) all inherit from InstanceBase, which implements operator== as:\r\n\r\n  bool operator==(const Instance& rhs) const override { return asString() == rhs.asString(); }\r\n\r\nThis works, but is a) dependent on the derived classes having a 1-1 mapping between string representations and unique instances, and b) not a very efficient method of computing equality for Ipv4 and Ipv6 addresses.  If we implement any algorithms that need to scale and compare Instances frequently, the string compare cost could be significant.\r\n\r\nUnfortunately, the current method has the advantage of working (modulo (a) above) on all derived classes of Address::Instance, current&future, core envoy and downstream specializations as it is defined in terms of methods on Instance.  Individual derived types could use RTTI to determine if the type being compared to was a known type, and implement the comparison in a more efficient fashion if it was.  If it is desirable that RTTI be avoided, a visitor design pattern could be implemented on the Instance to do double dispatch on the types of the two objects being compared.   However, this involves a non-trivial change to the interface of the abstract base class.\r\n\r\n@htuch : I hadn't figured out when we were talking what the implications of \"We should do this upstream\" were.  Given the above paragraph, do you have any prefereces?\r\n\r\n",
  "closed_at": "2018-06-12T18:39:56Z",
  "closed_by": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/6305260?v=4",
    "events_url": "https://api.github.com/users/mattklein123/events{/privacy}",
    "followers_url": "https://api.github.com/users/mattklein123/followers",
    "following_url": "https://api.github.com/users/mattklein123/following{/other_user}",
    "gists_url": "https://api.github.com/users/mattklein123/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/mattklein123",
    "id": 6305260,
    "login": "mattklein123",
    "node_id": "MDQ6VXNlcjYzMDUyNjA=",
    "organizations_url": "https://api.github.com/users/mattklein123/orgs",
    "received_events_url": "https://api.github.com/users/mattklein123/received_events",
    "repos_url": "https://api.github.com/users/mattklein123/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/mattklein123/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mattklein123/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/mattklein123"
  },
  "comments": 1,
  "comments_url": "https://api.github.com/repos/envoyproxy/envoy/issues/3529/comments",
  "created_at": "2018-06-03T19:54:18Z",
  "events_url": "https://api.github.com/repos/envoyproxy/envoy/issues/3529/events",
  "html_url": "https://github.com/envoyproxy/envoy/issues/3529",
  "id": 328856876,
  "labels": [
    {
      "color": "fbca04",
      "default": true,
      "description": "Needs help!",
      "id": 645516726,
      "name": "help wanted",
      "node_id": "MDU6TGFiZWw2NDU1MTY3MjY=",
      "url": "https://api.github.com/repos/envoyproxy/envoy/labels/help%20wanted"
    },
    {
      "color": "0e8a16",
      "default": false,
      "description": null,
      "id": 527497761,
      "name": "tech debt",
      "node_id": "MDU6TGFiZWw1Mjc0OTc3NjE=",
      "url": "https://api.github.com/repos/envoyproxy/envoy/labels/tech%20debt"
    }
  ],
  "labels_url": "https://api.github.com/repos/envoyproxy/envoy/issues/3529/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUzMjg4NTY4NzY=",
  "number": 3529,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/envoyproxy/envoy",
  "state": "closed",
  "title": "Address::Instance equality implemented through string compare",
  "updated_at": "2018-06-12T18:39:56Z",
  "url": "https://api.github.com/repos/envoyproxy/envoy/issues/3529",
  "user": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/252255?v=4",
    "events_url": "https://api.github.com/users/curiouserrandy/events{/privacy}",
    "followers_url": "https://api.github.com/users/curiouserrandy/followers",
    "following_url": "https://api.github.com/users/curiouserrandy/following{/other_user}",
    "gists_url": "https://api.github.com/users/curiouserrandy/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/curiouserrandy",
    "id": 252255,
    "login": "curiouserrandy",
    "node_id": "MDQ6VXNlcjI1MjI1NQ==",
    "organizations_url": "https://api.github.com/users/curiouserrandy/orgs",
    "received_events_url": "https://api.github.com/users/curiouserrandy/received_events",
    "repos_url": "https://api.github.com/users/curiouserrandy/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/curiouserrandy/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/curiouserrandy/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/curiouserrandy"
  }
}