{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "CONTRIBUTOR",
  "body": "We have a use case where for the same virtual host different the request needs to be routed differently based on the source of the request.\r\n\r\nThere are two different ways to distinguish the source:\r\n1) Whether the the request comes from the same node where Envoy is running. Where for the request socket: `tcp.src_address == tcp.dst_address`. This check catches local connections on all interfaces.\r\n2) The request's tcp.src_address belongs to a specific subnet ex. 192.168.0.0/24\r\n\r\nOne possible solution I see is to extend the RouteMatch structure with:\r\n\r\n```\r\nmessage RouteMatch {\r\n  ...\r\n  enun RequestSourceType {\r\n    // Request is comming from withing the same network node as Envoy\r\n    SAME_HOST = 0,\r\n    // Request is comming from outside of the node\r\n    EXTERNAL_HOST = 1,\r\n  }\r\n  oneof source {\r\n    RequestSourceType source_type;\r\n    repeated string source_subnet;\r\n  } \r\n}\r\n```\r\n\r\nThanks",
  "closed_at": "2018-12-17T00:38:52Z",
  "closed_by": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/6305260?v=4",
    "events_url": "https://api.github.com/users/mattklein123/events{/privacy}",
    "followers_url": "https://api.github.com/users/mattklein123/followers",
    "following_url": "https://api.github.com/users/mattklein123/following{/other_user}",
    "gists_url": "https://api.github.com/users/mattklein123/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/mattklein123",
    "id": 6305260,
    "login": "mattklein123",
    "node_id": "MDQ6VXNlcjYzMDUyNjA=",
    "organizations_url": "https://api.github.com/users/mattklein123/orgs",
    "received_events_url": "https://api.github.com/users/mattklein123/received_events",
    "repos_url": "https://api.github.com/users/mattklein123/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/mattklein123/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mattklein123/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/mattklein123"
  },
  "comments": 32,
  "comments_url": "https://api.github.com/repos/envoyproxy/envoy/issues/4535/comments",
  "created_at": "2018-09-26T15:37:35Z",
  "events_url": "https://api.github.com/repos/envoyproxy/envoy/issues/4535/events",
  "html_url": "https://github.com/envoyproxy/envoy/issues/4535",
  "id": 364093109,
  "labels": [
    {
      "color": "84b6eb",
      "default": true,
      "description": "Feature requests. Not bugs or questions.",
      "id": 421403909,
      "name": "enhancement",
      "node_id": "MDU6TGFiZWw0MjE0MDM5MDk=",
      "url": "https://api.github.com/repos/envoyproxy/envoy/labels/enhancement"
    },
    {
      "color": "fbca04",
      "default": true,
      "description": "Needs help!",
      "id": 645516726,
      "name": "help wanted",
      "node_id": "MDU6TGFiZWw2NDU1MTY3MjY=",
      "url": "https://api.github.com/repos/envoyproxy/envoy/labels/help%20wanted"
    }
  ],
  "labels_url": "https://api.github.com/repos/envoyproxy/envoy/issues/4535/labels{/name}",
  "locked": false,
  "milestone": {
    "closed_at": "2018-12-21T19:26:51Z",
    "closed_issues": 62,
    "created_at": "2018-09-21T05:26:05Z",
    "creator": {
      "avatar_url": "https://avatars3.githubusercontent.com/u/6305260?v=4",
      "events_url": "https://api.github.com/users/mattklein123/events{/privacy}",
      "followers_url": "https://api.github.com/users/mattklein123/followers",
      "following_url": "https://api.github.com/users/mattklein123/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattklein123/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mattklein123",
      "id": 6305260,
      "login": "mattklein123",
      "node_id": "MDQ6VXNlcjYzMDUyNjA=",
      "organizations_url": "https://api.github.com/users/mattklein123/orgs",
      "received_events_url": "https://api.github.com/users/mattklein123/received_events",
      "repos_url": "https://api.github.com/users/mattklein123/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mattklein123/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattklein123/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mattklein123"
    },
    "description": "",
    "due_on": null,
    "html_url": "https://github.com/envoyproxy/envoy/milestone/8",
    "id": 3676682,
    "labels_url": "https://api.github.com/repos/envoyproxy/envoy/milestones/8/labels",
    "node_id": "MDk6TWlsZXN0b25lMzY3NjY4Mg==",
    "number": 8,
    "open_issues": 0,
    "state": "closed",
    "title": "1.9.0",
    "updated_at": "2018-12-21T19:26:51Z",
    "url": "https://api.github.com/repos/envoyproxy/envoy/milestones/8"
  },
  "node_id": "MDU6SXNzdWUzNjQwOTMxMDk=",
  "number": 4535,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/envoyproxy/envoy",
  "state": "closed",
  "title": "Extend RouteMatch to support matching based on the request source",
  "updated_at": "2018-12-17T06:49:13Z",
  "url": "https://api.github.com/repos/envoyproxy/envoy/issues/4535",
  "user": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/11193886?v=4",
    "events_url": "https://api.github.com/users/georgi-d/events{/privacy}",
    "followers_url": "https://api.github.com/users/georgi-d/followers",
    "following_url": "https://api.github.com/users/georgi-d/following{/other_user}",
    "gists_url": "https://api.github.com/users/georgi-d/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/georgi-d",
    "id": 11193886,
    "login": "georgi-d",
    "node_id": "MDQ6VXNlcjExMTkzODg2",
    "organizations_url": "https://api.github.com/users/georgi-d/orgs",
    "received_events_url": "https://api.github.com/users/georgi-d/received_events",
    "repos_url": "https://api.github.com/users/georgi-d/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/georgi-d/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/georgi-d/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/georgi-d"
  }
}