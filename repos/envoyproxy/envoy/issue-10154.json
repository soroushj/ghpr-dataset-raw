{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/6305260?v=4",
    "events_url": "https://api.github.com/users/mattklein123/events{/privacy}",
    "followers_url": "https://api.github.com/users/mattklein123/followers",
    "following_url": "https://api.github.com/users/mattklein123/following{/other_user}",
    "gists_url": "https://api.github.com/users/mattklein123/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/mattklein123",
    "id": 6305260,
    "login": "mattklein123",
    "node_id": "MDQ6VXNlcjYzMDUyNjA=",
    "organizations_url": "https://api.github.com/users/mattklein123/orgs",
    "received_events_url": "https://api.github.com/users/mattklein123/received_events",
    "repos_url": "https://api.github.com/users/mattklein123/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/mattklein123/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mattklein123/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/mattklein123"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars3.githubusercontent.com/u/6305260?v=4",
      "events_url": "https://api.github.com/users/mattklein123/events{/privacy}",
      "followers_url": "https://api.github.com/users/mattklein123/followers",
      "following_url": "https://api.github.com/users/mattklein123/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattklein123/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mattklein123",
      "id": 6305260,
      "login": "mattklein123",
      "node_id": "MDQ6VXNlcjYzMDUyNjA=",
      "organizations_url": "https://api.github.com/users/mattklein123/orgs",
      "received_events_url": "https://api.github.com/users/mattklein123/received_events",
      "repos_url": "https://api.github.com/users/mattklein123/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mattklein123/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattklein123/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mattklein123"
    }
  ],
  "author_association": "CONTRIBUTOR",
  "body": "*Title*:\"/tap admin endpoint is taken\" error on hot reloads\r\n\r\n*Description*:\r\nAfter enabling the tap filter via the config snippet below, we are getting errors when attempting to reload Envoy. Shutting down envoy and doing a full restart works flawlessly.\r\n\r\nEnvoy version `1.12.2.p0.g55af249-1p49.g8b1f2e3`, using https://www.getenvoy.io/ packages.\r\n\r\n```yaml\r\n- name: envoy.filters.http.tap\r\n  typed_config:\r\n    \"@type\": type.googleapis.com/envoy.config.filter.http.tap.v2alpha.Tap\r\n    common_config:\r\n      admin_config:\r\n        config_id: some_config_id\r\n```\r\n\r\nWe are using the [hot reload script provided by Envoy](https://www.envoyproxy.io/docs/envoy/latest/operations/hot_restarter).\r\n\r\nHere is the exception stack trace we get when we try to perform a reload, while the configuration above is active (log edited for readability since it's originally very wide):\r\n\r\n```\r\n[info][main] [external/envoy/source/server/server.cc:455] runtime: layers:\r\n  - name: base\r\n    static_layer:\r\n      {}\r\n  - name: admin\r\n    admin_layer:\r\n      {}\r\n[info][config] [external/envoy/source/server/configuration_impl.cc:62] loading 0 static secret(s)\r\n[info][config] [external/envoy/source/server/configuration_impl.cc:68] loading 2 cluster(s)\r\n[warning][runtime] [external/envoy/source/common/runtime/runtime_impl.cc:63] Unable to use runtime singleton for feature envoy.reloadable_features.strict_header_validation\r\n[warning][runtime] [external/envoy/source/common/runtime/runtime_impl.cc:63] Unable to use runtime singleton for feature envoy.reloadable_features.connection_header_sanitization\r\n[info][config] [external/envoy/source/server/configuration_impl.cc:72] loading 3 listener(s)\r\n[critical][assert] [external/envoy/source/extensions/common/tap/admin.cc:33] assert failure: rc. Details: /tap admin endpoint is taken\r\n[critical][backtrace] Caught Aborted, suspect faulting address 0xb42d\r\n[critical][backtrace] Backtrace (use tools/stack_decode.py to get line numbers):\r\n[critical][backtrace] Envoy version: bb7ceff4c3c5bd4555dff28b6e56d27f2f8be0a7/1.13.0/clean-getenvoy-4bd7718-envoy/RELEASE/BoringSSL\r\n[critical][backtrace] #0: __restore_rt [0x7f6635337890]\r\n[critical][backtrace] #1: std::__1::__function::__func<>::operator()() [0x55f53760faa0]\r\n[critical][backtrace] #2: Envoy::Singleton::ManagerImpl::get() [0x55f5376eb019]\r\n[critical][backtrace] #3: Envoy::Singleton::Manager::getTyped<>() [0x55f53760e80e]\r\n[critical][backtrace] #4: Envoy::Extensions::Common::Tap::AdminHandler::getSingleton() [0x55f53760e6f7]\r\n[critical][backtrace] #5: Envoy::Extensions::Common::Tap::ExtensionConfigBase::ExtensionConfigBase() [0x55f53760da0a]\r\n[critical][backtrace] #6: Envoy::Extensions::HttpFilters::TapFilter::FilterConfigImpl::FilterConfigImpl() [0x55f53700864e]\r\n[critical][backtrace] #7: Envoy::Extensions::HttpFilters::TapFilter::TapFilterFactory::createFilterFactoryFromProtoTyped() [0x55f537005865]\r\n[critical][backtrace] #8: Envoy::Extensions::HttpFilters::Common::FactoryBase<>::createFilterFactoryFromProto() [0x55f537005c2f]\r\n[critical][backtrace] #9: Envoy::Extensions::NetworkFilters::HttpConnectionManager::HttpConnectionManagerConfig::processFilter() [0x55f5376a57d3]\r\n[critical][backtrace] #10: Envoy::Extensions::NetworkFilters::HttpConnectionManager::HttpConnectionManagerConfig::HttpConnectionManagerConfig() [0x55f5376a4373]\r\n[critical][backtrace] #11: Envoy::Extensions::NetworkFilters::HttpConnectionManager::HttpConnectionManagerFilterConfigFactory::createFilterFactoryFromProtoTyped() [0x55f5376a270b]\r\n[critical][backtrace] #12: Envoy::Extensions::NetworkFilters::Common::FactoryBase<>::createFilterFactoryFromProto() [0x55f5376a69b6]\r\n[critical][backtrace] #13: Envoy::Server::ProdListenerComponentFactory::createNetworkFilterFactoryList_() [0x55f537673aeb]\r\n[critical][backtrace] #14: Envoy::Server::ValidationInstance::createNetworkFilterFactoryList() [0x55f53764f384]\r\n[critical][backtrace] #15: Envoy::Server::ListenerFilterChainFactoryBuilder::buildFilterChainInternal() [0x55f53767b0ca]\r\n[critical][backtrace] #16: Envoy::Server::ListenerFilterChainFactoryBuilder::buildFilterChain() [0x55f53767af50]\r\n[critical][backtrace] #17: Envoy::Server::FilterChainManagerImpl::addFilterChain() [0x55f5376819b0]\r\n[critical][backtrace] #18: Envoy::Server::ListenerImpl::ListenerImpl() [0x55f53766faa4]\r\n[critical][backtrace] #19: Envoy::Server::ListenerManagerImpl::addOrUpdateListenerInternal() [0x55f537677c34]\r\n[critical][backtrace] #20: Envoy::Server::ListenerManagerImpl::addOrUpdateListener() [0x55f537677438]\r\n[critical][backtrace] #21: Envoy::Server::Configuration::MainImpl::initialize() [0x55f53769cfeb]\r\n[critical][backtrace] #22: Envoy::Server::ValidationInstance::initialize() [0x55f53764e5e9]\r\n[critical][backtrace] #23: Envoy::Server::ValidationInstance::ValidationInstance() [0x55f53764d2d5]\r\n[critical][backtrace] #24: Envoy::Server::validateConfig() [0x55f53764c4ad]\r\n[critical][backtrace] #25: Envoy::MainCommonBase::run() [0x55f536d3e52a]\r\n[critical][backtrace] #26: main [0x55f536d3d152]\r\n[critical][backtrace] #27: __libc_start_main [0x7f6634f55b97]\r\n```",
  "closed_at": "2020-07-14T20:17:29Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/6007532?v=4",
    "events_url": "https://api.github.com/users/junr03/events{/privacy}",
    "followers_url": "https://api.github.com/users/junr03/followers",
    "following_url": "https://api.github.com/users/junr03/following{/other_user}",
    "gists_url": "https://api.github.com/users/junr03/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/junr03",
    "id": 6007532,
    "login": "junr03",
    "node_id": "MDQ6VXNlcjYwMDc1MzI=",
    "organizations_url": "https://api.github.com/users/junr03/orgs",
    "received_events_url": "https://api.github.com/users/junr03/received_events",
    "repos_url": "https://api.github.com/users/junr03/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/junr03/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/junr03/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/junr03"
  },
  "comments": 12,
  "comments_url": "https://api.github.com/repos/envoyproxy/envoy/issues/10154/comments",
  "created_at": "2020-02-25T09:18:58Z",
  "events_url": "https://api.github.com/repos/envoyproxy/envoy/issues/10154/events",
  "html_url": "https://github.com/envoyproxy/envoy/issues/10154",
  "id": 570422635,
  "labels": [
    {
      "color": "5319e7",
      "default": false,
      "description": "",
      "id": 1251701895,
      "name": "area/tap",
      "node_id": "MDU6TGFiZWwxMjUxNzAxODk1",
      "url": "https://api.github.com/repos/envoyproxy/envoy/labels/area/tap"
    },
    {
      "color": "ee0701",
      "default": true,
      "description": null,
      "id": 421403907,
      "name": "bug",
      "node_id": "MDU6TGFiZWw0MjE0MDM5MDc=",
      "url": "https://api.github.com/repos/envoyproxy/envoy/labels/bug"
    },
    {
      "color": "fbca04",
      "default": true,
      "description": "Needs help!",
      "id": 645516726,
      "name": "help wanted",
      "node_id": "MDU6TGFiZWw2NDU1MTY3MjY=",
      "url": "https://api.github.com/repos/envoyproxy/envoy/labels/help%20wanted"
    }
  ],
  "labels_url": "https://api.github.com/repos/envoyproxy/envoy/issues/10154/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU1NzA0MjI2MzU=",
  "number": 10154,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/envoyproxy/envoy",
  "state": "closed",
  "title": "\"/tap admin endpoint is taken\" error on hot reloads",
  "updated_at": "2020-08-10T07:12:35Z",
  "url": "https://api.github.com/repos/envoyproxy/envoy/issues/10154",
  "user": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/630613?v=4",
    "events_url": "https://api.github.com/users/perlun/events{/privacy}",
    "followers_url": "https://api.github.com/users/perlun/followers",
    "following_url": "https://api.github.com/users/perlun/following{/other_user}",
    "gists_url": "https://api.github.com/users/perlun/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/perlun",
    "id": 630613,
    "login": "perlun",
    "node_id": "MDQ6VXNlcjYzMDYxMw==",
    "organizations_url": "https://api.github.com/users/perlun/orgs",
    "received_events_url": "https://api.github.com/users/perlun/received_events",
    "repos_url": "https://api.github.com/users/perlun/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/perlun/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/perlun/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/perlun"
  }
}