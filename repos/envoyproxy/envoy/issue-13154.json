{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "CONTRIBUTOR",
  "body": "*Title*: build: enable -Wrange-loop-analysis\r\n\r\n*Context*:\r\n\r\nIn https://github.com/envoyproxy/envoy/issues/13139 we noticed that building with Xcode 12 enables `-Wrange-loop-analysis` and yields errors preventing Envoy from building. More specifically, this affected Envoy Mobile when building for iOS. The code errors in Envoy code consumed by Envoy Mobile were fixed in https://github.com/envoyproxy/envoy/pull/13140, but there are some third parties (not depended on by Envoy Mobile) that prevent us from enabling this build rule in Envoy.\r\n\r\nFor example:\r\n\r\n```\r\nbazel-out/darwin-fastbuild/bin/external/com_googlesource_quiche/quiche/spdy/core/hpack/hpack_header_table.cc:258:19: error: loop variable 'it' of type 'const std::__1::pair<const std::__1::basic_string_view<char, std::__1::char_traits<char> >, const spdy::HpackEntry *>' creates a copy from type 'const std::__1::pair<const std::__1::basic_string_view<char, std::__1::char_traits<char> >, const spdy::HpackEntry *>' [-Werror,-Wrange-loop-analysis]\r\n  for (const auto it : static_name_index_) {\r\n                  ^\r\nbazel-out/darwin-fastbuild/bin/external/com_googlesource_quiche/quiche/spdy/core/hpack/hpack_header_table.cc:258:8: note: use reference type 'const std::__1::pair<const std::__1::basic_string_view<char, std::__1::char_traits<char> >, const spdy::HpackEntry *> &' to prevent copying\r\n  for (const auto it : static_name_index_) {\r\n       ^~~~~~~~~~~~~~~\r\nbazel-out/darwin-fastbuild/bin/external/com_googlesource_quiche/quiche/spdy/core/hpack/hpack_header_table.cc:266:19: error: loop variable 'it' of type 'const std::__1::pair<const std::__1::basic_string_view<char, std::__1::char_traits<char> >, const spdy::HpackEntry *>' creates a copy from type 'const std::__1::pair<const std::__1::basic_string_view<char, std::__1::char_traits<char> >, const spdy::HpackEntry *>' [-Werror,-Wrange-loop-analysis]\r\n  for (const auto it : dynamic_name_index_) {\r\n                  ^\r\nbazel-out/darwin-fastbuild/bin/external/com_googlesource_quiche/quiche/spdy/core/hpack/hpack_header_table.cc:266:8: note: use reference type 'const std::__1::pair<const std::__1::basic_string_view<char, std::__1::char_traits<char> >, const spdy::HpackEntry *> &' to prevent copying\r\n  for (const auto it : dynamic_name_index_) {\r\n       ^~~~~~~~~~~~~~~\r\n2 errors generated.\r\n```\r\n\r\n*Ask*:\r\n\r\nEnable the `-Wrange-loop-analysis` rule in Envoy for building once we're able to (after third parties are fixed) to avoid future build failures caused by this error in Envoy Mobile.",
  "closed_at": "2020-10-05T20:00:21Z",
  "closed_by": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/6305260?v=4",
    "events_url": "https://api.github.com/users/mattklein123/events{/privacy}",
    "followers_url": "https://api.github.com/users/mattklein123/followers",
    "following_url": "https://api.github.com/users/mattklein123/following{/other_user}",
    "gists_url": "https://api.github.com/users/mattklein123/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/mattklein123",
    "id": 6305260,
    "login": "mattklein123",
    "node_id": "MDQ6VXNlcjYzMDUyNjA=",
    "organizations_url": "https://api.github.com/users/mattklein123/orgs",
    "received_events_url": "https://api.github.com/users/mattklein123/received_events",
    "repos_url": "https://api.github.com/users/mattklein123/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/mattklein123/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mattklein123/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/mattklein123"
  },
  "comments": 12,
  "comments_url": "https://api.github.com/repos/envoyproxy/envoy/issues/13154/comments",
  "created_at": "2020-09-17T19:07:54Z",
  "events_url": "https://api.github.com/repos/envoyproxy/envoy/issues/13154/events",
  "html_url": "https://github.com/envoyproxy/envoy/issues/13154",
  "id": 703838497,
  "labels": [
    {
      "color": "5319e7",
      "default": false,
      "description": "",
      "id": 545563713,
      "name": "area/build",
      "node_id": "MDU6TGFiZWw1NDU1NjM3MTM=",
      "url": "https://api.github.com/repos/envoyproxy/envoy/labels/area/build"
    },
    {
      "color": "fbca04",
      "default": true,
      "description": "Needs help!",
      "id": 645516726,
      "name": "help wanted",
      "node_id": "MDU6TGFiZWw2NDU1MTY3MjY=",
      "url": "https://api.github.com/repos/envoyproxy/envoy/labels/help%20wanted"
    }
  ],
  "labels_url": "https://api.github.com/repos/envoyproxy/envoy/issues/13154/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU3MDM4Mzg0OTc=",
  "number": 13154,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/envoyproxy/envoy",
  "state": "closed",
  "title": "build: enable -Wrange-loop-analysis",
  "updated_at": "2020-10-05T20:00:21Z",
  "url": "https://api.github.com/repos/envoyproxy/envoy/issues/13154",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/2643476?v=4",
    "events_url": "https://api.github.com/users/rebello95/events{/privacy}",
    "followers_url": "https://api.github.com/users/rebello95/followers",
    "following_url": "https://api.github.com/users/rebello95/following{/other_user}",
    "gists_url": "https://api.github.com/users/rebello95/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/rebello95",
    "id": 2643476,
    "login": "rebello95",
    "node_id": "MDQ6VXNlcjI2NDM0NzY=",
    "organizations_url": "https://api.github.com/users/rebello95/orgs",
    "received_events_url": "https://api.github.com/users/rebello95/received_events",
    "repos_url": "https://api.github.com/users/rebello95/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/rebello95/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rebello95/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/rebello95"
  }
}