{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/587468?v=4",
    "events_url": "https://api.github.com/users/gsagula/events{/privacy}",
    "followers_url": "https://api.github.com/users/gsagula/followers",
    "following_url": "https://api.github.com/users/gsagula/following{/other_user}",
    "gists_url": "https://api.github.com/users/gsagula/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/gsagula",
    "id": 587468,
    "login": "gsagula",
    "node_id": "MDQ6VXNlcjU4NzQ2OA==",
    "organizations_url": "https://api.github.com/users/gsagula/orgs",
    "received_events_url": "https://api.github.com/users/gsagula/received_events",
    "repos_url": "https://api.github.com/users/gsagula/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/gsagula/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gsagula/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/gsagula"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars1.githubusercontent.com/u/587468?v=4",
      "events_url": "https://api.github.com/users/gsagula/events{/privacy}",
      "followers_url": "https://api.github.com/users/gsagula/followers",
      "following_url": "https://api.github.com/users/gsagula/following{/other_user}",
      "gists_url": "https://api.github.com/users/gsagula/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/gsagula",
      "id": 587468,
      "login": "gsagula",
      "node_id": "MDQ6VXNlcjU4NzQ2OA==",
      "organizations_url": "https://api.github.com/users/gsagula/orgs",
      "received_events_url": "https://api.github.com/users/gsagula/received_events",
      "repos_url": "https://api.github.com/users/gsagula/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/gsagula/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gsagula/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/gsagula"
    }
  ],
  "author_association": "NONE",
  "body": "*B3 HTTP headers are not propagated to ext_authz server*\r\n\r\n*Description*:\r\nUpgrading from Envoy 1.9.0 to 1.10.0 omits the Zipkin trace context propagation (B3 headers) to an external HTTP authorization server and hence is not visible in a distributed trace.\r\n\r\nUsing Envoy 1.9.0 the following config propagates B3 trace context (x-b3-traceid and x-b3-spanid headers) to an external auth server so it can join a distributed trace.\r\n```\r\n- name: envoy.ext_authz\r\n     config:\r\n       http_service:\r\n         server_uri:\r\n           uri: http://authorization-service:8080\r\n           cluster: ext-authz\r\n           timeout: 2s\r\n         allowed_request_headers: [\"x-b3-traceid\", \"x-b3-spanid\"]\r\n```\r\n\r\nWith Envoy 1.10.0 this configuration has changed (see https://www.envoyproxy.io/docs/envoy/v1.10.0/intro/version_history) and the corresponding config looks like\r\n```\r\n- name: envoy.ext_authz\r\n     config:\r\n       http_service:\r\n         server_uri:\r\n           uri: http://authorization-service:8080\r\n           cluster: ext-authz\r\n           timeout: 2s\r\n         authorization_request:\r\n           allowed_headers:\r\n             patterns:\r\n               prefix: \"x-b3\"\r\n```\r\nHowever, in 1.10.0 none of the x-b3-* keys are added in HTTP headers and hence the external authz. server can't be part of the trace. I've tried several patterns (exact, prefix, regex) to see if there are any issues with the StringMatcher but without any luck :(\r\n\r\nNote that it is only the external auth.server that doesn't get the HTTP headers, I can see the trace which is initiated by Envoy in my tracing UI (Jeager) but without the external auth.server so some parts of the trace is working as expected.",
  "closed_at": "2019-11-09T17:21:27Z",
  "closed_by": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/6305260?v=4",
    "events_url": "https://api.github.com/users/mattklein123/events{/privacy}",
    "followers_url": "https://api.github.com/users/mattklein123/followers",
    "following_url": "https://api.github.com/users/mattklein123/following{/other_user}",
    "gists_url": "https://api.github.com/users/mattklein123/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/mattklein123",
    "id": 6305260,
    "login": "mattklein123",
    "node_id": "MDQ6VXNlcjYzMDUyNjA=",
    "organizations_url": "https://api.github.com/users/mattklein123/orgs",
    "received_events_url": "https://api.github.com/users/mattklein123/received_events",
    "repos_url": "https://api.github.com/users/mattklein123/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/mattklein123/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mattklein123/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/mattklein123"
  },
  "comments": 37,
  "comments_url": "https://api.github.com/repos/envoyproxy/envoy/issues/6520/comments",
  "created_at": "2019-04-09T06:49:26Z",
  "events_url": "https://api.github.com/repos/envoyproxy/envoy/issues/6520/events",
  "html_url": "https://github.com/envoyproxy/envoy/issues/6520",
  "id": 430795490,
  "labels": [
    {
      "color": "ee0701",
      "default": true,
      "description": null,
      "id": 421403907,
      "name": "bug",
      "node_id": "MDU6TGFiZWw0MjE0MDM5MDc=",
      "url": "https://api.github.com/repos/envoyproxy/envoy/labels/bug"
    },
    {
      "color": "fbca04",
      "default": true,
      "description": "Needs help!",
      "id": 645516726,
      "name": "help wanted",
      "node_id": "MDU6TGFiZWw2NDU1MTY3MjY=",
      "url": "https://api.github.com/repos/envoyproxy/envoy/labels/help%20wanted"
    }
  ],
  "labels_url": "https://api.github.com/repos/envoyproxy/envoy/issues/6520/labels{/name}",
  "locked": false,
  "milestone": {
    "closed_at": "2019-11-03T23:59:23Z",
    "closed_issues": 73,
    "created_at": "2019-07-03T16:32:43Z",
    "creator": {
      "avatar_url": "https://avatars3.githubusercontent.com/u/6305260?v=4",
      "events_url": "https://api.github.com/users/mattklein123/events{/privacy}",
      "followers_url": "https://api.github.com/users/mattklein123/followers",
      "following_url": "https://api.github.com/users/mattklein123/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattklein123/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mattklein123",
      "id": 6305260,
      "login": "mattklein123",
      "node_id": "MDQ6VXNlcjYzMDUyNjA=",
      "organizations_url": "https://api.github.com/users/mattklein123/orgs",
      "received_events_url": "https://api.github.com/users/mattklein123/received_events",
      "repos_url": "https://api.github.com/users/mattklein123/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mattklein123/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattklein123/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mattklein123"
    },
    "description": "",
    "due_on": null,
    "html_url": "https://github.com/envoyproxy/envoy/milestone/11",
    "id": 4463348,
    "labels_url": "https://api.github.com/repos/envoyproxy/envoy/milestones/11/labels",
    "node_id": "MDk6TWlsZXN0b25lNDQ2MzM0OA==",
    "number": 11,
    "open_issues": 0,
    "state": "closed",
    "title": "1.12.0",
    "updated_at": "2019-11-09T17:21:27Z",
    "url": "https://api.github.com/repos/envoyproxy/envoy/milestones/11"
  },
  "node_id": "MDU6SXNzdWU0MzA3OTU0OTA=",
  "number": 6520,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/envoyproxy/envoy",
  "state": "closed",
  "title": "B3 HTTP headers not propagated to ext_authz server in 1.10.0",
  "updated_at": "2019-11-09T20:53:44Z",
  "url": "https://api.github.com/repos/envoyproxy/envoy/issues/6520",
  "user": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/4103786?v=4",
    "events_url": "https://api.github.com/users/enbohm/events{/privacy}",
    "followers_url": "https://api.github.com/users/enbohm/followers",
    "following_url": "https://api.github.com/users/enbohm/following{/other_user}",
    "gists_url": "https://api.github.com/users/enbohm/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/enbohm",
    "id": 4103786,
    "login": "enbohm",
    "node_id": "MDQ6VXNlcjQxMDM3ODY=",
    "organizations_url": "https://api.github.com/users/enbohm/orgs",
    "received_events_url": "https://api.github.com/users/enbohm/received_events",
    "repos_url": "https://api.github.com/users/enbohm/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/enbohm/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/enbohm/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/enbohm"
  }
}