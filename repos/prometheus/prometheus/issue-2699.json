{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "CONTRIBUTOR",
  "body": "**What did you do?**\r\nRan P2 from checkout https://github.com/prometheus/prometheus/commit/ff0ee264aea5ac7f8b757433e226c0e4c708cf52.\r\nWe have an external job that SIGHUPs prometheus when config reloads. There is a potential race condition between the first SIGHUP and prometheus being ready. That bug was fixed in P1, but seems to be back in P2.\r\n\r\n\r\n**What did you see instead? Under which circumstances?**\r\n\r\n```\r\n2017-05-09T14:00:15.768151000Z 2017/05/09 14:00:15 dinit: pid 37 finished: [/prometheus/prometheus -config.file=/prometheus.yml -log.level=info -query.staleness-delta=60s -query.max-concurrency=100 -query.timeout=2m -storage.local.path=/prometheus-data -storage.tsdb.appendable-blocks=2 -storage.tsdb.max-block-duration=36h -storage.tsdb.min-block-duration=2h -storage.tsdb.retention=360h -storage.tsdb.no-lockfile=true -web.external-url=http://hubmon2.h-te1.internal.improbable.io:9090/] with error: signal: hangup\r\n```\r\n\r\nThe `error: signal: hangup` shouldn't happen.  Note: this is *after* Prometheus starts with an existing volume and existing data, so the issue may be in the code initializing the TSDB.\r\n\r\n@fabxc ",
  "closed_at": "2017-05-10T08:20:51Z",
  "closed_by": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/9655971?v=4",
    "events_url": "https://api.github.com/users/mwitkow/events{/privacy}",
    "followers_url": "https://api.github.com/users/mwitkow/followers",
    "following_url": "https://api.github.com/users/mwitkow/following{/other_user}",
    "gists_url": "https://api.github.com/users/mwitkow/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/mwitkow",
    "id": 9655971,
    "login": "mwitkow",
    "node_id": "MDQ6VXNlcjk2NTU5NzE=",
    "organizations_url": "https://api.github.com/users/mwitkow/orgs",
    "received_events_url": "https://api.github.com/users/mwitkow/received_events",
    "repos_url": "https://api.github.com/users/mwitkow/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/mwitkow/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mwitkow/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/mwitkow"
  },
  "comments": 4,
  "comments_url": "https://api.github.com/repos/prometheus/prometheus/issues/2699/comments",
  "created_at": "2017-05-09T14:52:59Z",
  "events_url": "https://api.github.com/repos/prometheus/prometheus/issues/2699/events",
  "html_url": "https://github.com/prometheus/prometheus/issues/2699",
  "id": 227393808,
  "labels": [],
  "labels_url": "https://api.github.com/repos/prometheus/prometheus/issues/2699/labels{/name}",
  "locked": true,
  "milestone": null,
  "node_id": "MDU6SXNzdWUyMjczOTM4MDg=",
  "number": 2699,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/prometheus/prometheus",
  "state": "closed",
  "title": "Prometheus 2: sighup not handled gracefully during initialization phase",
  "updated_at": "2019-03-23T18:44:36Z",
  "url": "https://api.github.com/repos/prometheus/prometheus/issues/2699",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/9655971?v=4",
    "events_url": "https://api.github.com/users/mwitkow/events{/privacy}",
    "followers_url": "https://api.github.com/users/mwitkow/followers",
    "following_url": "https://api.github.com/users/mwitkow/following{/other_user}",
    "gists_url": "https://api.github.com/users/mwitkow/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/mwitkow",
    "id": 9655971,
    "login": "mwitkow",
    "node_id": "MDQ6VXNlcjk2NTU5NzE=",
    "organizations_url": "https://api.github.com/users/mwitkow/orgs",
    "received_events_url": "https://api.github.com/users/mwitkow/received_events",
    "repos_url": "https://api.github.com/users/mwitkow/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/mwitkow/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mwitkow/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/mwitkow"
  }
}