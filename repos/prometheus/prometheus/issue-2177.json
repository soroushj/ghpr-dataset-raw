{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "CONTRIBUTOR",
  "body": "**What did you do?**\r\n\r\nRan a Prometheus instance configured to use remote storage on a system with a broken DNS configuration.\r\n\r\nI don't have the exact command-line on me. I can construct a likely equivalent if necessary.\r\n\r\n**What did you expect to see?**\r\n\r\nError messages in the logs informing me that the remote host couldn't be discovered due to DNS lookup failures.\r\n\r\n**What did you see instead? Under which circumstances?**\r\n\r\n```\r\n$ cat logs | cut -f 1 -d ' ' --complement | sort | uniq -c | sort -n | grep -v -e '^\\s*1\\b'\r\n      5 level=info msg=\"Checkpointing in-memory metrics and chunks...\" source=\"persistence.go:549\"\r\n    198 level=warning msg=\"error sending 100 samples to remote storage: Post http://hostname:80/api/prom/push: dial tcp: lookup hostname on 10.96.0.10:53: dial udp 10.96.0.10:53: i/o timeout\" source=\"queue_manager.go:246\"\r\n    369 level=warning msg=\"error sending 100 samples to remote storage: context deadline exceeded\" source=\"queue_manager.go:246\"\r\n6660847 level=warning msg=\"Remote storage queue full, discarding sample.\" source=\"queue_manager.go:169\"\r\n```\r\n\r\nThat is, there were 30000 times as many `Remote storage queue full, discarding sample` messages as there were `dial tcp: lookup hostname on 10.96.0.10:53: dial udp 10.96.0.10:53: i/o timeout` failures.\r\n\r\nThis lead to the problem being misreported to me (\"it says the queue is full\") and made it harder than necessary to diagnose the root cause (i.e. that DNS was broken).\r\n\r\n**Environment**\r\n\r\nUbuntu 16.04 LTS images running on EC2. Prometheus itself was running as a container in a Kubernetes cluster.\r\n\r\n* System information:\r\n\r\nAlas, system has been wiped out now.\r\n\r\n* Prometheus version: \r\n\r\nAlas, I didn't capture exact output, but it was reported to me as 1.3.1.\r\n\r\n* Prometheus configuration file:\r\n\r\nCan provide equivalent on request.\r\n\r\n* Logs:\r\n\r\nAll I have left is the summary above.",
  "closed_at": "2017-02-23T18:20:40Z",
  "closed_by": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/538008?v=4",
    "events_url": "https://api.github.com/users/juliusv/events{/privacy}",
    "followers_url": "https://api.github.com/users/juliusv/followers",
    "following_url": "https://api.github.com/users/juliusv/following{/other_user}",
    "gists_url": "https://api.github.com/users/juliusv/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/juliusv",
    "id": 538008,
    "login": "juliusv",
    "node_id": "MDQ6VXNlcjUzODAwOA==",
    "organizations_url": "https://api.github.com/users/juliusv/orgs",
    "received_events_url": "https://api.github.com/users/juliusv/received_events",
    "repos_url": "https://api.github.com/users/juliusv/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/juliusv/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/juliusv/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/juliusv"
  },
  "comments": 2,
  "comments_url": "https://api.github.com/repos/prometheus/prometheus/issues/2177/comments",
  "created_at": "2016-11-08T16:04:02Z",
  "events_url": "https://api.github.com/repos/prometheus/prometheus/issues/2177/events",
  "html_url": "https://github.com/prometheus/prometheus/issues/2177",
  "id": 188031848,
  "labels": [],
  "labels_url": "https://api.github.com/repos/prometheus/prometheus/issues/2177/labels{/name}",
  "locked": true,
  "milestone": null,
  "node_id": "MDU6SXNzdWUxODgwMzE4NDg=",
  "number": 2177,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/prometheus/prometheus",
  "state": "closed",
  "title": "Too many warnings logged about remote storage queue being full",
  "updated_at": "2019-03-23T23:20:49Z",
  "url": "https://api.github.com/repos/prometheus/prometheus/issues/2177",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/125674?v=4",
    "events_url": "https://api.github.com/users/jml/events{/privacy}",
    "followers_url": "https://api.github.com/users/jml/followers",
    "following_url": "https://api.github.com/users/jml/following{/other_user}",
    "gists_url": "https://api.github.com/users/jml/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/jml",
    "id": 125674,
    "login": "jml",
    "node_id": "MDQ6VXNlcjEyNTY3NA==",
    "organizations_url": "https://api.github.com/users/jml/orgs",
    "received_events_url": "https://api.github.com/users/jml/received_events",
    "repos_url": "https://api.github.com/users/jml/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/jml/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jml/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/jml"
  }
}