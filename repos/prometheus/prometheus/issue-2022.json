{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "NONE",
  "body": "**What did you do?**\n\nprometheus -alertmanager.url=http://alertmanager-infra--0-4-1--mtq3ndm0odqxnw.service.us-east-1.consul:9093 -config.file=/etc/prometheus/prometheus.yml -log.level=debug\n\n**What did you expect to see?**\nPrometheus should start\n\n**What did you see instead? Under which circumstances?**\nERRO[0000] invalid Alertmanager URL: http://alertmanager-infra--0-4-1--mtq3ndm0odqxnw.service.us-east-1.consul  source=main.go:64\n\n**Environment**\nDocker Using phusion base image . Running docker with prometheus in net=host mode\n- System information:\n  \n  uname -srm\n  Linux 4.4.0-31-generic x86_64\n- Prometheus version: \n  \n  prometheus -version\n  prometheus, version 1.0.1 (branch: master, revision: be40190)\n  build user:       root@e881b289ce76\n  build date:       20160722-19:54:46\n  go version:       go1.6.2\n- Alertmanager version:\n- Prometheus configuration file:\n\n```\nglobal:\n  scrape_interval:     15s # By default, scrape targets every 15 seconds.\n  evaluation_interval: 15s # By default, scrape targets every 15 seconds.\n  # scrape_timeout is set to the global default (10s).\n\n  # The labels to add to any time series or alerts when communicating with\n  # external systems (federation, remote storage, Alertmanager).\n  external_labels:\n    apptype: 'infra'\n    datacenter: 'us-east-1'\n\nrule_files:\n  - /data/alert_rules/*.rules\n\n# A list of scrape configurations.\nscrape_configs:\n\n  - job_name: 'all-consul'\n    scrape_interval: 10s\n    scrape_timeout:  10s\n    consul_sd_configs:\n      - server: 'localhost:8500'\n        datacenter: us-east-1\n        services: [] \n    relabel_configs:\n      - source_labels: [__meta_consul_service]\n        target_label: job\n        # Use the instance ID as the instance label\n      - source_labels: ['__address__']\n        regex: '^(.+):.+'\n        target_label: __address__\n        replacement: '${1}:9100'\n      - source_labels: [__meta_consul_node]\n        target_label: instance\n\n\n\n```\n- Alertmanager configuration file:\n\n```\ninsert configuration here (if relevant to the issue)\n```\n- Logs:\n\n```\nERRO[0000] invalid Alertmanager URL: http://alertmanager-infra--0-4-1--mtq3ndm0odqxnw.service.us-east-1.consul  source=main.go:64\n```\n\nI see yall are using github.com/asaskevich/govalidator\n\nI did the following as a test \n\n```\ncheckurl.go \n\npackage main\n\nimport (\n  valid \"github.com/asaskevich/govalidator\"\n)\n\nfunc main() {\n    println(valid.IsURL(`http://alertmanager-infra--0-4-1--mtq3ndm0odqxnw.service.us-east-1.consul:9093`))\n}\n```\n\nWhen i run it\n\n```\ngo run checkurl.go \ntrue\n```\n\nWhy is prometheus failing to start up even when the url is valid?\n",
  "closed_at": "2016-09-22T23:06:51Z",
  "closed_by": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/538008?v=4",
    "events_url": "https://api.github.com/users/juliusv/events{/privacy}",
    "followers_url": "https://api.github.com/users/juliusv/followers",
    "following_url": "https://api.github.com/users/juliusv/following{/other_user}",
    "gists_url": "https://api.github.com/users/juliusv/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/juliusv",
    "id": 538008,
    "login": "juliusv",
    "node_id": "MDQ6VXNlcjUzODAwOA==",
    "organizations_url": "https://api.github.com/users/juliusv/orgs",
    "received_events_url": "https://api.github.com/users/juliusv/received_events",
    "repos_url": "https://api.github.com/users/juliusv/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/juliusv/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/juliusv/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/juliusv"
  },
  "comments": 3,
  "comments_url": "https://api.github.com/repos/prometheus/prometheus/issues/2022/comments",
  "created_at": "2016-09-22T16:45:48Z",
  "events_url": "https://api.github.com/repos/prometheus/prometheus/issues/2022/events",
  "html_url": "https://github.com/prometheus/prometheus/issues/2022",
  "id": 178662818,
  "labels": [],
  "labels_url": "https://api.github.com/repos/prometheus/prometheus/issues/2022/labels{/name}",
  "locked": true,
  "milestone": null,
  "node_id": "MDU6SXNzdWUxNzg2NjI4MTg=",
  "number": 2022,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/prometheus/prometheus",
  "state": "closed",
  "title": "Prometheus failing to start as it cannot validate alertmanager url ",
  "updated_at": "2019-03-24T05:20:12Z",
  "url": "https://api.github.com/repos/prometheus/prometheus/issues/2022",
  "user": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/8015568?v=4",
    "events_url": "https://api.github.com/users/mg03/events{/privacy}",
    "followers_url": "https://api.github.com/users/mg03/followers",
    "following_url": "https://api.github.com/users/mg03/following{/other_user}",
    "gists_url": "https://api.github.com/users/mg03/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/mg03",
    "id": 8015568,
    "login": "mg03",
    "node_id": "MDQ6VXNlcjgwMTU1Njg=",
    "organizations_url": "https://api.github.com/users/mg03/orgs",
    "received_events_url": "https://api.github.com/users/mg03/received_events",
    "repos_url": "https://api.github.com/users/mg03/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/mg03/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mg03/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/mg03"
  }
}