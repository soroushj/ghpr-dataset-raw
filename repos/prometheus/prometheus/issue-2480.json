{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/5609886?v=4",
    "events_url": "https://api.github.com/users/beorn7/events{/privacy}",
    "followers_url": "https://api.github.com/users/beorn7/followers",
    "following_url": "https://api.github.com/users/beorn7/following{/other_user}",
    "gists_url": "https://api.github.com/users/beorn7/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/beorn7",
    "id": 5609886,
    "login": "beorn7",
    "node_id": "MDQ6VXNlcjU2MDk4ODY=",
    "organizations_url": "https://api.github.com/users/beorn7/orgs",
    "received_events_url": "https://api.github.com/users/beorn7/received_events",
    "repos_url": "https://api.github.com/users/beorn7/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/beorn7/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/beorn7/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/beorn7"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars3.githubusercontent.com/u/5609886?v=4",
      "events_url": "https://api.github.com/users/beorn7/events{/privacy}",
      "followers_url": "https://api.github.com/users/beorn7/followers",
      "following_url": "https://api.github.com/users/beorn7/following{/other_user}",
      "gists_url": "https://api.github.com/users/beorn7/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/beorn7",
      "id": 5609886,
      "login": "beorn7",
      "node_id": "MDQ6VXNlcjU2MDk4ODY=",
      "organizations_url": "https://api.github.com/users/beorn7/orgs",
      "received_events_url": "https://api.github.com/users/beorn7/received_events",
      "repos_url": "https://api.github.com/users/beorn7/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/beorn7/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/beorn7/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/beorn7"
    }
  ],
  "author_association": "NONE",
  "body": "Reopen of https://github.com/prometheus/prometheus/issues/2339\r\n\r\n**What did you do?**\r\nRun Prometheus\r\n\r\n**What did you expect to see?**\r\nPrometheus is up and running\r\n\r\n**What did you see instead? Under which circumstances?**\r\nPrometheus crashed\r\n\r\n**Environment**\r\n\r\n* System information:\r\n\r\n\tLinux 4.7.3-coreos-r2 x86_64\r\n\r\n* Prometheus version: \r\n\r\n\tprometheus, version 1.5.2 (branch: master, revision: bd1182d29f462c39544f94cc822830e1c64cf55b)\r\n  build user:       root@1a01c5f68840\r\n  build date:       20170210-16:23:28\r\n  go version:       go1.7.5\r\n\r\n* Alertmanager version:\r\n\r\n\tN/A\r\n\r\n* Prometheus configuration file:\r\n```\r\n    global:\r\n      scrape_interval: 30s\r\n      scrape_timeout: 30s\r\n\r\n    rule_files:\r\n    - /etc/prometheus/alert.rules\r\n\r\n    scrape_configs:\r\n    - job_name: etcd\r\n      static_configs:\r\n        - targets:\r\n          - 10.72.132.6:2379\r\n          - 10.72.134.15:2379\r\n          - 10.72.146.27:2379\r\n          - 10.72.145.36:2379\r\n          - 10.72.144.241:2379\r\n\r\n    - job_name: 'prometheus'\r\n      static_configs:\r\n        - targets: ['localhost:9090']\r\n\r\n    - job_name: 'kube-state-metrics'\r\n      static_configs:\r\n        - targets: ['prometheus-kube-state-metrics:8080']\r\n\r\n    - job_name: 'kubernetes-apiservers'\r\n      kubernetes_sd_configs:\r\n      - role: endpoints\r\n      scheme: https\r\n      tls_config:\r\n        ca_file: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt\r\n        insecure_skip_verify: true\r\n      bearer_token_file: /var/run/secrets/kubernetes.io/serviceaccount/token\r\n      relabel_configs:\r\n      - source_labels: [__meta_kubernetes_namespace, __meta_kubernetes_service_name, __meta_kubernetes_endpoint_port_name]\r\n        action: keep\r\n        regex: default;kubernetes;https\r\n\r\n    - job_name: 'kube-dns-dnsmasq'\r\n      kubernetes_sd_configs:\r\n      - role: endpoints\r\n      scheme: http\r\n      relabel_configs:\r\n      - source_labels: [__meta_kubernetes_namespace, __meta_kubernetes_service_name, __meta_kubernetes_endpoint_port_name]\r\n        action: keep\r\n        regex: kube-system;kube-dns;metrics-sidecar\r\n\r\n    - job_name: 'kube-dns-skydns'\r\n      kubernetes_sd_configs:\r\n      - role: endpoints\r\n      scheme: http\r\n      relabel_configs:\r\n      - source_labels: [__meta_kubernetes_namespace, __meta_kubernetes_service_name, __meta_kubernetes_endpoint_port_name]\r\n        action: keep\r\n        regex: kube-system;kube-dns;metrics-kubedns\r\n\r\n    - job_name: 'kubernetes-nodes'\r\n      scheme: https\r\n      tls_config:\r\n        ca_file: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt\r\n        insecure_skip_verify: true\r\n      bearer_token_file: /var/run/secrets/kubernetes.io/serviceaccount/token\r\n      kubernetes_sd_configs:\r\n      - role: node\r\n      relabel_configs:\r\n      - action: labelmap\r\n        regex: __meta_kubernetes_node_label_(.+)\r\n\r\n    - job_name: 'kubernetes-service-endpoints'\r\n      scheme: https\r\n      kubernetes_sd_configs:\r\n      - role: endpoints\r\n      relabel_configs:\r\n      - source_labels: [__meta_kubernetes_service_annotation_prometheus_io_scrape]\r\n        action: keep\r\n        regex: true\r\n      - source_labels: [__meta_kubernetes_service_annotation_prometheus_io_scheme]\r\n        action: replace\r\n        target_label: __scheme__\r\n        regex: (https?)\r\n      - source_labels: [__meta_kubernetes_service_annotation_prometheus_io_path]\r\n        action: replace\r\n        target_label: __metrics_path__\r\n        regex: (.+)\r\n      - source_labels: [__address__, __meta_kubernetes_service_annotation_prometheus_io_port]\r\n        action: replace\r\n        target_label: __address__\r\n        regex: (.+)(?::\\d+);(\\d+)\r\n        replacement: $1:$2\r\n      - action: labelmap\r\n        regex: __meta_kubernetes_service_label_(.+)\r\n      - source_labels: [__meta_kubernetes_service_namespace]\r\n        action: replace\r\n        target_label: kubernetes_namespace\r\n      - source_labels: [__meta_kubernetes_service_name]\r\n        action: replace\r\n        target_label: kubernetes_name\r\n\r\n    - job_name: 'kubernetes-services'\r\n      scheme: https\r\n      metrics_path: /probe\r\n      params:\r\n        module: [http_2xx]\r\n      kubernetes_sd_configs:\r\n      - role: service\r\n      relabel_configs:\r\n      - source_labels: [__meta_kubernetes_service_annotation_prometheus_io_probe]\r\n        action: keep\r\n        regex: true\r\n      - source_labels: [__address__]\r\n        target_label: __param_target\r\n      - target_label: __address__\r\n        replacement: blackbox\r\n      - source_labels: [__param_target]\r\n        target_label: instance\r\n      - action: labelmap\r\n        regex: __meta_kubernetes_service_label_(.+)\r\n      - source_labels: [__meta_kubernetes_service_namespace]\r\n        target_label: kubernetes_namespace\r\n      - source_labels: [__meta_kubernetes_service_name]\r\n        target_label: kubernetes_name\r\n```\r\n\r\n* Alertmanager configuration file:\r\n\r\nN/A\r\n\r\n* Logs:\r\n```\r\ntime=\"2017-03-07T18:09:38Z\" level=info msg=\"Checkpointing in-memory metrics and chunks...\" source=\"persistence.go:612\" \r\ntime=\"2017-03-07T18:10:01Z\" level=info msg=\"Done checkpointing in-memory metrics and chunks in 22.980738545s.\" source=\"persistence.go:639\" \r\npanic: runtime error: invalid memory address or nil pointer dereference\r\n[signal SIGSEGV: segmentation violation code=0x1 addr=0xe pc=0x57ad22]\r\n\r\ngoroutine 640 [running]:\r\npanic(0x18b2120, 0xc420016030)\r\n        /usr/local/go/src/runtime/panic.go:500 +0x1a1\r\ngithub.com/prometheus/prometheus/storage/local/chunk.(*Desc).Add(0x6, 0x15aa9fa1597, 0x4147580000000000, 0x0, 0x0, 0x0, 0x5020105, 0x0)\r\n        /go/src/github.com/prometheus/prometheus/storage/local/chunk/chunk.go:136 +0x22\r\ngithub.com/prometheus/prometheus/storage/local.(*memorySeries).add(0xc4ae5f3490, 0x15aa9fa1597, 0x4147580000000000, 0xc4ae5f3490, 0x0, 0x0)\r\n        /go/src/github.com/prometheus/prometheus/storage/local/series.go:238 +0x115\r\ngithub.com/prometheus/prometheus/storage/local.(*MemorySeriesStorage).Append(0xc42038a6e0, 0xc5b48ee4c0, 0x0, 0x0)\r\n        /go/src/github.com/prometheus/prometheus/storage/local/storage.go:877 +0x398\r\ngithub.com/prometheus/prometheus/storage.Fanout.Append(0xc420536740, 0x2, 0x2, 0xc5b48ee4c0, 0xc4aff35488, 0x19e3620)\r\n        /go/src/github.com/prometheus/prometheus/storage/storage.go:60 +0x66\r\ngithub.com/prometheus/prometheus/storage.(*Fanout).Append(0xc4205369c0, 0xc5b48ee4c0, 0xc4b1b23440, 0x27257d0)\r\n        <autogenerated>:3 +0x6e\r\ngithub.com/prometheus/prometheus/retrieval.(*countingAppender).Append(0xc51b7396c0, 0xc5b48ee4c0, 0xc4a750fa28, 0xc4a750fa18)\r\n        /go/src/github.com/prometheus/prometheus/retrieval/target.go:301 +0x48\r\ngithub.com/prometheus/prometheus/retrieval.ruleLabelsAppender.Append(0x26876c0, 0xc51b7396c0, 0xc4d96b0000, 0xc5b48ee4c0, 0x0, 0x0)\r\n        /go/src/github.com/prometheus/prometheus/retrieval/target.go:241 +0x1b3\r\ngithub.com/prometheus/prometheus/retrieval.(*ruleLabelsAppender).Append(0xc51b739700, 0xc5b48ee4c0, 0x0, 0x0)\r\n        <autogenerated>:35 +0x6e\r\ngithub.com/prometheus/prometheus/retrieval.(*scrapeLoop).append(0xc4808cc230, 0xc4cfd16000, 0x7616, 0x9400, 0x1aaa6c5b, 0x27309c0, 0xc4cfd16000)\r\n        /go/src/github.com/prometheus/prometheus/retrieval/scrape.go:503 +0x2f1\r\ngithub.com/prometheus/prometheus/retrieval.(*scrapeLoop).run(0xc4808cc230, 0x6fc23ac00, 0x6fc23ac00, 0x0)\r\n        /go/src/github.com/prometheus/prometheus/retrieval/scrape.go:413 +0x5c3\r\ncreated by github.com/prometheus/prometheus/retrieval.(*scrapePool).sync\r\n        /go/src/github.com/prometheus/prometheus/retrieval/scrape.go:247 +0x3a4\r\n```\r\n",
  "closed_at": "2017-04-06T22:51:54Z",
  "closed_by": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/5609886?v=4",
    "events_url": "https://api.github.com/users/beorn7/events{/privacy}",
    "followers_url": "https://api.github.com/users/beorn7/followers",
    "following_url": "https://api.github.com/users/beorn7/following{/other_user}",
    "gists_url": "https://api.github.com/users/beorn7/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/beorn7",
    "id": 5609886,
    "login": "beorn7",
    "node_id": "MDQ6VXNlcjU2MDk4ODY=",
    "organizations_url": "https://api.github.com/users/beorn7/orgs",
    "received_events_url": "https://api.github.com/users/beorn7/received_events",
    "repos_url": "https://api.github.com/users/beorn7/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/beorn7/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/beorn7/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/beorn7"
  },
  "comments": 1,
  "comments_url": "https://api.github.com/repos/prometheus/prometheus/issues/2480/comments",
  "created_at": "2017-03-07T18:23:06Z",
  "events_url": "https://api.github.com/repos/prometheus/prometheus/issues/2480/events",
  "html_url": "https://github.com/prometheus/prometheus/issues/2480",
  "id": 212517367,
  "labels": [
    {
      "color": "ff0000",
      "default": false,
      "description": null,
      "id": 365563588,
      "name": "kind/bug",
      "node_id": "MDU6TGFiZWwzNjU1NjM1ODg=",
      "url": "https://api.github.com/repos/prometheus/prometheus/labels/kind/bug"
    }
  ],
  "labels_url": "https://api.github.com/repos/prometheus/prometheus/issues/2480/labels{/name}",
  "locked": true,
  "milestone": null,
  "node_id": "MDU6SXNzdWUyMTI1MTczNjc=",
  "number": 2480,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/prometheus/prometheus",
  "state": "closed",
  "title": "(Another) panic: runtime error: invalid memory address or nil pointer dereference ",
  "updated_at": "2019-03-23T19:45:26Z",
  "url": "https://api.github.com/repos/prometheus/prometheus/issues/2480",
  "user": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/324803?v=4",
    "events_url": "https://api.github.com/users/ichekrygin/events{/privacy}",
    "followers_url": "https://api.github.com/users/ichekrygin/followers",
    "following_url": "https://api.github.com/users/ichekrygin/following{/other_user}",
    "gists_url": "https://api.github.com/users/ichekrygin/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/ichekrygin",
    "id": 324803,
    "login": "ichekrygin",
    "node_id": "MDQ6VXNlcjMyNDgwMw==",
    "organizations_url": "https://api.github.com/users/ichekrygin/orgs",
    "received_events_url": "https://api.github.com/users/ichekrygin/received_events",
    "repos_url": "https://api.github.com/users/ichekrygin/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/ichekrygin/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ichekrygin/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/ichekrygin"
  }
}