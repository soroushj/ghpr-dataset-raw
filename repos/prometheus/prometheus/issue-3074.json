{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "CONTRIBUTOR",
  "body": "**What did you do?**\r\nusing a file sd to define the target groups.\r\n\r\n**What did you expect to see?**\r\nwrong discovery data should be skipped or warning, not panic.\r\n\r\n**What did you see instead? Under which circumstances?**\r\npanic, and the details is:\r\n```\r\nINFO[0000] Starting target manager...                    source=\"targetmanager.go:63\"\r\n\r\npanic: runtime error: invalid memory address or nil pointer dereference\r\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x28 pc=0x166053a]\r\n\r\ngoroutine 52 [running]:\r\ngithub.com/prometheus/prometheus/discovery/file.readFile(0xc42015e2a0, 0x1b, 0x1, 0x1, 0xc420b4a270, 0x3, 0x3)\r\n\t/Users/Jacky/Jacky.Wu/MyProjects/Go/src/github.com/prometheus/prometheus/discovery/file/file.go:259 +0x1ea\r\ngithub.com/prometheus/prometheus/discovery/file.(*Discovery).refresh(0xc420b28080, 0x3ea2080, 0xc420b28100, 0xc42001d620)\r\n\t/Users/Jacky/Jacky.Wu/MyProjects/Go/src/github.com/prometheus/prometheus/discovery/file/file.go:196 +0xfe\r\ngithub.com/prometheus/prometheus/discovery/file.(*Discovery).Run(0xc420b28080, 0x3ea2080, 0xc420b28100, 0xc42001d620)\r\n\t/Users/Jacky/Jacky.Wu/MyProjects/Go/src/github.com/prometheus/prometheus/discovery/file/file.go:121 +0x198\r\ncreated by github.com/prometheus/prometheus/discovery.(*TargetSet).updateProviders\r\n\t/Users/Jacky/Jacky.Wu/MyProjects/Go/src/github.com/prometheus/prometheus/discovery/discovery.go:249 +0x283\r\n```\r\n\r\n**Environment**\r\n\r\n* System information:\r\n\r\n\tLinux 3.16.0-4-amd64 x86_64\r\n\r\n* Prometheus version: \r\n\r\n```\r\n prometheus, version 1.6.0 (branch: master, revision: 10f645382988add09c8e3420d0d7ff2dc4d36a29)\r\n  build user:       root@0816a56aa81c\r\n  build date:       20170414-18:36:18\r\n  go version:       go1.8.1\r\n```\r\n\r\n* Alertmanager version:\r\n\r\n* Prometheus configuration file:\r\n```\r\n...\r\n  - job_name: 'nil-item-array-json-job'\r\n    metrics_path: /metrics\r\n    file_sd_configs:\r\n      - files:\r\n         - \"invalid_nil_item_array.json\"\r\n```\r\n\r\n```\r\n# invalid_nil_item_array.json\r\n# !!! the last null line caused panic!\r\n\r\n[\r\n    {\r\n        \"labels\": {\r\n            \"env\": \"prod\"\r\n        },\r\n        \"targets\": [\r\n            \"localhost:9090\"\r\n        ]\r\n    },\r\n    null\r\n]\r\n```\r\n",
  "closed_at": "2017-08-23T23:00:45Z",
  "closed_by": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/3432?v=4",
    "events_url": "https://api.github.com/users/grobie/events{/privacy}",
    "followers_url": "https://api.github.com/users/grobie/followers",
    "following_url": "https://api.github.com/users/grobie/following{/other_user}",
    "gists_url": "https://api.github.com/users/grobie/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/grobie",
    "id": 3432,
    "login": "grobie",
    "node_id": "MDQ6VXNlcjM0MzI=",
    "organizations_url": "https://api.github.com/users/grobie/orgs",
    "received_events_url": "https://api.github.com/users/grobie/received_events",
    "repos_url": "https://api.github.com/users/grobie/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/grobie/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/grobie/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/grobie"
  },
  "comments": 1,
  "comments_url": "https://api.github.com/repos/prometheus/prometheus/issues/3074/comments",
  "created_at": "2017-08-15T02:45:34Z",
  "events_url": "https://api.github.com/repos/prometheus/prometheus/issues/3074/events",
  "html_url": "https://github.com/prometheus/prometheus/issues/3074",
  "id": 250207626,
  "labels": [
    {
      "color": "0052cc",
      "default": false,
      "description": null,
      "id": 365567641,
      "name": "component/service discovery",
      "node_id": "MDU6TGFiZWwzNjU1Njc2NDE=",
      "url": "https://api.github.com/repos/prometheus/prometheus/labels/component/service%20discovery"
    },
    {
      "color": "ff0000",
      "default": false,
      "description": null,
      "id": 365563588,
      "name": "kind/bug",
      "node_id": "MDU6TGFiZWwzNjU1NjM1ODg=",
      "url": "https://api.github.com/repos/prometheus/prometheus/labels/kind/bug"
    },
    {
      "color": "eb6420",
      "default": false,
      "description": null,
      "id": 365563606,
      "name": "priority/P1",
      "node_id": "MDU6TGFiZWwzNjU1NjM2MDY=",
      "url": "https://api.github.com/repos/prometheus/prometheus/labels/priority/P1"
    }
  ],
  "labels_url": "https://api.github.com/repos/prometheus/prometheus/issues/3074/labels{/name}",
  "locked": true,
  "milestone": null,
  "node_id": "MDU6SXNzdWUyNTAyMDc2MjY=",
  "number": 3074,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/prometheus/prometheus",
  "state": "closed",
  "title": "[ BUG ] nil target item cause prometheus exit",
  "updated_at": "2019-03-23T10:44:44Z",
  "url": "https://api.github.com/repos/prometheus/prometheus/issues/3074",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/3972545?v=4",
    "events_url": "https://api.github.com/users/Colstuwjx/events{/privacy}",
    "followers_url": "https://api.github.com/users/Colstuwjx/followers",
    "following_url": "https://api.github.com/users/Colstuwjx/following{/other_user}",
    "gists_url": "https://api.github.com/users/Colstuwjx/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/Colstuwjx",
    "id": 3972545,
    "login": "Colstuwjx",
    "node_id": "MDQ6VXNlcjM5NzI1NDU=",
    "organizations_url": "https://api.github.com/users/Colstuwjx/orgs",
    "received_events_url": "https://api.github.com/users/Colstuwjx/received_events",
    "repos_url": "https://api.github.com/users/Colstuwjx/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/Colstuwjx/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Colstuwjx/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/Colstuwjx"
  }
}