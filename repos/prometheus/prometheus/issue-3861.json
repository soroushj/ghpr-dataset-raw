{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "MEMBER",
  "body": "On reload we restart all loops to adapt to changed configurations. This\r\ndiscarded all scrape caches which caused memory spikes due to rebuilding\r\nthem all after reload.\r\nWe only start a loop after its predecessor has terminated successfully.\r\nThus we can safely pass down the scrape cache.\r\n\r\n@brian-brazil I _think_ this is safe. Targets between loops, and thereby the target labels which are part of the cached label sets, do not change and thus all cache entries should remain to be correct.\r\nPut another very careful walk through the cases would be good.\r\n\r\n#3112 ",
  "closed_at": "2020-01-22T12:13:48Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/7115638?v=4",
    "events_url": "https://api.github.com/users/brian-brazil/events{/privacy}",
    "followers_url": "https://api.github.com/users/brian-brazil/followers",
    "following_url": "https://api.github.com/users/brian-brazil/following{/other_user}",
    "gists_url": "https://api.github.com/users/brian-brazil/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/brian-brazil",
    "id": 7115638,
    "login": "brian-brazil",
    "node_id": "MDQ6VXNlcjcxMTU2Mzg=",
    "organizations_url": "https://api.github.com/users/brian-brazil/orgs",
    "received_events_url": "https://api.github.com/users/brian-brazil/received_events",
    "repos_url": "https://api.github.com/users/brian-brazil/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/brian-brazil/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/brian-brazil/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/brian-brazil"
  },
  "comments": 7,
  "comments_url": "https://api.github.com/repos/prometheus/prometheus/issues/3861/comments",
  "created_at": "2018-02-19T13:04:37Z",
  "events_url": "https://api.github.com/repos/prometheus/prometheus/issues/3861/events",
  "html_url": "https://github.com/prometheus/prometheus/pull/3861",
  "id": 298268414,
  "labels": [],
  "labels_url": "https://api.github.com/repos/prometheus/prometheus/issues/3861/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDExOlB1bGxSZXF1ZXN0MTY5OTU1NDk1",
  "number": 3861,
  "performed_via_github_app": null,
  "pull_request": {
    "diff_url": "https://github.com/prometheus/prometheus/pull/3861.diff",
    "html_url": "https://github.com/prometheus/prometheus/pull/3861",
    "patch_url": "https://github.com/prometheus/prometheus/pull/3861.patch",
    "url": "https://api.github.com/repos/prometheus/prometheus/pulls/3861"
  },
  "repository_url": "https://api.github.com/repos/prometheus/prometheus",
  "state": "closed",
  "title": "scrape: pass scrape cache to replacement loops",
  "updated_at": "2020-02-14T12:11:28Z",
  "url": "https://api.github.com/repos/prometheus/prometheus/issues/3861",
  "user": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/4948210?v=4",
    "events_url": "https://api.github.com/users/fabxc/events{/privacy}",
    "followers_url": "https://api.github.com/users/fabxc/followers",
    "following_url": "https://api.github.com/users/fabxc/following{/other_user}",
    "gists_url": "https://api.github.com/users/fabxc/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/fabxc",
    "id": 4948210,
    "login": "fabxc",
    "node_id": "MDQ6VXNlcjQ5NDgyMTA=",
    "organizations_url": "https://api.github.com/users/fabxc/orgs",
    "received_events_url": "https://api.github.com/users/fabxc/received_events",
    "repos_url": "https://api.github.com/users/fabxc/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/fabxc/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fabxc/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/fabxc"
  }
}