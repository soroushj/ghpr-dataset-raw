{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "MEMBER",
  "body": "hi, `test_node_base_split_region_right_derive` failed with the following details on jenkins:\r\nhttp://45.249.247.133:8080/blue/organizations/jenkins/tikv_ghpr_unit_test/detail/tikv_ghpr_unit_test/150/pipeline/20/\r\n```\r\nthread 'raftstore-5::test_node_base_split_region_right_derive' panicked at 'failed to split: message: \"[region 1000] 1001 epoch changed conf_ver: 1 version: 3 != conf_ver: 1 version: 2, need re-check later\"', tests/raftstore/cluster.rs:768:24\r\nnote: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.\r\nstack backtrace:\r\n   0: std::sys::imp::backtrace::tracing::imp::unwind_backtrace\r\n             at /checkout/src/libstd/sys/unix/backtrace/tracing/gcc_s.rs:49\r\n   1: std::sys_common::backtrace::_print\r\n             at /checkout/src/libstd/sys_common/backtrace.rs:71\r\n   2: std::panicking::default_hook::{{closure}}\r\n             at /checkout/src/libstd/sys_common/backtrace.rs:60\r\n             at /checkout/src/libstd/panicking.rs:380\r\n   3: std::panicking::default_hook\r\n             at /checkout/src/libstd/panicking.rs:396\r\n   4: tikv::util::panic_hook::track_hook::{{closure}}\r\n             at src/util/panic_hook.rs:61\r\n   5: <std::thread::local::LocalKey<T>>::try_with\r\n             at /checkout/src/libstd/thread/local.rs:362\r\n   6: <std::thread::local::LocalKey<T>>::with\r\n             at /checkout/src/libstd/thread/local.rs:276\r\n   7: tikv::util::panic_hook::track_hook\r\n             at src/util/panic_hook.rs:55\r\n   8: core::ops::function::Fn::call\r\n             at /checkout/src/libcore/ops/function.rs:48\r\n   9: std::panicking::rust_panic_with_hook\r\n             at /checkout/src/libstd/panicking.rs:611\r\n  10: std::panicking::begin_panic\r\n             at /checkout/src/libstd/panicking.rs:571\r\n  11: std::panicking::begin_panic_fmt\r\n             at /checkout/src/libstd/panicking.rs:521\r\n  12: <integrations::raftstore::cluster::Cluster<T>>::must_split::{{closure}}\r\ntest raftstore_cases::test_split_region::test_node_delay_split_region ... ok\r\n             at tests/raftstore/cluster.rs:768\r\n  13: core::ops::function::FnOnce::call_once\r\n             at /checkout/src/libcore/ops/function.rs:143\r\n  14: <F as alloc::boxed::FnBox<A>>::call_box\r\n             at /checkout/src/liballoc/boxed.rs:682\r\n  15: <alloc::boxed::Box<alloc::boxed::FnBox<A, Output$u3d$R$GT$$u20$$u2b$$u20$core..marker..Send$u20$$u2b$$u20$$u27$a$GT$$u20$as$u20$core..ops..function..FnOnce$LT$A$GT$$GT$::call_once\r\n             at /checkout/src/liballoc/boxed.rs:702\r\n  16: <tikv::raftstore::store::store::Store<T, C>>::on_prepare_split_region::{{closure}}\r\n             at ./src/raftstore/store/store.rs:1858\r\n  17: <core::option::Option<T>>::map\r\n             at /checkout/src/libcore/option.rs:398\r\n  18: <tikv::raftstore::store::store::Store<T, C>>::on_prepare_split_region\r\n             at ./src/raftstore/store/store.rs:1858\r\n  19: <tikv::raftstore::store::store::Store<T, C> as mio::handler::Handler>::notify\r\n             at ./src/raftstore/store/store.rs:2487\r\n  20: <mio::event_loop::EventLoop<H>>::notify\r\n             at /home/jenkins/.cargo/registry/src/github.com-1ecc6299db9ec823/mio-0.5.1/src/event_loop.rs:350\r\n  21: <mio::event_loop::EventLoop<H>>::run_once\r\n             at /home/jenkins/.cargo/registry/src/github.com-1ecc6299db9ec823/mio-0.5.1/src/event_loop.rs:299\r\n  22: <mio::event_loop::EventLoop<H>>::run\r\n             at /home/jenkins/.cargo/registry/src/github.com-1ecc6299db9ec823/mio-0.5.1/src/event_loop.rs:247\r\n  23: <tikv::raftstore::store::store::Store<T, C>>::run\r\n             at ./src/raftstore/store/store.rs:545\r\n  24: <tikv::server::node::Node<C>>::start_store::{{closure}}\r\n             at ./src/server/node.rs:362\r\nthread 'raftstore_cases::test_split_region::test_node_base_split_region_right_derive' panicked at 'called `Result::unwrap()` on an `Err` value: Timeout(\"request timeout for Duration { secs: 5, nanos: 0 }\")', /checkout/src/libcore/result.rs:860:4\r\nnote: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.\r\nstack backtrace:\r\n   0: std::sys::imp::backtrace::tracing::imp::unwind_backtrace\r\n             at /checkout/src/libstd/sys/unix/backtrace/tracing/gcc_s.rs:49\r\n   1: std::sys_common::backtrace::_print\r\n             at /checkout/src/libstd/sys_common/backtrace.rs:71\r\n   2: std::panicking::default_hook::{{closure}}\r\n             at /checkout/src/libstd/sys_common/backtrace.rs:60\r\n             at /checkout/src/libstd/panicking.rs:380\r\n   3: std::panicking::default_hook\r\n             at /checkout/src/libstd/panicking.rs:396\r\n   4: tikv::util::panic_hook::track_hook::{{closure}}\r\n             at src/util/panic_hook.rs:61\r\n   5: <std::thread::local::LocalKey<T>>::try_with\r\n             at /checkout/src/libstd/thread/local.rs:362\r\n   6: <std::thread::local::LocalKey<T>>::with\r\n             at /checkout/src/libstd/thread/local.rs:276\r\n   7: tikv::util::panic_hook::track_hook\r\n             at src/util/panic_hook.rs:55\r\n   8: core::ops::function::Fn::call\r\n             at /checkout/src/libcore/ops/function.rs:48\r\n   9: std::panicking::rust_panic_with_hook\r\n             at /checkout/src/libstd/panicking.rs:611\r\n  10: std::panicking::begin_panic\r\n             at /checkout/src/libstd/panicking.rs:571\r\n  11: std::panicking::begin_panic_fmt\r\n             at /checkout/src/libstd/panicking.rs:521\r\n  12: rust_begin_unwind\r\n             at /checkout/src/libstd/panicking.rs:497\r\n  13: core::panicking::panic_fmt\r\n             at /checkout/src/libcore/panicking.rs:71\r\n  14: core::result::unwrap_failed\r\n             at /checkout/src/libcore/macros.rs:31\r\n  15: <core::result::Result<T, E>>::unwrap\r\n             at /checkout/src/libcore/result.rs:738\r\n  16: <integrations::raftstore::cluster::Cluster<T>>::query_leader\r\n             at tests/raftstore/cluster.rs:281\r\n  17: <integrations::raftstore::cluster::Cluster<T>>::leader_of_region\r\n             at tests/raftstore/cluster.rs:319\r\n  18: <integrations::raftstore::cluster::Cluster<T>>::call_command_on_leader\r\n             at tests/raftstore/cluster.rs:233\r\n  19: <integrations::raftstore::cluster::Cluster<T>>::request\r\n             at tests/raftstore/cluster.rs:516\r\n  20: <integrations::raftstore::cluster::Cluster<T>>::must_put_cf\r\n             at tests/raftstore/cluster.rs:591\r\n  21: <integrations::raftstore::cluster::Cluster<T>>::must_put\r\n             at tests/raftstore/cluster.rs:587\r\n  22: integrations::raftstore_cases::test_split_region::test_base_split_region\r\n             at tests/raftstore_cases/test_split_region.rs:80\r\n  23: integrations::raftstore_cases::test_split_region::test_node_base_split_region_right_derive\r\n             at tests/raftstore_cases/test_split_region.rs:118\r\n  24: <F as test::FnBox<T>>::call_box\r\n             at /checkout/src/libtest/lib.rs:1477\r\n             at /checkout/src/libcore/ops/function.rs:143\r\n             at /checkout/src/libtest/lib.rs:138\r\n  25: __rust_maybe_catch_panic\r\n             at /checkout/src/libpanic_unwind/lib.rs:98\r\nthread 'raftstore_cases::test_split_region::test_node_base_split_region_right_derive' panicked at 'called `Result::unwrap()` on an `Err` value: Other(Closed)', /checkout/src/libcore/result.rs:860:4\r\nstack backtrace:\r\n   0:     0x7fadafbb11a3 - std::sys::imp::backtrace::tracing::imp::unwind_backtrace::hc32b3550469bd7ec\r\n                               at /checkout/src/libstd/sys/unix/backtrace/tracing/gcc_s.rs:49\r\n   1:     0x7fadafbad754 - std::sys_common::backtrace::_print::h18ec9a3165b0d7ba\r\n                               at /checkout/src/libstd/sys_common/backtrace.rs:71\r\n   2:     0x7fadafbb4943 - std::panicking::default_hook::{{closure}}::hcead061326bfc66a\r\n                               at /checkout/src/libstd/sys_common/backtrace.rs:60\r\n                               at /checkout/src/libstd/panicking.rs:380\r\n   3:     0x7fadafbb46a2 - std::panicking::default_hook::h6a8c02fe69584b6b\r\n                               at /checkout/src/libstd/panicking.rs:396\r\n   4:     0x7fadae042789 - tikv::util::panic_hook::track_hook::{{closure}}::he4b7619911f2a73c\r\n                               at src/util/panic_hook.rs:61\r\n   5:     0x7fadade09e8d - <std::thread::local::LocalKey<T>>::try_with::hc1d10ce1c9c28d97\r\n                               at /checkout/src/libstd/thread/local.rs:362\r\n   6:     0x7fadade094ec - <std::thread::local::LocalKey<T>>::with::h1e04e77ff771795b\r\n                               at /checkout/src/libstd/thread/local.rs:276\r\n   7:     0x7fadae463cee - tikv::util::panic_hook::track_hook::hbfeb49144b456099\r\n                               at src/util/panic_hook.rs:55\r\n   8:     0x7fadae2fc978 - core::ops::function::Fn::call::hc7797a6ed162dcc2\r\n                               at /checkout/src/libcore/ops/function.rs:48\r\n   9:     0x7fadafbb4e86 - std::panicking::rust_panic_with_hook::h536d0075488cfad3\r\n                               at /checkout/src/libstd/panicking.rs:611\r\n  10:     0x7fadafbb4d14 - std::panicking::begin_panic::h59163d4c7e23a4b5\r\n                               at /checkout/src/libstd/panicking.rs:571\r\n  11:     0x7fadafbb4c19 - std::panicking::begin_panic_fmt::h226cbf2ee66e31a5\r\n                               at /checkout/src/libstd/panicking.rs:521\r\n  12:     0x7fadafbb4baa - rust_begin_unwind\r\n                               at /checkout/src/libstd/panicking.rs:497\r\n  13:     0x7fadafbe32a0 - core::panicking::panic_fmt::h232071f163afd174\r\n                               at /checkout/src/libcore/panicking.rs:71\r\n  14:     0x7fadad5168b4 - core::result::unwrap_failed::hca3280c65de924d0\r\n                               at /checkout/src/libcore/macros.rs:31\r\n  15:     0x7fadad2511f6 - <core::result::Result<T, E>>::unwrap::h0d26b4f0faa7f9bc\r\n                               at /checkout/src/libcore/result.rs:738\r\n  16:     0x7fadadb56d38 - <integrations::raftstore::node::NodeCluster as integrations::raftstore::cluster::Simulator>::stop_node::hccbee8dca237036b\r\n                               at tests/raftstore/node.rs:238\r\n  17:     0x7fadadb354ca - <integrations::raftstore::cluster::Cluster<T>>::stop_node::he97c80c659cf2759\r\n                               at tests/raftstore/cluster.rs:177\r\n  18:     0x7fadadb4109c - <integrations::raftstore::cluster::Cluster<T>>::shutdown::hc1fdba3c9317d84c\r\n                               at tests/raftstore/cluster.rs:467\r\n  19:     0x7fadadb5361c - <integrations::raftstore::cluster::Cluster<T> as core::ops::drop::Drop>::drop::h37fe55f293f0ad82\r\n                               at tests/raftstore/cluster.rs:856\r\n  20:     0x7fadad473514 - core::ptr::drop_in_place::h7426ff1341cfba16\r\n                               at /checkout/src/libcore/ptr.rs:61\r\n  21:     0x7fadadba60db - integrations::raftstore_cases::test_split_region::test_node_base_split_region_right_derive::h5437bbbff2d766ec\r\n                               at tests/raftstore_cases/test_split_region.rs:119\r\n  22:     0x7fadadd24f81 - <F as test::FnBox<T>>::call_box::h5e82055b2788b0b0\r\n                               at /checkout/src/libtest/lib.rs:1477\r\n                               at /checkout/src/libcore/ops/function.rs:143\r\n                               at /checkout/src/libtest/lib.rs:138\r\n  23:     0x7fadafbbbf9c - __rust_maybe_catch_panic\r\n                               at /checkout/src/libpanic_unwind/lib.rs:98\r\n  24:     0x7fadadd158fc - std::sys_common::backtrace::__rust_begin_short_backtrace::hed881682075c7641\r\n                               at /checkout/src/libstd/panicking.rs:458\r\n                               at /checkout/src/libstd/panic.rs:361\r\n                               at /checkout/src/libtest/lib.rs:1416\r\n                               at /checkout/src/libstd/sys_common/backtrace.rs:136\r\n  25:     0x7fadadd166c2 - std::panicking::try::do_call::hfb55048cb24e8c46\r\n                               at /checkout/src/libstd/thread/mod.rs:364\r\n                               at /checkout/src/libstd/panic.rs:296\r\n                               at /checkout/src/libstd/panicking.rs:479\r\n  26:     0x7fadafbbbf9c - __rust_maybe_catch_panic\r\n                               at /checkout/src/libpanic_unwind/lib.rs:98\r\n  27:     0x7fadadd1e8c2 - <F as alloc::boxed::FnBox<A>>::call_box::h38e755be7f3e288a\r\n                               at /checkout/src/libstd/panicking.rs:458\r\n                               at /checkout/src/libstd/panic.rs:361\r\n                               at /checkout/src/libstd/thread/mod.rs:363\r\n                               at /checkout/src/liballoc/boxed.rs:682\r\n  28:     0x7fadafbb3aab - std::sys::imp::thread::Thread::new::thread_start::h0aeebbbbd5e5d9cd\r\n                               at /checkout/src/liballoc/boxed.rs:692\r\n                               at /checkout/src/libstd/sys_common/thread.rs:21\r\n                               at /checkout/src/libstd/sys/unix/thread.rs:84\r\n  29:     0x7fadac4a0e24 - start_thread\r\n  30:     0x7fadabfb834c - __clone\r\n  31:                0x0 - <unknown>\r\nthread panicked while panicking. aborting.\r\nerror: An unknown error occurred\r\n```\r\n\r\n@overvenus @zhangjinpeng1987 PTAL",
  "closed_at": "2017-12-19T14:34:06Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/2150711?v=4",
    "events_url": "https://api.github.com/users/overvenus/events{/privacy}",
    "followers_url": "https://api.github.com/users/overvenus/followers",
    "following_url": "https://api.github.com/users/overvenus/following{/other_user}",
    "gists_url": "https://api.github.com/users/overvenus/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/overvenus",
    "id": 2150711,
    "login": "overvenus",
    "node_id": "MDQ6VXNlcjIxNTA3MTE=",
    "organizations_url": "https://api.github.com/users/overvenus/orgs",
    "received_events_url": "https://api.github.com/users/overvenus/received_events",
    "repos_url": "https://api.github.com/users/overvenus/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/overvenus/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/overvenus/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/overvenus"
  },
  "comments": 3,
  "comments_url": "https://api.github.com/repos/tikv/tikv/issues/2593/comments",
  "created_at": "2017-12-18T10:30:50Z",
  "events_url": "https://api.github.com/repos/tikv/tikv/issues/2593/events",
  "html_url": "https://github.com/tikv/tikv/issues/2593",
  "id": 282831070,
  "labels": [
    {
      "color": "d1fad7",
      "default": false,
      "description": "Component: Unit tests, Integration tests, CI, Benchmarks, etc.",
      "id": 462930498,
      "name": "component/test-bench",
      "node_id": "MDU6TGFiZWw0NjI5MzA0OTg=",
      "url": "https://api.github.com/repos/tikv/tikv/labels/component/test-bench"
    }
  ],
  "labels_url": "https://api.github.com/repos/tikv/tikv/issues/2593/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUyODI4MzEwNzA=",
  "number": 2593,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/tikv/tikv",
  "state": "closed",
  "title": "test_node_base_split_region_right_derive failed",
  "updated_at": "2018-08-07T00:47:22Z",
  "url": "https://api.github.com/repos/tikv/tikv/issues/2593",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/1085697?v=4",
    "events_url": "https://api.github.com/users/AndreMouche/events{/privacy}",
    "followers_url": "https://api.github.com/users/AndreMouche/followers",
    "following_url": "https://api.github.com/users/AndreMouche/following{/other_user}",
    "gists_url": "https://api.github.com/users/AndreMouche/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/AndreMouche",
    "id": 1085697,
    "login": "AndreMouche",
    "node_id": "MDQ6VXNlcjEwODU2OTc=",
    "organizations_url": "https://api.github.com/users/AndreMouche/orgs",
    "received_events_url": "https://api.github.com/users/AndreMouche/received_events",
    "repos_url": "https://api.github.com/users/AndreMouche/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/AndreMouche/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AndreMouche/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/AndreMouche"
  }
}