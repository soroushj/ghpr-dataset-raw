{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/28501710?v=4",
    "events_url": "https://api.github.com/users/NingLin-P/events{/privacy}",
    "followers_url": "https://api.github.com/users/NingLin-P/followers",
    "following_url": "https://api.github.com/users/NingLin-P/following{/other_user}",
    "gists_url": "https://api.github.com/users/NingLin-P/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/NingLin-P",
    "id": 28501710,
    "login": "NingLin-P",
    "node_id": "MDQ6VXNlcjI4NTAxNzEw",
    "organizations_url": "https://api.github.com/users/NingLin-P/orgs",
    "received_events_url": "https://api.github.com/users/NingLin-P/received_events",
    "repos_url": "https://api.github.com/users/NingLin-P/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/NingLin-P/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/NingLin-P/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/NingLin-P"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars3.githubusercontent.com/u/28501710?v=4",
      "events_url": "https://api.github.com/users/NingLin-P/events{/privacy}",
      "followers_url": "https://api.github.com/users/NingLin-P/followers",
      "following_url": "https://api.github.com/users/NingLin-P/following{/other_user}",
      "gists_url": "https://api.github.com/users/NingLin-P/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/NingLin-P",
      "id": 28501710,
      "login": "NingLin-P",
      "node_id": "MDQ6VXNlcjI4NTAxNzEw",
      "organizations_url": "https://api.github.com/users/NingLin-P/orgs",
      "received_events_url": "https://api.github.com/users/NingLin-P/received_events",
      "repos_url": "https://api.github.com/users/NingLin-P/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/NingLin-P/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/NingLin-P/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/NingLin-P"
    }
  ],
  "author_association": "COLLABORATOR",
  "body": "## Bug Report\r\n\r\n### What version of TiKV are you using?\r\nRelease Version:   4.1.0-alpha\r\nGit Commit Hash:   18b87012ac3450e8037baaa61ea26a73c40ef33e\r\nGit Commit Branch: master\r\nUTC Build Time:    2020-03-17 08:39:08\r\nRust Version:      rustc 1.42.0-nightly (0de96d37f 2019-12-19)\r\nEnable Features:   jemalloc portable sse protobuf-codec\r\nProfile:           release\r\n\r\n### What operating system and CPU are you using?\r\nnot related\r\n\r\n### Steps to reproduce\r\n1. run 1pd+1tikv\r\n2. kill pd and restart after 10 seconds\r\n\r\n### What did you expect?\r\nTiKV reconnect to PD and start region heartbeat.\r\n\r\n### What did happened?\r\nno region hearbeats any more\r\nlog:\r\n\r\n<details>\r\n\r\n```\r\n[2020/03/17 16:51:57.975 +08:00] [INFO] [<unknown>] [\"Connect failed: {\\\"created\\\":\\\"@1584435117.975396682\\\",\\\"description\\\":\\\"Failed to connect to remote host: Connection refused\\\",\\\"errno\\\":111,\\\"file\\\":\\\"/home/menglong/.cargo/registry/src/github.com-1ecc6299db9ec823/grpcio-sys-0.5.0/grpc/src/core/lib/iomgr/tcp_client_posix.cc\\\",\\\"file_line\\\":200,\\\"os_error\\\":\\\"Connection refused\\\",\\\"syscall\\\":\\\"connect\\\",\\\"target_address\\\":\\\"ipv4:127.0.0.1:2379\\\"}\"]\r\n[2020/03/17 16:51:57.976 +08:00] [INFO] [<unknown>] [\"Subchannel 0x7fd84f97f000: Retry in 1000 milliseconds\"]\r\n[2020/03/17 16:51:57.976 +08:00] [ERROR] [util.rs:315] [\"request failed, retry\"] [err=\"Grpc(RpcFailure(RpcStatus { status: 14-UNAVAILABLE, details: Some(\\\"failed to connect to all addresses\\\") }))\"]\r\n[2020/03/17 16:51:57.977 +08:00] [ERROR] [util.rs:315] [\"request failed, retry\"] [err=\"Grpc(RpcFailure(RpcStatus { status: 14-UNAVAILABLE, details: Some(\\\"failed to connect to all addresses\\\") }))\"]\r\n[2020/03/17 16:51:57.977 +08:00] [ERROR] [util.rs:315] [\"request failed, retry\"] [err=\"Grpc(RpcFailure(RpcStatus { status: 14-UNAVAILABLE, details: Some(\\\"failed to connect to all addresses\\\") }))\"]\r\n[2020/03/17 16:51:57.978 +08:00] [INFO] [util.rs:427] [\"connecting to PD endpoint\"] [endpoints=http://127.0.0.1:2379]\r\n[2020/03/17 16:51:58.974 +08:00] [INFO] [<unknown>] [\"Failed to connect to channel, retrying\"]\r\n[2020/03/17 16:52:03.577 +08:00] [INFO] [<unknown>] [\"Connect failed: {\\\"created\\\":\\\"@1584435123.576942607\\\",\\\"description\\\":\\\"Failed to connect to remote host: Connection refused\\\",\\\"errno\\\":111,\\\"file\\\":\\\"/home/menglong/.cargo/registry/src/github.com-1ecc6299db9ec823/grpcio-sys-0.5.0/grpc/src/core/lib/iomgr/tcp_client_posix.cc\\\",\\\"file_line\\\":200,\\\"os_error\\\":\\\"Connection refused\\\",\\\"syscall\\\":\\\"connect\\\",\\\"target_address\\\":\\\"ipv4:127.0.0.1:2379\\\"}\"]\r\n[2020/03/17 16:52:03.577 +08:00] [INFO] [<unknown>] [\"Subchannel 0x7fd84f97f000: Retry immediately\"]\r\n[2020/03/17 16:52:03.577 +08:00] [INFO] [<unknown>] [\"Failed to connect to channel, retrying\"]\r\n[2020/03/17 16:52:08.577 +08:00] [INFO] [<unknown>] [\"Connect failed: {\\\"created\\\":\\\"@1584435128.576987579\\\",\\\"description\\\":\\\"Failed to connect to remote host: Connection refused\\\",\\\"errno\\\":111,\\\"file\\\":\\\"/home/menglong/.cargo/registry/src/github.com-1ecc6299db9ec823/grpcio-sys-0.5.0/grpc/src/core/lib/iomgr/tcp_client_posix.cc\\\",\\\"file_line\\\":200,\\\"os_error\\\":\\\"Connection refused\\\",\\\"syscall\\\":\\\"connect\\\",\\\"target_address\\\":\\\"ipv4:127.0.0.1:2379\\\"}\"]\r\n[2020/03/17 16:52:08.578 +08:00] [INFO] [<unknown>] [\"Subchannel 0x7fd84f97f000: Retry immediately\"]\r\n[2020/03/17 16:52:08.578 +08:00] [INFO] [<unknown>] [\"Failed to connect to channel, retrying\"]\r\n[2020/03/17 16:52:13.577 +08:00] [INFO] [<unknown>] [\"New connected subchannel at 0x7fd84bc030f0 for subchannel 0x7fd84f97f000\"]\r\n\r\n```\r\n\r\n</details>\r\n",
  "closed_at": "2020-03-26T06:06:44Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/29268173?v=4",
    "events_url": "https://api.github.com/users/sre-bot/events{/privacy}",
    "followers_url": "https://api.github.com/users/sre-bot/followers",
    "following_url": "https://api.github.com/users/sre-bot/following{/other_user}",
    "gists_url": "https://api.github.com/users/sre-bot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/sre-bot",
    "id": 29268173,
    "login": "sre-bot",
    "node_id": "MDQ6VXNlcjI5MjY4MTcz",
    "organizations_url": "https://api.github.com/users/sre-bot/orgs",
    "received_events_url": "https://api.github.com/users/sre-bot/received_events",
    "repos_url": "https://api.github.com/users/sre-bot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/sre-bot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/sre-bot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/sre-bot"
  },
  "comments": 5,
  "comments_url": "https://api.github.com/repos/tikv/tikv/issues/7124/comments",
  "created_at": "2020-03-17T09:17:49Z",
  "events_url": "https://api.github.com/repos/tikv/tikv/issues/7124/events",
  "html_url": "https://github.com/tikv/tikv/issues/7124",
  "id": 582867884,
  "labels": [
    {
      "color": "d1fad7",
      "default": false,
      "description": "Component: pd",
      "id": 1158875561,
      "name": "component/pd-client",
      "node_id": "MDU6TGFiZWwxMTU4ODc1NTYx",
      "url": "https://api.github.com/repos/tikv/tikv/labels/component/pd-client"
    },
    {
      "color": "ed0000",
      "default": false,
      "description": "Priority: Critical",
      "id": 526190947,
      "name": "priority/critical",
      "node_id": "MDU6TGFiZWw1MjYxOTA5NDc=",
      "url": "https://api.github.com/repos/tikv/tikv/labels/priority/critical"
    },
    {
      "color": "ededed",
      "default": false,
      "description": null,
      "id": 2265335491,
      "name": "severity/Critical",
      "node_id": "MDU6TGFiZWwyMjY1MzM1NDkx",
      "url": "https://api.github.com/repos/tikv/tikv/labels/severity/Critical"
    },
    {
      "color": "1d76db",
      "default": false,
      "description": "Type: Issue - Confirmed a bug",
      "id": 305526945,
      "name": "type/bug",
      "node_id": "MDU6TGFiZWwzMDU1MjY5NDU=",
      "url": "https://api.github.com/repos/tikv/tikv/labels/type/bug"
    }
  ],
  "labels_url": "https://api.github.com/repos/tikv/tikv/issues/7124/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU1ODI4Njc4ODQ=",
  "number": 7124,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/tikv/tikv",
  "state": "closed",
  "title": "TiKV cannot send messages to PD after reconnect",
  "updated_at": "2020-08-10T03:45:29Z",
  "url": "https://api.github.com/repos/tikv/tikv/issues/7124",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/12077877?v=4",
    "events_url": "https://api.github.com/users/disksing/events{/privacy}",
    "followers_url": "https://api.github.com/users/disksing/followers",
    "following_url": "https://api.github.com/users/disksing/following{/other_user}",
    "gists_url": "https://api.github.com/users/disksing/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/disksing",
    "id": 12077877,
    "login": "disksing",
    "node_id": "MDQ6VXNlcjEyMDc3ODc3",
    "organizations_url": "https://api.github.com/users/disksing/orgs",
    "received_events_url": "https://api.github.com/users/disksing/received_events",
    "repos_url": "https://api.github.com/users/disksing/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/disksing/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/disksing/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/disksing"
  }
}