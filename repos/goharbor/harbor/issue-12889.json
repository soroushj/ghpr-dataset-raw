{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/2841473?v=4",
    "events_url": "https://api.github.com/users/wy65701436/events{/privacy}",
    "followers_url": "https://api.github.com/users/wy65701436/followers",
    "following_url": "https://api.github.com/users/wy65701436/following{/other_user}",
    "gists_url": "https://api.github.com/users/wy65701436/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/wy65701436",
    "id": 2841473,
    "login": "wy65701436",
    "node_id": "MDQ6VXNlcjI4NDE0NzM=",
    "organizations_url": "https://api.github.com/users/wy65701436/orgs",
    "received_events_url": "https://api.github.com/users/wy65701436/received_events",
    "repos_url": "https://api.github.com/users/wy65701436/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/wy65701436/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/wy65701436/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/wy65701436"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars3.githubusercontent.com/u/2841473?v=4",
      "events_url": "https://api.github.com/users/wy65701436/events{/privacy}",
      "followers_url": "https://api.github.com/users/wy65701436/followers",
      "following_url": "https://api.github.com/users/wy65701436/following{/other_user}",
      "gists_url": "https://api.github.com/users/wy65701436/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/wy65701436",
      "id": 2841473,
      "login": "wy65701436",
      "node_id": "MDQ6VXNlcjI4NDE0NzM=",
      "organizations_url": "https://api.github.com/users/wy65701436/orgs",
      "received_events_url": "https://api.github.com/users/wy65701436/received_events",
      "repos_url": "https://api.github.com/users/wy65701436/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/wy65701436/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wy65701436/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/wy65701436"
    },
    {
      "avatar_url": "https://avatars3.githubusercontent.com/u/5835782?v=4",
      "events_url": "https://api.github.com/users/ywk253100/events{/privacy}",
      "followers_url": "https://api.github.com/users/ywk253100/followers",
      "following_url": "https://api.github.com/users/ywk253100/following{/other_user}",
      "gists_url": "https://api.github.com/users/ywk253100/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ywk253100",
      "id": 5835782,
      "login": "ywk253100",
      "node_id": "MDQ6VXNlcjU4MzU3ODI=",
      "organizations_url": "https://api.github.com/users/ywk253100/orgs",
      "received_events_url": "https://api.github.com/users/ywk253100/received_events",
      "repos_url": "https://api.github.com/users/ywk253100/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ywk253100/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ywk253100/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ywk253100"
    }
  ],
  "author_association": "CONTRIBUTOR",
  "body": "There may be error like this:\r\n\r\n```\r\nregistry=# UPDATE tag SET\r\nregistry-#    repository_id=art.repository_id\r\nregistry-#    FROM artifact as art\r\nregistry-#    WHERE tag.artifact_id=art.id AND tag.repository_id!=art.repository_id;\r\nERROR:  duplicate key value violates unique constraint \"unique_tag\"\r\nDETAIL:  Key (repository_id, name)=(567, 20200805041431) already exists.\r\n```\r\n\r\nAnd there are records like this in the tag table, they are different artifacts but has same repository:\r\n\r\n```\r\n id  | repository_id | artifact_id |      name      |         push_time          |         pull_time\r\n-----+---------------+-------------+----------------+----------------------------+----------------------------\r\n\r\n 774 |         -1137 |        1137 | 20200804081431 | 2020-08-04 08:14:31.797459 |\r\n 775 |         -1141 |        1141 | 20200804081431 | 2020-08-04 08:14:31.887564 |\r\n```\r\n\r\nIn the migration script, we need to make sure that under the same repo name there's no dup tags.\r\n\r\n@ywk253100 help me understand why this can happen, is it because the same artifacts existed before migration, and after migrating to v2.0, the same artifact is tagged with a different tag and pushed again?",
  "closed_at": "2020-08-28T06:16:21Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/2390463?v=4",
    "events_url": "https://api.github.com/users/reasonerjt/events{/privacy}",
    "followers_url": "https://api.github.com/users/reasonerjt/followers",
    "following_url": "https://api.github.com/users/reasonerjt/following{/other_user}",
    "gists_url": "https://api.github.com/users/reasonerjt/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/reasonerjt",
    "id": 2390463,
    "login": "reasonerjt",
    "node_id": "MDQ6VXNlcjIzOTA0NjM=",
    "organizations_url": "https://api.github.com/users/reasonerjt/orgs",
    "received_events_url": "https://api.github.com/users/reasonerjt/received_events",
    "repos_url": "https://api.github.com/users/reasonerjt/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/reasonerjt/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/reasonerjt/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/reasonerjt"
  },
  "comments": 0,
  "comments_url": "https://api.github.com/repos/goharbor/harbor/issues/12889/comments",
  "created_at": "2020-08-26T17:30:14Z",
  "events_url": "https://api.github.com/repos/goharbor/harbor/issues/12889/events",
  "html_url": "https://github.com/goharbor/harbor/issues/12889",
  "id": 686494281,
  "labels": [
    {
      "color": "d93f0b",
      "default": false,
      "description": "",
      "id": 2252244926,
      "name": "target/2.0.3",
      "node_id": "MDU6TGFiZWwyMjUyMjQ0OTI2",
      "url": "https://api.github.com/repos/goharbor/harbor/labels/target/2.0.3"
    },
    {
      "color": "d93f0b",
      "default": false,
      "description": "",
      "id": 1906209670,
      "name": "target/2.1.0",
      "node_id": "MDU6TGFiZWwxOTA2MjA5Njcw",
      "url": "https://api.github.com/repos/goharbor/harbor/labels/target/2.1.0"
    },
    {
      "color": "00b7f9",
      "default": false,
      "description": "tracking issue which are must fixed before RC milestone",
      "id": 1912113240,
      "name": "target/RC",
      "node_id": "MDU6TGFiZWwxOTEyMTEzMjQw",
      "url": "https://api.github.com/repos/goharbor/harbor/labels/target/RC"
    }
  ],
  "labels_url": "https://api.github.com/repos/goharbor/harbor/issues/12889/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU2ODY0OTQyODE=",
  "number": 12889,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/goharbor/harbor",
  "state": "closed",
  "title": "The migration script in v2.0.3 will fail if there are records in the tag table with same name under same repository",
  "updated_at": "2020-08-28T06:16:21Z",
  "url": "https://api.github.com/repos/goharbor/harbor/issues/12889",
  "user": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/2390463?v=4",
    "events_url": "https://api.github.com/users/reasonerjt/events{/privacy}",
    "followers_url": "https://api.github.com/users/reasonerjt/followers",
    "following_url": "https://api.github.com/users/reasonerjt/following{/other_user}",
    "gists_url": "https://api.github.com/users/reasonerjt/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/reasonerjt",
    "id": 2390463,
    "login": "reasonerjt",
    "node_id": "MDQ6VXNlcjIzOTA0NjM=",
    "organizations_url": "https://api.github.com/users/reasonerjt/orgs",
    "received_events_url": "https://api.github.com/users/reasonerjt/received_events",
    "repos_url": "https://api.github.com/users/reasonerjt/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/reasonerjt/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/reasonerjt/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/reasonerjt"
  }
}