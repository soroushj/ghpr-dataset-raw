{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "NONE",
  "body": "We had rather strange case today when after rolling update one of the kubelet's started wrong container.\n\nFor this specific  replicationcontroller we are using         `imagePullPolicy: IfNotPresent`\n\nWhat happened was that after rolling-update when i started to debug the issue i discovered that one of the kubelet's did not pull the image:\n`2m            2m              1       {kubelet x.x.x.x}  spec.containers{myimage}        Normal          Pulled          Container image \"myrepo:5000/myimage:2208\" already present on machine`\n\nWhen looking into what image it actually started i saw:\n`Image ID:           docker://sha256:2208f7a29005d226d1ee33a63e33af1f47af6156c740d7d23c7948e8d282d53d`\n\nWhen checking from the actual node i saw this\n\n```\n$ docker images | grep 2208\nmyrepo:5000/myimage                  1393                2208f7a29005        3 months ago        611.7 MB\n```\n\nIt seems that instead of starting myimage with tag 2208 kubelet started image tagged as 1393 since the docker image id starts with 2208.\n\n```\n$ docker version\nClient:\n Version:      1.10.3\n API version:  1.22\n Go version:   go1.5.4\n Git commit:   3cd164c\n Built:        \n OS/Arch:      linux/amd64\n\nServer:\n Version:      1.10.3\n API version:  1.22\n Go version:   go1.5.4\n Git commit:   3cd164c\n Built:        \n OS/Arch:      linux/amd64\n\n$ kubectl version\nClient Version: version.Info{Major:\"1\", Minor:\"3\", GitVersion:\"v1.3.4\", GitCommit:\"dd6b458ef8dbf24aff55795baa68f83383c9b3a9\", GitTreeState:\"clean\", BuildDate:\"2016-08-01T16:45:16Z\", GoVersion:\"go1.6.2\", Compiler:\"gc\", Platform:\"linux/amd64\"}\nServer Version: version.Info{Major:\"1\", Minor:\"3\", GitVersion:\"v1.3.4\", GitCommit:\"dd6b458ef8dbf24aff55795baa68f83383c9b3a9\", GitTreeState:\"clean\", BuildDate:\"2016-08-01T16:38:31Z\", GoVersion:\"go1.6.2\", Compiler:\"gc\", Platform:\"linux/amd64\"}\n$ kubelet --version\nKubernetes v1.3.4\n$ uname -a\nLinux node 4.6.3-coreos #2 SMP Mon Jul 18 06:10:39 UTC 2016 x86_64 Intel(R) Xeon(R) CPU E3-1231 v3 @ 3.40GHz GenuineIntel GNU/Linux\n```\n",
  "closed_at": "2016-08-13T06:42:41Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/13653959?v=4",
    "events_url": "https://api.github.com/users/k8s-github-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-github-robot/followers",
    "following_url": "https://api.github.com/users/k8s-github-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-github-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-github-robot",
    "id": 13653959,
    "login": "k8s-github-robot",
    "node_id": "MDQ6VXNlcjEzNjUzOTU5",
    "organizations_url": "https://api.github.com/users/k8s-github-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-github-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-github-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-github-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-github-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-github-robot"
  },
  "comments": 0,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/30355/comments",
  "created_at": "2016-08-10T10:52:03Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/30355/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/30355",
  "id": 170388426,
  "labels": [
    {
      "color": "0052cc",
      "default": false,
      "description": null,
      "id": 116719829,
      "name": "area/kubelet",
      "node_id": "MDU6TGFiZWwxMTY3MTk4Mjk=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/area/kubelet"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Node.",
      "id": 173493665,
      "name": "sig/node",
      "node_id": "MDU6TGFiZWwxNzM0OTM2NjU=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/node"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/30355/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUxNzAzODg0MjY=",
  "number": 30355,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "kubelet gets confused when docker image tag is the same as docker image id start",
  "updated_at": "2016-08-13T06:42:41Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/30355",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/14195318?v=4",
    "events_url": "https://api.github.com/users/vkristjan/events{/privacy}",
    "followers_url": "https://api.github.com/users/vkristjan/followers",
    "following_url": "https://api.github.com/users/vkristjan/following{/other_user}",
    "gists_url": "https://api.github.com/users/vkristjan/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/vkristjan",
    "id": 14195318,
    "login": "vkristjan",
    "node_id": "MDQ6VXNlcjE0MTk1MzE4",
    "organizations_url": "https://api.github.com/users/vkristjan/orgs",
    "received_events_url": "https://api.github.com/users/vkristjan/received_events",
    "repos_url": "https://api.github.com/users/vkristjan/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/vkristjan/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vkristjan/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/vkristjan"
  }
}