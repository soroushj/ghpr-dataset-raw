{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "NONE",
  "body": "**Is this a BUG REPORT or FEATURE REQUEST?**:\r\n\r\n> Uncomment only one, leave it on its own line:\r\n>\r\n/kind bug\r\n> /kind feature\r\n\r\n\r\n**What happened**:\r\nIf hosts `/etc/resolv.conf` points to a local DNS server, or if it contains the cluster's DNS server (to enable looking up services from host), it'll cause DNS loop which can effectively disable kube-dns or make it very slow. \r\n\r\n**What you expected to happen**:\r\nAt least, kube-dns should detect localhost or cluster DNS server entries in resolv.conf and not send queries to them.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nUse a system with local cashing DNS server, or add cluster's DNS server address to hosts resolv.conf.\r\n\r\n**Anything else we need to know?**:\r\nAccording to `dnsmasq` documentation, adding `--dns-loop-detect` should make dnsmasq detect that and disable the upstream DNS server which cause the loop. It should prevent DNS from becoming unresponsive in the first case (a better solution is to extract real upstream servers, which probably cannot be done for every configuration); and for the second case it should skip sending queries to itself and send to real upstream servers.\r\n",
  "closed_at": "2018-08-18T15:47:19Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/13653959?v=4",
    "events_url": "https://api.github.com/users/k8s-github-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-github-robot/followers",
    "following_url": "https://api.github.com/users/k8s-github-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-github-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-github-robot",
    "id": 13653959,
    "login": "k8s-github-robot",
    "node_id": "MDQ6VXNlcjEzNjUzOTU5",
    "organizations_url": "https://api.github.com/users/k8s-github-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-github-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-github-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-github-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-github-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-github-robot"
  },
  "comments": 6,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/67299/comments",
  "created_at": "2018-08-11T13:14:38Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/67299/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/67299",
  "id": 349733308,
  "labels": [
    {
      "color": "e11d21",
      "default": false,
      "description": "Categorizes issue or PR as related to a bug.",
      "id": 105146071,
      "name": "kind/bug",
      "node_id": "MDU6TGFiZWwxMDUxNDYwNzE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/bug"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Network.",
      "id": 116712108,
      "name": "sig/network",
      "node_id": "MDU6TGFiZWwxMTY3MTIxMDg=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/network"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/67299/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUzNDk3MzMzMDg=",
  "number": 67299,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "Please add --dns-loop-detect option to dnsmasq run by kube-dns",
  "updated_at": "2018-08-18T15:47:19Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/67299",
  "user": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/497092?v=4",
    "events_url": "https://api.github.com/users/hedayat/events{/privacy}",
    "followers_url": "https://api.github.com/users/hedayat/followers",
    "following_url": "https://api.github.com/users/hedayat/following{/other_user}",
    "gists_url": "https://api.github.com/users/hedayat/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/hedayat",
    "id": 497092,
    "login": "hedayat",
    "node_id": "MDQ6VXNlcjQ5NzA5Mg==",
    "organizations_url": "https://api.github.com/users/hedayat/orgs",
    "received_events_url": "https://api.github.com/users/hedayat/received_events",
    "repos_url": "https://api.github.com/users/hedayat/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/hedayat/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hedayat/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/hedayat"
  }
}