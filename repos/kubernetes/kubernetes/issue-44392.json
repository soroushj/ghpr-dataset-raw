{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "NONE",
  "body": "**Is this a request for help?**\r\nNo\r\n\r\n**What keywords did you search in Kubernetes issues before filing this one?** \r\n`kubernetes-worker` `charm`\r\n\r\n**Is this a BUG REPORT or FEATURE REQUEST?** \r\nBug Report\r\n\r\n**Kubernetes version**\r\n```\r\nClient Version: version.Info{Major:\"1\", Minor:\"5\", GitVersion:\"v1.5.3\", GitCommit:\"029c3a408176b55c30846f0faedf56aae5992e9b\", GitTreeState:\"clean\", BuildDate:\"2017-02-23T22:48:32Z\", GoVersion:\"go1.7.4\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\nServer Version: version.Info{Major:\"1\", Minor:\"5\", GitVersion:\"v1.5.3\", GitCommit:\"029c3a408176b55c30846f0faedf56aae5992e9b\", GitTreeState:\"clean\", BuildDate:\"2017-02-23T22:28:16Z\", GoVersion:\"go1.7.4\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\n```\r\n\r\n\r\n**Environment**:\r\n- **Cloud provider or hardware configuration**: Libvirt VMs\r\n- **OS**: Ubuntu 16.04\r\n- **Kernel**: 4.4.0-21-generic\r\n- **Install tools**: Juju 2.1.2-xenial-amd64, `cs:~containers/kubernetes-worker-14`\r\n\r\n\r\n**What happened**:\r\n`juju run-action kubernetes-worker/0 pause` leads to immediate action failure. This action runs `kubectl drain` for the node that `kubernetes-worker/0` is deployed to, which is bound to fail:\r\n```\r\nkubectl drain daisy\r\nnode \"daisy\" cordoned\r\nerror: pods with local storage (use --delete-local-data to override): monitoring-influxdb-grafana-v4-6218d\r\n```\r\nThis leaves the node in a cordoned, undrained state.\r\n\r\n**What you expected to happen**:\r\nOne of three options:\r\n- The `pause` action should come with a parameter enabling `kubectl drain --delete-local-data`, _or_\r\n- CDK should not be deploying `monitoring-influxdb-grafana` (if other options are available), _or_\r\n- CDK should automatically reconfigure `monitoring-influxdb-grafana` to run off a Ceph RBD volume if `kubernetes-master` is linked to `ceph-mon`.\r\n\r\n**How to reproduce it** (as minimally and precisely as possible):\r\n- Deploy CDK.\r\n- Run `juju run-action kubernetes-worker/0 pause` and note the action UUID\r\n- Run `juju show-action-status` on that UUID\r\n- Observe the action's failed state:\r\n```\r\nactions:\r\n- id: ac1875a0-319b-47c1-8f18-52b02b313bb2\r\n  status: failed\r\n  unit: kubernetes-worker/0\r\n```\r\n",
  "closed_at": "2017-04-26T12:48:39Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/13653959?v=4",
    "events_url": "https://api.github.com/users/k8s-github-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-github-robot/followers",
    "following_url": "https://api.github.com/users/k8s-github-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-github-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-github-robot",
    "id": 13653959,
    "login": "k8s-github-robot",
    "node_id": "MDQ6VXNlcjEzNjUzOTU5",
    "organizations_url": "https://api.github.com/users/k8s-github-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-github-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-github-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-github-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-github-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-github-robot"
  },
  "comments": 4,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/44392/comments",
  "created_at": "2017-04-12T14:05:59Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/44392/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/44392",
  "id": 221273984,
  "labels": [],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/44392/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUyMjEyNzM5ODQ=",
  "number": 44392,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "kubernetes-worker Juju charm: \"pause\" action can't succeed in default configuration",
  "updated_at": "2017-04-26T17:14:34Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/44392",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/610707?v=4",
    "events_url": "https://api.github.com/users/fghaas/events{/privacy}",
    "followers_url": "https://api.github.com/users/fghaas/followers",
    "following_url": "https://api.github.com/users/fghaas/following{/other_user}",
    "gists_url": "https://api.github.com/users/fghaas/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/fghaas",
    "id": 610707,
    "login": "fghaas",
    "node_id": "MDQ6VXNlcjYxMDcwNw==",
    "organizations_url": "https://api.github.com/users/fghaas/orgs",
    "received_events_url": "https://api.github.com/users/fghaas/received_events",
    "repos_url": "https://api.github.com/users/fghaas/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/fghaas/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fghaas/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/fghaas"
  }
}