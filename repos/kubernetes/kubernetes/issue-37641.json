{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/8681801?v=4",
    "events_url": "https://api.github.com/users/MrHohn/events{/privacy}",
    "followers_url": "https://api.github.com/users/MrHohn/followers",
    "following_url": "https://api.github.com/users/MrHohn/following{/other_user}",
    "gists_url": "https://api.github.com/users/MrHohn/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/MrHohn",
    "id": 8681801,
    "login": "MrHohn",
    "node_id": "MDQ6VXNlcjg2ODE4MDE=",
    "organizations_url": "https://api.github.com/users/MrHohn/orgs",
    "received_events_url": "https://api.github.com/users/MrHohn/received_events",
    "repos_url": "https://api.github.com/users/MrHohn/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/MrHohn/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/MrHohn/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/MrHohn"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars0.githubusercontent.com/u/8681801?v=4",
      "events_url": "https://api.github.com/users/MrHohn/events{/privacy}",
      "followers_url": "https://api.github.com/users/MrHohn/followers",
      "following_url": "https://api.github.com/users/MrHohn/following{/other_user}",
      "gists_url": "https://api.github.com/users/MrHohn/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/MrHohn",
      "id": 8681801,
      "login": "MrHohn",
      "node_id": "MDQ6VXNlcjg2ODE4MDE=",
      "organizations_url": "https://api.github.com/users/MrHohn/orgs",
      "received_events_url": "https://api.github.com/users/MrHohn/received_events",
      "repos_url": "https://api.github.com/users/MrHohn/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/MrHohn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MrHohn/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/MrHohn"
    }
  ],
  "author_association": "MEMBER",
  "body": "<!-- Thanks for filing an issue! Before hitting the button, please answer these questions.-->\r\n\r\n**Is this a request for help?** (If yes, you should use our troubleshooting guide and community support channels, see http://kubernetes.io/docs/troubleshooting/.): No\r\n\r\n\r\n**What keywords did you search in Kubernetes issues before filing this one?** (If you have found any duplicates, you should instead reply there.): None\r\n\r\n---\r\n\r\n**Is this a BUG REPORT or FEATURE REQUEST?** (choose one): BUG REPORT\r\n\r\n<!--\r\nIf this is a BUG REPORT, please:\r\n  - Fill in as much of the template below as you can.  If you leave out\r\n    information, we can't help you as well.\r\n\r\nIf this is a FEATURE REQUEST, please:\r\n  - Describe *in detail* the feature/behavior/change you'd like to see.\r\n\r\nIn both cases, be ready for followup questions, and please respond in a timely\r\nmanner.  If we can't reproduce a bug or think a feature already exists, we\r\nmight close your issue.  If we're wrong, PLEASE feel free to reopen it and\r\nexplain why.\r\n-->\r\n\r\n**Kubernetes version** (use `kubectl version`):\r\n```console\r\n$ kubectl version                                                                          \r\nClient Version: version.Info{Major:\"1\", Minor:\"5+\", GitVersion:\"v1.5.0-beta.2.2+f64c9f2d999ceb\", GitCommit:\"f64c9f2d999ceb157d5672e9bba6639a4c456f6e\", GitTreeState:\"clean\", BuildDate:\"2016-11-29T15:21:56Z\", GoVersion:\"go1.7.3\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\nServer Version: version.Info{Major:\"1\", Minor:\"5+\", GitVersion:\"v1.5.0-beta.2.2+f64c9f2d999ceb\", GitCommit:\"f64c9f2d999ceb157d5672e9bba6639a4c456f6e\", GitTreeState:\"clean\", BuildDate:\"2016-11-29T15:13:51Z\", GoVersion:\"go1.7.3\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\n```\r\n\r\n\r\n\r\n**Environment**:\r\n- **Cloud provider or hardware configuration**: GKE\r\n\r\n**What happened**: Upgrades to version 1.5 (from any previous version) change existing addons from ReplicationControllers to Deployments without deleting old ReplicationControllers. This leads to multiple versions of the addons running at the same time. There also seems to be multiple deployments of heapster as well. \r\n\r\n```console\r\n$ kubectl get rc --namespace=kube-system                                                   \r\nNAME                          DESIRED   CURRENT   READY     AGE\r\nkube-dns-v17.1                2         2         2         1h\r\nkubernetes-dashboard-v1.1.1   1         1         1         1h\r\nl7-default-backend-v1.0       1         1         1         1h\r\n\r\n$ kubectl get deployment --namespace=kube-system                                           \r\nNAME                   DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE\r\nheapster-v1.1.0        1         1         1            1           1h\r\nheapster-v1.2.0        1         1         1            1           1h\r\nkube-dns               1         1         1            1           1h\r\nkubernetes-dashboard   1         1         1            1           1h\r\nl7-default-backend     1         1         1            1           1h\r\n\r\n$ kubectl get pods --namespace=kube-system                                                 \r\nNAME                                                               READY     STATUS    RESTARTS   AGE\r\nfluentd-cloud-logging-gke-jenkins-e2e-default-pool-91ebbcc7-f3wt   1/1       Unknown   0          1h\r\nfluentd-cloud-logging-gke-jenkins-e2e-default-pool-91ebbcc7-mgst   1/1       Running   0          1h\r\nfluentd-cloud-logging-gke-jenkins-e2e-default-pool-91ebbcc7-zhm0   1/1       Running   0          1h\r\nheapster-v1.1.0-2096339923-39key                                   2/2       Running   0          1h\r\nheapster-v1.2.0-2168613315-1bcy3                                   2/2       Running   0          1h\r\nkube-dns-4101612645-78hx6                                          4/4       Running   0          1h\r\nkube-dns-v17.1-3pyz0                                               3/3       Running   0          1h\r\nkube-dns-v17.1-zaskz                                               3/3       Running   0          1h\r\nkube-proxy-gke-jenkins-e2e-default-pool-91ebbcc7-f3wt              1/1       Unknown   0          1h\r\nkube-proxy-gke-jenkins-e2e-default-pool-91ebbcc7-mgst              1/1       Running   0          1h\r\nkube-proxy-gke-jenkins-e2e-default-pool-91ebbcc7-zhm0              1/1       Running   0          1h\r\nkubernetes-dashboard-3697774758-n808h                              1/1       Running   0          1h\r\nkubernetes-dashboard-v1.1.1-ljtj5                                  1/1       Running   0          1h\r\nl7-default-backend-2234341178-vo5z1                                1/1       Running   0          1h\r\nl7-default-backend-v1.0-qe9yo                                      1/1       Running   0          1h\r\n```\r\n\r\nI found this as a counting error in https://k8s-gubernator.appspot.com/build/kubernetes-jenkins/logs/kubernetes-e2e-gke-container_vm-1.3-container_vm-1.5-upgrade-cluster/337. At first, I just thought it was incorrectly counting, and I attempted to fix that https://github.com/kubernetes/kubernetes/pull/36924. That fix is still valid and an improvement, but the underlying problem of multiple versions of addons still running is probably bad.\r\n\r\nWe need a mechanism to delete the old ReplicationControllers/Deployments after an upgrade. \r\n",
  "closed_at": "2016-11-30T18:39:29Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/13653959?v=4",
    "events_url": "https://api.github.com/users/k8s-github-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-github-robot/followers",
    "following_url": "https://api.github.com/users/k8s-github-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-github-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-github-robot",
    "id": 13653959,
    "login": "k8s-github-robot",
    "node_id": "MDQ6VXNlcjEzNjUzOTU5",
    "organizations_url": "https://api.github.com/users/k8s-github-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-github-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-github-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-github-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-github-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-github-robot"
  },
  "comments": 14,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/37641/comments",
  "created_at": "2016-11-29T18:43:14Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/37641/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/37641",
  "id": 192364902,
  "labels": [
    {
      "color": "0052cc",
      "default": false,
      "description": null,
      "id": 192801498,
      "name": "area/upgrade",
      "node_id": "MDU6TGFiZWwxOTI4MDE0OTg=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/area/upgrade"
    },
    {
      "color": "e11d21",
      "default": false,
      "description": "Highest priority. Must be actively worked on as someone's top priority right now.",
      "id": 114528068,
      "name": "priority/critical-urgent",
      "node_id": "MDU6TGFiZWwxMTQ1MjgwNjg=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/priority/critical-urgent"
    },
    {
      "color": "d93f0b",
      "default": false,
      "description": null,
      "id": 435667038,
      "name": "release-blocker",
      "node_id": "MDU6TGFiZWw0MzU2NjcwMzg=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/release-blocker"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Cluster Lifecycle.",
      "id": 173494222,
      "name": "sig/cluster-lifecycle",
      "node_id": "MDU6TGFiZWwxNzM0OTQyMjI=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/cluster-lifecycle"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/37641/labels{/name}",
  "locked": false,
  "milestone": {
    "closed_at": "2019-08-26T17:22:47Z",
    "closed_issues": 1412,
    "created_at": "2016-08-16T21:47:28Z",
    "creator": {
      "avatar_url": "https://avatars0.githubusercontent.com/u/647318?v=4",
      "events_url": "https://api.github.com/users/lavalamp/events{/privacy}",
      "followers_url": "https://api.github.com/users/lavalamp/followers",
      "following_url": "https://api.github.com/users/lavalamp/following{/other_user}",
      "gists_url": "https://api.github.com/users/lavalamp/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/lavalamp",
      "id": 647318,
      "login": "lavalamp",
      "node_id": "MDQ6VXNlcjY0NzMxOA==",
      "organizations_url": "https://api.github.com/users/lavalamp/orgs",
      "received_events_url": "https://api.github.com/users/lavalamp/received_events",
      "repos_url": "https://api.github.com/users/lavalamp/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/lavalamp/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lavalamp/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/lavalamp"
    },
    "description": "",
    "due_on": null,
    "html_url": "https://github.com/kubernetes/kubernetes/milestone/23",
    "id": 1945978,
    "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/milestones/23/labels",
    "node_id": "MDk6TWlsZXN0b25lMTk0NTk3OA==",
    "number": 23,
    "open_issues": 0,
    "state": "closed",
    "title": "v1.5",
    "updated_at": "2019-08-26T17:22:47Z",
    "url": "https://api.github.com/repos/kubernetes/kubernetes/milestones/23"
  },
  "node_id": "MDU6SXNzdWUxOTIzNjQ5MDI=",
  "number": 37641,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "Multiple versions of addons running after upgrade.",
  "updated_at": "2016-11-30T18:39:29Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/37641",
  "user": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/157083?v=4",
    "events_url": "https://api.github.com/users/krousey/events{/privacy}",
    "followers_url": "https://api.github.com/users/krousey/followers",
    "following_url": "https://api.github.com/users/krousey/following{/other_user}",
    "gists_url": "https://api.github.com/users/krousey/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/krousey",
    "id": 157083,
    "login": "krousey",
    "node_id": "MDQ6VXNlcjE1NzA4Mw==",
    "organizations_url": "https://api.github.com/users/krousey/orgs",
    "received_events_url": "https://api.github.com/users/krousey/received_events",
    "repos_url": "https://api.github.com/users/krousey/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/krousey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/krousey/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/krousey"
  }
}