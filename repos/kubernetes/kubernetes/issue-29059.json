{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "NONE",
  "body": "**TL;DR: kubelet keeps trying to remount secrets and configmaps into pods over and over again.**\n\nMy environment: kubernetes 1.3.0 running on Ubuntu 14.04.  I used the instructions here to set things up:\n\nhttp://kubernetes.io/docs/getting-started-guides/ubuntu/\n\n(i.e. etcd, flanneld and the kube\\* processes are running on the host OS, not in containers or docker-in-a-vm ala minikube)\n\nIn trying to track down high disk write rates, I found that the partition I use for my etcd WAL log was getting about 40kb/s write traffic.  etcd metrics show that I'm getting 3 qps get and 3qps getrecursive.  Write traffic to etcd is essentially nil (pods are all stable).   This is a single node system with ~30 user pods, most of which are doing nothing unless I sent traffic to them (which I'm not while doing these measurements).\n\nIn the upstart kubelet log, I see this over and over again:\n\n```\nI0716 09:06:30.237831   19838 reconciler.go:253] MountVolume operation started for volume \"kubernetes.io/configmap/samba-config\" (spec.Name: \"samba-config\") to pod \"6a9d4812-4b57-11e6-bf48-38607772ada8\" (UID: \"6a9d4812-4b57-11e6-bf48-38607772ada8\"). Volume is already mounted to pod, but remount was requested.\nI0716 09:06:30.237969   19838 reconciler.go:253] MountVolume operation started for volume \"kubernetes.io/secret/default-token-4sd3h\" (spec.Name: \"default-token-4sd3h\") to pod \"6a9d4812-4b57-11e6-bf48-38607772ada8\" (UID: \"6a9d4812-4b57-11e6-bf48-38607772ada8\"). Volume is already mounted to pod, but remount was requested.\nI0716 09:06:30.238030   19838 reconciler.go:253] MountVolume operation started for volume \"kubernetes.io/configmap/samba-users\" (spec.Name: \"samba-users\") to pod \"6a9d4812-4b57-11e6-bf48-38607772ada8\" (UID: \"6a9d4812-4b57-11e6-bf48-38607772ada8\"). Volume is already mounted to pod, but remount was requested.\nI0716 09:06:30.240632   19838 operation_executor.go:720] MountVolume.SetUp succeeded for volume \"kubernetes.io/configmap/samba-config\" (spec.Name: \"samba-config\") pod \"6a9d4812-4b57-11e6-bf48-38607772ada8\" (UID: \"6a9d4812-4b57-11e6-bf48-38607772ada8\").\nI0716 09:06:30.240639   19838 operation_executor.go:720] MountVolume.SetUp succeeded for volume \"kubernetes.io/configmap/samba-users\" (spec.Name: \"samba-users\") pod \"6a9d4812-4b57-11e6-bf48-38607772ada8\" (UID: \"6a9d4812-4b57-11e6-bf48-38607772ada8\").\nI0716 09:06:30.240814   19838 operation_executor.go:720] MountVolume.SetUp succeeded for volume \"kubernetes.io/secret/default-token-4sd3h\" (spec.Name: \"default-token-4sd3h\") pod \"6a9d4812-4b57-11e6-bf48-38607772ada8\" (UID: \"6a9d4812-4b57-11e6-bf48-38607772ada8\").\n```\n\nSo it's repeatedly remounting already-mounted secret volumes and configmaps into pods.  Analyzing the unique pod IDs, this appears to be affecting all of them:\n\n```\n$ grep \"to pod\" /var/log/upstart/kubelet.log | awk '{print $15}' | sort | uniq | wc -l\n40\nkubectl get po --all-namespaces | wc -l\n38\n```\n\nI suspect the 2 missing pods are from old deployments.\n\nThis goes on ad infinitum every 3-5 seconds, hitting 2-3 pods each time, so presumably some kind of maint loop.\n\nThe code branch in reconciler.go is this one:\n\nhttps://github.com/kubernetes/kubernetes/blob/v1.3.0/pkg/kubelet/volume/reconciler/reconciler.go#L217\n\nand that err is populated from this line:\n\nhttps://github.com/kubernetes/kubernetes/blob/v1.3.0/pkg/kubelet/volume/reconciler/reconciler.go#L145\n\nBut beyond that I'm not sure why it is consistenly thinking that the mount operation didn't stick.\n\nAny ideas where to go from here?\n",
  "closed_at": "2017-05-27T01:49:04Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/13653959?v=4",
    "events_url": "https://api.github.com/users/k8s-github-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-github-robot/followers",
    "following_url": "https://api.github.com/users/k8s-github-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-github-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-github-robot",
    "id": 13653959,
    "login": "k8s-github-robot",
    "node_id": "MDQ6VXNlcjEzNjUzOTU5",
    "organizations_url": "https://api.github.com/users/k8s-github-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-github-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-github-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-github-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-github-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-github-robot"
  },
  "comments": 33,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/29059/comments",
  "created_at": "2016-07-16T16:15:14Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/29059/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/29059",
  "id": 165935764,
  "labels": [
    {
      "color": "0052cc",
      "default": false,
      "description": null,
      "id": 116719829,
      "name": "area/kubelet",
      "node_id": "MDU6TGFiZWwxMTY3MTk4Mjk=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/area/kubelet"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Storage.",
      "id": 169428334,
      "name": "sig/storage",
      "node_id": "MDU6TGFiZWwxNjk0MjgzMzQ=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/storage"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/29059/labels{/name}",
  "locked": false,
  "milestone": {
    "closed_at": "2019-08-26T17:22:37Z",
    "closed_issues": 1514,
    "created_at": "2017-01-19T17:41:27Z",
    "creator": {
      "avatar_url": "https://avatars0.githubusercontent.com/u/7882754?v=4",
      "events_url": "https://api.github.com/users/pwittrock/events{/privacy}",
      "followers_url": "https://api.github.com/users/pwittrock/followers",
      "following_url": "https://api.github.com/users/pwittrock/following{/other_user}",
      "gists_url": "https://api.github.com/users/pwittrock/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/pwittrock",
      "id": 7882754,
      "login": "pwittrock",
      "node_id": "MDQ6VXNlcjc4ODI3NTQ=",
      "organizations_url": "https://api.github.com/users/pwittrock/orgs",
      "received_events_url": "https://api.github.com/users/pwittrock/received_events",
      "repos_url": "https://api.github.com/users/pwittrock/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/pwittrock/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pwittrock/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/pwittrock"
    },
    "description": "",
    "due_on": "2017-06-28T07:00:00Z",
    "html_url": "https://github.com/kubernetes/kubernetes/milestone/32",
    "id": 2264750,
    "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/milestones/32/labels",
    "node_id": "MDk6TWlsZXN0b25lMjI2NDc1MA==",
    "number": 32,
    "open_issues": 0,
    "state": "closed",
    "title": "v1.7",
    "updated_at": "2019-08-26T17:22:37Z",
    "url": "https://api.github.com/repos/kubernetes/kubernetes/milestones/32"
  },
  "node_id": "MDU6SXNzdWUxNjU5MzU3NjQ=",
  "number": 29059,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "kubelet remounting default-token-xxxx repeatedly",
  "updated_at": "2017-05-27T01:49:04Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/29059",
  "user": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/41579?v=4",
    "events_url": "https://api.github.com/users/jf647/events{/privacy}",
    "followers_url": "https://api.github.com/users/jf647/followers",
    "following_url": "https://api.github.com/users/jf647/following{/other_user}",
    "gists_url": "https://api.github.com/users/jf647/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/jf647",
    "id": 41579,
    "login": "jf647",
    "node_id": "MDQ6VXNlcjQxNTc5",
    "organizations_url": "https://api.github.com/users/jf647/orgs",
    "received_events_url": "https://api.github.com/users/jf647/received_events",
    "repos_url": "https://api.github.com/users/jf647/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/jf647/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jf647/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/jf647"
  }
}