{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "NONE",
  "body": "BUG REPORT\r\n## Kubernetes version** (use `kubectl version`):\r\nClient Version: version.Info{Major:\"1\", Minor:\"4\", GitVersion:\"v1.4.5\", GitCommit:\"5a0a696437ad35c133c0c8493f7e9d22b0f9b81b\", GitTreeState:\"clean\", BuildDate:\"2016-10-29T01:38:40Z\", GoVersion:\"go1.6.3\", Compiler:\"gc\", Platform:\"windows/amd64\"}\r\nServer Version: version.Info{Major:\"1\", Minor:\"5\", GitVersion:\"v1.5.3\", GitCommit:\"029c3a408176b55c30846f0faedf56aae5992e9b\", GitTreeState:\"clean\", BuildDate:\"2017-02-15T06:34:56Z\", GoVersion:\"go1.7.4\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\n\r\n## Environment**:\r\nAzure ACS with windows agents\r\n**What happened**:\r\nunable to connect from one deployed service to other service based on the documented kubernetes dns name of the deployed service\r\n\r\n## repro steps:\r\nCreated two services using the following commands:\r\nkubectl create deployment iis --image=microsoft/iis\r\nkubectl expose iis --port:80 --type=LoadBalancer\r\n service is now available on external network\r\nnow I want from in this container to connect to a database using the dns name db.default.svc.cluster.local\r\nso created new service:\r\nkubectl create deployment db --image=marcelv/iisexpress\r\nand expose this internal in the cluster\r\nkubectl create service clusterip db --tcp=1433:1433\r\n\r\nnow I execute a command in the iis container to see if I can connect to the new db service:\r\nkubectl exec <nameofthepod> cmd.exe\r\ninside container I execute:\r\nnslookup\r\ndb.default.svc.cluster.local\r\nthis results the ip address I also see when I call the kubectl get services command\r\nbut when I want to connect to the dns name on port 1433 it wont resolve the ip adres\r\nif you do\r\nping db.default.svc.cluster.local\r\nPing request could not find host db.default.cluster.local. Please check the name and try again.\r\n\r\nso with a direct dns query it works, but the implicit name resolving on windows does not work.\r\nI tried to resolve it using \r\nipconfig /registerdns\r\nno avail\r\nlooking at the DNS cash does not show any entries\r\n\r\nSo it seems DNS is not fully functional inside the cluster.\r\n\r\n\r\n## What you expected to happen**:\r\nI expect to be able to connect to the network via DNS  from the pod\r\nI also deployed a .net application that tried to resolve the address\r\nbut those fal with a wind32 error network path not found\r\n\r\n",
  "closed_at": "2017-05-18T06:48:28Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/13653959?v=4",
    "events_url": "https://api.github.com/users/k8s-github-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-github-robot/followers",
    "following_url": "https://api.github.com/users/k8s-github-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-github-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-github-robot",
    "id": 13653959,
    "login": "k8s-github-robot",
    "node_id": "MDQ6VXNlcjEzNjUzOTU5",
    "organizations_url": "https://api.github.com/users/k8s-github-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-github-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-github-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-github-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-github-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-github-robot"
  },
  "comments": 6,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/42605/comments",
  "created_at": "2017-03-07T00:17:39Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/42605/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/42605",
  "id": 212291851,
  "labels": [],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/42605/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUyMTIyOTE4NTE=",
  "number": 42605,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "DNS resolving does not work on windows nodes",
  "updated_at": "2017-05-18T06:48:28Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/42605",
  "user": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/3602709?v=4",
    "events_url": "https://api.github.com/users/vriesmarcel/events{/privacy}",
    "followers_url": "https://api.github.com/users/vriesmarcel/followers",
    "following_url": "https://api.github.com/users/vriesmarcel/following{/other_user}",
    "gists_url": "https://api.github.com/users/vriesmarcel/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/vriesmarcel",
    "id": 3602709,
    "login": "vriesmarcel",
    "node_id": "MDQ6VXNlcjM2MDI3MDk=",
    "organizations_url": "https://api.github.com/users/vriesmarcel/orgs",
    "received_events_url": "https://api.github.com/users/vriesmarcel/received_events",
    "repos_url": "https://api.github.com/users/vriesmarcel/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/vriesmarcel/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vriesmarcel/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/vriesmarcel"
  }
}