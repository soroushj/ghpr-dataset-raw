{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/1745006?v=4",
    "events_url": "https://api.github.com/users/jsafrane/events{/privacy}",
    "followers_url": "https://api.github.com/users/jsafrane/followers",
    "following_url": "https://api.github.com/users/jsafrane/following{/other_user}",
    "gists_url": "https://api.github.com/users/jsafrane/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/jsafrane",
    "id": 1745006,
    "login": "jsafrane",
    "node_id": "MDQ6VXNlcjE3NDUwMDY=",
    "organizations_url": "https://api.github.com/users/jsafrane/orgs",
    "received_events_url": "https://api.github.com/users/jsafrane/received_events",
    "repos_url": "https://api.github.com/users/jsafrane/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/jsafrane/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jsafrane/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/jsafrane"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars2.githubusercontent.com/u/1745006?v=4",
      "events_url": "https://api.github.com/users/jsafrane/events{/privacy}",
      "followers_url": "https://api.github.com/users/jsafrane/followers",
      "following_url": "https://api.github.com/users/jsafrane/following{/other_user}",
      "gists_url": "https://api.github.com/users/jsafrane/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jsafrane",
      "id": 1745006,
      "login": "jsafrane",
      "node_id": "MDQ6VXNlcjE3NDUwMDY=",
      "organizations_url": "https://api.github.com/users/jsafrane/orgs",
      "received_events_url": "https://api.github.com/users/jsafrane/received_events",
      "repos_url": "https://api.github.com/users/jsafrane/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jsafrane/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jsafrane/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jsafrane"
    }
  ],
  "author_association": "MEMBER",
  "body": "If one target in multipath volume gets down **and** a pod that uses the volume is deleted and **quickly** recreated (e.g. by a Deployment), the new pod never starts.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n1. Run Deployment with single replica with one multipath iSCSI volume\r\n\r\n2. Destroy one target (e.g. switch the machine off). Multipath will mark appropriate path as failed:\r\n```\r\n$ multipath -ll\r\nmpatha (36001405ecb7e7041b044ba9805a1628b) dm-1 LIO-ORG ,TCMU device     \r\nsize=1.0G features='1 queue_if_no_path' hwhandler='1 alua' wp=rw\r\n|-+- policy='round-robin 0' prio=0 status=enabled\r\n| `- 14:0:0:0 sda 8:0  failed faulty running                 <----\r\n|-+- policy='round-robin 0' prio=10 status=active\r\n| `- 15:0:0:0 sdb 8:16 active ready running\r\n`-+- policy='round-robin 0' prio=10 status=enabled\r\n  `- 16:0:0:0 sdc 8:32 active ready running\r\n```\r\n\r\n3. Delete the deployment pod.\r\n\r\n4. Kubernetes will quickly start a new pod for the Deployment.\r\n\r\n5. This new pod will be `ContainerCreating` (or `Error`) forever,\r\n\r\n**What happened**:\r\nKubelet tries to WaitForAttach / SetUp volume for the new pod. The volume is still attached. Kubelet goes through all targets and tries to find out if it's logged in or not. Eventually it tries to read `/sys/class/iscsi_host/host415/device/session383/connection383:0/iscsi_connection/connection383:0/address` of the failed path and that returns error:\r\n\r\nhttps://github.com/kubernetes/kubernetes/blob/2f52e91d56dddde40a643c1202117ffdff55d930/pkg/volume/util/device_util_linux.go#L164-L168\r\n\r\n**What you expected to happen**:\r\nKubelet assumes that the path is failed / not logged in and tries to recover it. If it fails it continues with multipath with 2 available devices and 1 failed one.\r\n\r\nIMO, simple `continue` instead of `return` will do its job just fine.\r\n\r\n/assign\r\n/sig storage\r\ncc @bswartz @j-griffith @redbaron for iSCSI expertise\r\n",
  "closed_at": "2019-02-22T06:17:47Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/20407524?v=4",
    "events_url": "https://api.github.com/users/k8s-ci-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-ci-robot/followers",
    "following_url": "https://api.github.com/users/k8s-ci-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-ci-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-ci-robot",
    "id": 20407524,
    "login": "k8s-ci-robot",
    "node_id": "MDQ6VXNlcjIwNDA3NTI0",
    "organizations_url": "https://api.github.com/users/k8s-ci-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-ci-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-ci-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-ci-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-ci-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-ci-robot"
  },
  "comments": 1,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/74305/comments",
  "created_at": "2019-02-20T16:13:54Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/74305/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/74305",
  "id": 412508048,
  "labels": [
    {
      "color": "e11d21",
      "default": false,
      "description": "Categorizes issue or PR as related to a bug.",
      "id": 105146071,
      "name": "kind/bug",
      "node_id": "MDU6TGFiZWwxMDUxNDYwNzE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/bug"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Storage.",
      "id": 169428334,
      "name": "sig/storage",
      "node_id": "MDU6TGFiZWwxNjk0MjgzMzQ=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/storage"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/74305/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU0MTI1MDgwNDg=",
  "number": 74305,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "iSCSI fails to setup a volume when one target is down",
  "updated_at": "2019-02-22T06:17:47Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/74305",
  "user": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/1745006?v=4",
    "events_url": "https://api.github.com/users/jsafrane/events{/privacy}",
    "followers_url": "https://api.github.com/users/jsafrane/followers",
    "following_url": "https://api.github.com/users/jsafrane/following{/other_user}",
    "gists_url": "https://api.github.com/users/jsafrane/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/jsafrane",
    "id": 1745006,
    "login": "jsafrane",
    "node_id": "MDQ6VXNlcjE3NDUwMDY=",
    "organizations_url": "https://api.github.com/users/jsafrane/orgs",
    "received_events_url": "https://api.github.com/users/jsafrane/received_events",
    "repos_url": "https://api.github.com/users/jsafrane/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/jsafrane/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jsafrane/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/jsafrane"
  }
}