{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "MEMBER",
  "body": "Currently, we use disk UUID as the image filesystem storage identifier. https://github.com/kubernetes/kubernetes/blob/master/pkg/kubelet/apis/cri/v1alpha1/runtime/api.proto#L1057\r\n\r\nHowever, when implementing this in cri-containerd, we found it hard to implement.\r\n1) Today we are relying on `/dev/disk/by-uuid` to implement it (both cri-containerd and cadvisor). However `/dev/disk/by-uuid` is specific to [`udev`](https://en.wikipedia.org/wiki/Udev) device manager. Another device manager, such as [`mdev`](https://wiki.gentoo.org/wiki/Mdev) may not have it. We've got several issues for this in `cri-containerd` https://github.com/kubernetes-incubator/cri-containerd/issues/509, https://github.com/kubernetes-incubator/cri-containerd/issues/399 and https://github.com/kubernetes-incubator/cri-containerd/pull/292.\r\n2) Another option is to use `libblkid`. However, because there isn't go implementation, we need to:\r\n  a) Either use the C library, which introduces a hard dependency on cgo and `libblkid-dev`.\r\n  b) Or shell out [`blkid`](https://linux.die.net/man/8/blkid) which is part of `util-linux-ng` package. This is not impossible, but needs to introduce one extra dependency in both the container runtime and cadvisor.\r\n\r\nFor linux other than UUID, there are other options. The pros and cons:\r\n* UUID: Cons - Relatively hard to get and use in golang; Pros - Unique. For remote container runtime, kubelet won't be confused.\r\n* Device Number: Cons - For remote container runtime, kubelet may assume it's local device and can probably actually find a corresponding device locally; Pros - Easy to get. Actually `cri-containerd` [converts device number to UUID](https://github.com/kubernetes-incubator/cri-containerd/blob/master/pkg/server/service.go#L250), and cadvisor [converts UUID to device name](https://github.com/google/cadvisor/blob/7d11f4243f6e11700c0d644a468dfd48ba0ae588/fs/fs.go#L172) today. With device number, the logic will be simpler.\r\n* Device Name: Similar with device number.\r\n\r\nI'm not sure whether we should consider remote runtime today. Since if the runtime is remote, all the resource management and cgroup stuff won't work anyway today.\r\n\r\nOther than the problems above, there are some other problems:\r\n1) How to handle ZFS?\r\n  a) Should container runtime return device UUID/name/number? If yes, container runtime need to understand ZFS, and get device name/number from ZFS pool name.\r\n  b) Or should container runtime return ZFS pool name and let kubelet pass that to cadvisor?\r\nThe former seems better. Ref https://github.com/kubernetes-incubator/cri-containerd/issues/325.\r\n2) What about windows? It seems that windows also have the notion of [device number](https://technet.microsoft.com/en-us/library/cc957341.aspx), I'm not sure whether it's similar thing. @feiskyer \r\n3) How about VM-based container runtime?\r\n\r\n@yujuhong @mikebrow @abhi @ijc @mrunalp @feiskyer \r\n/cc @kubernetes/sig-node-api-reviews \r\n",
  "closed_at": "2018-02-09T03:41:57Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/13653959?v=4",
    "events_url": "https://api.github.com/users/k8s-github-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-github-robot/followers",
    "following_url": "https://api.github.com/users/k8s-github-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-github-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-github-robot",
    "id": 13653959,
    "login": "k8s-github-robot",
    "node_id": "MDQ6VXNlcjEzNjUzOTU5",
    "organizations_url": "https://api.github.com/users/k8s-github-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-github-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-github-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-github-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-github-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-github-robot"
  },
  "comments": 17,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/57356/comments",
  "created_at": "2017-12-18T22:19:50Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/57356/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/57356",
  "id": 283040072,
  "labels": [
    {
      "color": "0052cc",
      "default": false,
      "description": null,
      "id": 134645591,
      "name": "area/kubelet-api",
      "node_id": "MDU6TGFiZWwxMzQ2NDU1OTE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/area/kubelet-api"
    },
    {
      "color": "e11d21",
      "default": false,
      "description": "Categorizes issue or PR as related to adding, removing, or otherwise changing an API",
      "id": 261005360,
      "name": "kind/api-change",
      "node_id": "MDU6TGFiZWwyNjEwMDUzNjA=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/api-change"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Node.",
      "id": 173493665,
      "name": "sig/node",
      "node_id": "MDU6TGFiZWwxNzM0OTM2NjU=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/node"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/57356/labels{/name}",
  "locked": false,
  "milestone": {
    "closed_at": "2019-08-26T17:23:39Z",
    "closed_issues": 641,
    "created_at": "2017-07-24T18:50:54Z",
    "creator": {
      "avatar_url": "https://avatars1.githubusercontent.com/u/903617?v=4",
      "events_url": "https://api.github.com/users/mtaufen/events{/privacy}",
      "followers_url": "https://api.github.com/users/mtaufen/followers",
      "following_url": "https://api.github.com/users/mtaufen/following{/other_user}",
      "gists_url": "https://api.github.com/users/mtaufen/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mtaufen",
      "id": 903617,
      "login": "mtaufen",
      "node_id": "MDQ6VXNlcjkwMzYxNw==",
      "organizations_url": "https://api.github.com/users/mtaufen/orgs",
      "received_events_url": "https://api.github.com/users/mtaufen/received_events",
      "repos_url": "https://api.github.com/users/mtaufen/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mtaufen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mtaufen/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mtaufen"
    },
    "description": "",
    "due_on": "2018-03-26T07:00:00Z",
    "html_url": "https://github.com/kubernetes/kubernetes/milestone/37",
    "id": 2659046,
    "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/milestones/37/labels",
    "node_id": "MDk6TWlsZXN0b25lMjY1OTA0Ng==",
    "number": 37,
    "open_issues": 0,
    "state": "closed",
    "title": "v1.10",
    "updated_at": "2019-08-26T17:23:39Z",
    "url": "https://api.github.com/repos/kubernetes/kubernetes/milestones/37"
  },
  "node_id": "MDU6SXNzdWUyODMwNDAwNzI=",
  "number": 57356,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "CRI: Revisit Image Filesystem Storage Identifier",
  "updated_at": "2018-02-09T03:41:58Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/57356",
  "user": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/5821883?v=4",
    "events_url": "https://api.github.com/users/Random-Liu/events{/privacy}",
    "followers_url": "https://api.github.com/users/Random-Liu/followers",
    "following_url": "https://api.github.com/users/Random-Liu/following{/other_user}",
    "gists_url": "https://api.github.com/users/Random-Liu/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/Random-Liu",
    "id": 5821883,
    "login": "Random-Liu",
    "node_id": "MDQ6VXNlcjU4MjE4ODM=",
    "organizations_url": "https://api.github.com/users/Random-Liu/orgs",
    "received_events_url": "https://api.github.com/users/Random-Liu/received_events",
    "repos_url": "https://api.github.com/users/Random-Liu/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/Random-Liu/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Random-Liu/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/Random-Liu"
  }
}