{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/7182341?v=4",
    "events_url": "https://api.github.com/users/rikatz/events{/privacy}",
    "followers_url": "https://api.github.com/users/rikatz/followers",
    "following_url": "https://api.github.com/users/rikatz/following{/other_user}",
    "gists_url": "https://api.github.com/users/rikatz/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/rikatz",
    "id": 7182341,
    "login": "rikatz",
    "node_id": "MDQ6VXNlcjcxODIzNDE=",
    "organizations_url": "https://api.github.com/users/rikatz/orgs",
    "received_events_url": "https://api.github.com/users/rikatz/received_events",
    "repos_url": "https://api.github.com/users/rikatz/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/rikatz/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rikatz/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/rikatz"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars0.githubusercontent.com/u/7182341?v=4",
      "events_url": "https://api.github.com/users/rikatz/events{/privacy}",
      "followers_url": "https://api.github.com/users/rikatz/followers",
      "following_url": "https://api.github.com/users/rikatz/following{/other_user}",
      "gists_url": "https://api.github.com/users/rikatz/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/rikatz",
      "id": 7182341,
      "login": "rikatz",
      "node_id": "MDQ6VXNlcjcxODIzNDE=",
      "organizations_url": "https://api.github.com/users/rikatz/orgs",
      "received_events_url": "https://api.github.com/users/rikatz/received_events",
      "repos_url": "https://api.github.com/users/rikatz/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/rikatz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rikatz/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/rikatz"
    }
  ],
  "author_association": "NONE",
  "body": "**What happened**:\r\nWith several large headless services in the cluster providing DNS records for statefulset pods, we see about 1TB of watch traffic for Endpoints per day! Some of these Endpoints objects approach 1MB in size and we have thousands of nodes, so a single update to the Endpoints object results in gigabytes of broadcast.\r\n\r\n**What you expected to happen**:\r\nkube-proxy does not need to receive any updates for headless services.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n**Anything else we need to know?**:\r\nBig headless services like this are a stand-in for the lack of other pod-addressable DNS features. There's a lot of improvements that could be made to prevent this, but it seems like an extremely easy change to prevent kube-proxy from receiving updates for headless services.\r\n\r\nA simple solution:\r\n1. Make the Service controller propagate `ClusterIP: None` to a label on the Endpoints object like `service.k8s.io/headless: \"true\"` or similar.\r\n2. Add a filter in kube-proxy's endpoints watch to exclude the headless label.\r\n\r\n**Environment**:\r\n- Kubernetes version (use `kubectl version`): 1.12\r\n- Cloud provider or hardware configuration: EC2\r\n- OS (e.g: `cat /etc/os-release`): custom distro\r\n- Kernel (e.g. `uname -a`): 4.14.133\r\n- Install tools: custom",
  "closed_at": "2019-08-28T21:44:28Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/20407524?v=4",
    "events_url": "https://api.github.com/users/k8s-ci-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-ci-robot/followers",
    "following_url": "https://api.github.com/users/k8s-ci-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-ci-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-ci-robot",
    "id": 20407524,
    "login": "k8s-ci-robot",
    "node_id": "MDQ6VXNlcjIwNDA3NTI0",
    "organizations_url": "https://api.github.com/users/k8s-ci-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-ci-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-ci-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-ci-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-ci-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-ci-robot"
  },
  "comments": 5,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/81060/comments",
  "created_at": "2019-08-07T04:11:33Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/81060/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/81060",
  "id": 477697111,
  "labels": [
    {
      "color": "e11d21",
      "default": false,
      "description": "Categorizes issue or PR as related to a bug.",
      "id": 105146071,
      "name": "kind/bug",
      "node_id": "MDU6TGFiZWwxMDUxNDYwNzE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/bug"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Network.",
      "id": 116712108,
      "name": "sig/network",
      "node_id": "MDU6TGFiZWwxMTY3MTIxMDg=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/network"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/81060/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU0Nzc2OTcxMTE=",
  "number": 81060,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "Kube-proxy should not watch endpoints from headless services",
  "updated_at": "2019-08-28T21:44:28Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/81060",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/704936?v=4",
    "events_url": "https://api.github.com/users/PaulFurtado/events{/privacy}",
    "followers_url": "https://api.github.com/users/PaulFurtado/followers",
    "following_url": "https://api.github.com/users/PaulFurtado/following{/other_user}",
    "gists_url": "https://api.github.com/users/PaulFurtado/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/PaulFurtado",
    "id": 704936,
    "login": "PaulFurtado",
    "node_id": "MDQ6VXNlcjcwNDkzNg==",
    "organizations_url": "https://api.github.com/users/PaulFurtado/orgs",
    "received_events_url": "https://api.github.com/users/PaulFurtado/received_events",
    "repos_url": "https://api.github.com/users/PaulFurtado/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/PaulFurtado/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/PaulFurtado/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/PaulFurtado"
  }
}