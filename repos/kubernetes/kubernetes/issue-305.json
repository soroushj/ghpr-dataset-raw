{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "CONTRIBUTOR",
  "body": "Detected by `go test -race`\n\n```\n$ go test -race\nI0630 10:53:15.336432 28175 replication_controller.go:188] []api.Pod{api.Pod{JSONBase:api.JSONBase{Kind:\"\", ID:\"pod0\", CreationTimestamp:\"\", SelfLink:\"\"}, Labels:map[string]string(nil), DesiredState:api.PodState{Manifest:api.ContainerManifest{Version:\"\", Volumes:[]api.Volume(nil), Containers:[]api.Container(nil), Id:\"\"}, Status:\"\", Host:\"\", HostIP:\"\", Info:interface {}(nil)}, CurrentState:api.PodState{Manifest:api.ContainerManifest{Version:\"\", Volumes:[]api.Volume(nil), Containers:[]api.Container(nil), Id:\"\"}, Status:\"\", Host:\"\", HostIP:\"\", Info:interface {}(nil)}}, api.Pod{JSONBase:api.JSONBase{Kind:\"\", ID:\"pod1\", CreationTimestamp:\"\", SelfLink:\"\"}, Labels:map[string]string(nil), DesiredState:api.PodState{Manifest:api.ContainerManifest{Version:\"\", Volumes:[]api.Volume(nil), Containers:[]api.Container(nil), Id:\"\"}, Status:\"\", Host:\"\", HostIP:\"\", Info:interface {}(nil)}, CurrentState:api.PodState{Manifest:api.ContainerManifest{Version:\"\", Volumes:[]api.Volume(nil), Containers:[]api.Container(nil), Id:\"\"}, Status:\"\", Host:\"\", HostIP:\"\", Info:interface {}(nil)}}}\nI0630 10:53:15.438385 28175 replication_controller.go:188] []api.Pod{api.Pod{JSONBase:api.JSONBase{Kind:\"\", ID:\"pod0\", CreationTimestamp:\"\", SelfLink:\"\"}, Labels:map[string]string(nil), DesiredState:api.PodState{Manifest:api.ContainerManifest{Version:\"\", Volumes:[]api.Volume(nil), Containers:[]api.Container(nil), Id:\"\"}, Status:\"\", Host:\"\", HostIP:\"\", Info:interface {}(nil)}, CurrentState:api.PodState{Manifest:api.ContainerManifest{Version:\"\", Volumes:[]api.Volume(nil), Containers:[]api.Container(nil), Id:\"\"}, Status:\"\", Host:\"\", HostIP:\"\", Info:interface {}(nil)}}, api.Pod{JSONBase:api.JSONBase{Kind:\"\", ID:\"pod1\", CreationTimestamp:\"\", SelfLink:\"\"}, Labels:map[string]string(nil), DesiredState:api.PodState{Manifest:api.ContainerManifest{Version:\"\", Volumes:[]api.Volume(nil), Containers:[]api.Container(nil), Id:\"\"}, Status:\"\", Host:\"\", HostIP:\"\", Info:interface {}(nil)}, CurrentState:api.PodState{Manifest:api.ContainerManifest{Version:\"\", Volumes:[]api.Volume(nil), Containers:[]api.Container(nil), Id:\"\"}, Status:\"\", Host:\"\", HostIP:\"\", Info:interface {}(nil)}}}\nI0630 10:53:15.438565 28175 replication_controller.go:196] Too many replicas, deleting\nI0630 10:53:15.538979 28175 replication_controller.go:188] []api.Pod(nil)\nI0630 10:53:15.539021 28175 replication_controller.go:191] Too few replicas, creating 2\nI0630 10:53:15.863162 28175 replication_controller.go:188] []api.Pod(nil)\nI0630 10:53:15.863213 28175 replication_controller.go:191] Too few replicas, creating 4\nI0630 10:53:15.863729 28175 replication_controller.go:188] []api.Pod(nil)\nI0630 10:53:15.863762 28175 replication_controller.go:191] Too few replicas, creating 3\n==================\nWARNING: DATA RACE\nRead by goroutine 53:\n  github.com/GoogleCloudPlatform/kubernetes/pkg/controller.TestWatchControllers()\n      /usr/local/google/home/dengnan/goproj/src/github.com/GoogleCloudPlatform/kubernetes/pkg/controller/replication_controller_test.go:457 +0x4a1\n  testing.tRunner()\n      /usr/lib/google-golang/src/pkg/testing/testing.go:422 +0x10f\n\nPrevious write by goroutine 56:\n  github.com/GoogleCloudPlatform/kubernetes/pkg/util.(*FakeEtcdClient).Watch()\n      /usr/local/google/home/dengnan/goproj/src/github.com/GoogleCloudPlatform/kubernetes/pkg/util/fake_etcd_client.go:101 +0x63\n  github.com/GoogleCloudPlatform/kubernetes/pkg/controller.func\u00b7005()\n      /usr/local/google/home/dengnan/goproj/src/github.com/GoogleCloudPlatform/kubernetes/pkg/controller/replication_controller.go:112 +0x175\n\nGoroutine 53 (running) created at:\n  testing.RunTests()\n      /usr/lib/google-golang/src/pkg/testing/testing.go:508 +0xb46\n  testing.Main()\n      /usr/lib/google-golang/src/pkg/testing/testing.go:439 +0xbd\n  main.main()\n      github.com/GoogleCloudPlatform/kubernetes/pkg/controller/_test/_testmain.go:67 +0xdc\n\nGoroutine 56 (running) created at:\n  github.com/GoogleCloudPlatform/kubernetes/pkg/controller.(*ReplicationManager).watchControllers()\n      /usr/local/google/home/dengnan/goproj/src/github.com/GoogleCloudPlatform/kubernetes/pkg/controller/replication_controller.go:116 +0x205\n==================\nI0630 10:53:15.874408 28175 replication_controller.go:129] Got watch: &etcd.Response{Action:\"set\", Node:(*etcd.Node)(0x4c20814b7a0), PrevNode:(*etcd.Node)(nil), EtcdIndex:0x0, RaftIndex:0x0, RaftTerm:0x0}\n==================\nWARNING: DATA RACE\nRead by goroutine 53:\n  github.com/GoogleCloudPlatform/kubernetes/pkg/controller.TestWatchControllers()\n      /usr/local/google/home/dengnan/goproj/src/github.com/GoogleCloudPlatform/kubernetes/pkg/controller/replication_controller_test.go:460 +0x4e7\n  testing.tRunner()\n      /usr/lib/google-golang/src/pkg/testing/testing.go:422 +0x10f\n\nPrevious write by goroutine 55:\n  github.com/GoogleCloudPlatform/kubernetes/pkg/controller.func\u00b7007()\n      /usr/local/google/home/dengnan/goproj/src/github.com/GoogleCloudPlatform/kubernetes/pkg/controller/replication_controller_test.go:443 +0x2a7\n  github.com/GoogleCloudPlatform/kubernetes/pkg/controller.(*ReplicationManager).watchControllers()\n      /usr/local/google/home/dengnan/goproj/src/github.com/GoogleCloudPlatform/kubernetes/pkg/controller/replication_controller.go:135 +0x5e5\n\nGoroutine 53 (running) created at:\n  testing.RunTests()\n      /usr/lib/google-golang/src/pkg/testing/testing.go:508 +0xb46\n  testing.Main()\n      /usr/lib/google-golang/src/pkg/testing/testing.go:439 +0xbd\n  main.main()\n      github.com/GoogleCloudPlatform/kubernetes/pkg/controller/_test/_testmain.go:67 +0xdc\n\nGoroutine 55 (running) created at:\n  github.com/GoogleCloudPlatform/kubernetes/pkg/controller.TestWatchControllers()\n      /usr/local/google/home/dengnan/goproj/src/github.com/GoogleCloudPlatform/kubernetes/pkg/controller/replication_controller_test.go:447 +0x2d3\n  testing.tRunner()\n      /usr/lib/google-golang/src/pkg/testing/testing.go:422 +0x10f\n==================\n==================\nWARNING: DATA RACE\nRead by goroutine 53:\n  github.com/GoogleCloudPlatform/kubernetes/pkg/controller.TestWatchControllers()\n      /usr/local/google/home/dengnan/goproj/src/github.com/GoogleCloudPlatform/kubernetes/pkg/controller/replication_controller_test.go:465 +0x644\n  testing.tRunner()\n      /usr/lib/google-golang/src/pkg/testing/testing.go:422 +0x10f\n\nPrevious write by goroutine 56:\n  github.com/GoogleCloudPlatform/kubernetes/pkg/util.(*FakeEtcdClient).Watch()\n      /usr/local/google/home/dengnan/goproj/src/github.com/GoogleCloudPlatform/kubernetes/pkg/util/fake_etcd_client.go:105 +0xe2\n  github.com/GoogleCloudPlatform/kubernetes/pkg/controller.func\u00b7005()\n      /usr/local/google/home/dengnan/goproj/src/github.com/GoogleCloudPlatform/kubernetes/pkg/controller/replication_controller.go:112 +0x175\n\nGoroutine 53 (running) created at:\n  testing.RunTests()\n      /usr/lib/google-golang/src/pkg/testing/testing.go:508 +0xb46\n  testing.Main()\n      /usr/lib/google-golang/src/pkg/testing/testing.go:439 +0xbd\n  main.main()\n      github.com/GoogleCloudPlatform/kubernetes/pkg/controller/_test/_testmain.go:67 +0xdc\n\nGoroutine 56 (running) created at:\n  github.com/GoogleCloudPlatform/kubernetes/pkg/controller.(*ReplicationManager).watchControllers()\n      /usr/local/google/home/dengnan/goproj/src/github.com/GoogleCloudPlatform/kubernetes/pkg/controller/replication_controller.go:116 +0x205\n  github.com/GoogleCloudPlatform/kubernetes/pkg/controller.TestWatchControllers()\n      /usr/local/google/home/dengnan/goproj/src/github.com/GoogleCloudPlatform/kubernetes/pkg/controller/replication_controller_test.go:476 +0x756\n  testing.tRunner()\n      /usr/lib/google-golang/src/pkg/testing/testing.go:422 +0x10f\n\nPrevious write by goroutine 58:\n  github.com/GoogleCloudPlatform/kubernetes/pkg/util.(*FakeEtcdClient).Watch()\n      /usr/local/google/home/dengnan/goproj/src/github.com/GoogleCloudPlatform/kubernetes/pkg/util/fake_etcd_client.go:102 +0x82\n  github.com/GoogleCloudPlatform/kubernetes/pkg/controller.func\u00b7005()\n      /usr/local/google/home/dengnan/goproj/src/github.com/GoogleCloudPlatform/kubernetes/pkg/controller/replication_controller.go:112 +0x175\n\nGoroutine 53 (running) created at:\n  testing.RunTests()\n      /usr/lib/google-golang/src/pkg/testing/testing.go:508 +0xb46\n  testing.Main()\n      /usr/lib/google-golang/src/pkg/testing/testing.go:439 +0xbd\n  main.main()\n      github.com/GoogleCloudPlatform/kubernetes/pkg/controller/_test/_testmain.go:67 +0xdc\n\nGoroutine 58 (running) created at:\n  github.com/GoogleCloudPlatform/kubernetes/pkg/controller.(*ReplicationManager).watchControllers()\n      /usr/local/google/home/dengnan/goproj/src/github.com/GoogleCloudPlatform/kubernetes/pkg/controller/replication_controller.go:116 +0x205\n==================\nPASS\nFound 4 data race(s)\nexit status 66\nFAIL    github.com/GoogleCloudPlatform/kubernetes/pkg/controller    1.719s\n```\n",
  "closed_at": "2014-07-01T18:34:05Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/647318?v=4",
    "events_url": "https://api.github.com/users/lavalamp/events{/privacy}",
    "followers_url": "https://api.github.com/users/lavalamp/followers",
    "following_url": "https://api.github.com/users/lavalamp/following{/other_user}",
    "gists_url": "https://api.github.com/users/lavalamp/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/lavalamp",
    "id": 647318,
    "login": "lavalamp",
    "node_id": "MDQ6VXNlcjY0NzMxOA==",
    "organizations_url": "https://api.github.com/users/lavalamp/orgs",
    "received_events_url": "https://api.github.com/users/lavalamp/received_events",
    "repos_url": "https://api.github.com/users/lavalamp/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/lavalamp/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/lavalamp/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/lavalamp"
  },
  "comments": 1,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/305/comments",
  "created_at": "2014-06-30T17:56:10Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/305/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/305",
  "id": 36821080,
  "labels": [],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/305/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUzNjgyMTA4MA==",
  "number": 305,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "Data race in pkg/controller",
  "updated_at": "2019-03-24T06:55:54Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/305",
  "user": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/379562?v=4",
    "events_url": "https://api.github.com/users/monnand/events{/privacy}",
    "followers_url": "https://api.github.com/users/monnand/followers",
    "following_url": "https://api.github.com/users/monnand/following{/other_user}",
    "gists_url": "https://api.github.com/users/monnand/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/monnand",
    "id": 379562,
    "login": "monnand",
    "node_id": "MDQ6VXNlcjM3OTU2Mg==",
    "organizations_url": "https://api.github.com/users/monnand/orgs",
    "received_events_url": "https://api.github.com/users/monnand/received_events",
    "repos_url": "https://api.github.com/users/monnand/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/monnand/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/monnand/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/monnand"
  }
}