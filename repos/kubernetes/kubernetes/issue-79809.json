{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "NONE",
  "body": "Expectation-\r\nWe should be able to create PVCs via a storageclass with storagePolicyName defined while using a singed ca cert for secure communications with vCenter. \r\n\r\nBug-\r\nThe PVC created with a storageclass with storagePolicyName defined fails with a `x509: certificate signed by unknown authority` error when PVCs created with a storageclass without the storagPolicyName work against the same vCenter and datastore.\r\n\r\nScenario:\r\nUtilizing the vSphere in-tree plugin on kubernetes 1.12.7.\r\nUtilizing secure communication with vSphere (signed ca cert imported into the cluster)\r\nWe are able to create PVCs with the following storage class:\r\n```\r\nkind: StorageClass\r\napiVersion: storage.k8s.io/v1\r\nmetadata:\r\n  name: sc1\r\nprovisioner: kubernetes.io/vsphere-volume\r\nparameters:\r\n  datastore: datastore1\r\n```\r\n\r\nHowever, if we include a storagePolicyName we receive a failure:\r\n`  Warning  ProvisioningFailed  0s (x3 over 29s)  persistentvolume-controller  Failed to provision volume with StorageClass \"sc1\": Post https://[redacted].com:443/pbm/sdk: x509: certificate signed by unknown authority`\r\n\r\nHere is the yaml for our sc1 storage class:\r\n```\r\nkind: StorageClass\r\napiVersion: storage.k8s.io/v1\r\nmetadata:\r\n  name: sc1\r\nprovisioner: kubernetes.io/vsphere-volume\r\nparameters:\r\n  storagePolicyName: storageclass1\r\n  datastore: datastore1\r\n```\r\n/sig vmware ",
  "closed_at": "2019-07-08T16:12:26Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/44103209?v=4",
    "events_url": "https://api.github.com/users/paemason/events{/privacy}",
    "followers_url": "https://api.github.com/users/paemason/followers",
    "following_url": "https://api.github.com/users/paemason/following{/other_user}",
    "gists_url": "https://api.github.com/users/paemason/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/paemason",
    "id": 44103209,
    "login": "paemason",
    "node_id": "MDQ6VXNlcjQ0MTAzMjA5",
    "organizations_url": "https://api.github.com/users/paemason/orgs",
    "received_events_url": "https://api.github.com/users/paemason/received_events",
    "repos_url": "https://api.github.com/users/paemason/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/paemason/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/paemason/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/paemason"
  },
  "comments": 22,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/79809/comments",
  "created_at": "2019-06-27T15:39:10Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/79809/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/79809",
  "id": 464348142,
  "labels": [
    {
      "color": "0052cc",
      "default": false,
      "description": "Issues or PRs related to vmware provider",
      "id": 874113778,
      "name": "area/provider/vmware",
      "node_id": "MDU6TGFiZWw4NzQxMTM3Nzg=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/area/provider/vmware"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/79809/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU0NjQzNDgxNDI=",
  "number": 79809,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "Unable to create PVC using a storage class with vSphere storage policy defined (secure connection to vCenter)",
  "updated_at": "2019-10-04T16:09:44Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/79809",
  "user": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/44103209?v=4",
    "events_url": "https://api.github.com/users/paemason/events{/privacy}",
    "followers_url": "https://api.github.com/users/paemason/followers",
    "following_url": "https://api.github.com/users/paemason/following{/other_user}",
    "gists_url": "https://api.github.com/users/paemason/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/paemason",
    "id": 44103209,
    "login": "paemason",
    "node_id": "MDQ6VXNlcjQ0MTAzMjA5",
    "organizations_url": "https://api.github.com/users/paemason/orgs",
    "received_events_url": "https://api.github.com/users/paemason/received_events",
    "repos_url": "https://api.github.com/users/paemason/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/paemason/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/paemason/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/paemason"
  }
}