{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/4178417?v=4",
    "events_url": "https://api.github.com/users/andyzhangx/events{/privacy}",
    "followers_url": "https://api.github.com/users/andyzhangx/followers",
    "following_url": "https://api.github.com/users/andyzhangx/following{/other_user}",
    "gists_url": "https://api.github.com/users/andyzhangx/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/andyzhangx",
    "id": 4178417,
    "login": "andyzhangx",
    "node_id": "MDQ6VXNlcjQxNzg0MTc=",
    "organizations_url": "https://api.github.com/users/andyzhangx/orgs",
    "received_events_url": "https://api.github.com/users/andyzhangx/received_events",
    "repos_url": "https://api.github.com/users/andyzhangx/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/andyzhangx/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/andyzhangx/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/andyzhangx"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars1.githubusercontent.com/u/4178417?v=4",
      "events_url": "https://api.github.com/users/andyzhangx/events{/privacy}",
      "followers_url": "https://api.github.com/users/andyzhangx/followers",
      "following_url": "https://api.github.com/users/andyzhangx/following{/other_user}",
      "gists_url": "https://api.github.com/users/andyzhangx/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/andyzhangx",
      "id": 4178417,
      "login": "andyzhangx",
      "node_id": "MDQ6VXNlcjQxNzg0MTc=",
      "organizations_url": "https://api.github.com/users/andyzhangx/orgs",
      "received_events_url": "https://api.github.com/users/andyzhangx/received_events",
      "repos_url": "https://api.github.com/users/andyzhangx/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/andyzhangx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/andyzhangx/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/andyzhangx"
    }
  ],
  "author_association": "MEMBER",
  "body": "<!-- Please use this template while reporting a bug and provide as much info as possible. Not doing so may result in your bug not being addressed in a timely manner. Thanks!-->\r\n\r\n\r\n**What happened**:\r\nvm sku restriction policy does not work in azure disk attach/detach\r\nIf user set up a vm sku(vm size) restriction policy, only allow set up specified VM size in current subscription, disk attach/detach would fail. Error is like following:\r\n```\r\nEvents:\r\n  Type     Reason                  Age   From                     Message\r\n  ----     ------                  ----  ----                     -------\r\n  Normal   Scheduled               20s   default-scheduler        Successfully assigned default/nginx-azuredisk to k8s-agentpool-17181929-1\r\n  Warning  FailedAttachVolume      9s    attachdetach-controller  AttachVolume.Attach failed for volume \"pvc-0759925e-fd10-11e8-90f1-000d3a03e16b\" : Attach volume \"andy-mg1121-dynamic-pvc-0759925e-fd10-11e8-90f1-000d3a03e16b\" to instance\r\n \"/subscriptions/xxx/resourceGroups/andy-mg1121/providers/Microsoft.Compute/virtualMachines/k8s-agentpool-17181929-1\" failed with compute.VirtualMachinesClient#CreateOrUpdate: Failure sending request: Sta\r\ntusCode=0 -- Original Error: autorest/azure: Service returned an error. Status=403 Code=\"RequestDisallowedByPolicy\" Message=\"Resource 'k8s-agentpool-17181929-1' was disallowed by policy. Policy identifiers: '[{\\\"policyAssignment\\\":{\\\"nam\r\ne\\\":\\\"Allowed virtual machine SKUs\\\",\\\"id\\\":\\\"/subscriptions/xxx/providers/Microsoft.Authorization/policyAssignments/aabc40fc571542b99d1c2f93\\\"},\\\"policyDefinition\\\":{\\\"name\\\":\\\"Allowed virtual machine SK\r\nUs\\\",\\\"id\\\":\\\"/providers/Microsoft.Authorization/policyDefinitions/cccc23c7-8427-4f53-ad12-b6a63eb452b3\\\"}}]'.\" Target=\"k8s-agentpool-17181929-1\" AdditionalInfo=[{\"info\":{\"evaluationDetails\":{\"evaluatedExpressions\":[{\"expression\":\"type\",\r\n\"expressionValue\":\"Microsoft.Compute/virtualMachines\",\"operator\":\"Equals\",\"path\":\"type\",\"result\":\"True\",\"targetValue\":\"Microsoft.Compute/virtualMachines\"},{\"expression\":\"Microsoft.Compute/virtualMachines/sku.name\",\"operator\":\"In\",\"path\":\r\n\"properties.hardwareProfile.vmSize\",\"result\":\"False\",\"targetValue\":[\"Standard_D4\"]}]},\"policyAssignmentDisplayName\":\"Allowed virtual machine SKUs\",\"policyAssignmentId\":\"/subscriptions/xxx/providers/Micros\r\noft.Authorization/policyAssignments/aabc40fc571542b99d1c2f93\",\"policyAssignmentName\":\"aabc40fc571542b99d1c2f93\",\"policyAssignmentParameters\":{\"listOfAllowedSKUs\":{\"value\":[\"Standard_D4\"]}},\"policyAssignmentScope\":\"/subscriptions/b9d2281e\r\n-dcd5-4dfd-9a97-0d50377cdf76\",\"policyDefinitionDisplayName\":\"Allowed virtual machine SKUs\",\"policyDefinitionEffect\":\"Deny\",\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/cccc23c7-8427-4f53-ad12-b6a63eb452b3\",\r\n```\r\n\r\n**What you expected to happen**:\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Kubernetes version (use `kubectl version`):\r\n- Cloud provider or hardware configuration:\r\n- OS (e.g. from /etc/os-release):\r\n- Kernel (e.g. `uname -a`):\r\n- Install tools:\r\n- Others:\r\n\r\n<!-- DO NOT EDIT BELOW THIS LINE -->\r\n/kind bug\r\n/sig azure\r\n/assign",
  "closed_at": "2018-12-11T13:09:32Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/20407524?v=4",
    "events_url": "https://api.github.com/users/k8s-ci-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-ci-robot/followers",
    "following_url": "https://api.github.com/users/k8s-ci-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-ci-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-ci-robot",
    "id": 20407524,
    "login": "k8s-ci-robot",
    "node_id": "MDQ6VXNlcjIwNDA3NTI0",
    "organizations_url": "https://api.github.com/users/k8s-ci-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-ci-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-ci-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-ci-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-ci-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-ci-robot"
  },
  "comments": 0,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/71940/comments",
  "created_at": "2018-12-11T08:38:17Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/71940/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/71940",
  "id": 389649581,
  "labels": [
    {
      "color": "e11d21",
      "default": false,
      "description": "Categorizes issue or PR as related to a bug.",
      "id": 105146071,
      "name": "kind/bug",
      "node_id": "MDU6TGFiZWwxMDUxNDYwNzE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/bug"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/71940/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUzODk2NDk1ODE=",
  "number": 71940,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "vm sku restriction policy does not work in azure disk attach/detach",
  "updated_at": "2018-12-11T13:09:32Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/71940",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/4178417?v=4",
    "events_url": "https://api.github.com/users/andyzhangx/events{/privacy}",
    "followers_url": "https://api.github.com/users/andyzhangx/followers",
    "following_url": "https://api.github.com/users/andyzhangx/following{/other_user}",
    "gists_url": "https://api.github.com/users/andyzhangx/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/andyzhangx",
    "id": 4178417,
    "login": "andyzhangx",
    "node_id": "MDQ6VXNlcjQxNzg0MTc=",
    "organizations_url": "https://api.github.com/users/andyzhangx/orgs",
    "received_events_url": "https://api.github.com/users/andyzhangx/received_events",
    "repos_url": "https://api.github.com/users/andyzhangx/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/andyzhangx/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/andyzhangx/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/andyzhangx"
  }
}