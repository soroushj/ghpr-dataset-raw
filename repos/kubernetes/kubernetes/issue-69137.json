{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/1745006?v=4",
    "events_url": "https://api.github.com/users/jsafrane/events{/privacy}",
    "followers_url": "https://api.github.com/users/jsafrane/followers",
    "following_url": "https://api.github.com/users/jsafrane/following{/other_user}",
    "gists_url": "https://api.github.com/users/jsafrane/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/jsafrane",
    "id": 1745006,
    "login": "jsafrane",
    "node_id": "MDQ6VXNlcjE3NDUwMDY=",
    "organizations_url": "https://api.github.com/users/jsafrane/orgs",
    "received_events_url": "https://api.github.com/users/jsafrane/received_events",
    "repos_url": "https://api.github.com/users/jsafrane/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/jsafrane/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jsafrane/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/jsafrane"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars2.githubusercontent.com/u/1745006?v=4",
      "events_url": "https://api.github.com/users/jsafrane/events{/privacy}",
      "followers_url": "https://api.github.com/users/jsafrane/followers",
      "following_url": "https://api.github.com/users/jsafrane/following{/other_user}",
      "gists_url": "https://api.github.com/users/jsafrane/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jsafrane",
      "id": 1745006,
      "login": "jsafrane",
      "node_id": "MDQ6VXNlcjE3NDUwMDY=",
      "organizations_url": "https://api.github.com/users/jsafrane/orgs",
      "received_events_url": "https://api.github.com/users/jsafrane/received_events",
      "repos_url": "https://api.github.com/users/jsafrane/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jsafrane/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jsafrane/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jsafrane"
    }
  ],
  "author_association": "MEMBER",
  "body": "**What happened**:\r\niSCSI volume plugin panics before logging out from an iSCSI target. The volume is unmounted and its device is deleted correctly just before, so Kubernetes did not complain much, this panic is hidden in logs and nobody noticed it.\r\n\r\nOne visible artifact: `iscsiadm -m session` still lists the session:\r\n\r\n```bash\r\n$ iscsiadm -m session\r\ntcp: [1] 127.0.0.1:3260,1 iqn.2003-01.org.linux-iscsi.f21.x8664:sn.4b0aae584f7c (non-flash)\r\n```\r\n\r\nThe panic:\r\n\r\n```\r\nE0927 07:58:45.734294    4666 nestedpendingoperations.go:267] Operation for \"\\\"kubernetes.io/iscsi/127.0.0.1:3260:iqn.2003-01.org.linux-iscsi.f21.x8664:sn.4b0aae584f7c:0\\\"\" failed. No retries permitted until 2018-09-27 07:58:46.2342397 +0000 UTC m=+362.550815929 (durationBeforeRetry 500ms).\r\nError: \"recovered from panic \\\"runtime error: invalid memory address or nil pointer dereference\\\". (err=<nil>) Call stack:\\n\r\n/home/jsafrane/project/go/src/k8s.io/kubernetes/_output/local/go/src/k8s.io/kubernetes/vendor/k8s.io/apimachinery/pkg/util/runtime/runtime.go:72\\n\r\n/home/jsafrane/project/go/src/k8s.io/kubernetes/_output/local/go/src/k8s.io/kubernetes/vendor/k8s.io/apimachinery/pkg/util/runtime/runtime.go:154\\n\r\n/home/jsafrane/.gimme/versions/go1.11.linux.amd64/src/runtime/asm_amd64.s:522\\n\r\n/home/jsafrane/.gimme/versions/go1.11.linux.amd64/src/runtime/panic.go:513\\n\r\n/home/jsafrane/.gimme/versions/go1.11.linux.amd64/src/runtime/panic.go:82\\n\r\n/home/jsafrane/.gimme/versions/go1.11.linux.amd64/src/runtime/signal_unix.go:390\\n\r\n/home/jsafrane/project/go/src/k8s.io/kubernetes/_output/local/go/src/k8s.io/kubernetes/pkg/volume/iscsi/iscsi_util.go:596\\n\r\n/home/jsafrane/project/go/src/k8s.io/kubernetes/_output/local/go/src/k8s.io/kubernetes/pkg/volume/iscsi/attacher.go:164\\n\r\n/home/jsafrane/project/go/src/k8s.io/kubernetes/_output/local/go/src/k8s.io/kubernetes/pkg/volume/util/operationexecutor/operation_generator.go:763\\n\r\n/home/jsafrane/project/go/src/k8s.io/kubernetes/_output/local/go/src/k8s.io/kubernetes/pkg/volume/util/nestedpendingoperations/nestedpendingoperations.go:143\\n\r\n/home/jsafrane/.gimme/versions/go1.11.linux.amd64/src/runtime/asm_amd64.s:1333\\n\"\r\n```\r\n(it's one long line, formatted for readability)\r\n\r\nIt panics here: https://github.com/kubernetes/kubernetes/blob/3fe21e5433988b9512e74f42bf07a036be84a263/pkg/volume/iscsi/iscsi_util.go#L596\r\n\r\n`c.plugin` is nil, because `c` was initialized here (as `unMounter`) and no plugin is passed to it:\r\nhttps://github.com/kubernetes/kubernetes/blob/3fe21e5433988b9512e74f42bf07a036be84a263/pkg/volume/iscsi/attacher.go#L163\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nRun a pod with iSCSI volume and delete it. Yes, so simple :-(.\r\n\r\nPatch will follow shortly.\r\n\r\ncc @bswartz @redbaron @humblec \r\n/kind bug\r\n/sig storage\r\n/assign\r\n",
  "closed_at": "2018-10-03T08:16:30Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/20407524?v=4",
    "events_url": "https://api.github.com/users/k8s-ci-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-ci-robot/followers",
    "following_url": "https://api.github.com/users/k8s-ci-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-ci-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-ci-robot",
    "id": 20407524,
    "login": "k8s-ci-robot",
    "node_id": "MDQ6VXNlcjIwNDA3NTI0",
    "organizations_url": "https://api.github.com/users/k8s-ci-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-ci-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-ci-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-ci-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-ci-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-ci-robot"
  },
  "comments": 3,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/69137/comments",
  "created_at": "2018-09-27T08:02:33Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/69137/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/69137",
  "id": 364350599,
  "labels": [
    {
      "color": "e11d21",
      "default": false,
      "description": "Categorizes issue or PR as related to a bug.",
      "id": 105146071,
      "name": "kind/bug",
      "node_id": "MDU6TGFiZWwxMDUxNDYwNzE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/bug"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Storage.",
      "id": 169428334,
      "name": "sig/storage",
      "node_id": "MDU6TGFiZWwxNjk0MjgzMzQ=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/storage"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/69137/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUzNjQzNTA1OTk=",
  "number": 69137,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "iSCSI panics in UnmountDevice",
  "updated_at": "2018-10-03T08:16:30Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/69137",
  "user": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/1745006?v=4",
    "events_url": "https://api.github.com/users/jsafrane/events{/privacy}",
    "followers_url": "https://api.github.com/users/jsafrane/followers",
    "following_url": "https://api.github.com/users/jsafrane/following{/other_user}",
    "gists_url": "https://api.github.com/users/jsafrane/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/jsafrane",
    "id": 1745006,
    "login": "jsafrane",
    "node_id": "MDQ6VXNlcjE3NDUwMDY=",
    "organizations_url": "https://api.github.com/users/jsafrane/orgs",
    "received_events_url": "https://api.github.com/users/jsafrane/received_events",
    "repos_url": "https://api.github.com/users/jsafrane/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/jsafrane/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jsafrane/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/jsafrane"
  }
}