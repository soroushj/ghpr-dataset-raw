{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/14308438?v=4",
    "events_url": "https://api.github.com/users/bsalamat/events{/privacy}",
    "followers_url": "https://api.github.com/users/bsalamat/followers",
    "following_url": "https://api.github.com/users/bsalamat/following{/other_user}",
    "gists_url": "https://api.github.com/users/bsalamat/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/bsalamat",
    "id": 14308438,
    "login": "bsalamat",
    "node_id": "MDQ6VXNlcjE0MzA4NDM4",
    "organizations_url": "https://api.github.com/users/bsalamat/orgs",
    "received_events_url": "https://api.github.com/users/bsalamat/received_events",
    "repos_url": "https://api.github.com/users/bsalamat/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/bsalamat/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bsalamat/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/bsalamat"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars3.githubusercontent.com/u/14308438?v=4",
      "events_url": "https://api.github.com/users/bsalamat/events{/privacy}",
      "followers_url": "https://api.github.com/users/bsalamat/followers",
      "following_url": "https://api.github.com/users/bsalamat/following{/other_user}",
      "gists_url": "https://api.github.com/users/bsalamat/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/bsalamat",
      "id": 14308438,
      "login": "bsalamat",
      "node_id": "MDQ6VXNlcjE0MzA4NDM4",
      "organizations_url": "https://api.github.com/users/bsalamat/orgs",
      "received_events_url": "https://api.github.com/users/bsalamat/received_events",
      "repos_url": "https://api.github.com/users/bsalamat/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/bsalamat/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bsalamat/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/bsalamat"
    }
  ],
  "author_association": "MEMBER",
  "body": "**Is this a BUG REPORT or FEATURE REQUEST?**:\r\n/kind bug\r\n\r\n**What happened**:\r\nWhile I was working on #62211, I noticed a bug in affinity predicate when [it checks a pod's affinity to itself](https://github.com/kubernetes/kubernetes/blob/ee8c6d99b6064d3e490ad8607d1bfe28d86dd3d9/pkg/scheduler/algorithm/predicates/predicates.go#L1402). This check is important to ensure that the first pod of a service that has affinity to its own pods can be scheduled. Without this check, pods of such a service will never be scheduled. This piece of code checks that when there is no pod in the cluster that matches the affinity rules of the pod being scheduled and the affinity rules match the pod itself, then it does not fail the predicate. However, the implemented check has an issue. When there are multiple affinity terms, all of those terms must match a pod for the pod to be considered a matching pod. For example, consider the following affinity rule. Both <term 1> and <term 2> must match a pod for the pod to be considered matching. In the implemented version, if a pod matches any of the terms, it gives up scheduling the pod being scheduled and fails the predicate. \r\n\r\n```\r\nAffinity: &v1.Affinity{\r\n\tPodAffinity: &v1.PodAffinity{\r\n\t\tRequiredDuringSchedulingIgnoredDuringExecution: []v1.PodAffinityTerm{\r\n\t\t{\r\n\t\t\t<term 1>\r\n\t\t},\r\n\t\t{\r\n\t\t\t<term 2>\r\n\t\t},\r\n\t\t},\r\n\t},\r\n},\r\n```\r\n\r\nI have a fix, but I will until #62211 goes in. That PR has helper functions that makes fixing this issue easier.\r\n\r\n/sig scheduling\r\n/assign\r\n",
  "closed_at": "2018-04-17T09:11:37Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/13653959?v=4",
    "events_url": "https://api.github.com/users/k8s-github-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-github-robot/followers",
    "following_url": "https://api.github.com/users/k8s-github-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-github-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-github-robot",
    "id": 13653959,
    "login": "k8s-github-robot",
    "node_id": "MDQ6VXNlcjEzNjUzOTU5",
    "organizations_url": "https://api.github.com/users/k8s-github-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-github-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-github-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-github-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-github-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-github-robot"
  },
  "comments": 0,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/62232/comments",
  "created_at": "2018-04-07T01:06:00Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/62232/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/62232",
  "id": 312158078,
  "labels": [
    {
      "color": "e11d21",
      "default": false,
      "description": "Categorizes issue or PR as related to a bug.",
      "id": 105146071,
      "name": "kind/bug",
      "node_id": "MDU6TGFiZWwxMDUxNDYwNzE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/bug"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Scheduling.",
      "id": 125550211,
      "name": "sig/scheduling",
      "node_id": "MDU6TGFiZWwxMjU1NTAyMTE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/scheduling"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/62232/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUzMTIxNTgwNzg=",
  "number": 62232,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "Affinity predicate processes affinity to self incorrectly",
  "updated_at": "2018-04-17T09:11:37Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/62232",
  "user": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/14308438?v=4",
    "events_url": "https://api.github.com/users/bsalamat/events{/privacy}",
    "followers_url": "https://api.github.com/users/bsalamat/followers",
    "following_url": "https://api.github.com/users/bsalamat/following{/other_user}",
    "gists_url": "https://api.github.com/users/bsalamat/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/bsalamat",
    "id": 14308438,
    "login": "bsalamat",
    "node_id": "MDQ6VXNlcjE0MzA4NDM4",
    "organizations_url": "https://api.github.com/users/bsalamat/orgs",
    "received_events_url": "https://api.github.com/users/bsalamat/received_events",
    "repos_url": "https://api.github.com/users/bsalamat/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/bsalamat/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bsalamat/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/bsalamat"
  }
}