{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "NONE",
  "body": "<!-- Please use this template while reporting a bug and provide as much info as possible. Not doing so may result in your bug not being addressed in a timely manner. Thanks!\r\n\r\nIf the matter is security related, please disclose it privately via https://kubernetes.io/security/\r\n-->\r\n\r\n\r\n**What happened**:\r\nWe using go-code kubectl cli package. We are a long running app serving to many different Kubernetes clusters. Each cluster has a different user credentials and bearer token to access it. But they all use the same issuer and clientid. The oidc cache is keyed off of these two only. \r\n\r\nSo what happens is when we switch to another configuration it pulls in the oidc provider for the other cluster and that bearer token does not have authority to this other cluster. The cluster config has the correct info in it but the oidc provider ignores that and used the stale data.\r\n\r\n**What you expected to happen**:\r\noidc provider would always use the appropriate current config context to access the cluster\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nIn same app instance create two cluster configs to two different clusters with same oidc issuer and clientid by DIFFERENT credentials. Where the credentials on one are not authorized for the other cluster.\r\n\r\nTry to get namespaces on each, one will work and the other won't.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Kubernetes version (use `kubectl version`): latest go-code from k8s.io/client-go as a package called from go application.\r\n\r\n- Cloud provider or hardware configuration:  IBM Kubernetes\r\n- OS (e.g: `cat /etc/os-release`): \r\n- Kernel (e.g. `uname -a`):\r\n- Install tools:\r\n- Network plugin and version (if this is a network-related bug):\r\n- Others:\r\n\r\n@kubernetes/sig-auth",
  "closed_at": "2019-12-12T05:00:33Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/20407524?v=4",
    "events_url": "https://api.github.com/users/k8s-ci-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-ci-robot/followers",
    "following_url": "https://api.github.com/users/k8s-ci-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-ci-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-ci-robot",
    "id": 20407524,
    "login": "k8s-ci-robot",
    "node_id": "MDQ6VXNlcjIwNDA3NTI0",
    "organizations_url": "https://api.github.com/users/k8s-ci-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-ci-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-ci-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-ci-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-ci-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-ci-robot"
  },
  "comments": 6,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/79546/comments",
  "created_at": "2019-06-28T22:47:21Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/79546/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/79546",
  "id": 462231642,
  "labels": [
    {
      "color": "e11d21",
      "default": false,
      "description": "Categorizes issue or PR as related to a bug.",
      "id": 105146071,
      "name": "kind/bug",
      "node_id": "MDU6TGFiZWwxMDUxNDYwNzE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/bug"
    },
    {
      "color": "eb6420",
      "default": false,
      "description": "Must be staffed and worked on either currently, or very soon, ideally in time for the next release.",
      "id": 114528223,
      "name": "priority/important-soon",
      "node_id": "MDU6TGFiZWwxMTQ1MjgyMjM=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/priority/important-soon"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Auth.",
      "id": 357119284,
      "name": "sig/auth",
      "node_id": "MDU6TGFiZWwzNTcxMTkyODQ=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/auth"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/79546/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU0NjIyMzE2NDI=",
  "number": 79546,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "oidc cache does not work when muliple users and configs for same oidc provider",
  "updated_at": "2019-12-12T05:00:33Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/79546",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/5233332?v=4",
    "events_url": "https://api.github.com/users/rlk833/events{/privacy}",
    "followers_url": "https://api.github.com/users/rlk833/followers",
    "following_url": "https://api.github.com/users/rlk833/following{/other_user}",
    "gists_url": "https://api.github.com/users/rlk833/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/rlk833",
    "id": 5233332,
    "login": "rlk833",
    "node_id": "MDQ6VXNlcjUyMzMzMzI=",
    "organizations_url": "https://api.github.com/users/rlk833/orgs",
    "received_events_url": "https://api.github.com/users/rlk833/received_events",
    "repos_url": "https://api.github.com/users/rlk833/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/rlk833/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rlk833/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/rlk833"
  }
}