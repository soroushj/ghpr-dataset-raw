{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/2823529?v=4",
    "events_url": "https://api.github.com/users/caesarxuchao/events{/privacy}",
    "followers_url": "https://api.github.com/users/caesarxuchao/followers",
    "following_url": "https://api.github.com/users/caesarxuchao/following{/other_user}",
    "gists_url": "https://api.github.com/users/caesarxuchao/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/caesarxuchao",
    "id": 2823529,
    "login": "caesarxuchao",
    "node_id": "MDQ6VXNlcjI4MjM1Mjk=",
    "organizations_url": "https://api.github.com/users/caesarxuchao/orgs",
    "received_events_url": "https://api.github.com/users/caesarxuchao/received_events",
    "repos_url": "https://api.github.com/users/caesarxuchao/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/caesarxuchao/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/caesarxuchao/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/caesarxuchao"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars2.githubusercontent.com/u/2823529?v=4",
      "events_url": "https://api.github.com/users/caesarxuchao/events{/privacy}",
      "followers_url": "https://api.github.com/users/caesarxuchao/followers",
      "following_url": "https://api.github.com/users/caesarxuchao/following{/other_user}",
      "gists_url": "https://api.github.com/users/caesarxuchao/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/caesarxuchao",
      "id": 2823529,
      "login": "caesarxuchao",
      "node_id": "MDQ6VXNlcjI4MjM1Mjk=",
      "organizations_url": "https://api.github.com/users/caesarxuchao/orgs",
      "received_events_url": "https://api.github.com/users/caesarxuchao/received_events",
      "repos_url": "https://api.github.com/users/caesarxuchao/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/caesarxuchao/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/caesarxuchao/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/caesarxuchao"
    }
  ],
  "author_association": "MEMBER",
  "body": "# Background\r\n\r\nWe are migrating components other than kube-apiserver in the main repository to use [client-go](https://github.com/kubernetes/client-go). The end goal is removing most parts of the `pkg/client` out of the main repository, and developing clients in `client-go`. We believe it will increase the development velocity in the long run.\r\n\r\nAs the first step, we will migrate components to use the `client-go` located in the [staging area](https://github.com/kubernetes/kubernetes/tree/master/staging/src/k8s.io/client-go) of main repository.\r\n# Goal\r\n\r\nThe migration involves huge changes. We want to find a manageable way.\r\n- We want to break the migration into multiple PRs of sizes reasonable for review.\r\n- We want to reduce the operational cost the k8s community needs to bear with during the migration.\r\n# [Abandoned] Approach 1: migrating one component at a time\r\n\r\nFor example, first convert `kube-controller-manager` (https://github.com/kubernetes/kubernetes/issues/29934) to use client-go, then converting `kubelet`, etc.\r\n\r\nThe **problem** is: Components migrated to client-go will use versioned types defined in client-go, e.g., `client-go#v1.Pod` (client-go is the repo name, v1 is the package name), while the remaining components keep using unversioned types defined in the main repository, e.g., `kubernetes#api.Pod`. The difference in the types causes a dilemma for the packages shared by both groups of components, e.g., `pkg/volume`. We\u2019ve considered two workarounds:\r\n## [Abandoned] Approach 1.1:  Make two copies of the shared dependencies\r\n\r\n**We are going to take this approach if the community can bear with the disadvantages.**\r\n\r\nWe make two copies of the shared dependencies, one keeps using `kubernetes#api.Pod`, the other one uses `client-go#v1.Pod`. We will provide a script to do the copy. I had experimented to migrate only `kube-controller-manager`, it turned out we at least need to maintain copies of these package:\r\n- pkg/util/node (1 file)\r\n- pkg/util/system (one liner)\r\n- pkg/volume (147 files) @saad-ali \r\n- pkg/serviceaccount (5 files)\r\n- pkg/fieldpath (3 files)\r\n- pkg/controller/deployment/util (2 files) @janetkuo \r\n\r\n**Disadvantages:** \r\n- We need to add a verify script to force developers who make changes to the original package to run the update script to keep the copy in sync.\r\n## [Abandoned] Approach 1.2: Converting before calling shared packages\r\n\r\nWe convert `client-go#v1.Pod` to `kubernetes#api.Pod` before passing the object to shared packages. The conversion requires two steps: i). using the unsafe package to forcefully convert `client-go#v1.Pod` to `kubernetes#v1.Pod`, ii). Use `api.Scheme` to convert to `kubernetes#api.Pod`.\r\n\r\n  **Disadvantages:**\r\n- Converting to api.Pod will apply the defaults. _Perhaps_ this will cause problem if a controller is creating API objects.\r\n- Conversion is inefficient.\r\n\r\n# [Abandoned] Approach 2: migrating in a developing branch\r\n\r\nWe\u2019ll take this approach if the community finds the operational cost of the first approach is too high. We will make a developing branch, accumulating PRs and getting reviews, and finally merge with the master branch the migration is done for all binaries.\r\n\r\n**Disadvantages:**\r\n- The developing branch is in an uncompilable state until the most components are migrated.\r\n- _Perhaps_ the final merge will be challenging. I will try to reduce the workload by \r\n  - capture most rewrites in a script\r\n  - finish the migration during the 1.5 code freeze\r\n\r\n# [Picked] Approach 3: migrating to the versioned clients during the code freeze\r\n\r\nDetails are in this [comment](https://github.com/kubernetes/kubernetes/issues/35159#issue-184077641)\r\n\r\nPlease let us know if you can bear with the cost of approach 1.1.\r\n\r\n@kubernetes/sig-api-machinery @smarterclayton @deads2k @liggitt\r\n",
  "closed_at": "2016-11-24T01:31:40Z",
  "closed_by": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/10052848?v=4",
    "events_url": "https://api.github.com/users/saad-ali/events{/privacy}",
    "followers_url": "https://api.github.com/users/saad-ali/followers",
    "following_url": "https://api.github.com/users/saad-ali/following{/other_user}",
    "gists_url": "https://api.github.com/users/saad-ali/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/saad-ali",
    "id": 10052848,
    "login": "saad-ali",
    "node_id": "MDQ6VXNlcjEwMDUyODQ4",
    "organizations_url": "https://api.github.com/users/saad-ali/orgs",
    "received_events_url": "https://api.github.com/users/saad-ali/received_events",
    "repos_url": "https://api.github.com/users/saad-ali/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/saad-ali/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/saad-ali/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/saad-ali"
  },
  "comments": 16,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/35159/comments",
  "created_at": "2016-10-19T21:22:36Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/35159/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/35159",
  "id": 184077641,
  "labels": [
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG API Machinery.",
      "id": 173493835,
      "name": "sig/api-machinery",
      "node_id": "MDU6TGFiZWwxNzM0OTM4MzU=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/api-machinery"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/35159/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUxODQwNzc2NDE=",
  "number": 35159,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "[RFC] Migrating kubernetes components to use client-go",
  "updated_at": "2017-03-02T18:59:23Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/35159",
  "user": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/2823529?v=4",
    "events_url": "https://api.github.com/users/caesarxuchao/events{/privacy}",
    "followers_url": "https://api.github.com/users/caesarxuchao/followers",
    "following_url": "https://api.github.com/users/caesarxuchao/following{/other_user}",
    "gists_url": "https://api.github.com/users/caesarxuchao/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/caesarxuchao",
    "id": 2823529,
    "login": "caesarxuchao",
    "node_id": "MDQ6VXNlcjI4MjM1Mjk=",
    "organizations_url": "https://api.github.com/users/caesarxuchao/orgs",
    "received_events_url": "https://api.github.com/users/caesarxuchao/received_events",
    "repos_url": "https://api.github.com/users/caesarxuchao/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/caesarxuchao/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/caesarxuchao/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/caesarxuchao"
  }
}