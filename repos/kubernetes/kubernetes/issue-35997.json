{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "CONTRIBUTOR",
  "body": "**Is this a BUG REPORT or FEATURE REQUEST?** (choose one): Bug Report\r\n**Kubernetes version** (use `kubectl version`): \r\nClient Version: version.Info{Major:\"1\", Minor:\"4\", GitVersion:\"v1.4.1\", GitCommit:\"33cf7b9acbb2cb7c9c72a10d6636321fb180b159\", GitTreeState:\"clean\", BuildDate:\"2016-10-10T18:19:49Z\", GoVersion:\"go1.7.1\", Compiler:\"gc\", Platform:\"darwin/amd64\"}\r\nServer Version: version.Info{Major:\"1\", Minor:\"3\", GitVersion:\"v1.3.9\", GitCommit:\"ee10669e21109f86c21e8f7ceb1187d7910fe120\", GitTreeState:\"clean\", BuildDate:\"2016-10-20T20:37:18Z\", GoVersion:\"go1.6.2\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\n\r\n**Environment**:\r\n- **Cloud provider or hardware configuration**: GKE\r\n- **OS** (e.g. from /etc/os-release): Local: El Capitan, Remote: GCI\r\n- **Kernel** (e.g. `uname -a`): Local: Darwin ... 15.6.0 Darwin Kernel Version 15.6.0: Thu Sep  1 15:01:16 PDT 2016; root:xnu-3248.60.11~2/RELEASE_X86_64 x86_64\r\n- **Install tools**: gcloud\r\n- **Others**: n/a\r\n\r\n**What happened**:\r\nProvisioned 3 clusters each in different regions (us-central1, asia-east1, europe-west1). Each cluster is in 2 zones (w/ gcloud --zone... --additional-zones...) \r\n\r\nProvisioned Federation API Server and Controller (1.4.4) based on https://github.com/kelseyhightower/kubernetes-cluster-federation\r\n\r\nVerified clusters were ready.\r\n\r\nProvisioned federated service & deployed backends into each of the cluster. Verified the federated services were created, and all of the regional LB were created, and verified all the LB IPs were working w/ direct requests.\r\n\r\nDNS provider updated DNS w/ most of the service/zone CNAME records. But A records did not complete.\r\n\r\nFurther investigation for the log points to multiple entries in rrdata w/ the same IP due to the multi-zone deployment:\r\n\r\nI1029 19:24:24.506359       1 dns.go:240] Have recordset <(clouddns) \"buttonmasher-frontend.default.hybrid-cloud-rocks.svc.us-central1-b.us-central1.hybrid-cloud-rocks.com.\" type=CNAME rrdatas=[\"buttonmasher-frontend.default.hybrid-cloud-rocks.svc.us-central1.hybrid-cloud-rocks.com.\"] ttl=180>. Need recordset <(clouddns) \"buttonmasher-frontend.default.hybrid-cloud-rocks.svc.us-central1-b.us-central1.hybrid-cloud-rocks.com.\" type=A rrdatas=[\"130.211.203.196\" \"130.211.203.196\"] ttl=180>\r\nI1029 19:24:24.506520       1 dns.go:248] Existing recordset <(clouddns) \"buttonmasher-frontend.default.hybrid-cloud-rocks.svc.us-central1-b.us-central1.hybrid-cloud-rocks.com.\" type=CNAME rrdatas=[\"buttonmasher-frontend.default.hybrid-cloud-rocks.svc.us-central1.hybrid-cloud-rocks.com.\"] ttl=180> is not equivalent to needed recordset <(clouddns) \"buttonmasher-frontend.default.hybrid-cloud-rocks.svc.us-central1-b.us-central1.hybrid-cloud-rocks.com.\" type=A rrdatas=[\"130.211.203.196\" \"130.211.203.196\"] ttl=180>, removing existing and adding needed.\r\n\r\nAfter creating the clusters w/ only one zone, the DNS provider worked properly.\r\n\r\n**What you expected to happen**:\r\nCloud DNS Provider should update the DNS record properly w/ multi-zone clusters.\r\n\r\n**How to reproduce it** (as minimally and precisely as possible):\r\n1. Provision 3 x multi-zone clusters\r\n2. Provision Federation API Server and Controller\r\n3. Add clusters in to federation\r\n4. Deploy federated service and backends\r\n\r\n**Anything else do we need to know**:\r\nUsing GKE and Cloud DNS\r\n",
  "closed_at": "2017-05-26T04:13:22Z",
  "closed_by": null,
  "comments": 6,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/35997/comments",
  "created_at": "2016-11-01T20:03:58Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/35997/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/35997",
  "id": 186632258,
  "labels": [
    {
      "color": "e11d21",
      "default": false,
      "description": "Categorizes issue or PR as related to a bug.",
      "id": 105146071,
      "name": "kind/bug",
      "node_id": "MDU6TGFiZWwxMDUxNDYwNzE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/bug"
    },
    {
      "color": "fbca04",
      "default": false,
      "description": "Higher priority than priority/awaiting-more-evidence.",
      "id": 114528273,
      "name": "priority/backlog",
      "node_id": "MDU6TGFiZWwxMTQ1MjgyNzM=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/priority/backlog"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/35997/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUxODY2MzIyNTg=",
  "number": 35997,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "Federation Cloud DNS Provider fails to update DNS when running multizone clusters",
  "updated_at": "2019-04-22T15:10:34Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/35997",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/1998883?v=4",
    "events_url": "https://api.github.com/users/saturnism/events{/privacy}",
    "followers_url": "https://api.github.com/users/saturnism/followers",
    "following_url": "https://api.github.com/users/saturnism/following{/other_user}",
    "gists_url": "https://api.github.com/users/saturnism/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/saturnism",
    "id": 1998883,
    "login": "saturnism",
    "node_id": "MDQ6VXNlcjE5OTg4ODM=",
    "organizations_url": "https://api.github.com/users/saturnism/orgs",
    "received_events_url": "https://api.github.com/users/saturnism/received_events",
    "repos_url": "https://api.github.com/users/saturnism/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/saturnism/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/saturnism/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/saturnism"
  }
}