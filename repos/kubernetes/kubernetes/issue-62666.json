{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "MEMBER",
  "body": "**Is this a BUG REPORT or FEATURE REQUEST?**:\r\n/kind bug\r\n\r\n**What happened**: Pod stuck in terminating state.\r\n\r\n**What you expected to happen**: Pod successfully cleaned up.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n1. Set up a LimitRange. (Say \"limits:\r\n    - defaultRequest:\r\n        cpu: 100m\r\n      type: Container\")\r\n2. Install a mutating webhook on pod which creates an additional container on the pod (Eg. https://istio.io/docs/setup/kubernetes/sidecar-injection.html#automatic-sidecar-injection) without the limit range.\r\n3. Create a Pod with foreground deletion finalizer.\r\n4. Notice that you have a Pod with 2 containers. The 1 you created which now has a limit and the istio container which does not.\r\n5. Try to delete the Pod.\r\n6. The garbage collector tries to update the pod to remove the finalizer, however this triggers the limit range admission control to add the limit to the istio container. This then causes the API server to get the error \"invalid: spec: Forbidden: pod updates may not change fields other than `spec.containers[*].image`, `spec.initContainers[*].image`, `spec.activeDeadlineSeconds` or `spec.tolerations`\"\r\n7. Notice the pod is now stuck in terminating.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Kubernetes version (use `kubectl version`): 1.9.6\r\n\r\n/sig api-machinery\r\n",
  "closed_at": "2018-10-02T19:13:35Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/20407524?v=4",
    "events_url": "https://api.github.com/users/k8s-ci-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-ci-robot/followers",
    "following_url": "https://api.github.com/users/k8s-ci-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-ci-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-ci-robot",
    "id": 20407524,
    "login": "k8s-ci-robot",
    "node_id": "MDQ6VXNlcjIwNDA3NTI0",
    "organizations_url": "https://api.github.com/users/k8s-ci-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-ci-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-ci-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-ci-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-ci-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-ci-robot"
  },
  "comments": 2,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/62666/comments",
  "created_at": "2018-04-16T20:06:14Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/62666/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/62666",
  "id": 314798540,
  "labels": [
    {
      "color": "e11d21",
      "default": false,
      "description": "Categorizes issue or PR as related to a bug.",
      "id": 105146071,
      "name": "kind/bug",
      "node_id": "MDU6TGFiZWwxMDUxNDYwNzE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/bug"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG API Machinery.",
      "id": 173493835,
      "name": "sig/api-machinery",
      "node_id": "MDU6TGFiZWwxNzM0OTM4MzU=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/api-machinery"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/62666/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUzMTQ3OTg1NDA=",
  "number": 62666,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "Bad interaction between finalizer, limit range and mutating web-hook prevents pod termination",
  "updated_at": "2018-10-02T19:13:35Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/62666",
  "user": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/947971?v=4",
    "events_url": "https://api.github.com/users/cheftako/events{/privacy}",
    "followers_url": "https://api.github.com/users/cheftako/followers",
    "following_url": "https://api.github.com/users/cheftako/following{/other_user}",
    "gists_url": "https://api.github.com/users/cheftako/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/cheftako",
    "id": 947971,
    "login": "cheftako",
    "node_id": "MDQ6VXNlcjk0Nzk3MQ==",
    "organizations_url": "https://api.github.com/users/cheftako/orgs",
    "received_events_url": "https://api.github.com/users/cheftako/received_events",
    "repos_url": "https://api.github.com/users/cheftako/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/cheftako/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cheftako/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/cheftako"
  }
}