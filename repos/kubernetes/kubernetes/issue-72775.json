{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "NONE",
  "body": "<!-- Please use this template while reporting a bug and provide as much info as possible. Not doing so may result in your bug not being addressed in a timely manner. Thanks!-->\r\n\r\n\r\n**What happened**:\r\nI have deployment with following upgrade strategy\r\n\r\n>     strategy:\r\n>       rollingUpdate:\r\n>         maxSurge: 1\r\n>         maxUnavailable: 0\r\n>       type: RollingUpdate\r\n> \r\n\r\nand hpa:\r\n\r\n>  spec:\r\n>     maxReplicas: 3\r\n>     minReplicas: 1\r\n>     scaleTargetRef:\r\n>       apiVersion: extensions/v1beta1\r\n>       kind: Deployment\r\n>       name: xxxx\r\n>     targetCPUUtilizationPercentage: 80\r\n\r\nWhen sending patch command to update container image, (current replicas is 1),  following happended\r\n1. new pod created and getting ready\r\n2. after the new pod ready, the old pod is terminating.\r\n3. hpa make a judgement call to set desired replica to 2\r\n4. after a while, hpa readjust to desired replica back to 1\r\n\r\n**What you expected to happen**:\r\n1. new pod created and getting ready\r\n2. after the new pod ready, the old pod is terminating.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n1. create a deployment with replica set to 1, maxSurge 1, maxUnavailable: 0\r\n2. create a hpa targeting the deployment with replica 1 from 3, 80% cpu target\r\n3. change container image via kubectl edit or other approach\r\n4. keep checking pod count changes\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Kubernetes version (use `kubectl version`):\r\n- Cloud provider or hardware configuration:\r\n- OS (e.g. from /etc/os-release):\r\n- Kernel (e.g. `uname -a`):\r\n- Install tools:\r\n- Others:\r\n",
  "closed_at": "2019-07-02T16:31:10Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/20407524?v=4",
    "events_url": "https://api.github.com/users/k8s-ci-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-ci-robot/followers",
    "following_url": "https://api.github.com/users/k8s-ci-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-ci-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-ci-robot",
    "id": 20407524,
    "login": "k8s-ci-robot",
    "node_id": "MDQ6VXNlcjIwNDA3NTI0",
    "organizations_url": "https://api.github.com/users/k8s-ci-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-ci-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-ci-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-ci-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-ci-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-ci-robot"
  },
  "comments": 45,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/72775/comments",
  "created_at": "2019-01-10T10:24:42Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/72775/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/72775",
  "id": 397763327,
  "labels": [
    {
      "color": "e11d21",
      "default": false,
      "description": "Categorizes issue or PR as related to a bug.",
      "id": 105146071,
      "name": "kind/bug",
      "node_id": "MDU6TGFiZWwxMDUxNDYwNzE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/bug"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Autoscaling.",
      "id": 238245616,
      "name": "sig/autoscaling",
      "node_id": "MDU6TGFiZWwyMzgyNDU2MTY=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/autoscaling"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/72775/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUzOTc3NjMzMjc=",
  "number": 72775,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "pod hpa would create extra pods during deployment rolling update when there is no load at all during the rolling upgrade",
  "updated_at": "2020-05-15T15:04:44Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/72775",
  "user": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/6317291?v=4",
    "events_url": "https://api.github.com/users/zq-david-wang/events{/privacy}",
    "followers_url": "https://api.github.com/users/zq-david-wang/followers",
    "following_url": "https://api.github.com/users/zq-david-wang/following{/other_user}",
    "gists_url": "https://api.github.com/users/zq-david-wang/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/zq-david-wang",
    "id": 6317291,
    "login": "zq-david-wang",
    "node_id": "MDQ6VXNlcjYzMTcyOTE=",
    "organizations_url": "https://api.github.com/users/zq-david-wang/orgs",
    "received_events_url": "https://api.github.com/users/zq-david-wang/received_events",
    "repos_url": "https://api.github.com/users/zq-david-wang/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/zq-david-wang/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/zq-david-wang/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/zq-david-wang"
  }
}