{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "NONE",
  "body": "**Kubernetes version** (use `kubectl version`):\r\n\r\nClient Version: version.Info{Major:\"1\", Minor:\"7+\", GitVersion:\"v1.7.0-beta.1\", GitCommit:\"dfaba882698e26a47fb769be45fe5c048a9fe4ad\", GitTreeState:\"not a git tree\", BuildDate:\"2017-06-08T13:08:32Z\", GoVersion:\"go1.8.3\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\nServer Version: version.Info{Major:\"1\", Minor:\"6\", GitVersion:\"v1.6.3\", GitCommit:\"0480917b552be33e2dba47386e51decb1a211df6\", GitTreeState:\"clean\", BuildDate:\"2017-05-10T15:38:08Z\", GoVersion:\"go1.7.5\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\n\r\n\r\n**Environment**:\r\n- **Cloud provider or hardware configuration**: Bare-Metal, HP SE316M, 2x X5675, 144GB, iSCSI/RDMA/iSer\r\n- **OS**: CentOS 7\r\n- **Kernel**: Linux at-host-18 4.9.31 #1 SMP Wed Jun 7 22:40:40 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\r\n- **Install tools**: \r\n- **Others**:\r\n\r\n\r\n**What happened**:\r\nI want to mount a iSCSI volume via iSER (RDMA over Infiniband) in this case the iSCSI iface is \"iser\" and not tcp, therefore the glob path for device mount is selected (iscsi_util.go:215), which then is passed to the fsck and mount commands without globbing the path (e.g. calling filepath.Glob)\r\n\r\nTherefore the iSCSI volume is not mounted and the pod cannot be started.\r\n\r\n**Logs**:\r\n```\r\nJun  9 16:59:35 at-host-18 kernel: sd 5:0:0:0: alua: supports implicit and explicit TPGS\r\nJun  9 16:59:35 at-host-18 kernel: sd 5:0:0:0: alua: device naa.600140581cc879dd8a646fb9d818e1cf port group 0 rel port 1\r\nJun  9 16:59:35 at-host-18 kernel: sd 5:0:0:0: alua: port group 00 state A non-preferred supports TOlUSNA\r\nJun  9 16:59:35 at-host-18 kernel: sd 5:0:0:0: alua: supports implicit and explicit TPGS\r\nJun  9 16:59:35 at-host-18 kernel: sd 5:0:0:0: alua: device naa.600140581cc879dd8a646fb9d818e1cf port group 0 rel port 1\r\nJun  9 16:59:35 at-host-18 kernel: sd 5:0:0:0: alua: port group 00 state A non-preferred supports TOlUSNA\r\nJun  9 16:59:35 at-host-18 kubelet: I0609 16:59:35.354226   18204 mount_linux.go:347] `fsck` error fsck from util-linux 2.23.2\r\nJun  9 16:59:35 at-host-18 kubelet: fsck.ext2: No such file or directory while trying to open /dev/disk/by-path/pci-*-ip-10.0.13.3:3260-iscsi-iqn.2017-01.at.cf-it.at-storage-01-lun-0\r\nJun  9 16:59:35 at-host-18 kubelet: Possibly non-existent device?\r\nJun  9 16:59:35 at-host-18 kubelet: E0609 16:59:35.358239   18204 mount_linux.go:122] Mount failed: exit status 32\r\nJun  9 16:59:35 at-host-18 kubelet: Mounting command: mount\r\nJun  9 16:59:35 at-host-18 kubelet: Mounting arguments: /dev/disk/by-path/pci-*-ip-10.0.13.3:3260-iscsi-iqn.2017-01.at.cf-it.at-storage-01-lun-0 /var/lib/kubelet/plugins/kubernetes.io/iscsi/iface-iser/10.0.13.3:3260-iqn.2017-01.at.cf-it.at-storage-01-lun-0 ext4 [defaults]\r\nJun  9 16:59:35 at-host-18 kubelet: Output: mount: special device /dev/disk/by-path/pci-*-ip-10.0.13.3:3260-iscsi-iqn.2017-01.at.cf-it.at-storage-01-lun-0 does not exist\r\nJun  9 16:59:35 at-host-18 kubelet: E0609 16:59:35.362929   18204 mount_linux.go:406] Could not determine if disk \"/dev/disk/by-path/pci-*-ip-10.0.13.3:3260-iscsi-iqn.2017-01.at.cf-it.at-storage-01-lun-0\" is formatted (exit status 1)\r\nJun  9 16:59:35 at-host-18 kubelet: E0609 16:59:35.362987   18204 iscsi_util.go:301] iscsi: failed to mount iscsi volume /dev/disk/by-path/pci-*-ip-10.0.13.3:3260-iscsi-iqn.2017-01.at.cf-it.at-storage-01-lun-0 [ext4] to /var/lib/kubelet/plugins/kubernetes.io/iscsi/iface-iser/10.0.13.3:3260-iqn.2017-01.at.cf-it.at-storage-01-lun-0, error exit status 1\r\nJun  9 16:59:35 at-host-18 kubelet: E0609 16:59:35.363008   18204 disk_manager.go:51] failed to attach disk\r\nJun  9 16:59:35 at-host-18 kubelet: E0609 16:59:35.363022   18204 iscsi.go:247] iscsi: failed to setup\r\n```\r\n\r\n**What you expected to happen**:\r\nTo successfully mount the volume.\r\n\r\n**How to reproduce it** (as minimally and precisely as possible):\r\nSetup an iSCSI via RDMA (iSER) environment without multipath and try to mount a volume for a pod.\r\n\r\n**Anything else we need to know**:\r\nI believe it's just needed to add the globbing at line 259 like so:\r\n\r\ndevicePaths = append(devicePaths, filepath.Glob(devicePath))\r\n\r\n\r\nAs I'm not a go programmer and have no experience with it, probably somebody could create a commit which I would gladly test!\r\n\r\n\r\n",
  "closed_at": "2017-06-12T01:49:21Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/13653959?v=4",
    "events_url": "https://api.github.com/users/k8s-github-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-github-robot/followers",
    "following_url": "https://api.github.com/users/k8s-github-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-github-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-github-robot",
    "id": 13653959,
    "login": "k8s-github-robot",
    "node_id": "MDQ6VXNlcjEzNjUzOTU5",
    "organizations_url": "https://api.github.com/users/k8s-github-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-github-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-github-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-github-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-github-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-github-robot"
  },
  "comments": 10,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/47253/comments",
  "created_at": "2017-06-09T17:05:30Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/47253/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/47253",
  "id": 234886685,
  "labels": [
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Storage.",
      "id": 169428334,
      "name": "sig/storage",
      "node_id": "MDU6TGFiZWwxNjk0MjgzMzQ=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/storage"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/47253/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUyMzQ4ODY2ODU=",
  "number": 47253,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "iSCSI iSER mounting does use glob path for mount utilities",
  "updated_at": "2017-06-12T01:49:21Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/47253",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/554474?v=4",
    "events_url": "https://api.github.com/users/Thoro/events{/privacy}",
    "followers_url": "https://api.github.com/users/Thoro/followers",
    "following_url": "https://api.github.com/users/Thoro/following{/other_user}",
    "gists_url": "https://api.github.com/users/Thoro/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/Thoro",
    "id": 554474,
    "login": "Thoro",
    "node_id": "MDQ6VXNlcjU1NDQ3NA==",
    "organizations_url": "https://api.github.com/users/Thoro/orgs",
    "received_events_url": "https://api.github.com/users/Thoro/received_events",
    "repos_url": "https://api.github.com/users/Thoro/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/Thoro/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Thoro/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/Thoro"
  }
}