{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "NONE",
  "body": "\r\n**What would you like to be added**:\r\nI created a CSR with URL-type SANs ( spiffee ), approved it - the generated cert includes the other SANs, but not the URL one.\r\n\r\nThe bug seems to be in cloudfare.cfssl.ParseCertificateRequest - the template doesn't copy from the CSR.\r\n\r\n\r\n**Why is this needed**:\r\nIt would allow using the K8S CA to generate Istio or other Spiffee certificates, without having to run a separate CA.\r\n\r\nNote that as a workaround I tried to create a CSR for an intermediary - but K8S generated a \r\ncert that doesn't have 'Root=true'. This might be by design - would be good to document what parts of the CSR  are supported, and maybe would be good to allow intermediaries to be signed.\r\nI haven't figured why this is happening.\r\n\r\nIncluding the used CSR and result:\r\n```\r\n-----BEGIN CERTIFICATE REQUEST-----\r\nMIIC9zCCAd8CAQAwLDEqMCgGA1UEAxMhaW50ZXJtZWRpYXJ5LWNhMi5pc3Rpby1z\r\neXN0ZW0uc3ZjMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA2hArVPoz\r\nQcgORqEXb/tqDhwuDzCDC0U1WNXh3A46c9Sf3o2V6QPEgahxz3/jqyHweBnT9KpC\r\nvSNEltJTPKJEzSfck5BVevtt2TifrKN+zFT98fQZh/OT1jjxoTJtcckunoRFxrb7\r\nRgOAf570SdQMila5Px1TcJK78AQ83+QxuUNOWpsnmlDWglRWrvy83yPlimsZc2mN\r\nel+Vavy5MjuXdvFo+3mD+pxEK94J737mYaxJ5lw3E/+/TZRp2vnAO6uLRti6NXMb\r\neewy5fl4gHruRaOuedGyI1bQP8hdZ3xwKhjT5PzjOqdRwoU8uFK1IUr/EwayR4Lw\r\nBIXWDRqCLYVUcwIDAQABoIGFMIGCBgkqhkiG9w0BCQ4xdTBzMF0GA1UdEQRWMFSC\r\nEGludGVybWVkaWFyeS1jYTKCHWludGVybWVkaWFyeS1jYTIuaXN0aW8tc3lzdGVt\r\ngiFpbnRlcm1lZGlhcnktY2EyLmlzdGlvLXN5c3RlbS5zdmMwEgYDVR0TAQH/BAgw\r\nBgEB/wIBADANBgkqhkiG9w0BAQsFAAOCAQEAo1bdu9/thKgFgdsbgM6dRdIBzXZa\r\niitted0Fp/s/Jx7jr9Ijemd3sEu/TLpKwOhxoVnlIHoRxtZCuKIEoqqwFWMilPn7\r\n738NcKdN4RIrez43DQfNwXeuxTpQLmCOc64yGXSVLSYfHDlzm0bGgzV60syAl9zA\r\n09enhqJwtZYzGk/Luz3QK0jzv73Q/5oESukiEQjG1+WD/VqU+24LAPlYLbi+q1lc\r\nATWwR3HtkIMgaKbpS4us+4b+lw50zGEcz+KVnP6G0PdB0M3pSyZJX6kiZxpeHdDC\r\n4+BBUdWrYWV8yxU+2dkaQZNRIL4L2tEmXFg5hsS+fcXnBHPQiBgFjeXXMA==\r\n-----END CERTIFICATE REQUEST-----\r\nopenssl req -in csr.pem -noout -text \r\n... \r\nX509v3 Basic Constraints: critical\r\n                CA:TRUE, pathlen:0\r\n\r\nGenerated:\r\n-----BEGIN CERTIFICATE-----\r\nMIIDVTCCAj2gAwIBAgIRAIYi2vf/UfvnpOuSjc66aeMwDQYJKoZIhvcNAQELBQAw\r\nLzEtMCsGA1UEAxMkZTI1YTcwZmQtZjQyYy00YjFjLWI4MTEtNDlmMzU0NGJjNDI5\r\nMB4XDTE5MDcxMTAwMjYwN1oXDTI0MDcwOTAwMjYwN1owLDEqMCgGA1UEAxMhaW50\r\nZXJtZWRpYXJ5LWNhMi5pc3Rpby1zeXN0ZW0uc3ZjMIIBIjANBgkqhkiG9w0BAQEF\r\nAAOCAQ8AMIIBCgKCAQEA/QaF/Kj6zeJ4qAri9t2mm7dloQMU6XJ39/tzX0cOVI9W\r\ncWS2AzIoTAyTQr7eYsjSUOe9P7pACPOYsXKY8SiLLx8iduiQd4l++0913AgtsGEJ\r\nVjjzDKcO2jZGqNniE1jXFQ0Kc4bGR1xi3HuHy/8P4GQSowo4A9Tn3kcgPynowfnt\r\n/iiLFtDuYXL8eLR2GpMkxbsDQ+Q4unfziCOMumTJUC44N0P76cU5eL7oFENxOfmr\r\nxumOBDGDkhuHmfu38opMDF2UYYP+88B0sg/GeCGFjqNTGvUIk9BmCMNtr2QHm/6V\r\ntSWp88suB5oqksVc7f1rUoqSxF4x1tqOHspE5dTiUwIDAQABo28wbTAMBgNVHRMB\r\nAf8EAjAAMF0GA1UdEQRWMFSCEGludGVybWVkaWFyeS1jYTKCHWludGVybWVkaWFy\r\neS1jYTIuaXN0aW8tc3lzdGVtgiFpbnRlcm1lZGlhcnktY2EyLmlzdGlvLXN5c3Rl\r\nbS5zdmMwDQYJKoZIhvcNAQELBQADggEBAJS0ARAS7RJBsnFMQ7GSxU850bq+JyX6\r\n1lGeRlFqlhlVBTuXk1CYSh409Xxkab5DrPIIliydwdAEzpld+CxS03tFC+8qFrPv\r\n1PvjYtsYcyQ1IoHfbXRwbVOrVWY6cnTSLLwrv1kjBG7wVTMLhJTLfJdMV1Qqu5nt\r\n84/5m2XTILsyVfg6ew5usp2hUuuPT5WoZ2U1JOD3aBZcK1ecq+OFoFB57t/t2D+7\r\nJM1OiEqsQ/G2eqi66/rC1oHQFIPw2I/bptng0RjfynvRlQwdvo/jMRwcfwUrpdJ8\r\nPLsAiDLkGLvraNrgZCX4iiYNfQN3bbYbDBFGEegnr1x1fIWCOzuQess=\r\n-----END CERTIFICATE-----\r\n\r\n```",
  "closed_at": "2019-07-11T20:55:15Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/20407524?v=4",
    "events_url": "https://api.github.com/users/k8s-ci-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-ci-robot/followers",
    "following_url": "https://api.github.com/users/k8s-ci-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-ci-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-ci-robot",
    "id": 20407524,
    "login": "k8s-ci-robot",
    "node_id": "MDQ6VXNlcjIwNDA3NTI0",
    "organizations_url": "https://api.github.com/users/k8s-ci-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-ci-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-ci-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-ci-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-ci-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-ci-robot"
  },
  "comments": 2,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/80057/comments",
  "created_at": "2019-07-11T19:55:28Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/80057/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/80057",
  "id": 467077900,
  "labels": [
    {
      "color": "c7def8",
      "default": false,
      "description": "Categorizes issue or PR as related to a new feature.",
      "id": 267761362,
      "name": "kind/feature",
      "node_id": "MDU6TGFiZWwyNjc3NjEzNjI=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/feature"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Auth.",
      "id": 357119284,
      "name": "sig/auth",
      "node_id": "MDU6TGFiZWwzNTcxMTkyODQ=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/auth"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/80057/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU0NjcwNzc5MDA=",
  "number": 80057,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "CertificateSigningRequest doesn't support URL SANs or isCA",
  "updated_at": "2019-07-11T20:55:16Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/80057",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/84202?v=4",
    "events_url": "https://api.github.com/users/costinm/events{/privacy}",
    "followers_url": "https://api.github.com/users/costinm/followers",
    "following_url": "https://api.github.com/users/costinm/following{/other_user}",
    "gists_url": "https://api.github.com/users/costinm/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/costinm",
    "id": 84202,
    "login": "costinm",
    "node_id": "MDQ6VXNlcjg0MjAy",
    "organizations_url": "https://api.github.com/users/costinm/orgs",
    "received_events_url": "https://api.github.com/users/costinm/received_events",
    "repos_url": "https://api.github.com/users/costinm/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/costinm/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/costinm/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/costinm"
  }
}