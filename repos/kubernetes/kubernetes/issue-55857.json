{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/4953962?v=4",
    "events_url": "https://api.github.com/users/m1093782566/events{/privacy}",
    "followers_url": "https://api.github.com/users/m1093782566/followers",
    "following_url": "https://api.github.com/users/m1093782566/following{/other_user}",
    "gists_url": "https://api.github.com/users/m1093782566/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/m1093782566",
    "id": 4953962,
    "login": "m1093782566",
    "node_id": "MDQ6VXNlcjQ5NTM5NjI=",
    "organizations_url": "https://api.github.com/users/m1093782566/orgs",
    "received_events_url": "https://api.github.com/users/m1093782566/received_events",
    "repos_url": "https://api.github.com/users/m1093782566/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/m1093782566/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/m1093782566/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/m1093782566"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars1.githubusercontent.com/u/4953962?v=4",
      "events_url": "https://api.github.com/users/m1093782566/events{/privacy}",
      "followers_url": "https://api.github.com/users/m1093782566/followers",
      "following_url": "https://api.github.com/users/m1093782566/following{/other_user}",
      "gists_url": "https://api.github.com/users/m1093782566/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/m1093782566",
      "id": 4953962,
      "login": "m1093782566",
      "node_id": "MDQ6VXNlcjQ5NTM5NjI=",
      "organizations_url": "https://api.github.com/users/m1093782566/orgs",
      "received_events_url": "https://api.github.com/users/m1093782566/received_events",
      "repos_url": "https://api.github.com/users/m1093782566/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/m1093782566/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/m1093782566/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/m1093782566"
    }
  ],
  "author_association": "MEMBER",
  "body": "<!-- This form is for bug reports and feature requests ONLY! \r\n\r\nIf you're looking for help check [Stack Overflow](https://stackoverflow.com/questions/tagged/kubernetes) and the [troubleshooting guide](https://kubernetes.io/docs/tasks/debug-application-cluster/troubleshooting/).\r\n-->\r\n\r\n**Is this a BUG REPORT or FEATURE REQUEST?**:\r\n\r\n/kind bug\r\n\r\n\r\n**What happened**:\r\n\r\n@pires reported the bug.\r\n\r\nkube-proxy resets IPVS configuration even though `--mode=iptables`\r\n\r\non a node before ever running kube-proxy\r\n\r\n```\r\n$ toolbox ipvsadm -l\r\nIP Virtual Server version 1.2.1 (size=4096)\r\nProt LocalAddress:Port Scheduler Flags\r\n  -> RemoteAddress:Port           Forward Weight ActiveConn InActConn\r\nTCP  11.14.170.10:etcd-server wlc\r\n  -> vm-pb9g.c.massive-bliss-781. Masq    1      0          0         \r\n  -> vm-wrk6.c.massive-bliss-781. Masq    1      0          0         \r\n  -> vm-16sr.c.massive-bliss-781. Masq    1      0          0         \r\nTCP  11.22.117.27:http wlc\r\n  -> vm-wrk6.c.massive-bliss-781. Masq    1      0          0         \r\nTCP  11.53.156.194:sun-sr-https wlc\r\n  -> vm-pb9g.c.massive-bliss-781. Masq    1      0          4         \r\n  -> vm-wrk6.c.massive-bliss-781. Masq    1      0          3         \r\n  -> vm-16sr.c.massive-bliss-781. Masq    1      0          3         \r\nTCP  11.193.111.100:etcd-client wlc\r\n  -> vm-pb9g.c.massive-bliss-781. Masq    1      0          0         \r\n  -> vm-wrk6.c.massive-bliss-781. Masq    1      0          0         \r\n  -> vm-16sr.c.massive-bliss-781. Masq    1      0          0         \r\nTCP  11.244.244.158:cslistener wlc\r\n  -> vm-pb9g.c.massive-bliss-781. Masq    1      0          0         \r\n  -> vm-wrk6.c.massive-bliss-781. Masq    1      0          0         \r\n  -> vm-16sr.c.massive-bliss-781. Masq    1      0          0         \r\n(...)\r\n```\r\n\r\nafter running kube-proxy `--mode=iptables`\r\n\r\n```\r\n$ toolbox ipvsadm -l\r\nIP Virtual Server version 1.2.1 (size=4096)\r\nProt LocalAddress:Port Scheduler Flags\r\n  -> RemoteAddress:Port           Forward Weight ActiveConn InActConn\r\n```\r\n\r\n**What you expected to happen**:\r\n\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n\r\n**Anything else we need to know?**:\r\n\r\nCurrently we assume only ipvs proxier will create ipvs rules, ipvs proxier will flush all ipvs rules when clean up.  Users do this operation should be with caution. But, seems the comment message in codebase is not enough. We need to figure out how to fix it.\r\n\r\n**Environment**:\r\n- Kubernetes version (use `kubectl version`):\r\n- Cloud provider or hardware configuration:\r\n- OS (e.g. from /etc/os-release):\r\n- Kernel (e.g. `uname -a`):\r\n- Install tools:\r\n- Others:\r\n\r\n/sig network\r\n\r\ncc @thockin @caseydavenport \r\n",
  "closed_at": "2017-11-22T08:27:30Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/13653959?v=4",
    "events_url": "https://api.github.com/users/k8s-github-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-github-robot/followers",
    "following_url": "https://api.github.com/users/k8s-github-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-github-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-github-robot",
    "id": 13653959,
    "login": "k8s-github-robot",
    "node_id": "MDQ6VXNlcjEzNjUzOTU5",
    "organizations_url": "https://api.github.com/users/k8s-github-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-github-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-github-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-github-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-github-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-github-robot"
  },
  "comments": 22,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/55857/comments",
  "created_at": "2017-11-16T08:51:27Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/55857/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/55857",
  "id": 274437082,
  "labels": [
    {
      "color": "0052cc",
      "default": false,
      "description": null,
      "id": 755527763,
      "name": "area/ipvs",
      "node_id": "MDU6TGFiZWw3NTU1Mjc3NjM=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/area/ipvs"
    },
    {
      "color": "e11d21",
      "default": false,
      "description": "Categorizes issue or PR as related to a bug.",
      "id": 105146071,
      "name": "kind/bug",
      "node_id": "MDU6TGFiZWwxMDUxNDYwNzE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/bug"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Network.",
      "id": 116712108,
      "name": "sig/network",
      "node_id": "MDU6TGFiZWwxMTY3MTIxMDg=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/network"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/55857/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUyNzQ0MzcwODI=",
  "number": 55857,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "IPVS kube-proxy will flush all existing ipvs rules in its startup",
  "updated_at": "2017-11-22T08:27:30Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/55857",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/4953962?v=4",
    "events_url": "https://api.github.com/users/m1093782566/events{/privacy}",
    "followers_url": "https://api.github.com/users/m1093782566/followers",
    "following_url": "https://api.github.com/users/m1093782566/following{/other_user}",
    "gists_url": "https://api.github.com/users/m1093782566/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/m1093782566",
    "id": 4953962,
    "login": "m1093782566",
    "node_id": "MDQ6VXNlcjQ5NTM5NjI=",
    "organizations_url": "https://api.github.com/users/m1093782566/orgs",
    "received_events_url": "https://api.github.com/users/m1093782566/received_events",
    "repos_url": "https://api.github.com/users/m1093782566/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/m1093782566/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/m1093782566/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/m1093782566"
  }
}