{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/576341?v=4",
    "events_url": "https://api.github.com/users/soltysh/events{/privacy}",
    "followers_url": "https://api.github.com/users/soltysh/followers",
    "following_url": "https://api.github.com/users/soltysh/following{/other_user}",
    "gists_url": "https://api.github.com/users/soltysh/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/soltysh",
    "id": 576341,
    "login": "soltysh",
    "node_id": "MDQ6VXNlcjU3NjM0MQ==",
    "organizations_url": "https://api.github.com/users/soltysh/orgs",
    "received_events_url": "https://api.github.com/users/soltysh/received_events",
    "repos_url": "https://api.github.com/users/soltysh/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/soltysh/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/soltysh/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/soltysh"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars2.githubusercontent.com/u/576341?v=4",
      "events_url": "https://api.github.com/users/soltysh/events{/privacy}",
      "followers_url": "https://api.github.com/users/soltysh/followers",
      "following_url": "https://api.github.com/users/soltysh/following{/other_user}",
      "gists_url": "https://api.github.com/users/soltysh/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/soltysh",
      "id": 576341,
      "login": "soltysh",
      "node_id": "MDQ6VXNlcjU3NjM0MQ==",
      "organizations_url": "https://api.github.com/users/soltysh/orgs",
      "received_events_url": "https://api.github.com/users/soltysh/received_events",
      "repos_url": "https://api.github.com/users/soltysh/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/soltysh/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/soltysh/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/soltysh"
    }
  ],
  "author_association": "CONTRIBUTOR",
  "body": "<!-- Thanks for filing an issue! Before hitting the button, please answer these questions.-->\r\n\r\n**Is this a request for help?** (If yes, you should use our troubleshooting guide and community support channels, see http://kubernetes.io/docs/troubleshooting/.):\r\nNo\r\n\r\n**What keywords did you search in Kubernetes issues before filing this one?** (If you have found any duplicates, you should instead reply there.):\r\n`scheduledjob`, `cannot determine`, `too many missed start times`\r\n\r\n---\r\n\r\n**Is this a BUG REPORT or FEATURE REQUEST?** (choose one):\r\nBUG REPORT\r\n\r\n<!--\r\nIf this is a BUG REPORT, please:\r\n  - Fill in as much of the template below as you can.  If you leave out\r\n    information, we can't help you as well.\r\n\r\nIf this is a FEATURE REQUEST, please:\r\n  - Describe *in detail* the feature/behavior/change you'd like to see.\r\n\r\nIn both cases, be ready for followup questions, and please respond in a timely\r\nmanner.  If we can't reproduce a bug or think a feature already exists, we\r\nmight close your issue.  If we're wrong, PLEASE feel free to reopen it and\r\nexplain why.\r\n-->\r\n\r\n**Kubernetes version** (use `kubectl version`):\r\n````\r\nClient Version: version.Info{Major:\"1\", Minor:\"4\", GitVersion:\"v1.4.0+coreos.0\", GitCommit:\"278a1f7034bdba61cba443722647da1a8204a6fc\", GitTreeState:\"clean\", BuildDate:\"2016-09-26T20:48:37Z\", GoVersion:\"go1.6.3\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\nServer Version: version.Info{Major:\"1\", Minor:\"4\", GitVersion:\"v1.4.0+coreos.0\", GitCommit:\"278a1f7034bdba61cba443722647da1a8204a6fc\", GitTreeState:\"clean\", BuildDate:\"2016-09-26T20:48:37Z\", GoVersion:\"go1.6.3\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\n````\r\n\r\n**Environment**:\r\n- **Cloud provider or hardware configuration**: bare metal\r\n- **OS** (e.g. from /etc/os-release): `Debian GNU/Linux 8 (jessie)`\r\n- **Kernel** (e.g. `uname -a`): `4.4.0-36-generic #55-Ubuntu SMP Thu Aug 11 18:01:55 UTC 2016 x86_64 GNU/Linux`\r\n- **Install tools**: `quay.io/coreos/hyperkube:v1.4.0_coreos.0`, deployed with `kargo`\r\n- **Others**:\r\n\r\n\r\n**What happened**:\r\n\r\nI am using a scheduledjob with **`concurrencyPolicy: Forbid`**. An instance of my job has taken a long time to finish, thus skipping many start times.\r\n\r\nEver since, the scheduledjob will not schedule anything new.\r\n\r\nController manager log has:\r\n\r\n````\r\nE1106 13:37:12.457445       1 controller.go:163] Cannot determine if default/my-cron-job needs to be started: Too many missed start times to list\r\n````\r\n\r\n**What you expected to happen**:\r\n\r\nI expect the scheduledjob not to be stuck not scheduling anything anymore. With `concurrencyPolicy: Forbid`, I expect that it should just re-schedule something as soon as the previously running job has completed.\r\n\r\nThe \"Too many missed start times to list\" safeguard appears to apply mostly to cases where job concurrency is allowed to avoid creating a lot of jobs in case of timestamp issues.\r\nhttps://github.com/kubernetes/kubernetes/blob/56bbfd259a6f45dfbcfb6f3c9f61643a787ed067/pkg/controller/scheduledjob/utils.go#L148:\r\n\r\n````\r\n\t\t// An object might miss several starts.  For example, if\r\n\t\t// controller gets wedged on friday at 5:01pm when everyone has\r\n\t\t// gone home, and someone comes in on tuesday AM and discovers\r\n\t\t// the problem and restarts the controller, then all the hourly\r\n\t\t// jobs, more than 80 of them for one hourly scheduledJob, should\r\n\t\t// all start running with no further intervention (if the scheduledJob\r\n\t\t// allows concurrency and late starts).\r\n\t\t//\r\n\r\n\t\t// However, if there is a bug somewhere, or incorrect clock\r\n\t\t// on controller's server or apiservers (for setting creationTimestamp)\r\n\t\t// then there could be so many missed start times (it could be off\r\n\t\t// by decades or more), that it would eat up all the CPU and memory\r\n\t\t// of this controller. In that case, we want to not try to list\r\n\t\t// all the misseded start times.\r\n````\r\n\r\n**How to reproduce it** (as minimally and precisely as possible):\r\n\r\nThe issue shows up after about 100 minutes of this running.\r\n\r\n```\r\napiVersion: batch/v2alpha1\r\nkind: ScheduledJob\r\nmetadata:\r\n  name: my-cron-job\r\n  labels:\r\n    app: my-cron-job\r\nspec:\r\n  schedule: 0/1 * * * ?\r\n  concurrencyPolicy: Forbid\r\n  jobTemplate:\r\n    spec:\r\n      template:\r\n        spec:\r\n          containers:\r\n          - name: my-cron-job\r\n            image: busybox:1.25\r\n            command: [\"sleep\", \"7000\"]\r\n          restartPolicy: Never\r\n```\r\n\r\n\r\n**Anything else do we need to know**:\r\n\r\n",
  "closed_at": "2017-01-17T08:41:45Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/13653959?v=4",
    "events_url": "https://api.github.com/users/k8s-github-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-github-robot/followers",
    "following_url": "https://api.github.com/users/k8s-github-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-github-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-github-robot",
    "id": 13653959,
    "login": "k8s-github-robot",
    "node_id": "MDQ6VXNlcjEzNjUzOTU5",
    "organizations_url": "https://api.github.com/users/k8s-github-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-github-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-github-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-github-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-github-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-github-robot"
  },
  "comments": 9,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/36311/comments",
  "created_at": "2016-11-06T15:31:01Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/36311/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/36311",
  "id": 187568159,
  "labels": [
    {
      "color": "0052cc",
      "default": false,
      "description": null,
      "id": 483268583,
      "name": "area/workload-api/cronjob",
      "node_id": "MDU6TGFiZWw0ODMyNjg1ODM=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/area/workload-api/cronjob"
    },
    {
      "color": "e11d21",
      "default": false,
      "description": "Categorizes issue or PR as related to a bug.",
      "id": 105146071,
      "name": "kind/bug",
      "node_id": "MDU6TGFiZWwxMDUxNDYwNzE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/bug"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Apps.",
      "id": 404091735,
      "name": "sig/apps",
      "node_id": "MDU6TGFiZWw0MDQwOTE3MzU=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/apps"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/36311/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUxODc1NjgxNTk=",
  "number": 36311,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "Controller manager cannot determine if scheduledjob needs to be started",
  "updated_at": "2017-01-18T13:30:56Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/36311",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/7261177?v=4",
    "events_url": "https://api.github.com/users/peay/events{/privacy}",
    "followers_url": "https://api.github.com/users/peay/followers",
    "following_url": "https://api.github.com/users/peay/following{/other_user}",
    "gists_url": "https://api.github.com/users/peay/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/peay",
    "id": 7261177,
    "login": "peay",
    "node_id": "MDQ6VXNlcjcyNjExNzc=",
    "organizations_url": "https://api.github.com/users/peay/orgs",
    "received_events_url": "https://api.github.com/users/peay/received_events",
    "repos_url": "https://api.github.com/users/peay/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/peay/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/peay/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/peay"
  }
}