{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "MEMBER",
  "body": "We allow CRD authors to write [validation for CustomResources](https://github.com/kubernetes/community/blob/master/contributors/design-proposals/api-machinery/customresources-validation.md). Currently we don't restrict writing validation for `metadata`, which means people can have [additive validation constraints to `metadata` after the built-in validation](https://github.com/kubernetes/kubernetes/blob/74036c082aeec92c196a887460d2aec0c060cd8e/staging/src/k8s.io/apiextensions-apiserver/pkg/registry/customresource/validator.go#L55-L64).  \r\n\r\nFor example, people can have additive name constraints (require CR `metadata.name` to be `default`) with the following schema:\r\n\r\n```\r\n  validation:\r\n   openAPIV3Schema:\r\n     description: Foo CRD for Testing\r\n     properties:\r\n       metadata:\r\n         description: Metadata of Foo\r\n         properties:\r\n           name:\r\n             description: Name of Foo\r\n             pattern: default\r\n             type: string\r\n```\r\n\r\nThis brings us two questions: \r\n\r\n1. how do we [publish CR validation schema](https://github.com/kubernetes/kubernetes/pull/71192) if \"metadata\" is included in the schema: \r\n  - simplest option is to publish standard metav1.ObjectMeta schema info, and use any CRD-specified \"metadata\" properties as additive validation (just like in-tree types do, publishing standard ObjectMeta schema info, and implementing type-specific name validation internally)\r\n  - alternatively, we can try merging user-specified metadata schema with the standard one. Technically people should only add extra validation to existing metadata properties (adding new fields to metadata won't work since they will be pruned by built-in validation first), but it's unclear to me how arbitrary people may want the metadata validation to be\r\n\r\n2. longer term question is whether to allow people specifying metadata validation at all, or just allow a subset (like name validation) in CRD v1\r\n\r\n/sig api-machinery\r\n/area custom-resources\r\ncc @apelisse @lavalamp @liggitt @mbohlool @smarterclayton @sttts ",
  "closed_at": "2019-05-14T06:19:34Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/20407524?v=4",
    "events_url": "https://api.github.com/users/k8s-ci-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-ci-robot/followers",
    "following_url": "https://api.github.com/users/k8s-ci-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-ci-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-ci-robot",
    "id": 20407524,
    "login": "k8s-ci-robot",
    "node_id": "MDQ6VXNlcjIwNDA3NTI0",
    "organizations_url": "https://api.github.com/users/k8s-ci-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-ci-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-ci-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-ci-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-ci-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-ci-robot"
  },
  "comments": 3,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/74620/comments",
  "created_at": "2019-02-26T20:06:39Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/74620/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/74620",
  "id": 414795248,
  "labels": [
    {
      "color": "0052cc",
      "default": false,
      "description": null,
      "id": 556590057,
      "name": "area/custom-resources",
      "node_id": "MDU6TGFiZWw1NTY1OTAwNTc=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/area/custom-resources"
    },
    {
      "color": "c7def8",
      "default": false,
      "description": "Categorizes issue or PR as related to a new feature.",
      "id": 267761362,
      "name": "kind/feature",
      "node_id": "MDU6TGFiZWwyNjc3NjEzNjI=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/feature"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG API Machinery.",
      "id": 173493835,
      "name": "sig/api-machinery",
      "node_id": "MDU6TGFiZWwxNzM0OTM4MzU=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/api-machinery"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/74620/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU0MTQ3OTUyNDg=",
  "number": 74620,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "Metadata validation for CustomResources",
  "updated_at": "2019-05-14T06:19:34Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/74620",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/6629765?v=4",
    "events_url": "https://api.github.com/users/roycaihw/events{/privacy}",
    "followers_url": "https://api.github.com/users/roycaihw/followers",
    "following_url": "https://api.github.com/users/roycaihw/following{/other_user}",
    "gists_url": "https://api.github.com/users/roycaihw/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/roycaihw",
    "id": 6629765,
    "login": "roycaihw",
    "node_id": "MDQ6VXNlcjY2Mjk3NjU=",
    "organizations_url": "https://api.github.com/users/roycaihw/orgs",
    "received_events_url": "https://api.github.com/users/roycaihw/received_events",
    "repos_url": "https://api.github.com/users/roycaihw/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/roycaihw/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/roycaihw/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/roycaihw"
  }
}