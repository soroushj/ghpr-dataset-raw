{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "CONTRIBUTOR",
  "body": "When multiple pods use different iSCSI volumes from the same target on the same node, DetachDisk prematurely logs out from the target, even though there other active pods using the other volumes from the same target. Additionally, if the OS has been booted using iSCSI as well, this will leave the system unusable.\r\n\r\nI've noticed that the prefix returned by extractDeviceAndPrefix does not contain the host plugin directory, as returned by host.GetPluginDir(iscsiPluginName), and therefore getDevicePrefixRefCount always returns 1 as reference count.\r\n\r\nI've also noticed that the iSCSI logout command is not limited to the given volume iSCSI interface. \r\n\r\nI would like to submit a patch that addresses these issues.\r\n\r\nOS: CentOS Linux release 7.2.1511 (Core)\r\n\r\nClient Version: version.Info{Major:\"1\", Minor:\"5\", GitVersion:\"v1.5.1+82450d0\", GitCommit:\"82450d03cb057bab0950214ef122b67c83fb11df\", GitTreeState:\"not a git tree\", BuildDate:\"2016-12-20T15:11:31Z\", GoVersion:\"go1.7.4\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\nServer Version: version.Info{Major:\"1\", Minor:\"5\", GitVersion:\"v1.5.1+82450d0\", GitCommit:\"82450d03cb057bab0950214ef122b67c83fb11df\", GitTreeState:\"not a git tree\", BuildDate:\"2016-12-20T15:05:19Z\", GoVersion:\"go1.7.4\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\n\r\n",
  "closed_at": "2017-02-15T12:11:56Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/13653959?v=4",
    "events_url": "https://api.github.com/users/k8s-github-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-github-robot/followers",
    "following_url": "https://api.github.com/users/k8s-github-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-github-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-github-robot",
    "id": 13653959,
    "login": "k8s-github-robot",
    "node_id": "MDQ6VXNlcjEzNjUzOTU5",
    "organizations_url": "https://api.github.com/users/k8s-github-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-github-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-github-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-github-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-github-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-github-robot"
  },
  "comments": 2,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/39202/comments",
  "created_at": "2016-12-23T14:27:38Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/39202/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/39202",
  "id": 197378061,
  "labels": [],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/39202/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUxOTczNzgwNjE=",
  "number": 39202,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "Premature iSCSI logout",
  "updated_at": "2017-02-15T12:11:56Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/39202",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/4113414?v=4",
    "events_url": "https://api.github.com/users/cristianpop/events{/privacy}",
    "followers_url": "https://api.github.com/users/cristianpop/followers",
    "following_url": "https://api.github.com/users/cristianpop/following{/other_user}",
    "gists_url": "https://api.github.com/users/cristianpop/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/cristianpop",
    "id": 4113414,
    "login": "cristianpop",
    "node_id": "MDQ6VXNlcjQxMTM0MTQ=",
    "organizations_url": "https://api.github.com/users/cristianpop/orgs",
    "received_events_url": "https://api.github.com/users/cristianpop/received_events",
    "repos_url": "https://api.github.com/users/cristianpop/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/cristianpop/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cristianpop/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/cristianpop"
  }
}