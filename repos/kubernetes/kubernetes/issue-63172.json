{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/676637?v=4",
    "events_url": "https://api.github.com/users/feiskyer/events{/privacy}",
    "followers_url": "https://api.github.com/users/feiskyer/followers",
    "following_url": "https://api.github.com/users/feiskyer/following{/other_user}",
    "gists_url": "https://api.github.com/users/feiskyer/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/feiskyer",
    "id": 676637,
    "login": "feiskyer",
    "node_id": "MDQ6VXNlcjY3NjYzNw==",
    "organizations_url": "https://api.github.com/users/feiskyer/orgs",
    "received_events_url": "https://api.github.com/users/feiskyer/received_events",
    "repos_url": "https://api.github.com/users/feiskyer/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/feiskyer/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/feiskyer/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/feiskyer"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars2.githubusercontent.com/u/676637?v=4",
      "events_url": "https://api.github.com/users/feiskyer/events{/privacy}",
      "followers_url": "https://api.github.com/users/feiskyer/followers",
      "following_url": "https://api.github.com/users/feiskyer/following{/other_user}",
      "gists_url": "https://api.github.com/users/feiskyer/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/feiskyer",
      "id": 676637,
      "login": "feiskyer",
      "node_id": "MDQ6VXNlcjY3NjYzNw==",
      "organizations_url": "https://api.github.com/users/feiskyer/orgs",
      "received_events_url": "https://api.github.com/users/feiskyer/received_events",
      "repos_url": "https://api.github.com/users/feiskyer/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/feiskyer/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/feiskyer/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/feiskyer"
    }
  ],
  "author_association": "NONE",
  "body": "<!-- This form is for bug reports and feature requests ONLY!\r\n\r\nIf you're looking for help check [Stack Overflow](https://stackoverflow.com/questions/tagged/kubernetes) and the [troubleshooting guide](https://kubernetes.io/docs/tasks/debug-application-cluster/troubleshooting/).\r\n\r\nIf this may be security issue, please disclose it privately via https://kubernetes.io/security/.\r\n-->\r\n\r\n**Is this a BUG REPORT or FEATURE REQUEST?**:\r\n\r\n> Uncomment only one, leave it on its own line:\r\n>\r\n> /kind feature\r\n\r\n/kind bug\r\n\r\n\r\n**What happened**:\r\ncontroller manager crash looped with a seg fault after failing to create a load balancer for the kubernetes dashboard. The calls to create the load balancer were failing with a 400\r\n\r\n**What you expected to happen**:\r\ncontroller manager to provision the resources or to fail without a segfault and a clearer error message saying what the error creating the resource was.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nJust created a cluster with an add on for the dashboard.\r\n\r\n**Anything else we need to know?**:\r\nlogs from controller manager:\r\n\r\nI0423 12:50:28.532604   18125 range_allocator.go:157] Starting range CIDR allocator\r\nI0423 12:50:28.532635   18125 controller_utils.go:1019] Waiting for caches to sync for cidrallocator controller\r\nI0423 12:50:28.532669   18125 taint_controller.go:181] Starting NoExecuteTaintManager\r\nI0423 12:50:28.532732   18125 node_controller.go:611] Initializing eviction metric for zone: westeurope: :0\r\nW0423 12:50:28.532832   18125 node_controller.go:964] Missing timestamp for Node aks-nodepool1-38057350-0. Assuming now as a timestamp.\r\nI0423 12:50:28.532938   18125 node_controller.go:880] Controller detected that zone westeurope: :0 is now in state Normal.\r\nI0423 12:50:28.533081   18125 event.go:218] Event(v1.ObjectReference{Kind:\"Node\", Namespace:\"\", Name:\"aks-nodepool1-38057350-0\", UID:\"9fbde49a-4476-11e8-9b1c-0a58ac1f0e15\", APIVersion:\"\", ResourceVersion:\"\", FieldPath:\"\"}): type: 'Normal' reason: 'RegisteredNode' Node aks-nodepool1-38057350-0 event: Registered Node aks-nodepool1-38057350-0 in Controller\r\nI0423 12:50:28.533753   18125 controller_utils.go:1026] Caches are synced for ClusterRoleAggregator controller\r\nI0423 12:50:28.535278   18125 controller_utils.go:1026] Caches are synced for endpoint controller\r\nI0423 12:50:28.536974   18125 controller_utils.go:1026] Caches are synced for attach detach controller\r\nE0423 12:50:28.537377   18125 attach_detach_controller.go:345] Error creating spec for volume \"mssqldb\", pod \"feature-test3\"/\"mssqlserver-6d45f8cf58-r5r7l\": error processing PVC \"feature-test3\"/\"mssql-data\": PVC feature-test3/mssql-data has non-bound phase (\"Pending\") or empty pvc.Spec.VolumeName (\"\")\r\nI0423 12:50:28.538422   18125 controller_utils.go:1026] Caches are synced for deployment controller\r\nI0423 12:50:28.541231   18125 controller_utils.go:1026] Caches are synced for persistent volume controller\r\nI0423 12:50:28.553734   18125 controller_utils.go:1026] Caches are synced for ReplicationController controller\r\nI0423 12:50:28.557127   18125 controller_utils.go:1026] Caches are synced for TTL controller\r\nI0423 12:50:28.632899   18125 controller_utils.go:1026] Caches are synced for cidrallocator controller\r\nE0423 12:50:28.765043   18125 service_controller.go:776] Failed to process service kube-system/kubernetes-dashboard. Retrying in 5s: error getting LB for service kube-system/kubernetes-dashboard: Service(kube-system/kubernetes-dashboard) - Loadbalancer not found\r\nI0423 12:50:28.765606   18125 event.go:218] Event(v1.ObjectReference{Kind:\"Service\", Namespace:\"kube-system\", Name:\"kubernetes-dashboard\", UID:\"bf653ab4-4476-11e8-9b1c-0a58ac1f0e15\", APIVersion:\"v1\", ResourceVersion:\"193\", FieldPath:\"\"}): type: 'Warning' reason: 'CreatingLoadBalancerFailed' Error creating load balancer (will retry): error getting LB for service kube-system/kubernetes-dashboard: Service(kube-system/kubernetes-dashboard) - Loadbalancer not found\r\nI0423 12:50:28.765638   18125 event.go:218] Event(v1.ObjectReference{Kind:\"Service\", Namespace:\"feature-initialproject\", Name:\"identityserver-service\", UID:\"2ec2df0f-4485-11e8-9b1c-0a58ac1f0e15\", APIVersion:\"v1\", ResourceVersion:\"7879\", FieldPath:\"\"}): type: 'Normal' reason: 'EnsuringLoadBalancer' Ensuring load balancer\r\nI0423 12:50:28.806251   18125 controller_utils.go:1026] Caches are synced for namespace controller\r\nI0423 12:50:28.809049   18125 controller_utils.go:1026] Caches are synced for service account controller\r\nI0423 12:50:28.844247   18125 controller_utils.go:1026] Caches are synced for resource quota controller\r\nI0423 12:50:28.852639   18125 controller_utils.go:1026] Caches are synced for resource quota controller\r\nI0423 12:50:28.859159   18125 controller_utils.go:1026] Caches are synced for garbage collector controller\r\nI0423 12:50:28.859180   18125 garbagecollector.go:144] Garbage collector: all resource monitors have synced. Proceeding to collect garbage\r\nI0423 12:50:28.859261   18125 controller_utils.go:1026] Caches are synced for garbage collector controller\r\nI0423 12:50:28.908094   18125 controller_utils.go:1026] Caches are synced for stateful set controller\r\nI0423 12:50:28.919567   18125 controller_utils.go:1026] Caches are synced for disruption controller\r\nI0423 12:50:28.919591   18125 disruption.go:296] Sending events to api server.\r\nI0423 12:50:29.921277   18125 azure_loadbalancer.go:242] selectLoadBalancer: cluster(kubernetes) service(feature-initialproject/identityserver-service) isInternal(true) - availabilitysetsnames [nodepool1-availabilitySet-38057350]\r\nE0423 12:50:30.504721   18125 runtime.go:66] Observed a panic: \"invalid memory address or nil pointer dereference\" (runtime error: invalid memory address or nil pointer dereference)\r\n/go/src/k8s.io/kubernetes/_output/dockerized/go/src/k8s.io/kubernetes/vendor/k8s.io/apimachinery/pkg/util/runtime/runtime.go:72\r\n/go/src/k8s.io/kubernetes/_output/dockerized/go/src/k8s.io/kubernetes/vendor/k8s.io/apimachinery/pkg/util/runtime/runtime.go:65\r\n/go/src/k8s.io/kubernetes/_output/dockerized/go/src/k8s.io/kubernetes/vendor/k8s.io/apimachinery/pkg/util/runtime/runtime.go:51\r\n/usr/local/go/src/runtime/asm_amd64.s:509\r\n/usr/local/go/src/runtime/panic.go:491\r\n/usr/local/go/src/runtime/panic.go:63\r\n/usr/local/go/src/runtime/signal_unix.go:367\r\n/go/src/k8s.io/kubernetes/_output/dockerized/go/src/k8s.io/kubernetes/pkg/cloudprovider/providers/azure/azure_loadbalancer.go:326\r\n/go/src/k8s.io/kubernetes/_output/dockerized/go/src/k8s.io/kubernetes/pkg/cloudprovider/providers/azure/azure_loadbalancer.go:113\r\n/go/src/k8s.io/kubernetes/_output/dockerized/go/src/k8s.io/kubernetes/pkg/controller/service/service_controller.go:374\r\n/go/src/k8s.io/kubernetes/_output/dockerized/go/src/k8s.io/kubernetes/pkg/controller/service/service_controller.go:306\r\n/go/src/k8s.io/kubernetes/_output/dockerized/go/src/k8s.io/kubernetes/pkg/controller/service/service_controller.go:249\r\n/go/src/k8s.io/kubernetes/_output/dockerized/go/src/k8s.io/kubernetes/pkg/controller/service/service_controller.go:771\r\n/go/src/k8s.io/kubernetes/_output/dockerized/go/src/k8s.io/kubernetes/pkg/controller/service/service_controller.go:213\r\n/go/src/k8s.io/kubernetes/_output/dockerized/go/src/k8s.io/kubernetes/pkg/controller/service/service_controller.go:217\r\n/go/src/k8s.io/kubernetes/_output/dockerized/go/src/k8s.io/kubernetes/pkg/controller/service/service_controller.go:195\r\n/go/src/k8s.io/kubernetes/_output/dockerized/go/src/k8s.io/kubernetes/vendor/k8s.io/apimachinery/pkg/util/wait/wait.go:133\r\n/go/src/k8s.io/kubernetes/_output/dockerized/go/src/k8s.io/kubernetes/vendor/k8s.io/apimachinery/pkg/util/wait/wait.go:134\r\n/go/src/k8s.io/kubernetes/_output/dockerized/go/src/k8s.io/kubernetes/vendor/k8s.io/apimachinery/pkg/util/wait/wait.go:88\r\n/usr/local/go/src/runtime/asm_amd64.s:2337\r\npanic: runtime error: invalid memory address or nil pointer dereference [recovered]\r\n\tpanic: runtime error: invalid memory address or nil pointer dereference\r\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x0 pc=0x1d5772d]\r\n\r\ngoroutine 1338 [running]:\r\nk8s.io/kubernetes/vendor/k8s.io/apimachinery/pkg/util/runtime.HandleCrash(0x0, 0x0, 0x0)\r\n\t/go/src/k8s.io/kubernetes/_output/dockerized/go/src/k8s.io/kubernetes/vendor/k8s.io/apimachinery/pkg/util/runtime/runtime.go:58 +0x111\r\npanic(0x40b2e00, 0xa603590)\r\n\t/usr/local/go/src/runtime/panic.go:491 +0x283\r\nk8s.io/kubernetes/pkg/cloudprovider/providers/azure.(*Cloud).getServiceLoadBalancerStatus(0xc4206cdc00, 0xc422b401e0, 0xc4208f6b90, 0xc422b401e0, 0xc4210c0388, 0x1)\r\n\t/go/src/k8s.io/kubernetes/_output/dockerized/go/src/k8s.io/kubernetes/pkg/cloudprovider/providers/azure/azure_loadbalancer.go:326 +0x30d\r\nk8s.io/kubernetes/pkg/cloudprovider/providers/azure.(*Cloud).EnsureLoadBalancer(0xc4206cdc00, 0x496be8b, 0xa, 0xc422b401e0, 0xc4210c0388, 0x1, 0x1, 0xbeaf93852d9a680b, 0x2fe0fa757, 0xa9f0d40)\r\n\t/go/src/k8s.io/kubernetes/_output/dockerized/go/src/k8s.io/kubernetes/pkg/cloudprovider/providers/azure/azure_loadbalancer.go:113 +0x2ea\r\nk8s.io/kubernetes/pkg/controller/service.(*ServiceController).ensureLoadBalancer(0xc420f56000, 0xc422b401e0, 0xc422b401e0, 0x4961da9, 0x6)\r\n\t/go/src/k8s.io/kubernetes/_output/dockerized/go/src/k8s.io/kubernetes/pkg/controller/service/service_controller.go:374 +0xcc\r\nk8s.io/kubernetes/pkg/controller/service.(*ServiceController).createLoadBalancerIfNeeded(0xc420f56000, 0xc421fd81e0, 0x2d, 0xc422b401e0, 0xc422c8dc40, 0xc422c8dc78, 0x1265492)\r\n\t/go/src/k8s.io/kubernetes/_output/dockerized/go/src/k8s.io/kubernetes/pkg/controller/service/service_controller.go:306 +0x20e\r\nk8s.io/kubernetes/pkg/controller/service.(*ServiceController).processServiceUpdate(0xc420f56000, 0xc4217bcc60, 0xc422b401e0, 0xc421fd81e0, 0x2d, 0x0, 0x0, 0x0)\r\n\t/go/src/k8s.io/kubernetes/_output/dockerized/go/src/k8s.io/kubernetes/pkg/controller/service/service_controller.go:249 +0xeb\r\nk8s.io/kubernetes/pkg/controller/service.(*ServiceController).syncService(0xc420f56000, 0xc421fd81e0, 0x2d, 0x0, 0x0)\r\n\t/go/src/k8s.io/kubernetes/_output/dockerized/go/src/k8s.io/kubernetes/pkg/controller/service/service_controller.go:771 +0x3aa\r\nk8s.io/kubernetes/pkg/controller/service.(*ServiceController).worker.func1(0xc420f56000)\r\n\t/go/src/k8s.io/kubernetes/_output/dockerized/go/src/k8s.io/kubernetes/pkg/controller/service/service_controller.go:213 +0xd9\r\nk8s.io/kubernetes/pkg/controller/service.(*ServiceController).worker(0xc420f56000)\r\n\t/go/src/k8s.io/kubernetes/_output/dockerized/go/src/k8s.io/kubernetes/pkg/controller/service/service_controller.go:217 +0x2b\r\nk8s.io/kubernetes/pkg/controller/service.(*ServiceController).(k8s.io/kubernetes/pkg/controller/service.worker)-fm()\r\n\t/go/src/k8s.io/kubernetes/_output/dockerized/go/src/k8s.io/kubernetes/pkg/controller/service/service_controller.go:195 +0x2a\r\nk8s.io/kubernetes/vendor/k8s.io/apimachinery/pkg/util/wait.JitterUntil.func1(0xc420a04570)\r\n\t/go/src/k8s.io/kubernetes/_output/dockerized/go/src/k8s.io/kubernetes/vendor/k8s.io/apimachinery/pkg/util/wait/wait.go:133 +0x5e\r\nk8s.io/kubernetes/vendor/k8s.io/apimachinery/pkg/util/wait.JitterUntil(0xc420a04570, 0x3b9aca00, 0x0, 0x1, 0xc4208fa0c0)\r\n\t/go/src/k8s.io/kubernetes/_output/dockerized/go/src/k8s.io/kubernetes/vendor/k8s.io/apimachinery/pkg/util/wait/wait.go:134 +0xbd\r\nk8s.io/kubernetes/vendor/k8s.io/apimachinery/pkg/util/wait.Until(0xc420a04570, 0x3b9aca00, 0xc4208fa0c0)\r\n\t/go/src/k8s.io/kubernetes/_output/dockerized/go/src/k8s.io/kubernetes/vendor/k8s.io/apimachinery/pkg/util/wait/wait.go:88 +0x4d\r\ncreated by k8s.io/kubernetes/pkg/controller/service.(*ServiceController).Run\r\n\t/go/src/k8s.io/kubernetes/_output/dockerized/go/src/k8s.io/kubernetes/pkg/controller/service/service_controller.go:195 +0x20c\r\n**Environment**:\r\n- Kubernetes version (use `kubectl version`): 1.9.1\r\n- Cloud provider or hardware configuration: Azure, AKS\r\n- OS (e.g. from /etc/os-release): Ubunutu\r\n- Kernel (e.g. `uname -a`): xenial\r\n- Install tools:AKS\r\n- Others:\r\n@khenidak ",
  "closed_at": "2018-09-13T08:57:23Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/20407524?v=4",
    "events_url": "https://api.github.com/users/k8s-ci-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-ci-robot/followers",
    "following_url": "https://api.github.com/users/k8s-ci-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-ci-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-ci-robot",
    "id": 20407524,
    "login": "k8s-ci-robot",
    "node_id": "MDQ6VXNlcjIwNDA3NTI0",
    "organizations_url": "https://api.github.com/users/k8s-ci-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-ci-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-ci-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-ci-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-ci-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-ci-robot"
  },
  "comments": 14,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/63172/comments",
  "created_at": "2018-04-26T00:06:33Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/63172/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/63172",
  "id": 317833934,
  "labels": [
    {
      "color": "e11d21",
      "default": false,
      "description": "Categorizes issue or PR as related to a bug.",
      "id": 105146071,
      "name": "kind/bug",
      "node_id": "MDU6TGFiZWwxMDUxNDYwNzE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/bug"
    },
    {
      "color": "e11d21",
      "default": false,
      "description": "Highest priority. Must be actively worked on as someone's top priority right now.",
      "id": 114528068,
      "name": "priority/critical-urgent",
      "node_id": "MDU6TGFiZWwxMTQ1MjgwNjg=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/priority/critical-urgent"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/63172/labels{/name}",
  "locked": false,
  "milestone": {
    "closed_at": "2019-08-26T17:22:28Z",
    "closed_issues": 442,
    "created_at": "2017-11-15T06:32:51Z",
    "creator": {
      "avatar_url": "https://avatars0.githubusercontent.com/u/5595220?v=4",
      "events_url": "https://api.github.com/users/thockin/events{/privacy}",
      "followers_url": "https://api.github.com/users/thockin/followers",
      "following_url": "https://api.github.com/users/thockin/following{/other_user}",
      "gists_url": "https://api.github.com/users/thockin/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/thockin",
      "id": 5595220,
      "login": "thockin",
      "node_id": "MDQ6VXNlcjU1OTUyMjA=",
      "organizations_url": "https://api.github.com/users/thockin/orgs",
      "received_events_url": "https://api.github.com/users/thockin/received_events",
      "repos_url": "https://api.github.com/users/thockin/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/thockin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thockin/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/thockin"
    },
    "description": "",
    "due_on": null,
    "html_url": "https://github.com/kubernetes/kubernetes/milestone/39",
    "id": 2913712,
    "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/milestones/39/labels",
    "node_id": "MDk6TWlsZXN0b25lMjkxMzcxMg==",
    "number": 39,
    "open_issues": 0,
    "state": "closed",
    "title": "v1.12",
    "updated_at": "2019-08-26T17:22:28Z",
    "url": "https://api.github.com/repos/kubernetes/kubernetes/milestones/39"
  },
  "node_id": "MDU6SXNzdWUzMTc4MzM5MzQ=",
  "number": 63172,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "segfault in controllermanager",
  "updated_at": "2018-09-13T16:28:43Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/63172",
  "user": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/20996660?v=4",
    "events_url": "https://api.github.com/users/JackQuincy/events{/privacy}",
    "followers_url": "https://api.github.com/users/JackQuincy/followers",
    "following_url": "https://api.github.com/users/JackQuincy/following{/other_user}",
    "gists_url": "https://api.github.com/users/JackQuincy/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/JackQuincy",
    "id": 20996660,
    "login": "JackQuincy",
    "node_id": "MDQ6VXNlcjIwOTk2NjYw",
    "organizations_url": "https://api.github.com/users/JackQuincy/orgs",
    "received_events_url": "https://api.github.com/users/JackQuincy/received_events",
    "repos_url": "https://api.github.com/users/JackQuincy/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/JackQuincy/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/JackQuincy/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/JackQuincy"
  }
}