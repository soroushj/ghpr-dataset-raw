{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "MEMBER",
  "body": "<!-- This form is for bug reports and feature requests ONLY! \r\n\r\nIf you're looking for help check [Stack Overflow](https://stackoverflow.com/questions/tagged/kubernetes) and the [troubleshooting guide](https://kubernetes.io/docs/tasks/debug-application-cluster/troubleshooting/).\r\n-->\r\n\r\n**Is this a BUG REPORT or FEATURE REQUEST?**:\r\n\r\n/kind bug\r\n\r\n**What happened**:\r\n\r\nWhen user uses fc volume plugin, device file on operating system such as /dev/sdX remains after deleting a Pod.\r\nAfter deleting the Pod, PVC and PV, cluster admin or external-provisioner might delete the disk from the storage, therefore the block device on the worker node should be cleaned up.\r\n\r\nThe photon volume plugin already has this functionality in the removeFromScsiSubsystem().\r\nAlso the gce volume plugin has similar functionality in the udevadmChangeToDrive() too.\r\n\r\n- photon: echo 1 > /sys/block/<dev name>/device/delete\r\n- gce: udevadm trigger --action=change --property-match=DEVNAME=%s\r\n\r\nAlso os-brick library in the OpenStack Cinder component uses same way with photon driver.\r\n\r\n\r\n**What you expected to happen**:\r\n\r\nThe device file on operating system such as /dev/sdX will be cleaned up after deleting PVs.\r\n\r\n**Environment**:\r\n- Kubernetes version (use `kubectl version`):\r\n```\r\n% k versionClient Version: version.Info{Major:\"1\", Minor:\"8+\", GitVersion:\"v1.8.0-alpha.2.538+c35bf2aa7b476c\", GitCommit:\"c35bf2aa7b476c2523687b923f9e485df333f1d2\", GitTreeState:\"clean\", BuildDate:\"2017-07-20T16:53:54Z\", GoVersion:\"go1.8.1\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\nServer Version: version.Info{Major:\"1\", Minor:\"8+\", GitVersion:\"v1.8.0-alpha.2.538+c35bf2aa7b476c\", GitCommit:\"c35bf2aa7b476c2523687b923f9e485df333f1d2\", GitTreeState:\"clean\", BuildDate:\"2017-07-20T16:53:54Z\", GoVersion:\"go1.8.1\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\n```\r\n- Cloud provider or hardware configuration**: KVM\r\n- OS (e.g. from /etc/os-release): Fedora 25\r\n- Kernel (e.g. `uname -a`): \r\n```\r\nLinux master 4.11.3-200.fc25.x86_64 #1 SMP Thu May 25 19:03:07 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\r\n```\r\n- Install tools: local-up-cluster.sh\r\n- Others:\r\n",
  "closed_at": "2017-08-02T02:52:59Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/13653959?v=4",
    "events_url": "https://api.github.com/users/k8s-github-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-github-robot/followers",
    "following_url": "https://api.github.com/users/k8s-github-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-github-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-github-robot",
    "id": 13653959,
    "login": "k8s-github-robot",
    "node_id": "MDQ6VXNlcjEzNjUzOTU5",
    "organizations_url": "https://api.github.com/users/k8s-github-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-github-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-github-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-github-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-github-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-github-robot"
  },
  "comments": 4,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/49392/comments",
  "created_at": "2017-07-21T15:53:44Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/49392/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/49392",
  "id": 244711816,
  "labels": [
    {
      "color": "e11d21",
      "default": false,
      "description": "Categorizes issue or PR as related to a bug.",
      "id": 105146071,
      "name": "kind/bug",
      "node_id": "MDU6TGFiZWwxMDUxNDYwNzE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/bug"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Storage.",
      "id": 169428334,
      "name": "sig/storage",
      "node_id": "MDU6TGFiZWwxNjk0MjgzMzQ=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/storage"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/49392/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUyNDQ3MTE4MTY=",
  "number": 49392,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "FC volume plugin needs to remove detached block device at TeadDown sequence",
  "updated_at": "2017-08-02T02:52:59Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/49392",
  "user": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/19844283?v=4",
    "events_url": "https://api.github.com/users/mtanino/events{/privacy}",
    "followers_url": "https://api.github.com/users/mtanino/followers",
    "following_url": "https://api.github.com/users/mtanino/following{/other_user}",
    "gists_url": "https://api.github.com/users/mtanino/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/mtanino",
    "id": 19844283,
    "login": "mtanino",
    "node_id": "MDQ6VXNlcjE5ODQ0Mjgz",
    "organizations_url": "https://api.github.com/users/mtanino/orgs",
    "received_events_url": "https://api.github.com/users/mtanino/received_events",
    "repos_url": "https://api.github.com/users/mtanino/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/mtanino/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mtanino/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/mtanino"
  }
}