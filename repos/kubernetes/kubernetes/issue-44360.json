{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "MEMBER",
  "body": "Validation should reject empty TopologyKey when !utilfeature.DefaultFeatureGate.Enabled(features.AffinityInAnnotations) \r\n\r\nWe overlooked this in #41195\r\n\r\nRelevant validation section to modify is here:\r\nhttps://github.com/kubernetes/kubernetes/blob/98a4c6ba7f879a6c608575291566c910c0b50ef4/pkg/api/validation/validation.go#L2222\r\n\r\nNote that the current \"allowEmptyTopologyKey\" in the validation code is totally unrelated, and is enforcing that you can only have empty topology key with preferred scheduling, not required scheduling. We shouldn't change that.\r\n\r\n(https://github.com/kubernetes/kubernetes/blob/e58d3dbf062e9e75c3517a26310fbfc98cf9167c/plugin/pkg/scheduler/algorithm/priorities/util/topologies.go#L81 is the function where the topologyKey is used)\r\n\r\n@aveshagarwal do you think you could fix this? Should be easy.\r\n\r\ncc/ @wojtek-t  @kubernetes/sig-scheduling-bugs ",
  "closed_at": "2017-04-14T08:23:19Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/13653959?v=4",
    "events_url": "https://api.github.com/users/k8s-github-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-github-robot/followers",
    "following_url": "https://api.github.com/users/k8s-github-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-github-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-github-robot",
    "id": 13653959,
    "login": "k8s-github-robot",
    "node_id": "MDQ6VXNlcjEzNjUzOTU5",
    "organizations_url": "https://api.github.com/users/k8s-github-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-github-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-github-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-github-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-github-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-github-robot"
  },
  "comments": 1,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/44360/comments",
  "created_at": "2017-04-11T20:32:09Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/44360/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/44360",
  "id": 221072046,
  "labels": [
    {
      "color": "e11d21",
      "default": false,
      "description": "Categorizes issue or PR as related to a bug.",
      "id": 105146071,
      "name": "kind/bug",
      "node_id": "MDU6TGFiZWwxMDUxNDYwNzE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/bug"
    },
    {
      "color": "eb6420",
      "default": false,
      "description": "Must be staffed and worked on either currently, or very soon, ideally in time for the next release.",
      "id": 114528223,
      "name": "priority/important-soon",
      "node_id": "MDU6TGFiZWwxMTQ1MjgyMjM=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/priority/important-soon"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Scheduling.",
      "id": 125550211,
      "name": "sig/scheduling",
      "node_id": "MDU6TGFiZWwxMjU1NTAyMTE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/scheduling"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/44360/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUyMjEwNzIwNDY=",
  "number": 44360,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "Validation should reject empty TopologyKey when !utilfeature.DefaultFeatureGate.Enabled(features.AffinityInAnnotations) ",
  "updated_at": "2017-04-14T08:23:19Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/44360",
  "user": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/8264113?v=4",
    "events_url": "https://api.github.com/users/davidopp/events{/privacy}",
    "followers_url": "https://api.github.com/users/davidopp/followers",
    "following_url": "https://api.github.com/users/davidopp/following{/other_user}",
    "gists_url": "https://api.github.com/users/davidopp/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/davidopp",
    "id": 8264113,
    "login": "davidopp",
    "node_id": "MDQ6VXNlcjgyNjQxMTM=",
    "organizations_url": "https://api.github.com/users/davidopp/orgs",
    "received_events_url": "https://api.github.com/users/davidopp/received_events",
    "repos_url": "https://api.github.com/users/davidopp/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/davidopp/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/davidopp/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/davidopp"
  }
}