{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/16105680?v=4",
    "events_url": "https://api.github.com/users/nikhita/events{/privacy}",
    "followers_url": "https://api.github.com/users/nikhita/followers",
    "following_url": "https://api.github.com/users/nikhita/following{/other_user}",
    "gists_url": "https://api.github.com/users/nikhita/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/nikhita",
    "id": 16105680,
    "login": "nikhita",
    "node_id": "MDQ6VXNlcjE2MTA1Njgw",
    "organizations_url": "https://api.github.com/users/nikhita/orgs",
    "received_events_url": "https://api.github.com/users/nikhita/received_events",
    "repos_url": "https://api.github.com/users/nikhita/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/nikhita/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nikhita/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/nikhita"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars0.githubusercontent.com/u/730123?v=4",
      "events_url": "https://api.github.com/users/sttts/events{/privacy}",
      "followers_url": "https://api.github.com/users/sttts/followers",
      "following_url": "https://api.github.com/users/sttts/following{/other_user}",
      "gists_url": "https://api.github.com/users/sttts/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/sttts",
      "id": 730123,
      "login": "sttts",
      "node_id": "MDQ6VXNlcjczMDEyMw==",
      "organizations_url": "https://api.github.com/users/sttts/orgs",
      "received_events_url": "https://api.github.com/users/sttts/received_events",
      "repos_url": "https://api.github.com/users/sttts/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/sttts/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sttts/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/sttts"
    },
    {
      "avatar_url": "https://avatars1.githubusercontent.com/u/16105680?v=4",
      "events_url": "https://api.github.com/users/nikhita/events{/privacy}",
      "followers_url": "https://api.github.com/users/nikhita/followers",
      "following_url": "https://api.github.com/users/nikhita/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikhita/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/nikhita",
      "id": 16105680,
      "login": "nikhita",
      "node_id": "MDQ6VXNlcjE2MTA1Njgw",
      "organizations_url": "https://api.github.com/users/nikhita/orgs",
      "received_events_url": "https://api.github.com/users/nikhita/received_events",
      "repos_url": "https://api.github.com/users/nikhita/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/nikhita/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikhita/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/nikhita"
    }
  ],
  "author_association": "MEMBER",
  "body": "/kind bug\r\n/sig api-machinery\r\n/assign @sttts @nikhita \r\n\r\n1. Create a CRD\r\n2. Create a custom resource with a finalizer\r\n3. Delete the custom resource, leaving it pending finalization\r\n4. Delete the CRD, leaving it pending InstanceDeletionInProgress\r\n\r\nAs soon as the CRD enters InstanceDeletionInProgress, writes to custom resource objects are disallowed.\r\n\r\nThat means the finalizer cannot be removed, and the custom resource cannot be deleted, which blocks deletion of the CRD.\r\n\r\n\r\ncrd.yaml:\r\n```yaml\r\napiVersion: apiextensions.k8s.io/v1beta1 \r\nkind: CustomResourceDefinition\r\nmetadata:\r\n  name: crontabs.stable.example.com \r\nspec:\r\n  group: stable.example.com \r\n  version: v1 \r\n  scope: Namespaced \r\n  names:\r\n    plural: crontabs \r\n    singular: crontab \r\n    kind: CronTab \r\n    shortNames:\r\n    - ct \r\n---\r\napiVersion: \"stable.example.com/v1\" \r\nkind: CronTab \r\nmetadata:\r\n  name: my-new-cron-object \r\n  finalizers:\r\n  - foo.bar.baz\r\nspec: \r\n  cronSpec: \"* * * * /5\"\r\n  image: my-awesome-cron-image\r\n```\r\n\r\n```sh\r\nkubectl create -f crd.yaml\r\ncustomresourcedefinition.apiextensions.k8s.io \"crontabs.stable.example.com\" created\r\ncrontab.stable.example.com \"my-new-cron-object\" created\r\n\r\nkubectl delete -f crd.yaml \r\ncustomresourcedefinition.apiextensions.k8s.io \"crontabs.stable.example.com\" deleted\r\ncrontab.stable.example.com \"my-new-cron-object\" deleted\r\n\r\nkubectl get -f crd.yaml -o yaml\r\napiVersion: v1\r\nitems:\r\n- apiVersion: apiextensions.k8s.io/v1beta1\r\n  kind: CustomResourceDefinition\r\n  metadata:\r\n    creationTimestamp: 2018-02-28T02:38:07Z\r\n    deletionTimestamp: 2018-02-28T02:38:19Z\r\n    finalizers:\r\n    - customresourcecleanup.apiextensions.k8s.io\r\n    generation: 1\r\n    name: crontabs.stable.example.com\r\n    namespace: \"\"\r\n    resourceVersion: \"1562\"\r\n    selfLink: /apis/apiextensions.k8s.io/v1beta1/customresourcedefinitions/crontabs.stable.example.com\r\n    uid: 6877df14-1c30-11e8-9148-acbc32c1ca87\r\n  spec:\r\n    group: stable.example.com\r\n    names:\r\n      kind: CronTab\r\n      listKind: CronTabList\r\n      plural: crontabs\r\n      shortNames:\r\n      - ct\r\n      singular: crontab\r\n    scope: Namespaced\r\n    version: v1\r\n  status:\r\n    acceptedNames:\r\n      kind: CronTab\r\n      listKind: CronTabList\r\n      plural: crontabs\r\n      shortNames:\r\n      - ct\r\n      singular: crontab\r\n    conditions:\r\n    - lastTransitionTime: 2018-02-28T02:38:07Z\r\n      message: no conflicts found\r\n      reason: NoConflicts\r\n      status: \"True\"\r\n      type: NamesAccepted\r\n    - lastTransitionTime: 2018-02-28T02:38:07Z\r\n      message: the initial names have been accepted\r\n      reason: InitialNamesAccepted\r\n      status: \"True\"\r\n      type: Established\r\n    - lastTransitionTime: 2018-02-28T02:38:19Z\r\n      message: CustomResource deletion is in progress\r\n      reason: InstanceDeletionInProgress\r\n      status: \"True\"\r\n      type: Terminating\r\n- apiVersion: stable.example.com/v1\r\n  kind: CronTab\r\n  metadata:\r\n    clusterName: \"\"\r\n    creationTimestamp: 2018-02-28T02:38:07Z\r\n    deletionGracePeriodSeconds: 0\r\n    deletionTimestamp: 2018-02-28T02:38:19Z\r\n    finalizers:\r\n    - foo.bar.baz\r\n    generation: 2\r\n    name: my-new-cron-object\r\n    namespace: default\r\n    resourceVersion: \"1563\"\r\n    selfLink: /apis/stable.example.com/v1/namespaces/default/crontabs/my-new-cron-object\r\n    uid: 687ac990-1c30-11e8-9148-acbc32c1ca87\r\n  spec:\r\n    cronSpec: '* * * * /5'\r\n    image: my-awesome-cron-image\r\nkind: List\r\nmetadata:\r\n  resourceVersion: \"\"\r\n  selfLink: \"\"\r\n\r\nkubectl patch crontab/my-new-cron-object -p '{\"metadata\":{\"finalizers\":[]}}' --type=merge\r\nError from server (MethodNotAllowed): the server does not allow this method on the requested resource (patch crontabs.stable.example.com my-new-cron-object)\r\n```",
  "closed_at": "2018-03-01T19:42:45Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/13653959?v=4",
    "events_url": "https://api.github.com/users/k8s-github-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-github-robot/followers",
    "following_url": "https://api.github.com/users/k8s-github-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-github-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-github-robot",
    "id": 13653959,
    "login": "k8s-github-robot",
    "node_id": "MDQ6VXNlcjEzNjUzOTU5",
    "organizations_url": "https://api.github.com/users/k8s-github-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-github-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-github-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-github-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-github-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-github-robot"
  },
  "comments": 9,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/60538/comments",
  "created_at": "2018-02-28T02:20:42Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/60538/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/60538",
  "id": 300866194,
  "labels": [
    {
      "color": "0052cc",
      "default": false,
      "description": null,
      "id": 556590057,
      "name": "area/custom-resources",
      "node_id": "MDU6TGFiZWw1NTY1OTAwNTc=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/area/custom-resources"
    },
    {
      "color": "e11d21",
      "default": false,
      "description": "Categorizes issue or PR as related to a bug.",
      "id": 105146071,
      "name": "kind/bug",
      "node_id": "MDU6TGFiZWwxMDUxNDYwNzE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/bug"
    },
    {
      "color": "e11d21",
      "default": false,
      "description": "Highest priority. Must be actively worked on as someone's top priority right now.",
      "id": 114528068,
      "name": "priority/critical-urgent",
      "node_id": "MDU6TGFiZWwxMTQ1MjgwNjg=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/priority/critical-urgent"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG API Machinery.",
      "id": 173493835,
      "name": "sig/api-machinery",
      "node_id": "MDU6TGFiZWwxNzM0OTM4MzU=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/api-machinery"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/60538/labels{/name}",
  "locked": false,
  "milestone": {
    "closed_at": "2019-08-26T17:23:39Z",
    "closed_issues": 641,
    "created_at": "2017-07-24T18:50:54Z",
    "creator": {
      "avatar_url": "https://avatars1.githubusercontent.com/u/903617?v=4",
      "events_url": "https://api.github.com/users/mtaufen/events{/privacy}",
      "followers_url": "https://api.github.com/users/mtaufen/followers",
      "following_url": "https://api.github.com/users/mtaufen/following{/other_user}",
      "gists_url": "https://api.github.com/users/mtaufen/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mtaufen",
      "id": 903617,
      "login": "mtaufen",
      "node_id": "MDQ6VXNlcjkwMzYxNw==",
      "organizations_url": "https://api.github.com/users/mtaufen/orgs",
      "received_events_url": "https://api.github.com/users/mtaufen/received_events",
      "repos_url": "https://api.github.com/users/mtaufen/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mtaufen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mtaufen/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mtaufen"
    },
    "description": "",
    "due_on": "2018-03-26T07:00:00Z",
    "html_url": "https://github.com/kubernetes/kubernetes/milestone/37",
    "id": 2659046,
    "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/milestones/37/labels",
    "node_id": "MDk6TWlsZXN0b25lMjY1OTA0Ng==",
    "number": 37,
    "open_issues": 0,
    "state": "closed",
    "title": "v1.10",
    "updated_at": "2019-08-26T17:23:39Z",
    "url": "https://api.github.com/repos/kubernetes/kubernetes/milestones/37"
  },
  "node_id": "MDU6SXNzdWUzMDA4NjYxOTQ=",
  "number": 60538,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "Custom resources with finalizers can \"deadlock\" customresourcecleanup.apiextensions.k8s.io finalizer",
  "updated_at": "2020-08-25T21:29:32Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/60538",
  "user": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/980082?v=4",
    "events_url": "https://api.github.com/users/liggitt/events{/privacy}",
    "followers_url": "https://api.github.com/users/liggitt/followers",
    "following_url": "https://api.github.com/users/liggitt/following{/other_user}",
    "gists_url": "https://api.github.com/users/liggitt/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/liggitt",
    "id": 980082,
    "login": "liggitt",
    "node_id": "MDQ6VXNlcjk4MDA4Mg==",
    "organizations_url": "https://api.github.com/users/liggitt/orgs",
    "received_events_url": "https://api.github.com/users/liggitt/received_events",
    "repos_url": "https://api.github.com/users/liggitt/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/liggitt/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/liggitt/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/liggitt"
  }
}