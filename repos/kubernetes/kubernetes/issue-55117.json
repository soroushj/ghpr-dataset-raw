{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "MEMBER",
  "body": "/kind bug\r\ncc @kubernetes/sig-scheduling-bugs \r\n\r\n**What happened**: Running one scheduling predicates conformance test on a 1.7.10 cluster where node names are FQDN, e.g. kube-node-0.kubernetes.mesos, fails.\r\n\r\n```\r\n[21:36:48][Step 4/8] \u2022 Failure [83.160 seconds]\r\n[21:36:48][Step 4/8] [k8s.io] SchedulerPredicates [Serial]\r\n[21:36:48][Step 4/8] /pkg/src/k8s.io/kubernetes/_output/local/go/src/k8s.io/kubernetes/test/e2e/framework/framework.go:619\r\n[21:36:48][Step 4/8]   validates resource limits of pods that are allowed to run [Conformance] [It]\r\n[21:36:48][Step 4/8]   /pkg/src/k8s.io/kubernetes/_output/local/go/src/k8s.io/kubernetes/test/e2e/scheduling/predicates.go:160\r\n[21:36:48][Step 4/8] \r\n[21:36:48][Step 4/8]   Expected error:\r\n[21:36:48][Step 4/8]       <*errors.StatusError | 0xc42022bb80>: {\r\n[21:36:48][Step 4/8]           ErrStatus: {\r\n[21:36:48][Step 4/8]               TypeMeta: {Kind: \"\", APIVersion: \"\"},\r\n[21:36:48][Step 4/8]               ListMeta: {SelfLink: \"\", ResourceVersion: \"\"},\r\n[21:36:48][Step 4/8]               Status: \"Failure\",\r\n[21:36:48][Step 4/8]               Message: \"Pod \\\"filler-pod-kube-node-5-kubelet.kubernetes.mesos\\\" is invalid: spec.containers[0].name: Invalid value: \\\"filler-pod-kube-node-5-kubelet.kubernetes.mesos\\\": a DNS-1123 label must consist of lower case alphanumeric characters or '-', and must start and end with an alphanumeric character (e.g. 'my-name',  or '123-abc', regex used for validation is '[a-z0-9]([-a-z0-9]*[a-z0-9])?')\",\r\n[21:36:48][Step 4/8]               Reason: \"Invalid\",\r\n[21:36:48][Step 4/8]               Details: {\r\n[21:36:48][Step 4/8]                   Name: \"filler-pod-kube-node-5-kubelet.kubernetes.mesos\",\r\n[21:36:48][Step 4/8]                   Group: \"\",\r\n[21:36:48][Step 4/8]                   Kind: \"Pod\",\r\n[21:36:48][Step 4/8]                   UID: \"\",\r\n[21:36:48][Step 4/8]                   Causes: [\r\n[21:36:48][Step 4/8]                       {\r\n[21:36:48][Step 4/8]                           Type: \"FieldValueInvalid\",\r\n[21:36:48][Step 4/8]                           Message: \"Invalid value: \\\"filler-pod-kube-node-5-kubelet.kubernetes.mesos\\\": a DNS-1123 label must consist of lower case alphanumeric characters or '-', and must start and end with an alphanumeric character (e.g. 'my-name',  or '123-abc', regex used for validation is '[a-z0-9]([-a-z0-9]*[a-z0-9])?')\",\r\n[21:36:48][Step 4/8]                           Field: \"spec.containers[0].name\",\r\n[21:36:48][Step 4/8]                       },\r\n[21:36:48][Step 4/8]                   ],\r\n[21:36:48][Step 4/8]                   RetryAfterSeconds: 0,\r\n[21:36:48][Step 4/8]               },\r\n[21:36:48][Step 4/8]               Code: 422,\r\n[21:36:48][Step 4/8]           },\r\n[21:36:48][Step 4/8]       }\r\n[21:36:48][Step 4/8]       Pod \"filler-pod-kube-node-5-kubelet.kubernetes.mesos\" is invalid: spec.containers[0].name: Invalid value: \"filler-pod-kube-node-5-kubelet.kubernetes.mesos\": a DNS-1123 label must consist of lower case alphanumeric characters or '-', and must start and end with an alphanumeric character (e.g. 'my-name',  or '123-abc', regex used for validation is '[a-z0-9]([-a-z0-9]*[a-z0-9])?')\r\n[21:36:48][Step 4/8]   not to have occurred\r\n[21:36:48][Step 4/8] \r\n[21:36:48][Step 4/8]   /pkg/src/k8s.io/kubernetes/_output/local/go/src/k8s.io/kubernetes/test/e2e/scheduling/predicates.go:807\r\n```\r\n\r\n**What you expected to happen**: The tests should pass.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nFollow [these instructions to deploy Kubernetes 1.7.10 on DC/OS](https://github.com/mesosphere/dcos-kubernetes-quickstart#quickstart) or bootstrap a Kubernetes cluster where nodes names are FQDN, e.g. my-node-1.example.com.\r\n\r\n**Anything else we need to know?**:\r\n\r\nAlso affects master but not 1.8.x.\r\n\r\n**Environment**:\r\n- Kubernetes version (use `kubectl version`):\r\n```\r\n$ kubectl version\r\nClient Version: version.Info{Major:\"1\", Minor:\"7\", GitVersion:\"v1.7.5\", GitCommit:\"17d7182a7ccbb167074be7a87f0a68bd00d58d97\", GitTreeState:\"clean\", BuildDate:\"2017-08-31T09:14:02Z\", GoVersion:\"go1.8.3\", Compiler:\"gc\", Platform:\"darwin/amd64\"}\r\nServer Version: version.Info{Major:\"1\", Minor:\"7\", GitVersion:\"v1.7.10\", GitCommit:\"bebdeb749f1fa3da9e1312c4b08e439c404b3136\", GitTreeState:\"clean\", BuildDate:\"2017-11-03T16:31:49Z\", GoVersion:\"go1.8.3\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\n```\r\n- Cloud provider or hardware configuration: GCP\r\n- OS (e.g. from /etc/os-release):\r\n```\r\n$ cat /etc/lsb-release\r\nDISTRIB_ID=\"Container Linux by CoreOS\"\r\nDISTRIB_RELEASE=1465.6.0\r\nDISTRIB_CODENAME=\"Ladybug\"\r\nDISTRIB_DESCRIPTION=\"Container Linux by CoreOS 1465.6.0 (Ladybug)\"\r\n```\r\n- Kernel (e.g. `uname -a`): \r\n```\r\n$ uname -a\r\nLinux pires-aa53f593-private-agents-ff9n.c.massive-bliss-781.internal 4.12.7-coreos #1 SMP Tue Aug 15 23:54:56 UTC 2017 x86_64 Intel(R) Xeon(R) CPU @ 2.30GHz GenuineIntel GNU/Linux\r\n```\r\n- Install tools: [Kubernetes 1.7.10 on DC/OS](https://github.com/mesosphere/dcos-kubernetes-quickstart#quickstart)\r\n- Others: none\r\n",
  "closed_at": "2017-11-06T13:46:10Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/13653959?v=4",
    "events_url": "https://api.github.com/users/k8s-github-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-github-robot/followers",
    "following_url": "https://api.github.com/users/k8s-github-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-github-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-github-robot",
    "id": 13653959,
    "login": "k8s-github-robot",
    "node_id": "MDQ6VXNlcjEzNjUzOTU5",
    "organizations_url": "https://api.github.com/users/k8s-github-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-github-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-github-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-github-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-github-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-github-robot"
  },
  "comments": 1,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/55117/comments",
  "created_at": "2017-11-05T12:12:58Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/55117/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/55117",
  "id": 271271917,
  "labels": [
    {
      "color": "e11d21",
      "default": false,
      "description": "Categorizes issue or PR as related to a bug.",
      "id": 105146071,
      "name": "kind/bug",
      "node_id": "MDU6TGFiZWwxMDUxNDYwNzE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/bug"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Scheduling.",
      "id": 125550211,
      "name": "sig/scheduling",
      "node_id": "MDU6TGFiZWwxMjU1NTAyMTE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/scheduling"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/55117/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUyNzEyNzE5MTc=",
  "number": 55117,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "Scheduler predicates test that may violate DNS label rules",
  "updated_at": "2017-11-06T13:46:10Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/55117",
  "user": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/1752631?v=4",
    "events_url": "https://api.github.com/users/pires/events{/privacy}",
    "followers_url": "https://api.github.com/users/pires/followers",
    "following_url": "https://api.github.com/users/pires/following{/other_user}",
    "gists_url": "https://api.github.com/users/pires/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/pires",
    "id": 1752631,
    "login": "pires",
    "node_id": "MDQ6VXNlcjE3NTI2MzE=",
    "organizations_url": "https://api.github.com/users/pires/orgs",
    "received_events_url": "https://api.github.com/users/pires/received_events",
    "repos_url": "https://api.github.com/users/pires/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/pires/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/pires/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/pires"
  }
}