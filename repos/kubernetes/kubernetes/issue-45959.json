{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "CONTRIBUTOR",
  "body": "<!-- Thanks for filing an issue! Before hitting the button, please answer these questions.-->\r\n\r\n**Is this a request for help?** (If yes, you should use our troubleshooting guide and community support channels, see http://kubernetes.io/docs/troubleshooting/.):\r\nNo\r\n\r\n**What keywords did you search in Kubernetes issues before filing this one?** (If you have found any duplicates, you should instead reply there.):\r\n\r\n---\r\n\r\n**Is this a BUG REPORT or FEATURE REQUEST?** (choose one):\r\nBUG\r\n<!--\r\nIf this is a BUG REPORT, please:\r\n  - Fill in as much of the template below as you can.  If you leave out\r\n    information, we can't help you as well.\r\n\r\nIf this is a FEATURE REQUEST, please:\r\n  - Describe *in detail* the feature/behavior/change you'd like to see.\r\n\r\nIn both cases, be ready for followup questions, and please respond in a timely\r\nmanner.  If we can't reproduce a bug or think a feature already exists, we\r\nmight close your issue.  If we're wrong, PLEASE feel free to reopen it and\r\nexplain why.\r\n-->\r\n\r\n**Kubernetes version** (use `kubectl version`):\r\n1.6.3\r\n\r\n**Environment**:\r\n- **Cloud provider or hardware configuration**:\r\n- **OS** (e.g. from /etc/os-release):\r\n- **Kernel** (e.g. `uname -a`):\r\n- **Install tools**:\r\n- **Others**:\r\n\r\n\r\n**What happened**:\r\nAll of the salt scripts bundled in kubernetes (for example, https://github.com/kubernetes/kubernetes/blob/master/cluster/saltbase/salt/kube-apiserver/kube-apiserver.manifest) start up the component in a broken way. They use `/bin/sh -c` which means the shell will intercept all signals. So these daemons are not gracefully shutdown when the pod is stopped.\r\n\r\nThis causes serious problems since when apiserver is killed abruptly it doesn't seem to close watches correctly. This was observed in https://github.com/kubernetes/kubernetes/issues/41916 for example.\r\n\r\n**What you expected to happen**:\r\n\r\nRunning `/bin/sh -c` is incorrect. It should run the binary directly. Otherwise, it needs to perform an `exec` so the binary correctly replaces the shell script process.\r\n\r\n**How to reproduce it** (as minimally and precisely as possible):\r\nRun kube-apiserver inside a container with `/bin/sh -c` and try to stop it. You can't - eventually docker will force kill it.\r\n\r\n**Anything else we need to know**:\r\n\r\n",
  "closed_at": "2018-01-03T10:25:42Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/13653959?v=4",
    "events_url": "https://api.github.com/users/k8s-github-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-github-robot/followers",
    "following_url": "https://api.github.com/users/k8s-github-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-github-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-github-robot",
    "id": 13653959,
    "login": "k8s-github-robot",
    "node_id": "MDQ6VXNlcjEzNjUzOTU5",
    "organizations_url": "https://api.github.com/users/k8s-github-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-github-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-github-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-github-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-github-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-github-robot"
  },
  "comments": 4,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/45959/comments",
  "created_at": "2017-05-17T12:45:11Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/45959/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/45959",
  "id": 229339607,
  "labels": [
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Cluster Lifecycle.",
      "id": 173494222,
      "name": "sig/cluster-lifecycle",
      "node_id": "MDU6TGFiZWwxNzM0OTQyMjI=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/cluster-lifecycle"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/45959/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUyMjkzMzk2MDc=",
  "number": 45959,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "salt manifests for kube components breaks graceful termination",
  "updated_at": "2018-01-03T10:25:42Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/45959",
  "user": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/522123?v=4",
    "events_url": "https://api.github.com/users/jsravn/events{/privacy}",
    "followers_url": "https://api.github.com/users/jsravn/followers",
    "following_url": "https://api.github.com/users/jsravn/following{/other_user}",
    "gists_url": "https://api.github.com/users/jsravn/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/jsravn",
    "id": 522123,
    "login": "jsravn",
    "node_id": "MDQ6VXNlcjUyMjEyMw==",
    "organizations_url": "https://api.github.com/users/jsravn/orgs",
    "received_events_url": "https://api.github.com/users/jsravn/received_events",
    "repos_url": "https://api.github.com/users/jsravn/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/jsravn/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jsravn/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/jsravn"
  }
}