{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/1929644?v=4",
    "events_url": "https://api.github.com/users/apelisse/events{/privacy}",
    "followers_url": "https://api.github.com/users/apelisse/followers",
    "following_url": "https://api.github.com/users/apelisse/following{/other_user}",
    "gists_url": "https://api.github.com/users/apelisse/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/apelisse",
    "id": 1929644,
    "login": "apelisse",
    "node_id": "MDQ6VXNlcjE5Mjk2NDQ=",
    "organizations_url": "https://api.github.com/users/apelisse/orgs",
    "received_events_url": "https://api.github.com/users/apelisse/received_events",
    "repos_url": "https://api.github.com/users/apelisse/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/apelisse/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/apelisse/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/apelisse"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars0.githubusercontent.com/u/1929644?v=4",
      "events_url": "https://api.github.com/users/apelisse/events{/privacy}",
      "followers_url": "https://api.github.com/users/apelisse/followers",
      "following_url": "https://api.github.com/users/apelisse/following{/other_user}",
      "gists_url": "https://api.github.com/users/apelisse/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apelisse",
      "id": 1929644,
      "login": "apelisse",
      "node_id": "MDQ6VXNlcjE5Mjk2NDQ=",
      "organizations_url": "https://api.github.com/users/apelisse/orgs",
      "received_events_url": "https://api.github.com/users/apelisse/received_events",
      "repos_url": "https://api.github.com/users/apelisse/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/apelisse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/apelisse/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/apelisse"
    }
  ],
  "author_association": "NONE",
  "body": "**What happened**:\r\nI tried to apply the same statefulset twice and on the second apply, the api reported a validation error.\r\n\r\n**What you expected to happen**:\r\nI would expect that the same statefulset should apply successfully or fail consistently any number of times.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nApply this stateful set twice.\r\n```yaml\r\napiVersion: apps/v1\r\nkind: StatefulSet\r\nmetadata:\r\n  name: web\r\nspec:\r\n  selector:\r\n    matchLabels:\r\n      app: nginx # has to match .spec.template.metadata.labels\r\n  serviceName: \"nginx\"\r\n  replicas: 3 # by default is 1\r\n  template:\r\n    metadata:\r\n      labels:\r\n        app: nginx # has to match .spec.selector.matchLabels\r\n    spec:\r\n      terminationGracePeriodSeconds: 10\r\n      containers:\r\n      - name: nginx\r\n        image: k8s.gcr.io/nginx-slim:0.8\r\n        ports:\r\n        - containerPort: 80\r\n          name: web\r\n        volumeMounts:\r\n        - name: www\r\n          mountPath: /usr/share/nginx/html\r\n  volumeClaimTemplates:\r\n  - apiVersion: v1\r\n    kind: PersistentVolumeClaim\r\n    metadata:\r\n      name: www\r\n    spec:\r\n      accessModes: [ \"ReadWriteOnce\" ]\r\n      storageClassName: \"my-storage-class\"\r\n      resources:\r\n        requests:\r\n          storage: 1Gi\r\n```\r\n\r\nThe second attempt with fail.\r\n```\r\nThe StatefulSet \"web\" is invalid: spec: Forbidden: updates to statefulset spec for fields other than 'replicas', 'template', and 'updateStrategy' are forbidden\r\n```\r\n\r\n**Anything else we need to know?**:\r\nThe cause of this appears to be the combination of the api server removing the `apiVersion` and `kind` fields from the applied configuration, and the api server performing validation to see that nothing has changed in the config.  The same issue does not appear in kubernetes v1.16 because even though the `apiVersion` and `kind` fields are removed, the validation is not performed.\r\n\r\n**Environment**:\r\n- Kubernetes version (use `kubectl version`):\r\n\r\nClient Version: version.Info{Major:\"1\", Minor:\"16\", GitVersion:\"v1.16.0\", GitCommit:\"2bd9643cee5b3b3a5ecbd3af49d09018f0773c77\", GitTreeState:\"clean\", BuildDate:\"2019-09-18T14:36:53Z\", GoVersion:\"go1.12.9\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\nServer Version: version.Info{Major:\"1\", Minor:\"17\", GitVersion:\"v1.17.0\", GitCommit:\"70132b0f130acc0bed193d9ba59dd186f0e634cf\", GitTreeState:\"clean\", BuildDate:\"2020-01-14T00:09:19Z\", GoVersion:\"go1.13.4\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\n\r\n",
  "closed_at": "2020-02-01T04:08:17Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/20407524?v=4",
    "events_url": "https://api.github.com/users/k8s-ci-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-ci-robot/followers",
    "following_url": "https://api.github.com/users/k8s-ci-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-ci-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-ci-robot",
    "id": 20407524,
    "login": "k8s-ci-robot",
    "node_id": "MDQ6VXNlcjIwNDA3NTI0",
    "organizations_url": "https://api.github.com/users/k8s-ci-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-ci-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-ci-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-ci-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-ci-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-ci-robot"
  },
  "comments": 11,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/87583/comments",
  "created_at": "2020-01-27T21:47:49Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/87583/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/87583",
  "id": 555853511,
  "labels": [
    {
      "color": "e11d21",
      "default": false,
      "description": "Categorizes issue or PR as related to a bug.",
      "id": 105146071,
      "name": "kind/bug",
      "node_id": "MDU6TGFiZWwxMDUxNDYwNzE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/bug"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Apps.",
      "id": 404091735,
      "name": "sig/apps",
      "node_id": "MDU6TGFiZWw0MDQwOTE3MzU=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/apps"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/87583/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU1NTU4NTM1MTE=",
  "number": 87583,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "unable to reapply statefulset with volumeClaimTemplate/apiVersion",
  "updated_at": "2020-02-01T04:08:17Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/87583",
  "user": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/156120?v=4",
    "events_url": "https://api.github.com/users/pgier/events{/privacy}",
    "followers_url": "https://api.github.com/users/pgier/followers",
    "following_url": "https://api.github.com/users/pgier/following{/other_user}",
    "gists_url": "https://api.github.com/users/pgier/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/pgier",
    "id": 156120,
    "login": "pgier",
    "node_id": "MDQ6VXNlcjE1NjEyMA==",
    "organizations_url": "https://api.github.com/users/pgier/orgs",
    "received_events_url": "https://api.github.com/users/pgier/received_events",
    "repos_url": "https://api.github.com/users/pgier/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/pgier/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/pgier/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/pgier"
  }
}