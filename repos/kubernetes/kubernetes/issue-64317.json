{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "MEMBER",
  "body": "/kind bug\r\n/sig openstack\r\n\r\n**What happened**:\r\nI observed a strange behaviour regarding LBaaS when creating a service and having nodes in the cluster that have no valid IP address configured. While it is expected, that no Loadbalancer can be created in such a situation, the error message that popped up in the controller was rather unhelpful:\r\n```\r\nerror creating LB pool member for node: <node_name>, Invalid request due to incorrect syntax or missing required parameters.\r\n```\r\n\r\nThe OpenStack logs showed the actual problem:\r\n```\r\ncreate failed (client error): Invalid input for address. Reason: '<node_hostname>' is not a valid IP address.\r\n```\r\n\r\nInvestigation of the [relevant code](https://github.com/kubernetes/kubernetes/blob/master/pkg/cloudprovider/providers/openstack/openstack_loadbalancer.go#L492)  revealed the issue here: Since the node had no valid IP address configured, the function returned the first address listed for the node, which was the hostname in this case. Of course, LBaaS can't create  a pool member based on the hostname of the node.\r\n\r\n**What you expected to happen**:\r\nInstead of logging a unhelpful message like `Invalid request due to incorrect syntax or missing required parameters`, the cloud provider should say what the actual issue was: No valid address could be found.\r\n\r\n**Anything else we need to know?**:\r\nJust to be clear: The node in this case had a working IP address & network configuration. Due to a botched Nova config change and [this issue](https://bugs.launchpad.net/nova/+bug/1751923), nova did no longer report the IP addresses of nodes.\r\nBecause of this, the node_controller removed all IP addresses from the node status.\r\nThis is of course expected, but a better error message might have helped to find the root cause of our issues faster.\r\n\r\n**Environment**:\r\n- Kubernetes version (use `kubectl version`): 1.10, but also applies to older versions\r\n- Cloud provider or hardware configuration: OpenStack\r\n",
  "closed_at": "2018-05-30T18:25:12Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/13653959?v=4",
    "events_url": "https://api.github.com/users/k8s-github-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-github-robot/followers",
    "following_url": "https://api.github.com/users/k8s-github-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-github-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-github-robot",
    "id": 13653959,
    "login": "k8s-github-robot",
    "node_id": "MDQ6VXNlcjEzNjUzOTU5",
    "organizations_url": "https://api.github.com/users/k8s-github-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-github-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-github-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-github-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-github-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-github-robot"
  },
  "comments": 0,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/64317/comments",
  "created_at": "2018-05-25T14:33:58Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/64317/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/64317",
  "id": 326548777,
  "labels": [
    {
      "color": "0052cc",
      "default": false,
      "description": "Issues or PRs related to openstack provider",
      "id": 239914558,
      "name": "area/provider/openstack",
      "node_id": "MDU6TGFiZWwyMzk5MTQ1NTg=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/area/provider/openstack"
    },
    {
      "color": "e11d21",
      "default": false,
      "description": "Categorizes issue or PR as related to a bug.",
      "id": 105146071,
      "name": "kind/bug",
      "node_id": "MDU6TGFiZWwxMDUxNDYwNzE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/bug"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/64317/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUzMjY1NDg3Nzc=",
  "number": 64317,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "Only IPs should be used as node addresses for OpenStack LBs",
  "updated_at": "2018-05-30T18:25:12Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/64317",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/3019505?v=4",
    "events_url": "https://api.github.com/users/gonzolino/events{/privacy}",
    "followers_url": "https://api.github.com/users/gonzolino/followers",
    "following_url": "https://api.github.com/users/gonzolino/following{/other_user}",
    "gists_url": "https://api.github.com/users/gonzolino/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/gonzolino",
    "id": 3019505,
    "login": "gonzolino",
    "node_id": "MDQ6VXNlcjMwMTk1MDU=",
    "organizations_url": "https://api.github.com/users/gonzolino/orgs",
    "received_events_url": "https://api.github.com/users/gonzolino/received_events",
    "repos_url": "https://api.github.com/users/gonzolino/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/gonzolino/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gonzolino/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/gonzolino"
  }
}