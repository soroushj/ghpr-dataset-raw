{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "CONTRIBUTOR",
  "body": "From a user:\n\nI'm trying to expose multiple services on the same port in a GKE Kubernetes 0.8.1 cluster. My question is similar to this SO post but it is not solved by 0.5.x+\n\nI've deployed a service (hellogo) with an external load balancer which works correctly. Deploying another service (pynote) which is extremely similar fails\n\n{\n    \"apiVersion\": \"v1beta1\",\n    \"kind\": \"Service\",\n    \"id\": \"pynote-service\",\n    \"selector\": {\n        \"name\": \"pynote\"\n    },\n    \"containerPort\": 8080,\n    \"protocol\": \"TCP\",\n    \"port\": 80,\n    \"createExternalLoadBalancer\": true\n}\n\ngcloud preview container services --cluster athena --zone $ZONE create --config-file pynote-service.json\nERROR: F0124 19:42:27.683068   55331 create.go:61] service \"pynote-service\" is invalid: service \"pynote-service\" cannot be updated: port: 80 is already in use\n\nIf I delete the other service and start pynote first, the service and load balancer are setup correctly, but the other service cannot be deployed with the same error.\n\nI believe the current proxying design is that service routing occurs via proxies on every node which are part of the target pool. Every service gets its own IP. Putting up two external services on port 80 on GKE should allocate two load balancers, each with a fixed IP address. This design does not preclude exposing services on the same port as each service is accessed through a separate external IP. Furthermore, Kubernetes itself runs a service (kubernetes-ro) on port 80 which coexists with my first service nicely.\n\nAt the very least, the message is misleading. There is no requirement that the services deployed on a cluster use unique ports. In the source, it becomes apparent that its the external load balancer creation that causes the command to fail. Indeed, I can deploy pynote with createExternalLoadBalancer to false. Happily coexisting:\n\nhellogo-service     <none>                                    name=hellogo        10.143.249.126      80\npynote-service      <none>                                    name=pynote         10.143.254.255      80\n\nI've tried to define my own target pool called pynote-service, selecting all the cluster node instances and created a network load balancer with a forwarding rule on port 80 to the target pool. Despite the fact that it corresponds to the one created automatically for hellogo-service, it does not seem to resolve to the running pynote pod. \n\nThis feels like I'm missing something small, but I've been blocked on this. Perhaps I'll only ever run one lonely web service...\n",
  "closed_at": "2015-01-27T05:15:05Z",
  "closed_by": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/5751682?v=4",
    "events_url": "https://api.github.com/users/brendandburns/events{/privacy}",
    "followers_url": "https://api.github.com/users/brendandburns/followers",
    "following_url": "https://api.github.com/users/brendandburns/following{/other_user}",
    "gists_url": "https://api.github.com/users/brendandburns/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/brendandburns",
    "id": 5751682,
    "login": "brendandburns",
    "node_id": "MDQ6VXNlcjU3NTE2ODI=",
    "organizations_url": "https://api.github.com/users/brendandburns/orgs",
    "received_events_url": "https://api.github.com/users/brendandburns/received_events",
    "repos_url": "https://api.github.com/users/brendandburns/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/brendandburns/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/brendandburns/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/brendandburns"
  },
  "comments": 1,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/3804/comments",
  "created_at": "2015-01-26T19:41:49Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/3804/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/3804",
  "id": 55527441,
  "labels": [
    {
      "color": "e11d21",
      "default": false,
      "description": "Highest priority. Must be actively worked on as someone's top priority right now.",
      "id": 114528068,
      "name": "priority/critical-urgent",
      "node_id": "MDU6TGFiZWwxMTQ1MjgwNjg=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/priority/critical-urgent"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/3804/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU1NTUyNzQ0MQ==",
  "number": 3804,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "Erroneous service port conflicts for external services",
  "updated_at": "2015-08-12T17:35:52Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/3804",
  "user": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/5751682?v=4",
    "events_url": "https://api.github.com/users/brendandburns/events{/privacy}",
    "followers_url": "https://api.github.com/users/brendandburns/followers",
    "following_url": "https://api.github.com/users/brendandburns/following{/other_user}",
    "gists_url": "https://api.github.com/users/brendandburns/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/brendandburns",
    "id": 5751682,
    "login": "brendandburns",
    "node_id": "MDQ6VXNlcjU3NTE2ODI=",
    "organizations_url": "https://api.github.com/users/brendandburns/orgs",
    "received_events_url": "https://api.github.com/users/brendandburns/received_events",
    "repos_url": "https://api.github.com/users/brendandburns/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/brendandburns/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/brendandburns/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/brendandburns"
  }
}