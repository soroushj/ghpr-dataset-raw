{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/100893?v=4",
    "events_url": "https://api.github.com/users/justinsb/events{/privacy}",
    "followers_url": "https://api.github.com/users/justinsb/followers",
    "following_url": "https://api.github.com/users/justinsb/following{/other_user}",
    "gists_url": "https://api.github.com/users/justinsb/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/justinsb",
    "id": 100893,
    "login": "justinsb",
    "node_id": "MDQ6VXNlcjEwMDg5Mw==",
    "organizations_url": "https://api.github.com/users/justinsb/orgs",
    "received_events_url": "https://api.github.com/users/justinsb/received_events",
    "repos_url": "https://api.github.com/users/justinsb/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/justinsb/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/justinsb/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/justinsb"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars2.githubusercontent.com/u/100893?v=4",
      "events_url": "https://api.github.com/users/justinsb/events{/privacy}",
      "followers_url": "https://api.github.com/users/justinsb/followers",
      "following_url": "https://api.github.com/users/justinsb/following{/other_user}",
      "gists_url": "https://api.github.com/users/justinsb/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/justinsb",
      "id": 100893,
      "login": "justinsb",
      "node_id": "MDQ6VXNlcjEwMDg5Mw==",
      "organizations_url": "https://api.github.com/users/justinsb/orgs",
      "received_events_url": "https://api.github.com/users/justinsb/received_events",
      "repos_url": "https://api.github.com/users/justinsb/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/justinsb/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/justinsb/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/justinsb"
    },
    {
      "avatar_url": "https://avatars3.githubusercontent.com/u/19172805?v=4",
      "events_url": "https://api.github.com/users/jingxu97/events{/privacy}",
      "followers_url": "https://api.github.com/users/jingxu97/followers",
      "following_url": "https://api.github.com/users/jingxu97/following{/other_user}",
      "gists_url": "https://api.github.com/users/jingxu97/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jingxu97",
      "id": 19172805,
      "login": "jingxu97",
      "node_id": "MDQ6VXNlcjE5MTcyODA1",
      "organizations_url": "https://api.github.com/users/jingxu97/orgs",
      "received_events_url": "https://api.github.com/users/jingxu97/received_events",
      "repos_url": "https://api.github.com/users/jingxu97/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jingxu97/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jingxu97/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jingxu97"
    }
  ],
  "author_association": "CONTRIBUTOR",
  "body": "**Is this a BUG REPORT or FEATURE REQUEST?** BUG\r\n\r\n<!--\r\nIf this is a BUG REPORT, please:\r\n  - Fill in as much of the template below as you can.  If you leave out\r\n    information, we can't help you as well.\r\n\r\nIf this is a FEATURE REQUEST, please:\r\n  - Describe *in detail* the feature/behavior/change you'd like to see.\r\n\r\nIn both cases, be ready for followup questions, and please respond in a timely\r\nmanner.  If we can't reproduce a bug or think a feature already exists, we\r\nmight close your issue.  If we're wrong, PLEASE feel free to reopen it and\r\nexplain why.\r\n-->\r\n\r\n**Kubernetes version** (use `kubectl version`):\r\n```\r\nServer Version: version.Info{Major:\"1\", Minor:\"4\", GitVersion:\"v1.4.5\", GitCommit:\"5a0a696437ad35c133c0c8493f7e9d22b0f9b81b\", GitTreeState:\"clean\", BuildDate:\"2016-10-29T01:32:42Z\", GoVersion:\"go1.6.3\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\n```\r\n\r\n**Environment**:\r\n- **Cloud provider or hardware configuration**: EC2\r\n- **OS** (e.g. from /etc/os-release):\r\n```\r\nNAME=\"Ubuntu\"\r\nVERSION=\"16.04.1 LTS (Xenial Xerus)\"\r\nID=ubuntu\r\nID_LIKE=debian\r\nPRETTY_NAME=\"Ubuntu 16.04.1 LTS\"\r\nVERSION_ID=\"16.04\"\r\nHOME_URL=\"http://www.ubuntu.com/\"\r\nSUPPORT_URL=\"http://help.ubuntu.com/\"\r\nBUG_REPORT_URL=\"http://bugs.launchpad.net/ubuntu/\"\r\nVERSION_CODENAME=xenial\r\nUBUNTU_CODENAME=xenial\r\n```\r\n- **Kernel** (e.g. `uname -a`): `Linux ip-10-0-33-203.us-west-2.compute.internal 4.4.0-45-generic #66-Ubuntu SMP Wed Oct 19 14:12:37 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux`\r\n- **Install tools**: Custom install via something similar to Kelsey Hightower's guide.\r\n- **Others**: \r\nFlags:\r\nKubelet flags:\r\n```/opt/bin/kubelet\r\n         --allow-privileged=true\r\n         --root-dir=/data/kubelet\r\n         --api-servers=https://kube-master.XXXX:443\r\n         --v=2\r\n         --address=0.0.0.0\r\n         --healthz-bind-address=0.0.0.0\r\n         --healthz-port=10248\r\n         --cloud-provider aws\r\n         --enable-server\r\n         --config=/etc/kubernetes/manifests\r\n         --tls-cert-file=/etc/kubernetes/ssl/worker.pem\r\n         --tls-private-key-file=/etc/kubernetes/ssl/worker-key.pem\r\n         --cluster-dns 10.254.0.10\r\n         --cluster-domain=cluster.local\r\n         --kube-reserved cpu=200m,memory=300M\r\n```\r\n\r\nAPI Server flags:\r\n```\r\n    - --insecure-bind-address=0.0.0.0\r\n    - --bind-address=0.0.0.0\r\n    - --etcd-servers=https://kube-etcd.XXXX:443\r\n    - --etcd-cafile=/etc/kubernetes/ssl/ca.pem\r\n    - --allow-privileged=true\r\n    - --service-cluster-ip-range=10.254.0.0/16\r\n    - --secure-port=443\r\n    - --advertise-address=10.0.41.6\r\n    - --external-hostname=kube-master.XXXX\r\n    - --admission-control=NamespaceLifecycle,LimitRanger,ServiceAccount,DefaultStorageClass,ResourceQuota\r\n    - --runtime-config=batch/v2alpha1\r\n    - --authorization-mode=ABAC\r\n    - --authorization-policy-file=/etc/kubernetes/authorization-policy.jsonl\r\n    - --basic-auth-file=/etc/kubernetes/credentials.csv\r\n    - --enable-swagger-ui=true\r\n    - --tls-cert-file=/etc/kubernetes/ssl/apiserver-full.pem\r\n    - --tls-private-key-file=/etc/kubernetes/ssl/apiserver-key.pem\r\n    - --kubelet-certificate-authority=/etc/kubernetes/ssl/ca.pem\r\n    - --service-account-key-file=/etc/kubernetes/ssl/apiserver-key.pem\r\n    - --logtostderr=true\r\n    - --cloud-provider=aws\r\n```\r\n\r\nController manager flags:\r\n```\r\n    - --master=http://127.0.0.1:8080\r\n    - --service-account-private-key-file=/etc/kubernetes/ssl/apiserver-key.pem\r\n    - --root-ca-file=/etc/kubernetes/ssl/ca.pem\r\n    - --cluster-cidr=10.9.0.0/16\r\n    - --cloud-provider=aws\r\n    - --leader-elect\r\n```\r\n\r\n**What happened**: A pod that was in a crash loop was deleted and recreated by the deployment. The PVC associated failed to detach from the old pod's node.\r\n\r\n\r\n**What you expected to happen**: New pod comes up.\r\n\r\n\r\n**How to reproduce it** (as minimally and precisely as possible): See above. \r\n\r\n\r\n**Anything else do we need to know**:\r\n\r\nHere's some logs from the old node:\r\n```\r\nNov 04 22:43:25 ip-10-0-33-203.us-west-2.compute.internal kubelet[4366]: I1104 22:43:25.084350    4366 reconciler.go:188] UnmountVolume operation started for volume \"kubernetes\r\n.io/aws-ebs/aws://us-west-2c/vol-6c15deef\" (spec.Name: \"buck-cache-storage\") from pod \"3b441063-a2bd-11e6-9a0d-0aabbf7a2a09\" (UID: \"3b441063-a2bd-11e6-9a0d-0aabbf7a2a09\").\r\nNov 04 22:43:25 ip-10-0-33-203.us-west-2.compute.internal kubelet[4366]: I1104 22:43:25.096397    4366 aws_ebs.go:376] Error unmounting dir /data/kubelet/pods/3b441063-a2bd-11e\r\n6-9a0d-0aabbf7a2a09/volumes/kubernetes.io~aws-ebs/pvc-45fdfc74-828c-11e6-a9de-067c5270d429: Unmount failed: exit status 32\r\nNov 04 22:43:25 ip-10-0-33-203.us-west-2.compute.internal kubelet[4366]: Unmounting arguments: /data/kubelet/pods/3b441063-a2bd-11e6-9a0d-0aabbf7a2a09/volumes/kubernetes.io~aws-ebs/pvc-45fdfc74-828c-11e6-a9de-067c5270d429\r\nNov 04 22:43:25 ip-10-0-33-203.us-west-2.compute.internal kubelet[4366]: Output: umount: /data/kubelet/pods/3b441063-a2bd-11e6-9a0d-0aabbf7a2a09/volumes/kubernetes.io~aws-ebs/pvc-45fdfc74-828c-11e6-a9de-067c5270d429: not mounted\r\nNov 04 22:43:25 ip-10-0-33-203.us-west-2.compute.internal kubelet[4366]: E1104 22:43:25.096491    4366 nestedpendingoperations.go:253] Operation for \"\\\"kubernetes.io/aws-ebs/aws://us-west-2c/vol-6c15deef\\\" (\\\"3b441063-a2bd-11e6-9a0d-0aabbf7a2a09\\\")\" failed. No retries permitted until 2016-11-04 22:43:25.596461767 +0000 UTC (durationBeforeRetry 500ms). Error: UnmountVolume.TearDown failed for volume \"kubernetes.io/aws-ebs/aws://us-west-2c/vol-6c15deef\" (volume.spec.Name: \"buck-cache-storage\") pod \"3b441063-a2bd-11e6-9a0d-0aabbf7a2a09\" (UID: \"3b441063-a2bd-11e6-9a0d-0aabbf7a2a09\") with: Unmount failed: exit status 32\r\nNov 04 22:43:25 ip-10-0-33-203.us-west-2.compute.internal kubelet[4366]: Unmounting arguments: /data/kubelet/pods/3b441063-a2bd-11e6-9a0d-0aabbf7a2a09/volumes/kubernetes.io~aws-ebs/pvc-45fdfc74-828c-11e6-a9de-067c5270d429\r\nNov 04 22:43:25 ip-10-0-33-203.us-west-2.compute.internal kubelet[4366]: Output: umount: /data/kubelet/pods/3b441063-a2bd-11e6-9a0d-0aabbf7a2a09/volumes/kubernetes.io~aws-ebs/pvc-45fdfc74-828c-11e6-a9de-067c5270d429: not mounted\r\n...\r\nNov 04 22:43:25 ip-10-0-33-203.us-west-2.compute.internal kubelet[4366]: I1104 22:43:25.184697    4366 reconciler.go:338] UnmountDevice operation started for volume \"kubernetes.io/aws-ebs/vol-6c15deef\" (spec.Name: \"pvc-45fdfc74-828c-11e6-a9de-067c5270d429\")\r\nNov 04 22:43:25 ip-10-0-33-203.us-west-2.compute.internal kubelet[4366]: W1104 22:43:25.186415    4366 mount.go:121] could not determine device for path: \"/data/kubelet/plugins/kubernetes.io/aws-ebs/mounts/vol-6c15deef\"\r\nNov 04 22:43:25 ip-10-0-33-203.us-west-2.compute.internal kubelet[4366]: W1104 22:43:25.186440    4366 util.go:72] Warning: Unmount skipped because path does not exist: /data/kubelet/plugins/kubernetes.io/aws-ebs/mounts/vol-6c15deef\r\nNov 04 22:43:25 ip-10-0-33-203.us-west-2.compute.internal kubelet[4366]: E1104 22:43:25.186479    4366 nestedpendingoperations.go:253] Operation for \"\\\"kubernetes.io/aws-ebs/vol-6c15deef\\\"\" failed. No retries permitted until 2016-11-04 22:43:25.686461707 +0000 UTC (durationBeforeRetry 500ms). Error: UnmountDevice.DeviceOpened failed for volume \"kubernetes.io/aws-ebs/vol-6c15deef\" (spec.Name: \"pvc-45fdfc74-828c-11e6-a9de-067c5270d429\") with: PathIsDevice failed for path \"\": stat : no such file or directory\r\n```\r\n",
  "closed_at": "2016-11-18T23:17:21Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/13653959?v=4",
    "events_url": "https://api.github.com/users/k8s-github-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-github-robot/followers",
    "following_url": "https://api.github.com/users/k8s-github-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-github-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-github-robot",
    "id": 13653959,
    "login": "k8s-github-robot",
    "node_id": "MDQ6VXNlcjEzNjUzOTU5",
    "organizations_url": "https://api.github.com/users/k8s-github-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-github-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-github-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-github-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-github-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-github-robot"
  },
  "comments": 21,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/36269/comments",
  "created_at": "2016-11-04T23:03:43Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/36269/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/36269",
  "id": 187456517,
  "labels": [
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Node.",
      "id": 173493665,
      "name": "sig/node",
      "node_id": "MDU6TGFiZWwxNzM0OTM2NjU=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/node"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Storage.",
      "id": 169428334,
      "name": "sig/storage",
      "node_id": "MDU6TGFiZWwxNjk0MjgzMzQ=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/storage"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/36269/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUxODc0NTY1MTc=",
  "number": 36269,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "EBS volume unmounting is stalling",
  "updated_at": "2016-12-13T23:24:46Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/36269",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/43191?v=4",
    "events_url": "https://api.github.com/users/mikekap/events{/privacy}",
    "followers_url": "https://api.github.com/users/mikekap/followers",
    "following_url": "https://api.github.com/users/mikekap/following{/other_user}",
    "gists_url": "https://api.github.com/users/mikekap/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/mikekap",
    "id": 43191,
    "login": "mikekap",
    "node_id": "MDQ6VXNlcjQzMTkx",
    "organizations_url": "https://api.github.com/users/mikekap/orgs",
    "received_events_url": "https://api.github.com/users/mikekap/received_events",
    "repos_url": "https://api.github.com/users/mikekap/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/mikekap/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mikekap/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/mikekap"
  }
}