{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "CONTRIBUTOR",
  "body": "Since #62565 merged on Friday night, my PR (#62572) has failed several retests of pull-kubernetes-bazel-test. My PR is unrelated to the load balancer so I suspect that #62565 introduced a flake. I see several runs of that test against master that aren't failing, so clearly the test works sometimes (and the original PR passed it several times to before it merged). Perhaps the test harness sometimes runs problem tests in parallel and other times it doesn't.\r\n\r\n**Is this a BUG REPORT or FEATURE REQUEST?**:\r\n/kind bug\r\n\r\n**What happened**:\r\n\r\nMy PR had one good run of pull-kubernetes-bazel-test before #62565 merged, but has failed several times since with no code changes to my PR.\r\n\r\n```\r\nE0415 18:50:24.388907      15 gce_loadbalancer_external.go:461] verifyUserRequestedIP: requested IP \"1.1.1.1\" for LB test-lb is neither static nor assigned to the LB\r\nE0415 18:50:24.391401      15 gce_loadbalancer_external.go:445] verifyUserRequestedIP: requested static IP \"1.1.1.1\" (name: foo) for LB test-lb has network tier Premium, need Standard.\r\nE0415 18:50:24.410287      15 gce_loadbalancer_external.go:75] ensureExternalLoadBalancer(a(/)): Failed to get the desired network tier: unsupported network tier: \"SupremeLuxury\".\r\nE0415 18:50:24.480914      15 gce_healthchecks.go:195] vstring () is not a valid version string: could not parse \"\" as version\r\nE0415 18:50:24.481083      15 gce_instances.go:460] Failed to retrieve instances: []\r\n==================\r\nWARNING: DATA RACE\r\nRead at 0x000002fb6c08 by goroutine 61:\r\n  runtime.convT2E64()\r\n      GOROOT/src/runtime/iface.go:335 +0x0\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce/cloud/mock.convertAndInsertAlphaAddress()\r\n      pkg/cloudprovider/providers/gce/cloud/mock/mock.go:200 +0xc64\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce/cloud/mock.InsertAddressHook()\r\n      pkg/cloudprovider/providers/gce/cloud/mock/mock.go:216 +0x13f\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce/cloud.(*MockAddresses).Insert()\r\n      pkg/cloudprovider/providers/gce/cloud/gen.go:1309 +0xbd2\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce.(*GCECloud).ReserveRegionAddress()\r\n      pkg/cloudprovider/providers/gce/gce_addresses.go:67 +0x1fd\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce.ensureStaticIP()\r\n      pkg/cloudprovider/providers/gce/gce_loadbalancer_external.go:986 +0x803\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce.(*GCECloud).ensureExternalLoadBalancer()\r\n      pkg/cloudprovider/providers/gce/gce_loadbalancer_external.go:148 +0x37c8\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce.(*GCECloud).EnsureLoadBalancer()\r\n      pkg/cloudprovider/providers/gce/gce_loadbalancer.go:149 +0x9dc\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce.TestEnsureLoadBalancerCreatesExternalLb()\r\n      pkg/cloudprovider/providers/gce/gce_loadbalancer_test.go:66 +0x554\r\n  testing.tRunner()\r\n      GOROOT/src/testing/testing.go:777 +0x16d\r\n\r\nPrevious write at 0x000002fb6c08 by goroutine 86:\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce/cloud/mock.convertAndInsertAlphaAddress()\r\n      pkg/cloudprovider/providers/gce/cloud/mock/mock.go:201 +0xd6a\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce/cloud/mock.InsertAddressHook()\r\n      pkg/cloudprovider/providers/gce/cloud/mock/mock.go:216 +0x13f\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce/cloud.(*MockAddresses).Insert()\r\n      pkg/cloudprovider/providers/gce/cloud/gen.go:1309 +0xbd2\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce.(*GCECloud).ReserveRegionAddress()\r\n      pkg/cloudprovider/providers/gce/gce_addresses.go:67 +0x1fd\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce.ensureStaticIP()\r\n      pkg/cloudprovider/providers/gce/gce_loadbalancer_external.go:986 +0x803\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce.(*GCECloud).ensureExternalLoadBalancer()\r\n      pkg/cloudprovider/providers/gce/gce_loadbalancer_external.go:148 +0x37c8\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce.createExternalLoadBalancer()\r\n      pkg/cloudprovider/providers/gce/gce_loadbalancer_external_test.go:277 +0x15e\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce.TestEnsureLoadBalancerDeletedDeletesExternalLb()\r\n      pkg/cloudprovider/providers/gce/gce_loadbalancer_test.go:147 +0x502\r\n  testing.tRunner()\r\n      GOROOT/src/testing/testing.go:777 +0x16d\r\n\r\nGoroutine 61 (running) created at:\r\n  testing.(*T).Run()\r\n      GOROOT/src/testing/testing.go:824 +0x564\r\n  testing.runTests.func1()\r\n      GOROOT/src/testing/testing.go:1063 +0xa4\r\n  testing.tRunner()\r\n      GOROOT/src/testing/testing.go:777 +0x16d\r\n  testing.runTests()\r\n      GOROOT/src/testing/testing.go:1061 +0x4e1\r\n  testing.(*M).Run()\r\n      GOROOT/src/testing/testing.go:978 +0x2cd\r\n  main.main()\r\n      bazel-out/k8-fastbuild/bin/pkg/cloudprovider/providers/gce/linux_amd64_race_stripped/go_default_test~/testmain.go:267 +0x3ad\r\n\r\nGoroutine 86 (running) created at:\r\n  testing.(*T).Run()\r\n      GOROOT/src/testing/testing.go:824 +0x564\r\n  testing.runTests.func1()\r\n      GOROOT/src/testing/testing.go:1063 +0xa4\r\n  testing.tRunner()\r\n      GOROOT/src/testing/testing.go:777 +0x16d\r\n  testing.runTests()\r\n      GOROOT/src/testing/testing.go:1061 +0x4e1\r\n  testing.(*M).Run()\r\n      GOROOT/src/testing/testing.go:978 +0x2cd\r\n  main.main()\r\n      bazel-out/k8-fastbuild/bin/pkg/cloudprovider/providers/gce/linux_amd64_race_stripped/go_default_test~/testmain.go:267 +0x3ad\r\n==================\r\n==================\r\nWARNING: DATA RACE\r\nRead at 0x000002fb6c08 by goroutine 84:\r\n  runtime.convT2E64()\r\n      GOROOT/src/runtime/iface.go:335 +0x0\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce/cloud/mock.convertAndInsertAlphaAddress()\r\n      pkg/cloudprovider/providers/gce/cloud/mock/mock.go:200 +0xc64\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce/cloud/mock.InsertAddressHook()\r\n      pkg/cloudprovider/providers/gce/cloud/mock/mock.go:216 +0x13f\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce/cloud.(*MockAddresses).Insert()\r\n      pkg/cloudprovider/providers/gce/cloud/gen.go:1309 +0xbd2\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce.(*GCECloud).ReserveRegionAddress()\r\n      pkg/cloudprovider/providers/gce/gce_addresses.go:67 +0x1fd\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce.(*addressManager).ensureAddressReservation()\r\n      pkg/cloudprovider/providers/gce/gce_address_manager.go:130 +0x36d\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce.(*addressManager).HoldAddress()\r\n      pkg/cloudprovider/providers/gce/gce_address_manager.go:93 +0x2ec\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce.(*GCECloud).ensureInternalLoadBalancer()\r\n      pkg/cloudprovider/providers/gce/gce_loadbalancer_internal.go:98 +0x1862\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce.createInternalLoadBalancer()\r\n      pkg/cloudprovider/providers/gce/gce_loadbalancer_internal_test.go:41 +0x162\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce.TestEnsureLoadBalancerDeletesExistingInternalLb()\r\n      pkg/cloudprovider/providers/gce/gce_loadbalancer_test.go:102 +0x559\r\n  testing.tRunner()\r\n      GOROOT/src/testing/testing.go:777 +0x16d\r\n\r\nPrevious write at 0x000002fb6c08 by goroutine 60:\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce/cloud/mock.convertAndInsertAlphaAddress()\r\n      pkg/cloudprovider/providers/gce/cloud/mock/mock.go:201 +0xd6a\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce/cloud/mock.InsertAddressHook()\r\n      pkg/cloudprovider/providers/gce/cloud/mock/mock.go:216 +0x13f\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce/cloud.(*MockAddresses).Insert()\r\n      pkg/cloudprovider/providers/gce/cloud/gen.go:1309 +0xbd2\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce.(*GCECloud).ReserveRegionAddress()\r\n      pkg/cloudprovider/providers/gce/gce_addresses.go:67 +0x1fd\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce.ensureStaticIP()\r\n      pkg/cloudprovider/providers/gce/gce_loadbalancer_external.go:986 +0x803\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce.(*GCECloud).ensureExternalLoadBalancer()\r\n      pkg/cloudprovider/providers/gce/gce_loadbalancer_external.go:148 +0x37c8\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce.(*GCECloud).EnsureLoadBalancer()\r\n      pkg/cloudprovider/providers/gce/gce_loadbalancer.go:149 +0x9dc\r\n  k8s.io/kubernetes/pkg/cloudprovider/providers/gce.TestGetLoadBalancer()\r\n      pkg/cloudprovider/providers/gce/gce_loadbalancer_test.go:45 +0x697\r\n  testing.tRunner()\r\n      GOROOT/src/testing/testing.go:777 +0x16d\r\n\r\nGoroutine 84 (running) created at:\r\n  testing.(*T).Run()\r\n      GOROOT/src/testing/testing.go:824 +0x564\r\n  testing.runTests.func1()\r\n      GOROOT/src/testing/testing.go:1063 +0xa4\r\n  testing.tRunner()\r\n      GOROOT/src/testing/testing.go:777 +0x16d\r\n  testing.runTests()\r\n      GOROOT/src/testing/testing.go:1061 +0x4e1\r\n  testing.(*M).Run()\r\n      GOROOT/src/testing/testing.go:978 +0x2cd\r\n  main.main()\r\n      bazel-out/k8-fastbuild/bin/pkg/cloudprovider/providers/gce/linux_amd64_race_stripped/go_default_test~/testmain.go:267 +0x3ad\r\n\r\nGoroutine 60 (running) created at:\r\n  testing.(*T).Run()\r\n      GOROOT/src/testing/testing.go:824 +0x564\r\n  testing.runTests.func1()\r\n      GOROOT/src/testing/testing.go:1063 +0xa4\r\n  testing.tRunner()\r\n      GOROOT/src/testing/testing.go:777 +0x16d\r\n  testing.runTests()\r\n      GOROOT/src/testing/testing.go:1061 +0x4e1\r\n  testing.(*M).Run()\r\n      GOROOT/src/testing/testing.go:978 +0x2cd\r\n  main.main()\r\n      bazel-out/k8-fastbuild/bin/pkg/cloudprovider/providers/gce/linux_amd64_race_stripped/go_default_test~/testmain.go:267 +0x3ad\r\n==================\r\n--- FAIL: TestEnsureLoadBalancerDeletedDeletesInternalLb (0.00s)\r\n\ttesting.go:730: race detected during execution of test\r\n--- FAIL: TestGetLoadBalancer (0.00s)\r\n\ttesting.go:730: race detected during execution of test\r\n--- FAIL: TestEnsureLoadBalancerCreatesInternalLb (0.01s)\r\n\ttesting.go:730: race detected during execution of test\r\n--- FAIL: TestEnsureLoadBalancerCreatesExternalLb (0.01s)\r\n\ttesting.go:730: race detected during execution of test\r\n--- FAIL: TestEnsureLoadBalancerDeletedDeletesExternalLb (0.01s)\r\n\ttesting.go:730: race detected during execution of test\r\n--- FAIL: TestEnsureLoadBalancerDeletesExistingExternalLb (0.01s)\r\n\ttesting.go:730: race detected during execution of test\r\n--- FAIL: TestEnsureLoadBalancerDeletesExistingInternalLb (0.01s)\r\n\ttesting.go:730: race detected during execution of test\r\nFAIL\r\n```\r\n\r\n**What you expected to happen**:\r\n\r\nThe tests should consistently pass unless related problem code is introduced.\r\n\r\n",
  "closed_at": "2018-04-16T19:58:25Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/13653959?v=4",
    "events_url": "https://api.github.com/users/k8s-github-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-github-robot/followers",
    "following_url": "https://api.github.com/users/k8s-github-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-github-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-github-robot",
    "id": 13653959,
    "login": "k8s-github-robot",
    "node_id": "MDQ6VXNlcjEzNjUzOTU5",
    "organizations_url": "https://api.github.com/users/k8s-github-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-github-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-github-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-github-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-github-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-github-robot"
  },
  "comments": 3,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/62601/comments",
  "created_at": "2018-04-15T19:03:17Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/62601/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/62601",
  "id": 314442130,
  "labels": [
    {
      "color": "e11d21",
      "default": false,
      "description": "Categorizes issue or PR as related to a bug.",
      "id": 105146071,
      "name": "kind/bug",
      "node_id": "MDU6TGFiZWwxMDUxNDYwNzE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/bug"
    },
    {
      "color": "f7c6c7",
      "default": false,
      "description": "Categorizes issue or PR as related to a flaky test.",
      "id": 264749912,
      "name": "kind/flake",
      "node_id": "MDU6TGFiZWwyNjQ3NDk5MTI=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/flake"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/62601/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUzMTQ0NDIxMzA=",
  "number": 62601,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "TestGetLoadBalancer race detected during execution of test",
  "updated_at": "2018-04-16T19:58:25Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/62601",
  "user": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/329907?v=4",
    "events_url": "https://api.github.com/users/joelsmith/events{/privacy}",
    "followers_url": "https://api.github.com/users/joelsmith/followers",
    "following_url": "https://api.github.com/users/joelsmith/following{/other_user}",
    "gists_url": "https://api.github.com/users/joelsmith/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/joelsmith",
    "id": 329907,
    "login": "joelsmith",
    "node_id": "MDQ6VXNlcjMyOTkwNw==",
    "organizations_url": "https://api.github.com/users/joelsmith/orgs",
    "received_events_url": "https://api.github.com/users/joelsmith/received_events",
    "repos_url": "https://api.github.com/users/joelsmith/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/joelsmith/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/joelsmith/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/joelsmith"
  }
}