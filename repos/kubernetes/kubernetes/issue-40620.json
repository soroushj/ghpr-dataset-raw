{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "MEMBER",
  "body": "``kubefed`` currently relies on the dnsaas configuration to be discoverable.  This works in gke for google cloud dns (and likely in aws for route-53), but neither provider will be configured by ``kubefed init`` in a non-cloud deployment of the federation control plane.  ``kubefed`` deploys the controller manager (which talks to the dnsaas provider) without setting ``--dns-provider-config``:\r\n\r\nhttps://github.com/kubernetes/kubernetes/blob/master/federation/pkg/kubefed/init/init.go#L548\r\n\r\nThis means that configuring dnsaas for non-cloud requires manual post-init configuration.  Here are the steps required to get google dns configured for a local deployment:\r\n\r\n- create a service account with the \"Compute Network User\" role as per the google instructions and download the resulting json auth file\r\n- create a secret in the federation namespace from the auth file\r\n- edit the controller manager deployment template to include:\r\n   - a volume for the secret\r\n   - a mount for the secret volume\r\n   - an env entry for GOOGLE_APPLICATION_CREDENTIALS that pointed to the mounted file\r\n     - setting --dns-provider-config resulted in the controller manager complaining about invalid configuration. It didn't seem to expect json.\r\n\r\nTo simplify non-cloud deployment, ``kubefed`` should accept a configuration file (e.g. ``--dns-provider-config``), create a secret from the federation control plane, and configure the controller manager deployment template to use that secret to configure the chosen dnsaas provider.\r\n\r\n#40536 is the umbrella issue for tracking this and others targeting improvements in non-cloud deployment of the federation control plane.\r\n\r\ncc: @kubernetes/sig-federation-bugs ",
  "closed_at": "2017-02-26T22:54:51Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/13653959?v=4",
    "events_url": "https://api.github.com/users/k8s-github-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-github-robot/followers",
    "following_url": "https://api.github.com/users/k8s-github-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-github-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-github-robot",
    "id": 13653959,
    "login": "k8s-github-robot",
    "node_id": "MDQ6VXNlcjEzNjUzOTU5",
    "organizations_url": "https://api.github.com/users/k8s-github-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-github-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-github-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-github-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-github-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-github-robot"
  },
  "comments": 2,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/40620/comments",
  "created_at": "2017-01-27T19:28:21Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/40620/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/40620",
  "id": 203719292,
  "labels": [],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/40620/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUyMDM3MTkyOTI=",
  "number": 40620,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "[Federation][kubefed] Enable dnsaas configuration for non-cloud deployments",
  "updated_at": "2017-02-26T22:54:51Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/40620",
  "user": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/451477?v=4",
    "events_url": "https://api.github.com/users/marun/events{/privacy}",
    "followers_url": "https://api.github.com/users/marun/followers",
    "following_url": "https://api.github.com/users/marun/following{/other_user}",
    "gists_url": "https://api.github.com/users/marun/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/marun",
    "id": 451477,
    "login": "marun",
    "node_id": "MDQ6VXNlcjQ1MTQ3Nw==",
    "organizations_url": "https://api.github.com/users/marun/orgs",
    "received_events_url": "https://api.github.com/users/marun/received_events",
    "repos_url": "https://api.github.com/users/marun/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/marun/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/marun/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/marun"
  }
}