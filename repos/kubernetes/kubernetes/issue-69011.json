{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "MEMBER",
  "body": "There are several places where we return errors from an HTTP server by writing the error code and message directly. We should standardize on using [http.Error ](https://golang.org/pkg/net/http/?#Error)everywhere to pick up the \"text/plain\" and \"nosniff\" content type headers.\r\n\r\nHere's a [cs.k8s.io query](https://cs.k8s.io/?q=%5C.WriteHeader%5C\\(http%5C.Status%5B%5EO%5D&i=nope&files=%5E\\(pkg%7Ccmd%7Cstaging\\)&repos=kubernetes/kubernetes) @tallclair gave me that probably catches most of the places where we are doing this.\r\n\r\nThe unit test ones would be nice to fix too, but the more important ones are the non-test code:\r\n- [ ] pkg/controller/garbagecollector/dump.go\r\n- [ ] pkg/kubectl/proxy/proxy_server.go\r\n- [ ] pkg/kubelet/server/remotecommand/httpstream.go\r\n- [ ] pkg/proxy/healthcheck/healthcheck.go\r\n- [ ] staging/src/k8s.io/apimachinery/pkg/util/httpstream/httpstream.go\r\n- [ ] staging/src/k8s.io/apimachinery/pkg/util/httpstream/spdy/upgrade.go\r\n- [ ] staging/src/k8s.io/apimachinery/pkg/util/proxy/upgradeaware.go\r\n- [ ] staging/src/k8s.io/apiserver/pkg/endpoints/handlers/responsewriters/writers.go\r\n- [ ] staging/src/k8s.io/apiserver/pkg/server/filters/cors.go\r\n- [ ] staging/src/k8s.io/apiserver/pkg/server/filters/maxinflight.go\r\n- [ ] staging/src/k8s.io/apiserver/pkg/server/filters/timeout.go",
  "closed_at": "2018-10-23T22:31:55Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/20407524?v=4",
    "events_url": "https://api.github.com/users/k8s-ci-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-ci-robot/followers",
    "following_url": "https://api.github.com/users/k8s-ci-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-ci-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-ci-robot",
    "id": 20407524,
    "login": "k8s-ci-robot",
    "node_id": "MDQ6VXNlcjIwNDA3NTI0",
    "organizations_url": "https://api.github.com/users/k8s-ci-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-ci-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-ci-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-ci-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-ci-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-ci-robot"
  },
  "comments": 1,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/69011/comments",
  "created_at": "2018-09-24T21:49:13Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/69011/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/69011",
  "id": 363333567,
  "labels": [
    {
      "color": "7057ff",
      "default": true,
      "description": "Denotes an issue ready for a new contributor, according to the \"help wanted\" guidelines.",
      "id": 954672878,
      "name": "good first issue",
      "node_id": "MDU6TGFiZWw5NTQ2NzI4Nzg=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/good%20first%20issue"
    },
    {
      "color": "006b75",
      "default": true,
      "description": "Denotes an issue that needs help from a contributor. Must meet \"help wanted\" guidelines.",
      "id": 433686790,
      "name": "help wanted",
      "node_id": "MDU6TGFiZWw0MzM2ODY3OTA=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/help%20wanted"
    },
    {
      "color": "c7def8",
      "default": false,
      "description": "Categorizes issue or PR as related to cleaning up code, process, or technical debt.",
      "id": 122775691,
      "name": "kind/cleanup",
      "node_id": "MDU6TGFiZWwxMjI3NzU2OTE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/cleanup"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG API Machinery.",
      "id": 173493835,
      "name": "sig/api-machinery",
      "node_id": "MDU6TGFiZWwxNzM0OTM4MzU=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/api-machinery"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Auth.",
      "id": 357119284,
      "name": "sig/auth",
      "node_id": "MDU6TGFiZWwzNTcxMTkyODQ=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/auth"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/69011/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUzNjMzMzM1Njc=",
  "number": 69011,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "Use http.Error() instead of writing responses directly",
  "updated_at": "2018-10-23T22:31:55Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/69011",
  "user": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/7154008?v=4",
    "events_url": "https://api.github.com/users/cjcullen/events{/privacy}",
    "followers_url": "https://api.github.com/users/cjcullen/followers",
    "following_url": "https://api.github.com/users/cjcullen/following{/other_user}",
    "gists_url": "https://api.github.com/users/cjcullen/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/cjcullen",
    "id": 7154008,
    "login": "cjcullen",
    "node_id": "MDQ6VXNlcjcxNTQwMDg=",
    "organizations_url": "https://api.github.com/users/cjcullen/orgs",
    "received_events_url": "https://api.github.com/users/cjcullen/received_events",
    "repos_url": "https://api.github.com/users/cjcullen/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/cjcullen/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cjcullen/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/cjcullen"
  }
}