{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/10052848?v=4",
    "events_url": "https://api.github.com/users/saad-ali/events{/privacy}",
    "followers_url": "https://api.github.com/users/saad-ali/followers",
    "following_url": "https://api.github.com/users/saad-ali/following{/other_user}",
    "gists_url": "https://api.github.com/users/saad-ali/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/saad-ali",
    "id": 10052848,
    "login": "saad-ali",
    "node_id": "MDQ6VXNlcjEwMDUyODQ4",
    "organizations_url": "https://api.github.com/users/saad-ali/orgs",
    "received_events_url": "https://api.github.com/users/saad-ali/received_events",
    "repos_url": "https://api.github.com/users/saad-ali/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/saad-ali/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/saad-ali/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/saad-ali"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars1.githubusercontent.com/u/10052848?v=4",
      "events_url": "https://api.github.com/users/saad-ali/events{/privacy}",
      "followers_url": "https://api.github.com/users/saad-ali/followers",
      "following_url": "https://api.github.com/users/saad-ali/following{/other_user}",
      "gists_url": "https://api.github.com/users/saad-ali/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/saad-ali",
      "id": 10052848,
      "login": "saad-ali",
      "node_id": "MDQ6VXNlcjEwMDUyODQ4",
      "organizations_url": "https://api.github.com/users/saad-ali/orgs",
      "received_events_url": "https://api.github.com/users/saad-ali/received_events",
      "repos_url": "https://api.github.com/users/saad-ali/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/saad-ali/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/saad-ali/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/saad-ali"
    }
  ],
  "author_association": "CONTRIBUTOR",
  "body": "Here's logs from `kubelet` formatting a 10GB HDD disk in Azure as ext4:\n\n```\nAug 17 07:30:22 colemick-kany04-node-0 docker[6700]: I0817 07:30:22.450752    6891 mount_linux.go:342] Disk \"/dev/sdc\" appears to be unformatted, attempting to format as type: \"ext4\" with options: [-E lazy_itable_init=0,lazy_journal_init=0 -F /dev/sdc]\n\nAug 17 07:37:52 colemick-kany04-node-0 docker[6700]: I0817 07:37:52.538305    6891 mount_linux.go:347] Disk successfully formatted (mkfs): ext4 - /dev/sdc /var/lib/kubelet/plugins/kubernetes.io/azure-disk/mounts/kubetestdisk0\n\nAug 17 07:37:52 colemick-kany04-node-0 docker[6700]: I0817 07:37:52.592955    6891 operation_executor.go:720] MountVolume.MountDevice succeeded for volume \"kubernetes.io/azure-disk/kubetestdisk0\" (spec.Name: \"disk-azuredisk\") pod \"cddd37fc-644b-11e6-88b3-000d3af71bc2\" (UID: \"cddd37fc-644b-11e6-88b3-000d3af71bc2\").                                                                                                                                                                 \n\nAug 17 07:37:52 colemick-kany04-node-0 docker[6700]: I0817 07:37:52.599067    6891 operation_executor.go:755] MountVolume.SetUp succeeded for volume \"kubernetes.io/azure-disk/kubetestdisk0\" (spec.Name: \"disk-azuredisk\") pod \"cddd37fc-644b-11e6-88b3-000d3af71bc2\" (UID: \"cddd37fc-644b-11e6-88b3-000d3af71bc2\").\n```\n\nIt took seven and a half minutes to complete `mkfs`.\n\nHere's me doing it manually from the node:\n\n```\nkube@colemick-kany04-node-0:~$ time sudo mkfs.ext4 -E lazy_itable_init=0,lazy_journal_init=0 -F /dev/sdc\nmke2fs 1.42.13 (17-May-2015)\n/dev/sdc contains a ext4 file system\n        created on Wed Aug 17 07:52:59 2016\nDiscarding device blocks: done\nCreating filesystem with 2621440 4k blocks and 655360 inodes\nFilesystem UUID: 3fedd79f-3064-48ad-9c94-990d6ae83d2d\nSuperblock backups stored on blocks:\n        32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632\n\nAllocating group tables: done\nWriting inode tables: done\nCreating journal (32768 blocks): done\nWriting superblocks and filesystem accounting information: done\n\n\nreal    0m3.388s\nuser    0m0.020s\nsys     0m0.232s\n```\n\nAnd even from a container, somewhat emulating kubelet:\n\n```\nkube@colemick-kany04-node-0:~$ sudo docker run -it --privileged -v /dev:/dev ubuntu:xenial\nroot@3f3c3f796fa9:/# time mkfs.ext4 -E lazy_itable_init=0,lazy_journal_init=0 -F /dev/sdc\nmke2fs 1.42.13 (17-May-2015)\n/dev/sdc contains a ext4 file system\n        created on Wed Aug 17 07:53:13 2016\nDiscarding device blocks: done\nCreating filesystem with 2621440 4k blocks and 655360 inodes\nFilesystem UUID: 98c150f0-17b4-4ebe-8e9c-31506722a785\nSuperblock backups stored on blocks:\n        32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632\n\nAllocating group tables: done\nWriting inode tables: done\nCreating journal (32768 blocks): done\nWriting superblocks and filesystem accounting information: done\n\n\nreal    0m3.421s\nuser    0m0.024s\nsys     0m0.224s\n```\n\n**Kubernetes version** (use `kubectl version`):\n\n**Environment**:\n- **Cloud provider or hardware configuration**: Azure\n- **OS** (e.g. from /etc/os-release): Ubuntu (Xenial) 16.10\n- **Kernel** (e.g. `uname -a`): Linux 3f3c3f796fa9 4.4.0-34-generic #53-Ubuntu SMP Wed Jul 27 16:06:39 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux\n- **Install tools**: kubernetes-anywhere / static pods with kubelet / kubelet in container\n\n**What happened**:\nIt took seven and a half minutes to format, causing the overall pod startup time to take over 10 minutes by time attachment occurred\n\n**What you expected to happen**:\nIt to take a matter of seconds, similar to how it does if I execute the command manully.\n\n**How to reproduce it** (as minimally and precisely as possible):\nBuild `kubernetes` with [the azure disk PR](https://github.com/kubernetes/kubernetes/pull/29836) on top. Deploy a cluster. Try to attach an unformatted VHD. Observe `watch -n1 \"ps ax | grep mkfs` along with watching `kubelet` logs and confirm it really does take that long.\n\n**Anything else do we need to know**:\nI'm running `kubelet` containerized. Like this: https://github.com/kubernetes/kubernetes-anywhere/blob/f3c6143cfebf97d11bf36191721ea528a63e01a8/phase2/ignition/vanilla/kubelet.service\n",
  "closed_at": "2017-01-18T17:09:52Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/13653959?v=4",
    "events_url": "https://api.github.com/users/k8s-github-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-github-robot/followers",
    "following_url": "https://api.github.com/users/k8s-github-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-github-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-github-robot",
    "id": 13653959,
    "login": "k8s-github-robot",
    "node_id": "MDQ6VXNlcjEzNjUzOTU5",
    "organizations_url": "https://api.github.com/users/k8s-github-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-github-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-github-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-github-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-github-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-github-robot"
  },
  "comments": 35,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/30752/comments",
  "created_at": "2016-08-17T08:03:23Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/30752/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/30752",
  "id": 171597656,
  "labels": [
    {
      "color": "0052cc",
      "default": false,
      "description": null,
      "id": 116719829,
      "name": "area/kubelet",
      "node_id": "MDU6TGFiZWwxMTY3MTk4Mjk=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/area/kubelet"
    },
    {
      "color": "eb6420",
      "default": false,
      "description": "Must be staffed and worked on either currently, or very soon, ideally in time for the next release.",
      "id": 114528223,
      "name": "priority/important-soon",
      "node_id": "MDU6TGFiZWwxMTQ1MjgyMjM=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/priority/important-soon"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Storage.",
      "id": 169428334,
      "name": "sig/storage",
      "node_id": "MDU6TGFiZWwxNjk0MjgzMzQ=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/storage"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/30752/labels{/name}",
  "locked": false,
  "milestone": {
    "closed_at": "2019-08-26T17:23:42Z",
    "closed_issues": 1693,
    "created_at": "2016-11-12T00:35:38Z",
    "creator": {
      "avatar_url": "https://avatars1.githubusercontent.com/u/10052848?v=4",
      "events_url": "https://api.github.com/users/saad-ali/events{/privacy}",
      "followers_url": "https://api.github.com/users/saad-ali/followers",
      "following_url": "https://api.github.com/users/saad-ali/following{/other_user}",
      "gists_url": "https://api.github.com/users/saad-ali/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/saad-ali",
      "id": 10052848,
      "login": "saad-ali",
      "node_id": "MDQ6VXNlcjEwMDUyODQ4",
      "organizations_url": "https://api.github.com/users/saad-ali/orgs",
      "received_events_url": "https://api.github.com/users/saad-ali/received_events",
      "repos_url": "https://api.github.com/users/saad-ali/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/saad-ali/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/saad-ali/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/saad-ali"
    },
    "description": "",
    "due_on": "2017-03-22T07:00:00Z",
    "html_url": "https://github.com/kubernetes/kubernetes/milestone/31",
    "id": 2130587,
    "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/milestones/31/labels",
    "node_id": "MDk6TWlsZXN0b25lMjEzMDU4Nw==",
    "number": 31,
    "open_issues": 0,
    "state": "closed",
    "title": "v1.6",
    "updated_at": "2019-08-26T17:23:42Z",
    "url": "https://api.github.com/repos/kubernetes/kubernetes/milestones/31"
  },
  "node_id": "MDU6SXNzdWUxNzE1OTc2NTY=",
  "number": 30752,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "mkfs.ext4 is slow when run by kubelet",
  "updated_at": "2017-01-18T17:09:52Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/30752",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/327028?v=4",
    "events_url": "https://api.github.com/users/colemickens/events{/privacy}",
    "followers_url": "https://api.github.com/users/colemickens/followers",
    "following_url": "https://api.github.com/users/colemickens/following{/other_user}",
    "gists_url": "https://api.github.com/users/colemickens/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/colemickens",
    "id": 327028,
    "login": "colemickens",
    "node_id": "MDQ6VXNlcjMyNzAyOA==",
    "organizations_url": "https://api.github.com/users/colemickens/orgs",
    "received_events_url": "https://api.github.com/users/colemickens/received_events",
    "repos_url": "https://api.github.com/users/colemickens/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/colemickens/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/colemickens/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/colemickens"
  }
}