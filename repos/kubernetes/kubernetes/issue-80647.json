{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "CONTRIBUTOR",
  "body": "<!-- Please only use this template for submitting enhancement requests -->\r\n\r\n**What would you like to be added**:\r\n\r\nReport request throttling by the kubelet by default (i. e. V=3)\r\n\r\n**Why is this needed**:\r\n\r\nRequest throttling can have serious consequences, but it is reported (in `staging/src/k8s.io/client-go/rest/request.go:tryThrottle()`) at V=4, so not by default.\r\n\r\nWhile attempting to probe limits of how many pods per node we could run, we hit a situation where the test pods would go Pending and eventually fail.  After investigation, it turned out that the pod was being started by the kubelet, but that status update was not provided to the apiserver in a timely manner, resulting in the pod-to-pod network not coming up, so a pod attempting to connect would time out and fail.  The delay was root caused to throttling by the kubelet; raising the KubeAPIBurst and KubeAPIQPS limits resolved the issue.  The throttling was caused by fetching secrets for each pod, which was in its own namespace.\r\n\r\nThe subjects of pods/node, namespaces/node, and throttling parameters are complex and I do not propose to solve them here (those are scalability issues that have to be approached carefully).  However, being able to easily identify that throttling is taking place without having to restart the kubelet at higher verbosity would help administrators identify the possibility of this issue.\r\n\r\nMy test attempted to create 500 pods across 3 nodes (OpenShift allows 250 pods/node).  Running at V=5, I captured a histogram of the throttling delay in seconds.  There were 7881 throttling events reported total over perhaps a 45 minute period, with a somewhat bimodal (in this case) distribution:\r\n\r\n```   0 -    1 sec   981     981\r\n   1 -    2 sec   565    1546\r\n   2 -    3 sec   264    1810\r\n   3 -    4 sec   226    2036\r\n   4 -    5 sec   266    2302\r\n   5 -    6 sec   229    2531\r\n   6 -    7 sec   110    2641\r\n   7 -    8 sec    86    2727\r\n   8 -    9 sec    81    2808\r\n   9 -   10 sec    70    2878\r\n  10 -   11 sec   118    2996\r\n  11 -   12 sec   209    3205\r\n  12 -   13 sec   167    3372\r\n  13 -   14 sec   125    3497\r\n  14 -   15 sec   162    3659\r\n  15 -   16 sec   121    3780\r\n  16 -   17 sec   195    3975\r\n  17 -   18 sec   344    4319\r\n  18 -   19 sec   232    4551\r\n  19 -   20 sec   109    4660\r\n  20 -   21 sec   138    4798\r\n  21 -   22 sec   251    5049\r\n  22 -   23 sec   439    5488\r\n  23 -   24 sec   550    6038\r\n  24 -   25 sec   593    6631\r\n  25 -   26 sec   531    7162\r\n  26 -   27 sec   380    7542\r\n  27 -   28 sec   228    7770\r\n  28 -   29 sec    78    7848\r\n  29 -   30 sec    14    7862\r\n  30 -   31 sec     1    7863\r\n  31 -   32 sec    18    7881\r\nMax time 31.775421718\r\n```\r\n",
  "closed_at": "2019-12-10T20:16:07Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/20407524?v=4",
    "events_url": "https://api.github.com/users/k8s-ci-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-ci-robot/followers",
    "following_url": "https://api.github.com/users/k8s-ci-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-ci-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-ci-robot",
    "id": 20407524,
    "login": "k8s-ci-robot",
    "node_id": "MDQ6VXNlcjIwNDA3NTI0",
    "organizations_url": "https://api.github.com/users/k8s-ci-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-ci-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-ci-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-ci-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-ci-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-ci-robot"
  },
  "comments": 6,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/80647/comments",
  "created_at": "2019-07-26T16:48:18Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/80647/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/80647",
  "id": 473447211,
  "labels": [
    {
      "color": "c7def8",
      "default": false,
      "description": "Categorizes issue or PR as related to a new feature.",
      "id": 267761362,
      "name": "kind/feature",
      "node_id": "MDU6TGFiZWwyNjc3NjEzNjI=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/feature"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Node.",
      "id": 173493665,
      "name": "sig/node",
      "node_id": "MDU6TGFiZWwxNzM0OTM2NjU=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/node"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Scalability.",
      "id": 125010198,
      "name": "sig/scalability",
      "node_id": "MDU6TGFiZWwxMjUwMTAxOTg=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/scalability"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/80647/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU0NzM0NDcyMTE=",
  "number": 80647,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "Report API server throttling by the kubelet by default",
  "updated_at": "2019-12-10T20:16:07Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/80647",
  "user": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/31751681?v=4",
    "events_url": "https://api.github.com/users/RobertKrawitz/events{/privacy}",
    "followers_url": "https://api.github.com/users/RobertKrawitz/followers",
    "following_url": "https://api.github.com/users/RobertKrawitz/following{/other_user}",
    "gists_url": "https://api.github.com/users/RobertKrawitz/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/RobertKrawitz",
    "id": 31751681,
    "login": "RobertKrawitz",
    "node_id": "MDQ6VXNlcjMxNzUxNjgx",
    "organizations_url": "https://api.github.com/users/RobertKrawitz/orgs",
    "received_events_url": "https://api.github.com/users/RobertKrawitz/received_events",
    "repos_url": "https://api.github.com/users/RobertKrawitz/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/RobertKrawitz/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/RobertKrawitz/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/RobertKrawitz"
  }
}