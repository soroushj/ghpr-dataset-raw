{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "MEMBER",
  "body": "When running a kubernetes cluster with Cloud Controller Manager, the node object does not get any addresses other than the internal IP address and Hostname.\r\n\r\nAfter debugging @ublubu and I found that both CCM and kubelet race to set the node address. The kubelet is supposed to back off from setting node address when the cloudprovider is set to external. \r\n\r\nThis is where kubelet sets node address - https://github.com/kubernetes/kubernetes/blob/b8c9ee8abb387de7d6e0e910538bd53057c77d0f/pkg/kubelet/kubelet_node_status.go#L968\r\n\r\n(Kubelet is not supposed to set it, a condition for this check needs to be added)\r\n\r\nThis is where CCM sets node address - https://github.com/kubernetes/kubernetes/blob/b8c9ee8abb387de7d6e0e910538bd53057c77d0f/pkg/controller/cloud/nodecontroller.go#L192",
  "closed_at": "2017-06-24T16:31:15Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/13653959?v=4",
    "events_url": "https://api.github.com/users/k8s-github-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-github-robot/followers",
    "following_url": "https://api.github.com/users/k8s-github-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-github-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-github-robot",
    "id": 13653959,
    "login": "k8s-github-robot",
    "node_id": "MDQ6VXNlcjEzNjUzOTU5",
    "organizations_url": "https://api.github.com/users/k8s-github-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-github-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-github-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-github-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-github-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-github-robot"
  },
  "comments": 6,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/47155/comments",
  "created_at": "2017-06-08T03:41:12Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/47155/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/47155",
  "id": 234403279,
  "labels": [
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Cluster Lifecycle.",
      "id": 173494222,
      "name": "sig/cluster-lifecycle",
      "node_id": "MDU6TGFiZWwxNzM0OTQyMjI=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/cluster-lifecycle"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/47155/labels{/name}",
  "locked": false,
  "milestone": {
    "closed_at": "2019-08-26T17:22:37Z",
    "closed_issues": 1514,
    "created_at": "2017-01-19T17:41:27Z",
    "creator": {
      "avatar_url": "https://avatars0.githubusercontent.com/u/7882754?v=4",
      "events_url": "https://api.github.com/users/pwittrock/events{/privacy}",
      "followers_url": "https://api.github.com/users/pwittrock/followers",
      "following_url": "https://api.github.com/users/pwittrock/following{/other_user}",
      "gists_url": "https://api.github.com/users/pwittrock/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/pwittrock",
      "id": 7882754,
      "login": "pwittrock",
      "node_id": "MDQ6VXNlcjc4ODI3NTQ=",
      "organizations_url": "https://api.github.com/users/pwittrock/orgs",
      "received_events_url": "https://api.github.com/users/pwittrock/received_events",
      "repos_url": "https://api.github.com/users/pwittrock/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/pwittrock/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pwittrock/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/pwittrock"
    },
    "description": "",
    "due_on": "2017-06-28T07:00:00Z",
    "html_url": "https://github.com/kubernetes/kubernetes/milestone/32",
    "id": 2264750,
    "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/milestones/32/labels",
    "node_id": "MDk6TWlsZXN0b25lMjI2NDc1MA==",
    "number": 32,
    "open_issues": 0,
    "state": "closed",
    "title": "v1.7",
    "updated_at": "2019-08-26T17:22:37Z",
    "url": "https://api.github.com/repos/kubernetes/kubernetes/milestones/32"
  },
  "node_id": "MDU6SXNzdWUyMzQ0MDMyNzk=",
  "number": 47155,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "CCM and Kubelet both write addresses on node object",
  "updated_at": "2017-06-24T16:31:15Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/47155",
  "user": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/1050521?v=4",
    "events_url": "https://api.github.com/users/wlan0/events{/privacy}",
    "followers_url": "https://api.github.com/users/wlan0/followers",
    "following_url": "https://api.github.com/users/wlan0/following{/other_user}",
    "gists_url": "https://api.github.com/users/wlan0/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/wlan0",
    "id": 1050521,
    "login": "wlan0",
    "node_id": "MDQ6VXNlcjEwNTA1MjE=",
    "organizations_url": "https://api.github.com/users/wlan0/orgs",
    "received_events_url": "https://api.github.com/users/wlan0/received_events",
    "repos_url": "https://api.github.com/users/wlan0/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/wlan0/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/wlan0/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/wlan0"
  }
}