{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/18107181?v=4",
    "events_url": "https://api.github.com/users/k82cn/events{/privacy}",
    "followers_url": "https://api.github.com/users/k82cn/followers",
    "following_url": "https://api.github.com/users/k82cn/following{/other_user}",
    "gists_url": "https://api.github.com/users/k82cn/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k82cn",
    "id": 18107181,
    "login": "k82cn",
    "node_id": "MDQ6VXNlcjE4MTA3MTgx",
    "organizations_url": "https://api.github.com/users/k82cn/orgs",
    "received_events_url": "https://api.github.com/users/k82cn/received_events",
    "repos_url": "https://api.github.com/users/k82cn/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k82cn/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k82cn/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k82cn"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars0.githubusercontent.com/u/18107181?v=4",
      "events_url": "https://api.github.com/users/k82cn/events{/privacy}",
      "followers_url": "https://api.github.com/users/k82cn/followers",
      "following_url": "https://api.github.com/users/k82cn/following{/other_user}",
      "gists_url": "https://api.github.com/users/k82cn/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/k82cn",
      "id": 18107181,
      "login": "k82cn",
      "node_id": "MDQ6VXNlcjE4MTA3MTgx",
      "organizations_url": "https://api.github.com/users/k82cn/orgs",
      "received_events_url": "https://api.github.com/users/k82cn/received_events",
      "repos_url": "https://api.github.com/users/k82cn/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/k82cn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/k82cn/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/k82cn"
    }
  ],
  "author_association": "MEMBER",
  "body": "<!--\r\nIf this is a BUG REPORT, please:\r\n  - Fill in as much of the template below as you can.  If you leave out\r\n    information, we can't help you as well.\r\n\r\nIf this is a FEATURE REQUEST, please:\r\n  - Describe *in detail* the feature/behavior/change you'd like to see.\r\n\r\nIn both cases, be ready for followup questions, and please respond in a timely\r\nmanner.  If we can't reproduce a bug or think a feature already exists, we\r\nmight close your issue.  If we're wrong, PLEASE feel free to reopen it and\r\nexplain why.\r\n-->\r\n\r\n**Kubernetes version** (use `kubectl version`):\r\nClient Version: version.Info{Major:\"1\", Minor:\"8+\", GitVersion:\"v1.8.0-alpha.1.51+594edb77397512-dirty\", GitCommit:\"594edb773975124b137fa12bc573478a0355e89c\", GitTreeState:\"dirty\", BuildDate:\"2017-06-20T10:51:10Z\", GoVersion:\"go1.8\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\nServer Version: version.Info{Major:\"1\", Minor:\"8+\", GitVersion:\"v1.8.0-alpha.1.51+594edb77397512-dirty\", GitCommit:\"594edb773975124b137fa12bc573478a0355e89c\", GitTreeState:\"dirty\", BuildDate:\"2017-06-20T11:29:14Z\", GoVersion:\"go1.8\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\n\r\n**What happened**: After adding `failure-domain.beta.kubernetes.io/zone` label to a node, node controller panics.\r\n\r\n\r\n**What you expected to happen**: Everything should still work.\r\n\r\n\r\n**How to reproduce it** (as minimally and precisely as possible):\r\n\r\nRun `\"cluster/kubectl.sh\" label  nodes --all failure-domain.beta.kubernetes.io/zone=zone` and wait for the node controller to panic:\r\n\r\n```\r\nE0620 14:45:34.888655       1 runtime.go:66] Observed a panic: \"invalid memory address or nil pointer dereference\" (runtime error: invalid memory address or nil pointer dereference)\r\n/home/salmon/code/src/k8s.io/kubernetes/_output/local/go/src/k8s.io/kubernetes/vendor/k8s.io/apimachinery/pkg/util/runtime/runtime.go:72\r\n/home/salmon/code/src/k8s.io/kubernetes/_output/local/go/src/k8s.io/kubernetes/vendor/k8s.io/apimachinery/pkg/util/runtime/runtime.go:65\r\n/home/salmon/code/src/k8s.io/kubernetes/_output/local/go/src/k8s.io/kubernetes/vendor/k8s.io/apimachinery/pkg/util/runtime/runtime.go:51\r\n/home/salmon/.gimme/versions/go1.8.linux.amd64/src/runtime/asm_amd64.s:514\r\n/home/salmon/.gimme/versions/go1.8.linux.amd64/src/runtime/panic.go:489\r\n/home/salmon/.gimme/versions/go1.8.linux.amd64/src/runtime/panic.go:63\r\n/home/salmon/.gimme/versions/go1.8.linux.amd64/src/runtime/signal_unix.go:290\r\n/home/salmon/code/src/k8s.io/kubernetes/_output/local/go/src/k8s.io/kubernetes/pkg/controller/node/rate_limited_queue.go:244\r\n/home/salmon/code/src/k8s.io/kubernetes/_output/local/go/src/k8s.io/kubernetes/pkg/controller/node/nodecontroller.go:1023\r\n/home/salmon/code/src/k8s.io/kubernetes/_output/local/go/src/k8s.io/kubernetes/pkg/controller/node/nodecontroller.go:659\r\n/home/salmon/code/src/k8s.io/kubernetes/_output/local/go/src/k8s.io/kubernetes/pkg/controller/node/nodecontroller.go:490\r\n/home/salmon/code/src/k8s.io/kubernetes/_output/local/go/src/k8s.io/kubernetes/vendor/k8s.io/apimachinery/pkg/util/wait/wait.go:97\r\n/home/salmon/code/src/k8s.io/kubernetes/_output/local/go/src/k8s.io/kubernetes/vendor/k8s.io/apimachinery/pkg/util/wait/wait.go:98\r\n/home/salmon/code/src/k8s.io/kubernetes/_output/local/go/src/k8s.io/kubernetes/vendor/k8s.io/apimachinery/pkg/util/wait/wait.go:52\r\n/home/salmon/.gimme/versions/go1.8.linux.amd64/src/runtime/asm_amd64.s:2197\r\npanic: runtime error: invalid memory address or nil pointer dereference [recovered]\r\n        panic: runtime error: invalid memory address or nil pointer dereference\r\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x0 pc=0x3484942]\r\n```\r\n\r\n**Anything else we need to know**:\r\n\r\nI've checked the code and it looks like the node controller expects the label to be present during node registration and it can not be added later.\r\nEven if the label can not be added latter it shouldn't panic.\r\n\r\n",
  "closed_at": "2017-07-12T18:52:23Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/13653959?v=4",
    "events_url": "https://api.github.com/users/k8s-github-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-github-robot/followers",
    "following_url": "https://api.github.com/users/k8s-github-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-github-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-github-robot",
    "id": 13653959,
    "login": "k8s-github-robot",
    "node_id": "MDQ6VXNlcjEzNjUzOTU5",
    "organizations_url": "https://api.github.com/users/k8s-github-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-github-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-github-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-github-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-github-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-github-robot"
  },
  "comments": 3,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/47791/comments",
  "created_at": "2017-06-20T14:49:45Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/47791/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/47791",
  "id": 237238117,
  "labels": [
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Node.",
      "id": 173493665,
      "name": "sig/node",
      "node_id": "MDU6TGFiZWwxNzM0OTM2NjU=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/node"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/47791/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUyMzcyMzgxMTc=",
  "number": 47791,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "Adding `failure-domain.beta.kubernetes.io/zone` label manually causes node controller panic",
  "updated_at": "2017-07-12T18:52:23Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/47791",
  "user": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/97335?v=4",
    "events_url": "https://api.github.com/users/lukaszo/events{/privacy}",
    "followers_url": "https://api.github.com/users/lukaszo/followers",
    "following_url": "https://api.github.com/users/lukaszo/following{/other_user}",
    "gists_url": "https://api.github.com/users/lukaszo/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/lukaszo",
    "id": 97335,
    "login": "lukaszo",
    "node_id": "MDQ6VXNlcjk3MzM1",
    "organizations_url": "https://api.github.com/users/lukaszo/orgs",
    "received_events_url": "https://api.github.com/users/lukaszo/received_events",
    "repos_url": "https://api.github.com/users/lukaszo/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/lukaszo/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/lukaszo/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/lukaszo"
  }
}