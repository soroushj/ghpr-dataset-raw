{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "NONE",
  "body": "<!-- Thanks for filing an issue! Before hitting the button, please answer these questions.-->\n\n**Is this a request for help?** (If yes, you should use our troubleshooting guide and community support channels, see http://kubernetes.io/docs/troubleshooting/.):\n\nNo, already discussed on sig-auth\n\n**What keywords did you search in Kubernetes issues before filing this one?** (If you have found any duplicates, you should instead reply there.):\n\nconfirmed issue on sig-auth channel\n\n---\n\n**Is this a BUG REPORT or FEATURE REQUEST?** (choose one):\n\nDepends on interpretation\n\n<!--\nIf this is a BUG REPORT, please:\n  - Fill in as much of the template below as you can.  If you leave out\n    information, we can't help you as well.\n\nIf this is a FEATURE REQUEST, please:\n  - Describe *in detail* the feature/behavior/change you'd like to see.\n\nIn both cases, be ready for followup questions, and please respond in a timely\nmanner.  If we can't reproduce a bug or think a feature already exists, we\nmight close your issue.  If we're wrong, PLEASE feel free to reopen it and\nexplain why.\n-->\n\n**Kubernetes version** (use `kubectl version`):\n\nClient Version: version.Info{Major:\"1\", Minor:\"3\", GitVersion:\"v1.3.0\", GitCommit:\"283137936a498aed572ee22af6774b6fb6e9fd94\", GitTreeState:\"clean\", BuildDate:\"2016-07-01T19:26:38Z\", GoVersion:\"go1.6.2\", Compiler:\"gc\", Platform:\"darwin/amd64\"}\nServer Version: version.Info{Major:\"1\", Minor:\"3\", GitVersion:\"v1.3.4+coreos.0\", GitCommit:\"be9bf3e842a90537e48361aded2872e389e902e7\", GitTreeState:\"clean\", BuildDate:\"2016-08-02T00:54:53Z\", GoVersion:\"go1.6.2\", Compiler:\"gc\", Platform:\"linux/amd64\"}\n\n**Environment**:\n- **Cloud provider or hardware configuration**:  CoreOS Vagrant Image\n- **OS** (e.g. from /etc/os-release): \n\nNAME=CoreOS\nID=coreos\nVERSION=1122.0.0\nVERSION_ID=1122.0.0\nBUILD_ID=2016-07-27-0739\nPRETTY_NAME=\"CoreOS 1122.0.0 (MoreOS)\"\nANSI_COLOR=\"1;32\"\nHOME_URL=\"https://coreos.com/\"\nBUG_REPORT_URL=\"https://github.com/coreos/bugs/issues\"\n- **Kernel** (e.g. `uname -a`):\n\nLinux localhost 4.7.0-coreos #1 SMP Wed Jul 27 07:30:04 UTC 2016 x86_64 Intel(R) Core(TM) i7-4980HQ CPU @ 2.80GHz GenuineIntel GNU/Linux\n- **Install tools**:\n\nVagrant\n- **Others**:\n\n**What happened**:\n\nThe claim named in --oidc-groups-claim MUST be list of strings, even if there is only one value.  Talking to @ericchiang this is by design since its assumed that users will have more then one group.\n\n**What you expected to happen**:\n\nThe OIDC authenticator should accept either a list of strings or a single string since:\n1.  There is no concept of schema that marks an attribute as single value or multi value in JSON or a JWT\n2.  There is no standard for representing groups in a JWT\n3.  There is no standard for representing groups in OIDC\n\nAn OIDC should be flexible in how it accepts data.\n\n**How to reproduce it** (as minimally and precisely as possible):\n1.  Deploy with RBAC enabled\n2.  Create a role binding for the group \"admin\"\n3.  Generate a JWT such as the one that does NOT work below\n4.  User won't be able to login\n5.  Generate a JWT where the role is multi-value\n6.  User will be authorized\n\nDoes _NOT_ Work:\n\n``` json\n{\n  \"iss\": \"https://mlb.tremolo.lan:8043/auth/idp/oidc\",\n  \"aud\": \"kubernetes\",\n  \"exp\": 1474562249,\n  \"jti\": \"8UgF8is2XOgqPUlExxlsdg\",\n  \"iat\": 1474562189,\n  \"nbf\": 1474562069,\n  \"sub\": \"mmosley\",\n  \"user_role\": \"admin\",\n  \"email\": \"matt.mosley@tremolosecurity-test.com\"\n}\n```\n\n_DOES_ Work:\n\n``` json\n{\n  \"iss\": \"https://mlb.tremolo.lan:8043/auth/idp/oidc\",\n  \"aud\": \"kubernetes\",\n  \"exp\": 1474564875,\n  \"jti\": \"3Oo35Su-oXPX3RoUY91xXg\",\n  \"iat\": 1474564815,\n  \"nbf\": 1474564695,\n  \"sub\": \"mmosley\",\n  \"user_role\": [\n    \"admin\",\n    \"users\",\n    \"approvers\"\n  ],\n  \"email\": \"matt.mosley@tremolosecurity-test.com\"\n}\n```\n\n**Anything else do we need to know**:\n",
  "closed_at": "2016-09-23T19:41:27Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/13653959?v=4",
    "events_url": "https://api.github.com/users/k8s-github-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-github-robot/followers",
    "following_url": "https://api.github.com/users/k8s-github-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-github-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-github-robot",
    "id": 13653959,
    "login": "k8s-github-robot",
    "node_id": "MDQ6VXNlcjEzNjUzOTU5",
    "organizations_url": "https://api.github.com/users/k8s-github-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-github-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-github-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-github-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-github-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-github-robot"
  },
  "comments": 5,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/33290/comments",
  "created_at": "2016-09-22T17:30:12Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/33290/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/33290",
  "id": 178672086,
  "labels": [
    {
      "color": "0052cc",
      "default": false,
      "description": null,
      "id": 138247961,
      "name": "area/kubectl",
      "node_id": "MDU6TGFiZWwxMzgyNDc5NjE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/area/kubectl"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/33290/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUxNzg2NzIwODY=",
  "number": 33290,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "OpenIDConnect - group claim assumes list of strings, should accept single value",
  "updated_at": "2016-09-23T19:41:27Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/33290",
  "user": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/8249283?v=4",
    "events_url": "https://api.github.com/users/mlbiam/events{/privacy}",
    "followers_url": "https://api.github.com/users/mlbiam/followers",
    "following_url": "https://api.github.com/users/mlbiam/following{/other_user}",
    "gists_url": "https://api.github.com/users/mlbiam/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/mlbiam",
    "id": 8249283,
    "login": "mlbiam",
    "node_id": "MDQ6VXNlcjgyNDkyODM=",
    "organizations_url": "https://api.github.com/users/mlbiam/orgs",
    "received_events_url": "https://api.github.com/users/mlbiam/received_events",
    "repos_url": "https://api.github.com/users/mlbiam/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/mlbiam/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mlbiam/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/mlbiam"
  }
}