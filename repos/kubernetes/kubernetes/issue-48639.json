{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "MEMBER",
  "body": "<!-- This form is for bug reports and feature requests ONLY! \r\n\r\nIf you're looking for help check [Stack Overflow](https://stackoverflow.com/questions/tagged/kubernetes) and the [troubleshooting guide](https://kubernetes.io/docs/tasks/debug-application-cluster/troubleshooting/).\r\n-->\r\n\r\n**Is this a BUG REPORT or FEATURE REQUEST?**: BUG\r\n\r\n/kind bug\r\n/kind feature\r\n\r\n**What happened**:\r\n\r\nCurrently FC volume plugin supports two parameters \"targetWWNs\" and \"lun\" to specify volume from the /dev/disk/by-path/ directory. However as mentioned on the Red Hat's persistent naming documentation, devices referenced by  by-path might be changed.\r\n\r\nThis means that volume for Pod A is potentially used by Pod B on the same node and this causes security problem and also deta destruction. \r\n\r\nhttps://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Storage_Administration_Guide/persistent_naming.html\r\n\r\n```\r\nIt is generally not appropriate for applications to use these path-based names. This is\r\nbecause the storage device these paths reference may change, potentially causing incorrect\r\ndata to be written to the device. Path-based names are also not appropriate for multipath\r\ndevices, because the path-based names may be mistaken for separate storage devices, leading\r\nto uncoordinated access and unintended modifications of the data.\r\n```\r\n\r\nAlso LUN format can be contained hex value, but current LUN of FC plugin only permits integer value. Therefore LUN is restricted the value between 0 and 255 inclusive.\r\n\r\n```\r\nls -l /dev/disk/by-path/\r\nlrwxrwxrwx. 1 root root  9 Jul  6 05:12 pci-0000:05:00.0-fc-0xXXXXXXXXXXXXXXXX-lun-1 -> ../../sdc\r\nlrwxrwxrwx. 1 root root  9 Jul  6 05:14 pci-0000:05:00.0-fc-0xXXXXXXXXXXXXXXXX-lun-10 -> ../../sdd\r\nlrwxrwxrwx. 1 root root  9 Jul  6 05:25 pci-0000:05:00.0-fc-0xXXXXXXXXXXXXXXXX-lun-20 -> ../../sde\r\nlrwxrwxrwx. 1 root root  9 Jul  6 05:51 pci-0000:05:00.0-fc-0xXXXXXXXXXXXXXXXX-lun-255 -> ../../sdi\r\nlrwxrwxrwx. 1 root root  9 Jul  6 05:50 pci-0000:05:00.0-fc-0xXXXXXXXXXXXXXXXX-lun-0x0100000000000000 -> ../../sdh   (LUN-> 256)\r\nlrwxrwxrwx. 1 root root  9 Jul  6 05:40 pci-0000:05:00.0-fc-0xXXXXXXXXXXXXXXXX-lun-0x03e8000000000000 -> ../../sdf   (LUN->1000)\r\nlrwxrwxrwx. 1 root root  9 Jul  6 05:45 pci-0000:05:00.0-fc-0xXXXXXXXXXXXXXXXX-lun-0x07d0000000000000 -> ../../sdg   (LUN->2000)\r\n```\r\n\r\nor\r\n\r\nLUN specification for FC Persistent Volumes #45024\r\n```\r\nFor example, the /dev/disk/by-path for one of these devices looks like:\r\nccw-0.0.50c0-fc-0x500507680b2281fb-lun-0x027b000000000000 -> ../../sda\r\n```\r\n\r\n\r\n\r\n**What you expected to happen**:\r\n\r\nInstead of using \"targetWWNs\" and \"lun\", \"WWID\" is recommended to be used in reliably identifying devices. (See following documents)\r\n\r\nWWID can be obtained by SCSI Inquiry page 0x83 as mentioned on the following documents. The symlink including WWID for /dev/sdX is exposed under the /dev/disk/by-id/ directory. Therefore we can use \"by-id\" instead of \"by-path\".\r\n\r\n- https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Storage_Administration_Guide/persistent_naming.html#persistent_naming-wwid\r\n```\r\nThis identifier can be obtained by issuing a SCSI Inquiry to retrieve the Device Identification\r\nVital Product Data (page 0x83) or Unit Serial Number (page 0x80). The mappings from these\r\nWWIDs to the current /dev/sd names can be seen in the symlinks maintained in the\r\n/dev/disk/by-id/ directory.\r\n```\r\n- https://pubs.vmware.com/vsphere-50/index.jsp?topic=%2Fcom.vmware.vsphere.storage.doc_50%2FGUID-A36810F4-00EC-4EA8-A242-2A0DBBF56731.html\r\n- https://msdn.microsoft.com/en-us/library/windows/desktop/aa384634(v=vs.85).aspx\r\n\r\n**Anything else we need to know?**:\r\n\r\nI'll push a PR to support  \"WWID\" for FC volume plugin. Current target version is v1.8.\r\n- TODO\r\n- [ ]  Support \"WWID\" in FCVolumeSource (API change)\r\n- [ ]  Support \"WWID\" in FC volume plugin\r\n- [ ]  Deprecate current \"targetWWNs\" and \"lun\" in the future (discussion needed)",
  "closed_at": "2017-08-11T00:55:09Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/13653959?v=4",
    "events_url": "https://api.github.com/users/k8s-github-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-github-robot/followers",
    "following_url": "https://api.github.com/users/k8s-github-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-github-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-github-robot",
    "id": 13653959,
    "login": "k8s-github-robot",
    "node_id": "MDQ6VXNlcjEzNjUzOTU5",
    "organizations_url": "https://api.github.com/users/k8s-github-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-github-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-github-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-github-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-github-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-github-robot"
  },
  "comments": 5,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/48639/comments",
  "created_at": "2017-07-07T21:29:20Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/48639/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/48639",
  "id": 241385255,
  "labels": [
    {
      "color": "e11d21",
      "default": false,
      "description": "Categorizes issue or PR as related to a bug.",
      "id": 105146071,
      "name": "kind/bug",
      "node_id": "MDU6TGFiZWwxMDUxNDYwNzE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/bug"
    },
    {
      "color": "c7def8",
      "default": false,
      "description": "Categorizes issue or PR as related to a new feature.",
      "id": 267761362,
      "name": "kind/feature",
      "node_id": "MDU6TGFiZWwyNjc3NjEzNjI=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/feature"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Storage.",
      "id": 169428334,
      "name": "sig/storage",
      "node_id": "MDU6TGFiZWwxNjk0MjgzMzQ=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/storage"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/48639/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUyNDEzODUyNTU=",
  "number": 48639,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "FC volume plugin should support World Wide Identifier (WWID) parameter as an unique volume identifier",
  "updated_at": "2020-07-16T14:09:10Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/48639",
  "user": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/19844283?v=4",
    "events_url": "https://api.github.com/users/mtanino/events{/privacy}",
    "followers_url": "https://api.github.com/users/mtanino/followers",
    "following_url": "https://api.github.com/users/mtanino/following{/other_user}",
    "gists_url": "https://api.github.com/users/mtanino/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/mtanino",
    "id": 19844283,
    "login": "mtanino",
    "node_id": "MDQ6VXNlcjE5ODQ0Mjgz",
    "organizations_url": "https://api.github.com/users/mtanino/orgs",
    "received_events_url": "https://api.github.com/users/mtanino/received_events",
    "repos_url": "https://api.github.com/users/mtanino/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/mtanino/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mtanino/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/mtanino"
  }
}