{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/676637?v=4",
    "events_url": "https://api.github.com/users/feiskyer/events{/privacy}",
    "followers_url": "https://api.github.com/users/feiskyer/followers",
    "following_url": "https://api.github.com/users/feiskyer/following{/other_user}",
    "gists_url": "https://api.github.com/users/feiskyer/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/feiskyer",
    "id": 676637,
    "login": "feiskyer",
    "node_id": "MDQ6VXNlcjY3NjYzNw==",
    "organizations_url": "https://api.github.com/users/feiskyer/orgs",
    "received_events_url": "https://api.github.com/users/feiskyer/received_events",
    "repos_url": "https://api.github.com/users/feiskyer/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/feiskyer/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/feiskyer/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/feiskyer"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars2.githubusercontent.com/u/676637?v=4",
      "events_url": "https://api.github.com/users/feiskyer/events{/privacy}",
      "followers_url": "https://api.github.com/users/feiskyer/followers",
      "following_url": "https://api.github.com/users/feiskyer/following{/other_user}",
      "gists_url": "https://api.github.com/users/feiskyer/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/feiskyer",
      "id": 676637,
      "login": "feiskyer",
      "node_id": "MDQ6VXNlcjY3NjYzNw==",
      "organizations_url": "https://api.github.com/users/feiskyer/orgs",
      "received_events_url": "https://api.github.com/users/feiskyer/received_events",
      "repos_url": "https://api.github.com/users/feiskyer/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/feiskyer/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/feiskyer/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/feiskyer"
    }
  ],
  "author_association": "CONTRIBUTOR",
  "body": "<!-- Please use this template while reporting a bug and provide as much info as possible. Not doing so may result in your bug not being addressed in a timely manner. Thanks!\r\n\r\nIf the matter is security related, please disclose it privately via https://kubernetes.io/security/\r\n-->\r\n\r\n\r\n**What happened**:\r\nIf computer name prefix does not match VMSS name, then Azure cloud provider will use VMSS API instead of using metadata service data. This leads to throttling, because every affected kubelet is making API requests.\r\n\r\n**What you expected to happen**:\r\nAzure cloud provider should use metadata service data instead of calling VMSS API when instance is current.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nSet computer name prefix of the VMSS to something different than default. You should observe Azure provider making requests to the VMSS API rather than using metadata service, which leads to throttling if you have multiple kubelets with this bug.\r\n\r\n**Anything else we need to know?**:\r\nThis is bug was introduced by #89138 - `isCurrentInstance` returns false even if instance is current, because it expects\r\nnode name to match VMSS name + instance id, however node name is derived from the computer-name-prefix which can be different than VMSS name. Node name should be matched against `{computer-name-prefix}{base-36-instance-id}`, not against `{vmss-name}{base-36-instance-id}`.\r\n\r\n**Environment**:\r\n- Kubernetes version (use `kubectl version`): 1.18.x and higher\r\n- Cloud provider or hardware configuration: azure\r\n\r\n/sig cloud-provider\r\n",
  "closed_at": "2020-07-05T03:44:50Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/20407524?v=4",
    "events_url": "https://api.github.com/users/k8s-ci-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-ci-robot/followers",
    "following_url": "https://api.github.com/users/k8s-ci-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-ci-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-ci-robot",
    "id": 20407524,
    "login": "k8s-ci-robot",
    "node_id": "MDQ6VXNlcjIwNDA3NTI0",
    "organizations_url": "https://api.github.com/users/k8s-ci-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-ci-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-ci-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-ci-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-ci-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-ci-robot"
  },
  "comments": 11,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/92733/comments",
  "created_at": "2020-07-01T21:58:15Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/92733/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/92733",
  "id": 649348565,
  "labels": [
    {
      "color": "0052cc",
      "default": false,
      "description": "Issues or PRs related to azure provider",
      "id": 852130786,
      "name": "area/provider/azure",
      "node_id": "MDU6TGFiZWw4NTIxMzA3ODY=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/area/provider/azure"
    },
    {
      "color": "e11d21",
      "default": false,
      "description": "Categorizes issue or PR as related to a bug.",
      "id": 105146071,
      "name": "kind/bug",
      "node_id": "MDU6TGFiZWwxMDUxNDYwNzE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/bug"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Cloud Provider.",
      "id": 958178286,
      "name": "sig/cloud-provider",
      "node_id": "MDU6TGFiZWw5NTgxNzgyODY=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/cloud-provider"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/92733/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU2NDkzNDg1NjU=",
  "number": 92733,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "Azure provider uses VMSS API instead of metadata service when computer name prefix differs from VMSS name",
  "updated_at": "2020-07-07T17:00:26Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/92733",
  "user": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/1050702?v=4",
    "events_url": "https://api.github.com/users/mateuszlitwin/events{/privacy}",
    "followers_url": "https://api.github.com/users/mateuszlitwin/followers",
    "following_url": "https://api.github.com/users/mateuszlitwin/following{/other_user}",
    "gists_url": "https://api.github.com/users/mateuszlitwin/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/mateuszlitwin",
    "id": 1050702,
    "login": "mateuszlitwin",
    "node_id": "MDQ6VXNlcjEwNTA3MDI=",
    "organizations_url": "https://api.github.com/users/mateuszlitwin/orgs",
    "received_events_url": "https://api.github.com/users/mateuszlitwin/received_events",
    "repos_url": "https://api.github.com/users/mateuszlitwin/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/mateuszlitwin/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mateuszlitwin/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/mateuszlitwin"
  }
}