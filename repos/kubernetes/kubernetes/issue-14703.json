{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/3272040?v=4",
    "events_url": "https://api.github.com/users/timstclair/events{/privacy}",
    "followers_url": "https://api.github.com/users/timstclair/followers",
    "following_url": "https://api.github.com/users/timstclair/following{/other_user}",
    "gists_url": "https://api.github.com/users/timstclair/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/timstclair",
    "id": 3272040,
    "login": "timstclair",
    "node_id": "MDQ6VXNlcjMyNzIwNDA=",
    "organizations_url": "https://api.github.com/users/timstclair/orgs",
    "received_events_url": "https://api.github.com/users/timstclair/received_events",
    "repos_url": "https://api.github.com/users/timstclair/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/timstclair/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/timstclair/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/timstclair"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars1.githubusercontent.com/u/3272040?v=4",
      "events_url": "https://api.github.com/users/timstclair/events{/privacy}",
      "followers_url": "https://api.github.com/users/timstclair/followers",
      "following_url": "https://api.github.com/users/timstclair/following{/other_user}",
      "gists_url": "https://api.github.com/users/timstclair/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/timstclair",
      "id": 3272040,
      "login": "timstclair",
      "node_id": "MDQ6VXNlcjMyNzIwNDA=",
      "organizations_url": "https://api.github.com/users/timstclair/orgs",
      "received_events_url": "https://api.github.com/users/timstclair/received_events",
      "repos_url": "https://api.github.com/users/timstclair/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/timstclair/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/timstclair/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/timstclair"
    }
  ],
  "author_association": "NONE",
  "body": "`kubectl run foo --attach` runs foo and then waits for it to be ready or terminated. If the pod is terminated, it prints the log, and if it's not terminated, it attaches the output. However, it does not handle the case that the pod terminates between returning the ready status and attaching, as can be the case in the [kubectl e2e test](https://github.com/kubernetes/kubernetes/blob/master/test/e2e/kubectl.go#L193):\n\n``` console\n[It] should support inline execution and attach\n...\n    Sep 28 13:49:15.303: Error running &{/jenkins-master-data/jobs/kubernetes-pull-build-test-e2e-gce/workspace/kubernetes/platforms/linux/amd64/kubectl [kubectl --server=https://104.197.180.162 --kubeconfig=/var/lib/jenkins/jobs/kubernetes-pull-build-test-e2e-gce/workspace/.kube/config --namespace=e2e-tests-kubectl-1bdva run run-test --image=busybox --restart=Never --attach=true echo running in container] []  <nil> Waiting for pod e2e-tests-kubectl-1bdva/run-test to be running, status is Pending, pod ready: false\n    Waiting for pod e2e-tests-kubectl-1bdva/run-test to be running, status is Pending, pod ready: false\n     error: error executing remote command: Error executing command in container: container not found (\"run-test\")\n     [] <nil> 0xc20829d3a0 exit status 1 <nil> true [0xc2080528e0 0xc208052920 0xc208052968] [0xc2080528e0 0xc208052920 0xc208052968] [0xc208052918 0xc208052940] [0x6aa400 0x6aa400] 0xc208370060}:\n    Command stdout:\n    Waiting for pod e2e-tests-kubectl-1bdva/run-test to be running, status is Pending, pod ready: false\n    Waiting for pod e2e-tests-kubectl-1bdva/run-test to be running, status is Pending, pod ready: false\n\n    stderr:\n    error: error executing remote command: Error executing command in container: container not found (\"run-test\")\n```\n\nOptions to fix this:\n- Fix kubectl:\n  - If attach fails, fall back to printing the logs\n  - If attach fails, check the status again and if it's terminated, print the logs\n- Fix the flaky test:\n  - Prevent the container from exiting (e.g. `sh -c 'echo running in container && sleep 30')\n  - Prevent the container from entering ready state (e.g. `readinessProbe: {initialDelaySeconds: 30}`)\n\n@brendandburns\n",
  "closed_at": "2015-10-02T00:10:10Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/13653959?v=4",
    "events_url": "https://api.github.com/users/k8s-github-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-github-robot/followers",
    "following_url": "https://api.github.com/users/k8s-github-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-github-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-github-robot",
    "id": 13653959,
    "login": "k8s-github-robot",
    "node_id": "MDQ6VXNlcjEzNjUzOTU5",
    "organizations_url": "https://api.github.com/users/k8s-github-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-github-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-github-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-github-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-github-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-github-robot"
  },
  "comments": 1,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/14703/comments",
  "created_at": "2015-09-29T01:46:05Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/14703/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/14703",
  "id": 108779314,
  "labels": [
    {
      "color": "f7c6c7",
      "default": false,
      "description": "Categorizes issue or PR as related to a flaky test.",
      "id": 264749912,
      "name": "kind/flake",
      "node_id": "MDU6TGFiZWwyNjQ3NDk5MTI=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/flake"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/14703/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUxMDg3NzkzMTQ=",
  "number": 14703,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "Race condition in `kubectl run --attach`",
  "updated_at": "2015-10-02T00:10:10Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/14703",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/3272040?v=4",
    "events_url": "https://api.github.com/users/timstclair/events{/privacy}",
    "followers_url": "https://api.github.com/users/timstclair/followers",
    "following_url": "https://api.github.com/users/timstclair/following{/other_user}",
    "gists_url": "https://api.github.com/users/timstclair/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/timstclair",
    "id": 3272040,
    "login": "timstclair",
    "node_id": "MDQ6VXNlcjMyNzIwNDA=",
    "organizations_url": "https://api.github.com/users/timstclair/orgs",
    "received_events_url": "https://api.github.com/users/timstclair/received_events",
    "repos_url": "https://api.github.com/users/timstclair/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/timstclair/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/timstclair/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/timstclair"
  }
}