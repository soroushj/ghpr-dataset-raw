{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/2823529?v=4",
    "events_url": "https://api.github.com/users/caesarxuchao/events{/privacy}",
    "followers_url": "https://api.github.com/users/caesarxuchao/followers",
    "following_url": "https://api.github.com/users/caesarxuchao/following{/other_user}",
    "gists_url": "https://api.github.com/users/caesarxuchao/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/caesarxuchao",
    "id": 2823529,
    "login": "caesarxuchao",
    "node_id": "MDQ6VXNlcjI4MjM1Mjk=",
    "organizations_url": "https://api.github.com/users/caesarxuchao/orgs",
    "received_events_url": "https://api.github.com/users/caesarxuchao/received_events",
    "repos_url": "https://api.github.com/users/caesarxuchao/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/caesarxuchao/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/caesarxuchao/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/caesarxuchao"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars2.githubusercontent.com/u/2823529?v=4",
      "events_url": "https://api.github.com/users/caesarxuchao/events{/privacy}",
      "followers_url": "https://api.github.com/users/caesarxuchao/followers",
      "following_url": "https://api.github.com/users/caesarxuchao/following{/other_user}",
      "gists_url": "https://api.github.com/users/caesarxuchao/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/caesarxuchao",
      "id": 2823529,
      "login": "caesarxuchao",
      "node_id": "MDQ6VXNlcjI4MjM1Mjk=",
      "organizations_url": "https://api.github.com/users/caesarxuchao/orgs",
      "received_events_url": "https://api.github.com/users/caesarxuchao/received_events",
      "repos_url": "https://api.github.com/users/caesarxuchao/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/caesarxuchao/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/caesarxuchao/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/caesarxuchao"
    },
    {
      "avatar_url": "https://avatars2.githubusercontent.com/u/31416425?v=4",
      "events_url": "https://api.github.com/users/jennybuckley/events{/privacy}",
      "followers_url": "https://api.github.com/users/jennybuckley/followers",
      "following_url": "https://api.github.com/users/jennybuckley/following{/other_user}",
      "gists_url": "https://api.github.com/users/jennybuckley/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jennybuckley",
      "id": 31416425,
      "login": "jennybuckley",
      "node_id": "MDQ6VXNlcjMxNDE2NDI1",
      "organizations_url": "https://api.github.com/users/jennybuckley/orgs",
      "received_events_url": "https://api.github.com/users/jennybuckley/received_events",
      "repos_url": "https://api.github.com/users/jennybuckley/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jennybuckley/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jennybuckley/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jennybuckley"
    }
  ],
  "author_association": "MEMBER",
  "body": "**What happened**:\r\n\r\nDeployed a webhook backend and service as follows:\r\n**Please note that there is only 8443 port on the service.** \r\n```\r\napiVersion: extensions/v1beta1\r\nkind: Deployment\r\nmetadata:\r\n  labels:\r\n    run: webhook\r\n  name: webhook\r\n  namespace: kube-system\r\nspec:\r\n  template:\r\n    metadata:\r\n      labels:\r\n        run: webhook\r\n    spec:\r\n      containers:\r\n      - args:\r\n        - --tls-cert-file=/webhook.local.config/certificates/tls.crt\r\n        - --tls-private-key-file=/webhook.local.config/certificates/tls.key\r\n        - --alsologtostderr\r\n        - -v=4\r\n        - 2>&1\r\n        image: xxxxxxxxxxxxxxxxxxxxxxxxxxx\r\n        imagePullPolicy: Always\r\n        name: webhook\r\n        volumeMounts:\r\n        - mountPath: /webhook.local.config/certificates\r\n          name: webhook-certs\r\n          readOnly: true\r\n      volumes:\r\n      - name: webhook-certs\r\n        secret:\r\n          defaultMode: 420\r\n          secretName: webhook-secret\r\n---\r\napiVersion: v1\r\nkind: Service\r\nmetadata:\r\n  labels:\r\n    run: webhook\r\n  name: webhook-service\r\n  namespace: kube-system\r\nspec:\r\n  ports:\r\n    - port: 8443\r\n      protocol: TCP\r\n      targetPort: 8443\r\n  selector:\r\n    run: \"webhook\"\r\n\r\n```\r\n\r\nRegister the webhook as follows:\r\n```\r\n{  \r\n   \"metadata\":{  \r\n      \"name\":\"webhook-config\",\r\n      \"selfLink\":\"/apis/admissionregistration.k8s.io/v1beta1/mutatingwebhookconfigurations/webhook-config\",\r\n      \"uid\":\"d0ea605f-2d68-11e8-a2a7-42010a280002\",\r\n      \"resourceVersion\":\"867428\",\r\n      \"generation\":1,\r\n      \"creationTimestamp\":\"2018-03-22T00:34:43Z\"\r\n   },\r\n   \"webhooks\":[  \r\n      {  \r\n         \"name\":\"adding-annotation.k8s.io\",\r\n         \"clientConfig\":{  \r\n            \"service\":{  \r\n               \"namespace\":\"kube-system\",\r\n               \"name\":\"webhook-service\",\r\n               \"path\":\"/mutating-pods\"\r\n            },\r\n            \"caBundle\":\"xxxxxxxxxxxxxxxxxxxx\"\r\n         },\r\n         \"rules\":[  \r\n            {  \r\n               \"operations\":[  \r\n                  \"CREATE\"\r\n               ],\r\n               \"apiGroups\":[  \r\n                  \"\"\r\n               ],\r\n               \"apiVersions\":[  \r\n                  \"v1\"\r\n               ],\r\n               \"resources\":[  \r\n                  \"pods\"\r\n               ]\r\n            }\r\n         ],\r\n         \"failurePolicy\":\"Fail\",\r\n         \"namespaceSelector\":{  \r\n\r\n         }\r\n      }\r\n   ]\r\n}\r\n```\r\n\r\nGot the following error when creating pods:\r\n```\r\nError creating: Internal error occurred: failed calling admission webhook \"adding-annotation.k8s.io\": Post https://webhook-service.kube-system.svc:443/mutating-pods?timeout=30s: no service port \"443\" found for service \"webhook-service\"\r\n```\r\n\r\n**What you expected to happen**:\r\nBased on https://github.com/kubernetes/api/blob/master/admissionregistration/v1beta1/types.go#L257, `https://webhook-service.kube-system.svc:8443/mutating-pods` should be called. Not the 443 port shown in the error message.\r\n\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nJust deploy the same setup and register webhook. \r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Kubernetes version (use `kubectl version`): HEAD\r\nClient Version: version.Info{Major:\"1\", Minor:\"10+\", GitVersion:\"v1.10.0-alpha.1.97+2bbae9ab581bf6-dirty\", GitCommit:\"2bbae9ab581bf6fc0fb491136c42673c745c190d\", GitTreeState:\"dirty\", BuildDate:\"2018-01-22T20:00:24Z\", GoVersion:\"go1.9.1\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\nServer Version: version.Info{Major:\"1\", Minor:\"11+\", GitVersion:\"v1.11.0-alpha.0.470+890bd2174cf566\", GitCommit:\"890bd2174cf566e663c9cc0768799f7a94dbf6f0\", GitTreeState:\"clean\", BuildDate:\"2018-03-12T19:36:42Z\", GoVersion:\"go1.9.3\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\n- Cloud provider or hardware configuration: GCE\r\n- OS (e.g. from /etc/os-release): COS\r\n- Kernel (e.g. `uname -a`): COS\r\n",
  "closed_at": "2018-04-13T22:03:10Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/13653959?v=4",
    "events_url": "https://api.github.com/users/k8s-github-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-github-robot/followers",
    "following_url": "https://api.github.com/users/k8s-github-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-github-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-github-robot",
    "id": 13653959,
    "login": "k8s-github-robot",
    "node_id": "MDQ6VXNlcjEzNjUzOTU5",
    "organizations_url": "https://api.github.com/users/k8s-github-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-github-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-github-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-github-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-github-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-github-robot"
  },
  "comments": 5,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/61510/comments",
  "created_at": "2018-03-22T00:44:42Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/61510/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/61510",
  "id": 307467087,
  "labels": [
    {
      "color": "0052cc",
      "default": false,
      "description": null,
      "id": 486445796,
      "name": "area/admission-control",
      "node_id": "MDU6TGFiZWw0ODY0NDU3OTY=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/area/admission-control"
    },
    {
      "color": "e11d21",
      "default": false,
      "description": "Categorizes issue or PR as related to a bug.",
      "id": 105146071,
      "name": "kind/bug",
      "node_id": "MDU6TGFiZWwxMDUxNDYwNzE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/bug"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG API Machinery.",
      "id": 173493835,
      "name": "sig/api-machinery",
      "node_id": "MDU6TGFiZWwxNzM0OTM4MzU=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/api-machinery"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/61510/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUzMDc0NjcwODc=",
  "number": 61510,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "Webhook ServiceReference keeps calling 443 port when there is only one non-443 port in ServiceSpec",
  "updated_at": "2020-02-17T19:59:42Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/61510",
  "user": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/1332699?v=4",
    "events_url": "https://api.github.com/users/freehan/events{/privacy}",
    "followers_url": "https://api.github.com/users/freehan/followers",
    "following_url": "https://api.github.com/users/freehan/following{/other_user}",
    "gists_url": "https://api.github.com/users/freehan/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/freehan",
    "id": 1332699,
    "login": "freehan",
    "node_id": "MDQ6VXNlcjEzMzI2OTk=",
    "organizations_url": "https://api.github.com/users/freehan/orgs",
    "received_events_url": "https://api.github.com/users/freehan/received_events",
    "repos_url": "https://api.github.com/users/freehan/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/freehan/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/freehan/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/freehan"
  }
}