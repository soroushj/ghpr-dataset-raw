{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "NONE",
  "body": "<!-- This form is for bug reports and feature requests ONLY! \r\n\r\nIf you're looking for help check [Stack Overflow](https://stackoverflow.com/questions/tagged/kubernetes) and the [troubleshooting guide](https://kubernetes.io/docs/tasks/debug-application-cluster/troubleshooting/).\r\n-->\r\n\r\n**Is this a BUG REPORT or FEATURE REQUEST?**:\r\n\r\n/kind feature\r\n\r\n\r\n**What happened**:\r\n\r\nWe run Kuberentes on AWS. We are trying out `LoadBalancer` service type.\r\n\r\nWe use Terraform heavily for managing infrastructure on AWS. As a result we have several shared security groups with \"perfect\" rules. One of them is supposed to be attached to ELBs so our own IPs, partners, etc are whitelisted. Right now, it seems there isn't a way for Kubernetes to use the security group as is. There are several alternatives:\r\n\r\n- Pass my existing security group as `service.beta.kubernetes.io/aws-load-balancer-extra-security-groups` annotation. However, Kubernetes still tries to create one first, or use a global security group. If I don't provide any IP range, Kubernetes will whitelist `0.0.0.0/0`. This seems insecure.\r\n- Provide my own IP ranges as either annotation `service.beta.kubernetes.io/load-balancer-source-ranges` or `service.Spec.LoadBalancerSourceRanges`. Then Kubernetes will create a security group for this ELB with the given IPs. This means I need to duplicate my IPs in all microservices.\r\n- Provide my own IP ranges as either annotation `service.beta.kubernetes.io/load-balancer-source-ranges` or `service.Spec.LoadBalancerSourceRanges`, and use a global security group. Then Kubernetes will modify the global SG with the given IPs. This seems problematic when lots of microservices share one SG but some want different IPs whitelisted.\r\n\r\nI want to entertain the idea below:\r\n\r\n- Allow users to sepcify another security group to `kube-controller-manager` or `Service` object, which Kubernetes will take it and attach it to ELBs as is.\r\n- If such security group is provided, skip other IP whitelisting steps.\r\n\r\n\r\n**What you expected to happen**:\r\n\r\nI can give Kubernetes existing security group(s). Kuberentes just attaches the security group(s) to the managed ELBs without modifying the rules.\r\n\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n\r\n**Anything else we need to know?**:\r\n\r\nIt may already be possible to achieve this, and I'm not aware of. Or there are other concerns so that Kubernetes didn't choose to implement this feature.\r\n\r\n**Environment**:\r\n- Kubernetes version (use `kubectl version`): v1.7.1\r\n- Cloud provider or hardware configuration**: AWS\r\n- OS (e.g. from /etc/os-release):\r\n- Kernel (e.g. `uname -a`):\r\n- Install tools:\r\n- Others:\r\n",
  "closed_at": "2018-10-01T22:51:14Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/20407524?v=4",
    "events_url": "https://api.github.com/users/k8s-ci-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-ci-robot/followers",
    "following_url": "https://api.github.com/users/k8s-ci-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-ci-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-ci-robot",
    "id": 20407524,
    "login": "k8s-ci-robot",
    "node_id": "MDQ6VXNlcjIwNDA3NTI0",
    "organizations_url": "https://api.github.com/users/k8s-ci-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-ci-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-ci-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-ci-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-ci-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-ci-robot"
  },
  "comments": 12,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/49445/comments",
  "created_at": "2017-07-22T18:06:33Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/49445/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/49445",
  "id": 244862246,
  "labels": [
    {
      "color": "c7def8",
      "default": false,
      "description": "Categorizes issue or PR as related to a new feature.",
      "id": 267761362,
      "name": "kind/feature",
      "node_id": "MDU6TGFiZWwyNjc3NjEzNjI=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/feature"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/49445/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUyNDQ4NjIyNDY=",
  "number": 49445,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "Do not modify ELB security group",
  "updated_at": "2019-05-22T15:39:52Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/49445",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/464299?v=4",
    "events_url": "https://api.github.com/users/zihaoyu/events{/privacy}",
    "followers_url": "https://api.github.com/users/zihaoyu/followers",
    "following_url": "https://api.github.com/users/zihaoyu/following{/other_user}",
    "gists_url": "https://api.github.com/users/zihaoyu/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/zihaoyu",
    "id": 464299,
    "login": "zihaoyu",
    "node_id": "MDQ6VXNlcjQ2NDI5OQ==",
    "organizations_url": "https://api.github.com/users/zihaoyu/orgs",
    "received_events_url": "https://api.github.com/users/zihaoyu/received_events",
    "repos_url": "https://api.github.com/users/zihaoyu/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/zihaoyu/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/zihaoyu/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/zihaoyu"
  }
}