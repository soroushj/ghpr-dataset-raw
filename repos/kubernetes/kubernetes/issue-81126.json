{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "MEMBER",
  "body": "This issue was reported in the [Kubernetes Security Audit Report](https://github.com/kubernetes/community/blob/master/wg-security-audit/findings/Kubernetes%20Final%20Report.pdf)\r\n\r\n**Description**\r\nThe kube-apiserver includes multiple authentication backends for client request processing. These range in strength from client certificate authentication to simple HTTP Basic Authentication. When using a password (Basic Authentication), the kube-apiserver does not perform a secure comparison of secret values. In theory, this could allow an attacker to perform a timing attack on the comparison. For example, the AuthenticatePassword function simply performs string comparison to authenticate a user\u2019s password (Figure 9.1).\r\n\r\n```\r\nfunc ( a* PasswordAuthenticator ) AuthenticatePassword ( ctx context . Context , username , password string ) (* authenticator . Response , bool , error ) {\r\n\tuser, ok := a.users[username]\r\n\tif !ok {\r\n\t\treturn nil , false , nil\r\n\t}\r\n\tif user.password != password {\r\n\t\treturn nil , false , nil\r\n\t}\r\n\treturn &authenticator.Response{User: user.info}, true , nil\r\n}\r\n```\r\nFigure 9.1: Username and password authentication handling in passwordfile.go\r\n\r\n**Exploit Scenario**\r\nAlice runs a Kubernetes cluster in production. In order to support multiple organizational \u201ccustomers,\u201d she configures the cluster with HTTP Basic Authentication. Eve has a large number of username and password pairs for the organization, and uses the side-channel information from string comparison to tune her credential-stuffing attacks.\r\n\r\n**Recommendation**\r\nShort term, use a safe, constant-time comparison function such as `crypto.subtle.ConstantTimeCompare`. The comparison function should take the same amount of time regardless of matching prefix data within the password.\r\n\r\nLong term, deprecate Basic Authentication in favor of more robust and secure options. Add documentation noting that any Basic Authentication is for use only in development scenarios, and not appropriate for production deployments. This will help users create a robust and secure default stance for all deployments.\r\n\r\n**Anything else we need to know?**:\r\n\r\nSee #81146 for current status of all issues created from these findings.\r\n\r\nThe vendor gave this issue an ID of ATR-K8S-002 and it was finding 18 of the report.\r\n\r\nThe vendor considers this issue Medium Severity.\r\n\r\nTo view the original finding, begin on page 55 of the [Kubernetes Security Review Report](https://github.com/kubernetes/community/blob/master/wg-security-audit/findings/Kubernetes%20Final%20Report.pdf)\r\n\r\n**Environment**:\r\n\r\n- Kubernetes version: 1.13.4\r\n\r\nFixed in v1.16.0 by https://github.com/kubernetes/kubernetes/pull/81152",
  "closed_at": "2019-08-08T19:36:00Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/20407524?v=4",
    "events_url": "https://api.github.com/users/k8s-ci-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-ci-robot/followers",
    "following_url": "https://api.github.com/users/k8s-ci-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-ci-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-ci-robot",
    "id": 20407524,
    "login": "k8s-ci-robot",
    "node_id": "MDQ6VXNlcjIwNDA3NTI0",
    "organizations_url": "https://api.github.com/users/k8s-ci-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-ci-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-ci-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-ci-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-ci-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-ci-robot"
  },
  "comments": 2,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/81126/comments",
  "created_at": "2019-08-08T02:03:51Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/81126/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/81126",
  "id": 478214012,
  "labels": [
    {
      "color": "d93f0b",
      "default": false,
      "description": null,
      "id": 116712923,
      "name": "area/security",
      "node_id": "MDU6TGFiZWwxMTY3MTI5MjM=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/area/security"
    },
    {
      "color": "e11d21",
      "default": false,
      "description": "Categorizes issue or PR as related to a bug.",
      "id": 105146071,
      "name": "kind/bug",
      "node_id": "MDU6TGFiZWwxMDUxNDYwNzE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/bug"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Auth.",
      "id": 357119284,
      "name": "sig/auth",
      "node_id": "MDU6TGFiZWwzNTcxMTkyODQ=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/auth"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to WG Security Audit.",
      "id": 1086787146,
      "name": "wg/security-audit",
      "node_id": "MDU6TGFiZWwxMDg2Nzg3MTQ2",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/wg/security-audit"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/81126/labels{/name}",
  "locked": false,
  "milestone": {
    "closed_at": null,
    "closed_issues": 1361,
    "created_at": "2019-01-31T15:17:37Z",
    "creator": {
      "avatar_url": "https://avatars0.githubusercontent.com/u/980082?v=4",
      "events_url": "https://api.github.com/users/liggitt/events{/privacy}",
      "followers_url": "https://api.github.com/users/liggitt/followers",
      "following_url": "https://api.github.com/users/liggitt/following{/other_user}",
      "gists_url": "https://api.github.com/users/liggitt/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/liggitt",
      "id": 980082,
      "login": "liggitt",
      "node_id": "MDQ6VXNlcjk4MDA4Mg==",
      "organizations_url": "https://api.github.com/users/liggitt/orgs",
      "received_events_url": "https://api.github.com/users/liggitt/received_events",
      "repos_url": "https://api.github.com/users/liggitt/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/liggitt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/liggitt/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/liggitt"
    },
    "description": null,
    "due_on": null,
    "html_url": "https://github.com/kubernetes/kubernetes/milestone/45",
    "id": 4018466,
    "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/milestones/45/labels",
    "node_id": "MDk6TWlsZXN0b25lNDAxODQ2Ng==",
    "number": 45,
    "open_issues": 0,
    "state": "open",
    "title": "v1.16",
    "updated_at": "2020-10-25T01:09:02Z",
    "url": "https://api.github.com/repos/kubernetes/kubernetes/milestones/45"
  },
  "node_id": "MDU6SXNzdWU0NzgyMTQwMTI=",
  "number": 81126,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "ATR-K8S-002: Non-constant time password comparison ",
  "updated_at": "2019-08-09T03:20:35Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/81126",
  "user": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/419708?v=4",
    "events_url": "https://api.github.com/users/cji/events{/privacy}",
    "followers_url": "https://api.github.com/users/cji/followers",
    "following_url": "https://api.github.com/users/cji/following{/other_user}",
    "gists_url": "https://api.github.com/users/cji/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/cji",
    "id": 419708,
    "login": "cji",
    "node_id": "MDQ6VXNlcjQxOTcwOA==",
    "organizations_url": "https://api.github.com/users/cji/orgs",
    "received_events_url": "https://api.github.com/users/cji/received_events",
    "repos_url": "https://api.github.com/users/cji/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/cji/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cji/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/cji"
  }
}