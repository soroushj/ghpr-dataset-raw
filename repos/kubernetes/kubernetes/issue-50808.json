{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "CONTRIBUTOR",
  "body": "**Background**\r\nAs part of the greater controller GA effort, we have removed defaulting `spec.selector` to `spec.template.labels` values in `apps/v1beta2` as the defaulting operation is semantically broken. In this issue, we propose to make `spec.selector` immutable after API object creation.\r\n\r\n**Motivation**\r\n\r\n1. Changing selectors leads to undefined behaviors - users are not expected to change the selectors\r\n2. Having selectors immutable ensures they always match created children, preventing events such as accidental bulk orphaning\r\n3. Having selectors mutable for GA is an immortal decision, which does not guarantee API backward compatibility\r\n\r\nImmutability resolves some challenging issues that plague many teams for over a year e.g., #34292, and the current behavior for controllers with respect to selector mutations is undefined e.g., #26202.\r\n\r\nIn contrast, by making selectors immutable, validation ensures the selectors always match template labels of created children. This provides a risk-free, deterministic behavior to resolve the issue, and meet the general goal of declarative configuration.\r\n\r\nWe could **lift the immutability in future** after all controller types have well-defined behaviors (i.e., after GA). This provides ability to address new use cases while maintaining API backward compatibility. However, if we do not make selectors immutable prior to GA, we will have to live with mutable selectors for the lifetime of the v1 API and the controllers\u2019 undefined behaviors until reasonable semantics are decided and implemented.\r\n\r\n/kind bug\r\n/sig apps\r\n/sig api-machinery\r\n@bgrant0607 @erictune @kow3ns @enisoc @janetkuo @foxish @liyinan926 \r\n@liggitt @smarterclayton @kargakis @mikedanese \r\n\r\n",
  "closed_at": "2017-09-01T04:09:08Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/13653959?v=4",
    "events_url": "https://api.github.com/users/k8s-github-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-github-robot/followers",
    "following_url": "https://api.github.com/users/k8s-github-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-github-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-github-robot",
    "id": 13653959,
    "login": "k8s-github-robot",
    "node_id": "MDQ6VXNlcjEzNjUzOTU5",
    "organizations_url": "https://api.github.com/users/k8s-github-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-github-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-github-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-github-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-github-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-github-robot"
  },
  "comments": 26,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/50808/comments",
  "created_at": "2017-08-16T23:16:52Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/50808/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/50808",
  "id": 250786876,
  "labels": [
    {
      "color": "e11d21",
      "default": false,
      "description": "Categorizes issue or PR as related to a bug.",
      "id": 105146071,
      "name": "kind/bug",
      "node_id": "MDU6TGFiZWwxMDUxNDYwNzE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/bug"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG API Machinery.",
      "id": 173493835,
      "name": "sig/api-machinery",
      "node_id": "MDU6TGFiZWwxNzM0OTM4MzU=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/api-machinery"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Apps.",
      "id": 404091735,
      "name": "sig/apps",
      "node_id": "MDU6TGFiZWw0MDQwOTE3MzU=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/apps"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/50808/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUyNTA3ODY4NzY=",
  "number": 50808,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "Controller selectors should be immutable after creation",
  "updated_at": "2017-09-01T04:09:08Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/50808",
  "user": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/13921630?v=4",
    "events_url": "https://api.github.com/users/crimsonfaith91/events{/privacy}",
    "followers_url": "https://api.github.com/users/crimsonfaith91/followers",
    "following_url": "https://api.github.com/users/crimsonfaith91/following{/other_user}",
    "gists_url": "https://api.github.com/users/crimsonfaith91/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/crimsonfaith91",
    "id": 13921630,
    "login": "crimsonfaith91",
    "node_id": "MDQ6VXNlcjEzOTIxNjMw",
    "organizations_url": "https://api.github.com/users/crimsonfaith91/orgs",
    "received_events_url": "https://api.github.com/users/crimsonfaith91/received_events",
    "repos_url": "https://api.github.com/users/crimsonfaith91/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/crimsonfaith91/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/crimsonfaith91/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/crimsonfaith91"
  }
}