{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/980082?v=4",
    "events_url": "https://api.github.com/users/liggitt/events{/privacy}",
    "followers_url": "https://api.github.com/users/liggitt/followers",
    "following_url": "https://api.github.com/users/liggitt/following{/other_user}",
    "gists_url": "https://api.github.com/users/liggitt/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/liggitt",
    "id": 980082,
    "login": "liggitt",
    "node_id": "MDQ6VXNlcjk4MDA4Mg==",
    "organizations_url": "https://api.github.com/users/liggitt/orgs",
    "received_events_url": "https://api.github.com/users/liggitt/received_events",
    "repos_url": "https://api.github.com/users/liggitt/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/liggitt/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/liggitt/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/liggitt"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars0.githubusercontent.com/u/980082?v=4",
      "events_url": "https://api.github.com/users/liggitt/events{/privacy}",
      "followers_url": "https://api.github.com/users/liggitt/followers",
      "following_url": "https://api.github.com/users/liggitt/following{/other_user}",
      "gists_url": "https://api.github.com/users/liggitt/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/liggitt",
      "id": 980082,
      "login": "liggitt",
      "node_id": "MDQ6VXNlcjk4MDA4Mg==",
      "organizations_url": "https://api.github.com/users/liggitt/orgs",
      "received_events_url": "https://api.github.com/users/liggitt/received_events",
      "repos_url": "https://api.github.com/users/liggitt/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/liggitt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/liggitt/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/liggitt"
    }
  ],
  "author_association": "NONE",
  "body": "**What happened**:\r\n\r\nIf you establish a WATCH request on a list of CRs, then edit the CRD's `validation` object, you will stop getting MODIFIED events on the WATCH request. The WATCH request doesn't fail or report an error, but will not return more MODIFIED events until the request is restarted.\r\n\r\nThis causes problems for custom controllers, which become unresponsive until their requests expire.\r\n\r\n**What you expected to happen**:\r\n\r\nEither the request should end (so it can be restarted safely) or it should continue to return MODIFIED events.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nI've attached [repro.sh.txt](https://github.com/kubernetes/kubernetes/files/2590209/repro.sh.txt). It does the following:\r\n\r\n- Create CRD and an initial CR.\r\n- Start a proxy, wait for it to come up, then start a watch request.\r\n- Change the CR. (This change to the CR results in a MODIFIED event)\r\n- Change the `validation` section of the CRD.\r\n- Make another change to the CR. (This change to the CR doesn't result in an event).\r\n\r\nI've tested this against GKE masters on 1.9, 1.10 and 1.11, as well as a kubeadm 1.12.2 cluster. The output looks like:\r\n\r\n```\r\ncustomresourcedefinition.apiextensions.k8s.io/testcrs.example.com created\r\ntestcr.example.com/my-test-cr created\r\nStarting to serve on 127.0.0.1:8303\r\n{\"type\":\"ADDED\",\"object\":{\"apiVersion\":\"example.com/v1\",\"kind\":\"TestCR\",\"metadata\":{\"creationTimestamp\":\"2018-11-16T17:08:48Z\",\"generation\":1,\"name\":\"my-test-cr\",\"namespace\":\"default\",\"resourceVersion\":\"471\",\"selfLink\":\"/apis/example.com/v1/namespaces/default/testcrs/my-test-cr\",\"uid\":\"4845b766-e9c2-11e8-a427-02423c385d1a\"},\"spec\":{\"a\":\"asdf\"}}}\r\ntestcr.example.com/my-test-cr replaced\r\n{\"type\":\"MODIFIED\",\"object\":{\"apiVersion\":\"example.com/v1\",\"kind\":\"TestCR\",\"metadata\":{\"creationTimestamp\":\"2018-11-16T17:08:48Z\",\"generation\":1,\"name\":\"my-test-cr\",\"namespace\":\"default\",\"resourceVersion\":\"474\",\"selfLink\":\"/apis/example.com/v1/namespaces/default/testcrs/my-test-cr\",\"uid\":\"4845b766-e9c2-11e8-a427-02423c385d1a\"},\"spec\":{\"a\":\"This change to the CR results in a MODIFIED event.\"}}}\r\nThe first modification has been made.\r\ncustomresourcedefinition.apiextensions.k8s.io/testcrs.example.com replaced\r\ntestcr.example.com/my-test-cr replaced\r\nThe second modification has been made.\r\ntestcr.example.com \"my-test-cr\" deleted\r\ncustomresourcedefinition.apiextensions.k8s.io \"testcrs.example.com\" deleted\r\ncurl: (18) transfer closed with outstanding read data remaining\r\n```\r\n\r\nNote that you only see MODIFIED once despite the CR being changed twice.\r\n\r\n**Environment**:\r\n- Kubernetes version (use `kubectl version`): 1.11.2-gke.18, 1.12.2\r\n- Cloud provider or hardware configuration: GKE, kubeadm on amd64\r\n- OS (e.g. from /etc/os-release): Ubuntu 16.04\r\n- Kernel (e.g. `uname -a`): 4.15.0-36-generic #39~16.04.1-Ubuntu SMP\r\n\r\n<!-- DO NOT EDIT BELOW THIS LINE -->\r\n/kind bug",
  "closed_at": "2019-05-18T01:57:18Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/20407524?v=4",
    "events_url": "https://api.github.com/users/k8s-ci-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-ci-robot/followers",
    "following_url": "https://api.github.com/users/k8s-ci-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-ci-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-ci-robot",
    "id": 20407524,
    "login": "k8s-ci-robot",
    "node_id": "MDQ6VXNlcjIwNDA3NTI0",
    "organizations_url": "https://api.github.com/users/k8s-ci-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-ci-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-ci-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-ci-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-ci-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-ci-robot"
  },
  "comments": 8,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/71138/comments",
  "created_at": "2018-11-16T17:02:23Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/71138/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/71138",
  "id": 381683662,
  "labels": [
    {
      "color": "0052cc",
      "default": false,
      "description": null,
      "id": 556590057,
      "name": "area/custom-resources",
      "node_id": "MDU6TGFiZWw1NTY1OTAwNTc=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/area/custom-resources"
    },
    {
      "color": "e11d21",
      "default": false,
      "description": "Categorizes issue or PR as related to a bug.",
      "id": 105146071,
      "name": "kind/bug",
      "node_id": "MDU6TGFiZWwxMDUxNDYwNzE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/bug"
    },
    {
      "color": "d3e2f0",
      "default": false,
      "description": "Indicates that an issue or PR should not be auto-closed due to staleness.",
      "id": 778118403,
      "name": "lifecycle/frozen",
      "node_id": "MDU6TGFiZWw3NzgxMTg0MDM=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/lifecycle/frozen"
    },
    {
      "color": "eb6420",
      "default": false,
      "description": "Must be staffed and worked on either currently, or very soon, ideally in time for the next release.",
      "id": 114528223,
      "name": "priority/important-soon",
      "node_id": "MDU6TGFiZWwxMTQ1MjgyMjM=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/priority/important-soon"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG API Machinery.",
      "id": 173493835,
      "name": "sig/api-machinery",
      "node_id": "MDU6TGFiZWwxNzM0OTM4MzU=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/api-machinery"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/71138/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUzODE2ODM2NjI=",
  "number": 71138,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "Changing CRD validation causes existing WATCH requests to silently hang",
  "updated_at": "2019-05-18T01:57:18Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/71138",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/632207?v=4",
    "events_url": "https://api.github.com/users/drigz/events{/privacy}",
    "followers_url": "https://api.github.com/users/drigz/followers",
    "following_url": "https://api.github.com/users/drigz/following{/other_user}",
    "gists_url": "https://api.github.com/users/drigz/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/drigz",
    "id": 632207,
    "login": "drigz",
    "node_id": "MDQ6VXNlcjYzMjIwNw==",
    "organizations_url": "https://api.github.com/users/drigz/orgs",
    "received_events_url": "https://api.github.com/users/drigz/received_events",
    "repos_url": "https://api.github.com/users/drigz/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/drigz/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/drigz/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/drigz"
  }
}