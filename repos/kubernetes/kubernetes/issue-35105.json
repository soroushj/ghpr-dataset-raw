{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "MEMBER",
  "body": "I've been testing a simple upgrade script for kubeadm, and discovered this surprising behaviour:\n\n```\nroot@38b1eff931f0:/# cat /etc/kubernetes/manifests/kube-apiserver.json\n{\n  \"kind\": \"Pod\",\n  \"apiVersion\": \"v1\",\n  \"metadata\": {\n    \"name\": \"kube-apiserver\",\n    \"namespace\": \"kube-system\",\n    \"creationTimestamp\": null,\n    \"labels\": {\n      \"component\": \"kube-apiserver\",\n      \"tier\": \"control-plane\"\n    }\n  },\n  \"spec\": {\n    \"volumes\": [\n      {\n        \"name\": \"certs\",\n        \"hostPath\": {\n          \"path\": \"/etc/ssl/certs\"\n        }\n      },\n      {\n        \"name\": \"pki\",\n        \"hostPath\": {\n          \"path\": \"/etc/kubernetes\"\n        }\n      }\n    ],\n    \"containers\": [\n      {\n        \"name\": \"kube-apiserver\",\n        \"image\": \"gcr.io/google_containers/kube-apiserver-amd64:v1.4.0\",\n        \"command\": [\n          \"/usr/local/bin/kube-apiserver\",\n          \"--v=4\",\n          \"--insecure-bind-address=127.0.0.1\",\n          \"--etcd-servers=http://127.0.0.1:2379\",\n          \"--admission-control=NamespaceLifecycle,LimitRanger,ServiceAccount,PersistentVolumeLabel,DefaultStorageClass,ResourceQuota\",\n          \"--service-cluster-ip-range=100.64.0.0/12\",\n          \"--service-account-key-file=/etc/kubernetes/pki/apiserver-key.pem\",\n          \"--client-ca-file=/etc/kubernetes/pki/ca.pem\",\n          \"--tls-cert-file=/etc/kubernetes/pki/apiserver.pem\",\n          \"--tls-private-key-file=/etc/kubernetes/pki/apiserver-key.pem\",\n          \"--token-auth-file=/etc/kubernetes/pki/tokens.csv\",\n          \"--secure-port=443\",\n          \"--allow-privileged\",\n          \"--etcd-servers=http://127.0.0.1:2379\"\n        ],\n        \"resources\": {\n          \"requests\": {\n            \"cpu\": \"250m\"\n          }\n        },\n        \"volumeMounts\": [\n          {\n            \"name\": \"certs\",\n            \"mountPath\": \"/etc/ssl/certs\"\n          },\n          {\n            \"name\": \"pki\",\n            \"readOnly\": true,\n            \"mountPath\": \"/etc/kubernetes/\"\n          }\n        ],\n        \"livenessProbe\": {\n          \"httpGet\": {\n            \"path\": \"/healthz\",\n            \"port\": 8080,\n            \"host\": \"127.0.0.1\"\n          },\n          \"initialDelaySeconds\": 15,\n          \"timeoutSeconds\": 15\n        }\n      }\n    ],\n    \"hostNetwork\": true\n  },\n  \"status\": {}\n}\nroot@38b1eff931f0:/# kubectl set image -f /etc/kubernetes/manifests/kube-apiserver.json kube-apiserver=gcr.io/google_containers/kube-apiserver-amd64:v1.4.3 --local -o json > /tmp/kube-apiserver.json\nroot@38b1eff931f0:/# cat /tmp/kube-apiserver.json \nrunning in local mode...\n{\n    \"kind\": \"Pod\",\n    \"apiVersion\": \"v1\",\n    \"metadata\": {\n        \"name\": \"kube-apiserver\",\n        \"namespace\": \"kube-system\",\n        \"creationTimestamp\": null,\n        \"labels\": {\n            \"component\": \"kube-apiserver\",\n            \"tier\": \"control-plane\"\n        }\n    },\n    \"spec\": {\n        \"volumes\": [\n            {\n                \"name\": \"certs\",\n                \"hostPath\": {\n                    \"path\": \"/etc/ssl/certs\"\n                }\n            },\n            {\n                \"name\": \"pki\",\n                \"hostPath\": {\n                    \"path\": \"/etc/kubernetes\"\n                }\n            }\n        ],\n        \"containers\": [\n            {\n                \"name\": \"kube-apiserver\",\n                \"image\": \"gcr.io/google_containers/kube-apiserver-amd64:v1.4.3\",\n                \"command\": [\n                    \"/usr/local/bin/kube-apiserver\",\n                    \"--v=4\",\n                    \"--insecure-bind-address=127.0.0.1\",\n                    \"--etcd-servers=http://127.0.0.1:2379\",\n                    \"--admission-control=NamespaceLifecycle,LimitRanger,ServiceAccount,PersistentVolumeLabel,DefaultStorageClass,ResourceQuota\",\n                    \"--service-cluster-ip-range=100.64.0.0/12\",\n                    \"--service-account-key-file=/etc/kubernetes/pki/apiserver-key.pem\",\n                    \"--client-ca-file=/etc/kubernetes/pki/ca.pem\",\n                    \"--tls-cert-file=/etc/kubernetes/pki/apiserver.pem\",\n                    \"--tls-private-key-file=/etc/kubernetes/pki/apiserver-key.pem\",\n                    \"--token-auth-file=/etc/kubernetes/pki/tokens.csv\",\n                    \"--secure-port=443\",\n                    \"--allow-privileged\",\n                    \"--etcd-servers=http://127.0.0.1:2379\"\n                ],\n                \"resources\": {\n                    \"requests\": {\n                        \"cpu\": \"250m\"\n                    }\n                },\n                \"volumeMounts\": [\n                    {\n                        \"name\": \"certs\",\n                        \"mountPath\": \"/etc/ssl/certs\"\n                    },\n                    {\n                        \"name\": \"pki\",\n                        \"readOnly\": true,\n                        \"mountPath\": \"/etc/kubernetes/\"\n                    }\n                ],\n                \"livenessProbe\": {\n                    \"httpGet\": {\n                        \"path\": \"/healthz\",\n                        \"port\": 8080,\n                        \"host\": \"127.0.0.1\",\n                        \"scheme\": \"HTTP\"\n                    },\n                    \"initialDelaySeconds\": 15,\n                    \"timeoutSeconds\": 15,\n                    \"periodSeconds\": 10,\n                    \"successThreshold\": 1,\n                    \"failureThreshold\": 3\n                },\n                \"terminationMessagePath\": \"/dev/termination-log\",\n                \"imagePullPolicy\": \"IfNotPresent\"\n            }\n        ],\n        \"restartPolicy\": \"Always\",\n        \"terminationGracePeriodSeconds\": 30,\n        \"dnsPolicy\": \"ClusterFirst\",\n        \"hostNetwork\": true,\n        \"securityContext\": {}\n    },\n    \"status\": {}\n}\nroot@38b1eff931f0:/# \n```\n\nThe problem is with `running in local mode...` message, it shouldn't appear when output is being redirected. \n",
  "closed_at": "2016-10-19T13:23:38Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/13653959?v=4",
    "events_url": "https://api.github.com/users/k8s-github-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-github-robot/followers",
    "following_url": "https://api.github.com/users/k8s-github-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-github-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-github-robot",
    "id": 13653959,
    "login": "k8s-github-robot",
    "node_id": "MDQ6VXNlcjEzNjUzOTU5",
    "organizations_url": "https://api.github.com/users/k8s-github-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-github-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-github-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-github-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-github-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-github-robot"
  },
  "comments": 0,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/35105/comments",
  "created_at": "2016-10-19T10:39:39Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/35105/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/35105",
  "id": 183926097,
  "labels": [
    {
      "color": "0052cc",
      "default": false,
      "description": null,
      "id": 136601536,
      "name": "area/apiserver",
      "node_id": "MDU6TGFiZWwxMzY2MDE1MzY=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/area/apiserver"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG API Machinery.",
      "id": 173493835,
      "name": "sig/api-machinery",
      "node_id": "MDU6TGFiZWwxNzM0OTM4MzU=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/api-machinery"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/35105/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUxODM5MjYwOTc=",
  "number": 35105,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "kubectl set image outputs user-facing message when output is redirected",
  "updated_at": "2016-10-19T13:23:38Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/35105",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/251467?v=4",
    "events_url": "https://api.github.com/users/errordeveloper/events{/privacy}",
    "followers_url": "https://api.github.com/users/errordeveloper/followers",
    "following_url": "https://api.github.com/users/errordeveloper/following{/other_user}",
    "gists_url": "https://api.github.com/users/errordeveloper/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/errordeveloper",
    "id": 251467,
    "login": "errordeveloper",
    "node_id": "MDQ6VXNlcjI1MTQ2Nw==",
    "organizations_url": "https://api.github.com/users/errordeveloper/orgs",
    "received_events_url": "https://api.github.com/users/errordeveloper/received_events",
    "repos_url": "https://api.github.com/users/errordeveloper/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/errordeveloper/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/errordeveloper/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/errordeveloper"
  }
}