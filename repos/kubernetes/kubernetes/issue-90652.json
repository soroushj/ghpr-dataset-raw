{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/5071689?v=4",
    "events_url": "https://api.github.com/users/gongguan/events{/privacy}",
    "followers_url": "https://api.github.com/users/gongguan/followers",
    "following_url": "https://api.github.com/users/gongguan/following{/other_user}",
    "gists_url": "https://api.github.com/users/gongguan/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/gongguan",
    "id": 5071689,
    "login": "gongguan",
    "node_id": "MDQ6VXNlcjUwNzE2ODk=",
    "organizations_url": "https://api.github.com/users/gongguan/orgs",
    "received_events_url": "https://api.github.com/users/gongguan/received_events",
    "repos_url": "https://api.github.com/users/gongguan/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/gongguan/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gongguan/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/gongguan"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars0.githubusercontent.com/u/5071689?v=4",
      "events_url": "https://api.github.com/users/gongguan/events{/privacy}",
      "followers_url": "https://api.github.com/users/gongguan/followers",
      "following_url": "https://api.github.com/users/gongguan/following{/other_user}",
      "gists_url": "https://api.github.com/users/gongguan/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/gongguan",
      "id": 5071689,
      "login": "gongguan",
      "node_id": "MDQ6VXNlcjUwNzE2ODk=",
      "organizations_url": "https://api.github.com/users/gongguan/orgs",
      "received_events_url": "https://api.github.com/users/gongguan/received_events",
      "repos_url": "https://api.github.com/users/gongguan/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/gongguan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gongguan/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/gongguan"
    }
  ],
  "author_association": "MEMBER",
  "body": "For external cloud provider - Kubelet setting the TaintExternalCloudProvider taint: https://github.com/kubernetes/kubernetes/blob/master/pkg/kubelet/kubelet_node_status.go#L266\r\n\r\nThe results in calling `initializeNode` function in cloud node-controller:\r\nhttps://github.com/kubernetes/kubernetes/blob/5c276a451d64d161b21d70042d93f4c4b8e3201d/pkg/controller/cloud/node_controller.go#L323\r\n\r\nThis (in a healthy case) sends 4 GCE API calls to:\r\n1. get node addresses: https://github.com/kubernetes/kubernetes/blob/5c276a451d64d161b21d70042d93f4c4b8e3201d/pkg/controller/cloud/node_controller.go#L439 (as part of getNodeModifier call)\r\n2. get instance type:\r\nhttps://github.com/kubernetes/kubernetes/blob/5c276a451d64d161b21d70042d93f4c4b8e3201d/pkg/controller/cloud/node_controller.go#L452 (as part of getNodeModifiers call)\r\n3. get instance:\r\nhttps://github.com/kubernetes/kubernetes/blob/5c276a451d64d161b21d70042d93f4c4b8e3201d/pkg/controller/cloud/node_controller.go#L233 (as part of updateNodeAddresses call)\r\n4. get node addresses (again):\r\nhttps://github.com/kubernetes/kubernetes/blob/5c276a451d64d161b21d70042d93f4c4b8e3201d/pkg/controller/cloud/node_controller.go#L242 (as part of updateNodeAddresses call)\r\n\r\nAll those requests are read requests and could be replaced by a single call.\r\nWe could do that by introducing a simple struct like:\r\n```\r\ntype InstanceMetadata struct {\r\n  ProviderID ...\r\n  Type ...\r\n  NodeAddresses ...\r\n}\r\n```\r\nand adding a method (or rather replacing the existing InstanceTypeByProviderID which is used only for this purpose) to Instances cloud-provider interface;\r\n```\r\nfunc InstanceMetadataByProviderID(...) (*InstanceMetadata, error)\r\n```\r\n\r\nWith that change, we would be able to replace all that 4 calls with just a single API call.\r\n\r\nThis would be useful especially for creating large clusters (like 5k nodes), which may saturate the quota for API calls for quite some time.\r\n\r\nThis is quite significant size of refactoring, though it should be relatively mechanical task to do.\r\n\r\n/sig cloud-provider\r\n/sig scalability\r\n/priority important-longterm\r\n\r\n/help-wanted\r\n\r\n@mborsz @mm4tt - FYI",
  "closed_at": "2020-09-22T12:12:23Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/20407524?v=4",
    "events_url": "https://api.github.com/users/k8s-ci-robot/events{/privacy}",
    "followers_url": "https://api.github.com/users/k8s-ci-robot/followers",
    "following_url": "https://api.github.com/users/k8s-ci-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-ci-robot/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/k8s-ci-robot",
    "id": 20407524,
    "login": "k8s-ci-robot",
    "node_id": "MDQ6VXNlcjIwNDA3NTI0",
    "organizations_url": "https://api.github.com/users/k8s-ci-robot/orgs",
    "received_events_url": "https://api.github.com/users/k8s-ci-robot/received_events",
    "repos_url": "https://api.github.com/users/k8s-ci-robot/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/k8s-ci-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-ci-robot/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/k8s-ci-robot"
  },
  "comments": 13,
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/90652/comments",
  "created_at": "2020-04-30T18:51:21Z",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/90652/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/90652",
  "id": 610307751,
  "labels": [
    {
      "color": "006b75",
      "default": true,
      "description": "Denotes an issue that needs help from a contributor. Must meet \"help wanted\" guidelines.",
      "id": 433686790,
      "name": "help wanted",
      "node_id": "MDU6TGFiZWw0MzM2ODY3OTA=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/help%20wanted"
    },
    {
      "color": "eb6420",
      "default": false,
      "description": "Important over the long term, but may not be staffed and/or may need multiple releases to complete.",
      "id": 496752236,
      "name": "priority/important-longterm",
      "node_id": "MDU6TGFiZWw0OTY3NTIyMzY=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/priority/important-longterm"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Cloud Provider.",
      "id": 958178286,
      "name": "sig/cloud-provider",
      "node_id": "MDU6TGFiZWw5NTgxNzgyODY=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/cloud-provider"
    },
    {
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Scalability.",
      "id": 125010198,
      "name": "sig/scalability",
      "node_id": "MDU6TGFiZWwxMjUwMTAxOTg=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/scalability"
    }
  ],
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/90652/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU2MTAzMDc3NTE=",
  "number": 90652,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "state": "closed",
  "title": "Reduce the number of calls to GCE API (for clusters on GCE) coming from cloud node-controller",
  "updated_at": "2020-09-22T12:12:24Z",
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/90652",
  "user": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/10743879?v=4",
    "events_url": "https://api.github.com/users/wojtek-t/events{/privacy}",
    "followers_url": "https://api.github.com/users/wojtek-t/followers",
    "following_url": "https://api.github.com/users/wojtek-t/following{/other_user}",
    "gists_url": "https://api.github.com/users/wojtek-t/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/wojtek-t",
    "id": 10743879,
    "login": "wojtek-t",
    "node_id": "MDQ6VXNlcjEwNzQzODc5",
    "organizations_url": "https://api.github.com/users/wojtek-t/orgs",
    "received_events_url": "https://api.github.com/users/wojtek-t/received_events",
    "repos_url": "https://api.github.com/users/wojtek-t/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/wojtek-t/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/wojtek-t/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/wojtek-t"
  }
}