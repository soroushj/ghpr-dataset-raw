{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "NONE",
  "body": "**Description**\r\n\r\nRunning ``Docker version 18.09.1, build 4c52b90`` on ``Ubuntu 18.04.1 LTS (GNU/Linux 4.15.0-44-generic x86_64)``. My various containers, all running swift code based on official swift images from https://hub.docker.com/_/swift latest tag are crashing randomly every couple of days.\r\n\r\nI only receive a message ``\"shim reaped\"`` and because my docker container restart policy is set to ``unless-stopped`` the container restarts automatically and runs again for couple days.\r\n\r\nLooking at all the logs and docker stats the container memory usage is stable, process inside the container is not reporting any troubles.\r\n\r\nEnabled ``containerd`` debug and found the stack trace pasted below. The same stack trace is reported from multiple containers running different swift projects.\r\n\r\n**Describe the results you received:**\r\n\r\nContainer randomly restarting without any apparent cause,  only ``\"shim reaped\"`` being reported to the logs.\r\n\r\n**Describe the results you expected:**\r\n\r\nContainer running smoothly for years :)\r\n\r\nI'm not sure if this ``\"shim reaped\"`` is a result of silent crash of the process inside the container, in which case I'd love to get more diagnostics as to what happened and to which process. Right now I'm not sure if this is the crash of my app, or crash of ``containers-shim``. Please help me clarify. The stack trace below is pointing to null pointer dereference in ``containerd`` go code.\r\n\r\n**Output of `containerd --version`:**\r\n\r\n```\r\ncontainerd github.com/containerd/containerd 1.2.2 9754871865f7fe2f4e74d43e2fc7ccd237edcbce\r\n```\r\n\r\n\r\n```\r\nJan 31 08:24:11 pmx-2 containerd[784]: panic: runtime error: invalid memory address or nil pointer dereference\r\nJan 31 08:24:11 pmx-2 containerd[784]: [signal SIGSEGV: segmentation violation code=0x1 addr=0x78 pc=0x5ff488]\r\nJan 31 08:24:11 pmx-2 containerd[784]: goroutine 18 [running]:\r\nJan 31 08:24:11 pmx-2 containerd[784]: github.com/containerd/containerd/runtime/v1/linux/proc.(*execProcess).pidv(...)\r\nJan 31 08:24:11 pmx-2 containerd[784]: #011/go/src/github.com/containerd/containerd/runtime/v1/linux/proc/exec.go:76\r\nJan 31 08:24:11 pmx-2 containerd[784]: github.com/containerd/containerd/runtime/v1/linux/proc.(*execStoppedState).Pid(0x8d8cf0, 0xffffffffffffffff)\r\nJan 31 08:24:11 pmx-2 containerd[784]: #011/go/src/github.com/containerd/containerd/runtime/v1/linux/proc/exec_state.go:175 +0x8\r\nJan 31 08:24:11 pmx-2 containerd[784]: github.com/containerd/containerd/runtime/v1/linux/proc.(*execProcess).Pid(0xc420088000, 0x6b2)\r\nJan 31 08:24:11 pmx-2 containerd[784]: #011/go/src/github.com/containerd/containerd/runtime/v1/linux/proc/exec.go:72 +0x34\r\nJan 31 08:24:11 pmx-2 containerd[784]: github.com/containerd/containerd/runtime/v1/shim.(*Service).checkProcesses(0xc420136000, 0xbf0cc686daab6e4b, 0x42f0c5aab511, 0x8bc720, 0x6ab7, 0x0)\r\nJan 31 08:24:11 pmx-2 containerd[784]: #011/go/src/github.com/containerd/containerd/runtime/v1/shim/service.go:514 +0xde\r\nJan 31 08:24:11 pmx-2 containerd[784]: github.com/containerd/containerd/runtime/v1/shim.(*Service).processExits(0xc420136000)\r\nJan 31 08:24:11 pmx-2 containerd[784]: #011/go/src/github.com/containerd/containerd/runtime/v1/shim/service.go:492 +0xd0\r\nJan 31 08:24:11 pmx-2 containerd[784]: created by github.com/containerd/containerd/runtime/v1/shim.NewService\r\nJan 31 08:24:11 pmx-2 containerd[784]: #011/go/src/github.com/containerd/containerd/runtime/v1/shim/service.go:91 +0x3e9\r\nJan 31 08:24:11 pmx-2 containerd[784]: time=\"2019-01-31T08:24:11.458001949+01:00\" level=info msg=\"shim reaped\" id=0f04f4b172dbd5f40b27e98ba6559ad072852cca84c1410792883a35c0cc7076\r\nJan 31 08:24:11 pmx-2 containerd[784]: time=\"2019-01-31T08:24:11.458352273+01:00\" level=warning msg=\"cleaning up after killed shim\" id=0f04f4b172dbd5f40b27e98ba6559ad072852cca84c1410792883a35c0cc7076 namespace=moby```\r\n",
  "closed_at": "2019-02-01T21:08:41Z",
  "closed_by": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/749551?v=4",
    "events_url": "https://api.github.com/users/crosbymichael/events{/privacy}",
    "followers_url": "https://api.github.com/users/crosbymichael/followers",
    "following_url": "https://api.github.com/users/crosbymichael/following{/other_user}",
    "gists_url": "https://api.github.com/users/crosbymichael/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/crosbymichael",
    "id": 749551,
    "login": "crosbymichael",
    "node_id": "MDQ6VXNlcjc0OTU1MQ==",
    "organizations_url": "https://api.github.com/users/crosbymichael/orgs",
    "received_events_url": "https://api.github.com/users/crosbymichael/received_events",
    "repos_url": "https://api.github.com/users/crosbymichael/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/crosbymichael/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/crosbymichael/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/crosbymichael"
  },
  "comments": 3,
  "comments_url": "https://api.github.com/repos/containerd/containerd/issues/2969/comments",
  "created_at": "2019-01-31T10:12:48Z",
  "events_url": "https://api.github.com/repos/containerd/containerd/issues/2969/events",
  "html_url": "https://github.com/containerd/containerd/issues/2969",
  "id": 405171304,
  "labels": [
    {
      "color": "FF8C94",
      "default": false,
      "description": null,
      "id": 347599646,
      "name": "kind/bug",
      "node_id": "MDU6TGFiZWwzNDc1OTk2NDY=",
      "url": "https://api.github.com/repos/containerd/containerd/labels/kind/bug"
    },
    {
      "color": "e11d21",
      "default": false,
      "description": null,
      "id": 347599659,
      "name": "priority/P0",
      "node_id": "MDU6TGFiZWwzNDc1OTk2NTk=",
      "url": "https://api.github.com/repos/containerd/containerd/labels/priority/P0"
    }
  ],
  "labels_url": "https://api.github.com/repos/containerd/containerd/issues/2969/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU0MDUxNzEzMDQ=",
  "number": 2969,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/containerd/containerd",
  "state": "closed",
  "title": "[signal SIGSEGV: segmentation violation code=0x1 addr=0x78 pc=0x5ff488]",
  "updated_at": "2019-02-11T10:23:47Z",
  "url": "https://api.github.com/repos/containerd/containerd/issues/2969",
  "user": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/249814?v=4",
    "events_url": "https://api.github.com/users/mman/events{/privacy}",
    "followers_url": "https://api.github.com/users/mman/followers",
    "following_url": "https://api.github.com/users/mman/following{/other_user}",
    "gists_url": "https://api.github.com/users/mman/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/mman",
    "id": 249814,
    "login": "mman",
    "node_id": "MDQ6VXNlcjI0OTgxNA==",
    "organizations_url": "https://api.github.com/users/mman/orgs",
    "received_events_url": "https://api.github.com/users/mman/received_events",
    "repos_url": "https://api.github.com/users/mman/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/mman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mman/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/mman"
  }
}