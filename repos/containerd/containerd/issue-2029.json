{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "CONTRIBUTOR",
  "body": "Hi all,\r\n\r\nAs more and more images have been transformed to multi-arch-images. For those platforms only support single runtime (e.g.  only support arm64/amd64 runtime environment), we can send the single arch information to containerd to request matched image. But, when the platform supports multi-arch runtimes (e.g. support arm64 and arm32 runtime environments), how can we handle multi-arch images?\r\n \r\nBecause both arm64 and arm32 container images can run on these platforms. In current code, containerd gets GOARCH from Go runtime. But the GOARCH could not represent the actual ability of the platform. For example, if you installed Golang-aarch64 on a platform that supports arm64/arm32 runtimes. The Go runtime only reports arm64 to containerd. The containerd will only find the arm64 images for this platform, but will ignore all arm32 images. In some areas, this will be an issue. For example, telecom carriers like AT&T will use arm64 servers to run lots containers for IoT services. If it can't find suitable arm64 images, it doesn't mind to run arm32 containers for IoT. \r\n\r\nIn order to solve this issue, can we pass a list of supported runtime architectures to containerd? For example, if platform supports arm64v8 and arm32v7 Runtime, we can send both to containerd. We can see this figure:\r\n\r\n![image](https://user-images.githubusercontent.com/25216491/35132807-fa180d60-fd07-11e7-9ef9-1536e5d0bd53.png)\r\n\r\nIn consideration of performance, we can define priorities for these architectures to match images. On a arm64 server, we can define the highest priority for arm64. But we have divergence of handling the images when the priority matched image is missing. If we send both arm64v8 and arm32v7 to containerd to pull busybox image from repository. After parsing the image manifest file, we have following options:\r\n1. If this image supports arm64v8, that\u2019s good, containerd will pull it for us.\r\n2. If this image supports neither arm64v8 nor arm32v7. That\u2019s OK. containerd can exit.\r\n3. If this image support arm32v7 but doesn\u2019t support arm64v8. How should we handle this case?\r\n    - Option#1: containerd should fall back to pull the arm32v7 image automatically and print some message to notify user\r\n    - Option#2: we should notify the user in advance and provide a choice to user to select 'Yes' or 'No' to download such compatible images.\r\n\r\n@stevvooe @estesp @mattspencer-arm @Pennyzct @stevecapperlinaro\r\n\r\nRegards,\r\nWei Chen\r\n",
  "closed_at": "2018-08-27T14:22:12Z",
  "closed_by": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/749551?v=4",
    "events_url": "https://api.github.com/users/crosbymichael/events{/privacy}",
    "followers_url": "https://api.github.com/users/crosbymichael/followers",
    "following_url": "https://api.github.com/users/crosbymichael/following{/other_user}",
    "gists_url": "https://api.github.com/users/crosbymichael/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/crosbymichael",
    "id": 749551,
    "login": "crosbymichael",
    "node_id": "MDQ6VXNlcjc0OTU1MQ==",
    "organizations_url": "https://api.github.com/users/crosbymichael/orgs",
    "received_events_url": "https://api.github.com/users/crosbymichael/received_events",
    "repos_url": "https://api.github.com/users/crosbymichael/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/crosbymichael/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/crosbymichael/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/crosbymichael"
  },
  "comments": 18,
  "comments_url": "https://api.github.com/repos/containerd/containerd/issues/2029/comments",
  "created_at": "2018-01-19T05:18:16Z",
  "events_url": "https://api.github.com/repos/containerd/containerd/issues/2029/events",
  "html_url": "https://github.com/containerd/containerd/issues/2029",
  "id": 289865578,
  "labels": [
    {
      "color": "AAB3AB",
      "default": false,
      "description": null,
      "id": 347599657,
      "name": "kind/feature",
      "node_id": "MDU6TGFiZWwzNDc1OTk2NTc=",
      "url": "https://api.github.com/repos/containerd/containerd/labels/kind/feature"
    },
    {
      "color": "d4c5f9",
      "default": false,
      "description": null,
      "id": 347599663,
      "name": "roadmap",
      "node_id": "MDU6TGFiZWwzNDc1OTk2NjM=",
      "url": "https://api.github.com/repos/containerd/containerd/labels/roadmap"
    }
  ],
  "labels_url": "https://api.github.com/repos/containerd/containerd/issues/2029/labels{/name}",
  "locked": false,
  "milestone": {
    "closed_at": "2018-10-26T16:45:53Z",
    "closed_issues": 80,
    "created_at": "2017-12-19T20:28:17Z",
    "creator": {
      "avatar_url": "https://avatars1.githubusercontent.com/u/120601?v=4",
      "events_url": "https://api.github.com/users/stevvooe/events{/privacy}",
      "followers_url": "https://api.github.com/users/stevvooe/followers",
      "following_url": "https://api.github.com/users/stevvooe/following{/other_user}",
      "gists_url": "https://api.github.com/users/stevvooe/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/stevvooe",
      "id": 120601,
      "login": "stevvooe",
      "node_id": "MDQ6VXNlcjEyMDYwMQ==",
      "organizations_url": "https://api.github.com/users/stevvooe/orgs",
      "received_events_url": "https://api.github.com/users/stevvooe/received_events",
      "repos_url": "https://api.github.com/users/stevvooe/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/stevvooe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stevvooe/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/stevvooe"
    },
    "description": "",
    "due_on": null,
    "html_url": "https://github.com/containerd/containerd/milestone/17",
    "id": 2989685,
    "labels_url": "https://api.github.com/repos/containerd/containerd/milestones/17/labels",
    "node_id": "MDk6TWlsZXN0b25lMjk4OTY4NQ==",
    "number": 17,
    "open_issues": 0,
    "state": "closed",
    "title": "1.2",
    "updated_at": "2019-02-06T04:23:01Z",
    "url": "https://api.github.com/repos/containerd/containerd/milestones/17"
  },
  "node_id": "MDU6SXNzdWUyODk4NjU1Nzg=",
  "number": 2029,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/containerd/containerd",
  "state": "closed",
  "title": "Discuss: How to handle multi-arch images when platforms support multi-arch runtimes?",
  "updated_at": "2018-11-15T22:26:01Z",
  "url": "https://api.github.com/repos/containerd/containerd/issues/2029",
  "user": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/25216491?v=4",
    "events_url": "https://api.github.com/users/Weichen81/events{/privacy}",
    "followers_url": "https://api.github.com/users/Weichen81/followers",
    "following_url": "https://api.github.com/users/Weichen81/following{/other_user}",
    "gists_url": "https://api.github.com/users/Weichen81/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/Weichen81",
    "id": 25216491,
    "login": "Weichen81",
    "node_id": "MDQ6VXNlcjI1MjE2NDkx",
    "organizations_url": "https://api.github.com/users/Weichen81/orgs",
    "received_events_url": "https://api.github.com/users/Weichen81/received_events",
    "repos_url": "https://api.github.com/users/Weichen81/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/Weichen81/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Weichen81/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/Weichen81"
  }
}