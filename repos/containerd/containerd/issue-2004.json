{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "MEMBER",
  "body": "Currently all our code which handles mounts (such as for diff, user namespace remapping, resolving user ids) is relying on the process which performed the mount to unmount on success or error. The problem is there is a 3rd possible case, that the process crashes between the mount and unmount, where the mount is now completely untracked after the process starts back up. Cleaning up these mounts would require user interaction. A possible solution to this is use a common location for mount targets for temporary mounts which are done outside of a mount namespace. Containerd or a Containerd client can check these on startup and unmount any lingering mounts. A better long term solution would be to always perform these operations in a subprocess which has its own mount namespace (similar to the idea of chroot or containerization of some operations).\r\n\r\nNote: this was considered when discussing integrating containerd snapshotters into moby. The moby graph drivers always mount to a single location, requiring only management of a single mount point and reducing the number of mounts which could leak. However moby still lacks leak protection in failure scenarios if a graph driver layer gets removed but fails to unmount properly.",
  "closed_at": "2018-02-21T20:56:23Z",
  "closed_by": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/169601?v=4",
    "events_url": "https://api.github.com/users/dmcgowan/events{/privacy}",
    "followers_url": "https://api.github.com/users/dmcgowan/followers",
    "following_url": "https://api.github.com/users/dmcgowan/following{/other_user}",
    "gists_url": "https://api.github.com/users/dmcgowan/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/dmcgowan",
    "id": 169601,
    "login": "dmcgowan",
    "node_id": "MDQ6VXNlcjE2OTYwMQ==",
    "organizations_url": "https://api.github.com/users/dmcgowan/orgs",
    "received_events_url": "https://api.github.com/users/dmcgowan/received_events",
    "repos_url": "https://api.github.com/users/dmcgowan/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/dmcgowan/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dmcgowan/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/dmcgowan"
  },
  "comments": 3,
  "comments_url": "https://api.github.com/repos/containerd/containerd/issues/2004/comments",
  "created_at": "2018-01-12T23:45:04Z",
  "events_url": "https://api.github.com/repos/containerd/containerd/issues/2004/events",
  "html_url": "https://github.com/containerd/containerd/issues/2004",
  "id": 288278276,
  "labels": [],
  "labels_url": "https://api.github.com/repos/containerd/containerd/issues/2004/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUyODgyNzgyNzY=",
  "number": 2004,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/containerd/containerd",
  "state": "closed",
  "title": "Track mounts for diff and other operations",
  "updated_at": "2018-02-21T20:56:23Z",
  "url": "https://api.github.com/repos/containerd/containerd/issues/2004",
  "user": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/169601?v=4",
    "events_url": "https://api.github.com/users/dmcgowan/events{/privacy}",
    "followers_url": "https://api.github.com/users/dmcgowan/followers",
    "following_url": "https://api.github.com/users/dmcgowan/following{/other_user}",
    "gists_url": "https://api.github.com/users/dmcgowan/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/dmcgowan",
    "id": 169601,
    "login": "dmcgowan",
    "node_id": "MDQ6VXNlcjE2OTYwMQ==",
    "organizations_url": "https://api.github.com/users/dmcgowan/orgs",
    "received_events_url": "https://api.github.com/users/dmcgowan/received_events",
    "repos_url": "https://api.github.com/users/dmcgowan/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/dmcgowan/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dmcgowan/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/dmcgowan"
  }
}