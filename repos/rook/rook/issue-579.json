{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/1048514?v=4",
    "events_url": "https://api.github.com/users/travisn/events{/privacy}",
    "followers_url": "https://api.github.com/users/travisn/followers",
    "following_url": "https://api.github.com/users/travisn/following{/other_user}",
    "gists_url": "https://api.github.com/users/travisn/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/travisn",
    "id": 1048514,
    "login": "travisn",
    "node_id": "MDQ6VXNlcjEwNDg1MTQ=",
    "organizations_url": "https://api.github.com/users/travisn/orgs",
    "received_events_url": "https://api.github.com/users/travisn/received_events",
    "repos_url": "https://api.github.com/users/travisn/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/travisn/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/travisn/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/travisn"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars0.githubusercontent.com/u/1048514?v=4",
      "events_url": "https://api.github.com/users/travisn/events{/privacy}",
      "followers_url": "https://api.github.com/users/travisn/followers",
      "following_url": "https://api.github.com/users/travisn/following{/other_user}",
      "gists_url": "https://api.github.com/users/travisn/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/travisn",
      "id": 1048514,
      "login": "travisn",
      "node_id": "MDQ6VXNlcjEwNDg1MTQ=",
      "organizations_url": "https://api.github.com/users/travisn/orgs",
      "received_events_url": "https://api.github.com/users/travisn/received_events",
      "repos_url": "https://api.github.com/users/travisn/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/travisn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/travisn/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/travisn"
    }
  ],
  "author_association": "NONE",
  "body": "After a day or so of running a cluster, I just noticed only 1 mon is running. Few hours ago I had a couple of unrelated pods die and get recreated(the ones using deployment/etc). My pods with already mounted volumes continue to work.\r\n\r\nI am using `v0.3.1`.\r\n\r\ntl;dr operator thinks 3 mons are running, and api server probably fails to connect to the mons probably because it is under quorum. \r\n\r\nIs there a way to \"tell\" the operator about the vanished mons?\r\n\r\n```\r\n$ kubectl get pods --all-namespaces -o wide | grep rook\r\ndefault       rook-operator-2900126290-7k03v          1/1       Running             0          14m       10.2.75.5       10.130.55.21\r\nrook          mds-4027210838-zghbs                    1/1       Running             0          1d        10.2.49.10      10.130.55.18\r\nrook          mon1                                    1/1       Running             0          1d        10.2.49.4       10.130.55.18\r\nrook          osd-0cdm1                               1/1       Running             0          1d        10.2.60.2       10.130.54.215\r\nrook          osd-4k1sn                               1/1       Running             0          1d        10.2.82.5       10.130.55.8\r\nrook          osd-bht2f                               1/1       Running             0          1d        10.2.49.5       10.130.55.18\r\nrook          osd-m1bwd                               1/1       Running             0          1d        10.2.75.7       10.130.55.21\r\nrook          osd-qc1h5                               1/1       Running             0          1d        10.2.37.2       10.130.54.184\r\nrook          prometheus-rook-prometheus-0            2/2       Running             0          1d        10.2.49.7       10.130.55.18\r\nrook          rook-api-1392339950-wj4lj               1/1       Running             0          15m       10.2.75.6       10.130.55.21\r\n```\r\n\r\nI tried killing the operator and api to see if it helps, it didnt. Here is the log from the operator.\r\n\r\n```\r\n$ kubectl logs rook-operator-2900126290-7k03v\r\n2017-04-15 15:04:04.653781 I | rook-operator: starting operator in namespace default\r\n2017-04-15 15:04:04.654156 I | operator: creating rookcluster TPR\r\n2017-04-15 15:04:04.793384 I | operator: creating rookpool TPR\r\n2017-04-15 15:04:04.877786 I | operator: finding existing clusters...\r\n2017-04-15 15:04:04.890272 I | operator: found 1 clusters\r\n2017-04-15 15:04:04.890318 I | operator: resuming cluster rook in namespace rook\r\n2017-04-15 15:04:04.890346 I | operator: finding existing pools...\r\n2017-04-15 15:04:04.895285 I | operator: found 1 pools. ensuring they exist.\r\n2017-04-15 15:04:04.895437 I | op-cluster: retrieving rook api endpoint for namespace rook\r\n2017-04-15 15:04:04.907598 I | op-mon: start running mons\r\n2017-04-15 15:04:04.908348 I | op-cluster: rook api endpoint 10.3.0.146:8124 for namespace rook\r\n2017-04-15 15:04:04.915025 I | cephmon: parsing mon endpoints: mon2=10.2.75.6:6790,mon0=10.2.75.5:6790,mon1=10.2.49.4:6790\r\n2017-04-15 15:04:04.915258 I | op-mon: loaded: maxMonID=2, mons=map[mon2:0xc4201c9fc0 mon0:0xc420360000 mon1:0xc42000c120]\r\n2017-04-15 15:04:04.964472 I | cephmon: connecting to ceph cluster rook with user admin\r\n2017-04-15 15:04:19.908630 I | op-cluster: creating pool replicapool in namespace rook with replicas 2\r\n2017-04-15 15:04:34.909323 W | operator: failed to check that pool replicapool exists in namespace rook. failed to create pool replicapool. Post http://10.3.0.146:8124/pool: net/http: request canceled (Client.Timeout exceeded while awaiting headers)\r\n2017-04-15 15:04:34.909398 I | operator: start watching rookpool tpr: 165056\r\n2017-04-15 15:04:34.909553 I | operator: start watching rookcluster tpr: 165056\r\n2017-04-15 15:09:05.075646 c8c3240  0 monclient(hunting): authenticate timed out after 300\r\n2017-04-15 15:09:05.075689 c8c3240  0 librados: client.admin authentication error (110) Connection timed out\r\n2017-04-15 15:09:05.085617 W | op-mon: failed to check mon health map[mon2:0xc4201c9fc0 mon0:0xc420360000 mon1:0xc42000c120]. cannot connect to cluster. failed to connect to cluster rook: cephd: Connection timed out\r\n2017-04-15 15:09:05.085651 I | op-api: starting the Rook api\r\n2017-04-15 15:09:05.348657 I | op-api: api service already running\r\n2017-04-15 15:09:05.361347 I | op-api: api deployment already exists\r\n2017-04-15 15:09:05.361375 I | op-osd: start running osds\r\n2017-04-15 15:09:05.377776 I | op-osd: osd daemon set already exists\r\n2017-04-15 15:09:05.378156 I | cephmon: connecting to ceph cluster rook with user admin\r\n2017-04-15 15:14:05.382732 7f8f853a3700  0 monclient(hunting): authenticate timed out after 300\r\n2017-04-15 15:14:05.382780 7f8f853a3700  0 librados: client.admin authentication error (110) Connection timed out\r\n2017-04-15 15:14:05.383969 E | operator: failed to create cluster in namespace rook. failed to create client access. failed to connect to cluster: failed to connect to cluster rook: cephd: Connection timed out\r\n```\r\n\r\nThe operator thinks mon[0-2] are running, when in fact only mon1 is alive. The operator should have noticed this and created 2 replacement mons before continuing.\r\n\r\nHere are the logs from rook-api\r\n\r\n```\r\n$ kubectl logs rook-api-1392339950-wj4lj -n rook --tail=20\r\n2017-04-15 15:22:55.655996 I | api: 3426f802-39d4-4deb-b1a6-c9af9c7f961f\tGET\t/metrics\tGetMetrics\t(start)\r\n2017-04-15 15:22:55.660482 I | api: 3426f802-39d4-4deb-b1a6-c9af9c7f961f\tGET\t/metrics\tGetMetrics\t200 OK\t4.502423ms\r\n2017-04-15 15:22:58.612026 7f6912163700  0 monclient(hunting): authenticate timed out after 300\r\n2017-04-15 15:22:58.612082 7f6912163700  0 librados: client.admin authentication error (110) Connection timed out\r\n2017-04-15 15:22:58.617680 E | api: failed to connect to cluster as admin: failed to connect to cluster rook: cephd: Connection timed out\r\n2017-04-15 15:22:58.617751 I | api: 7e358f65-c220-468a-8fd1-bacc1ee92c16\tPOST\t/pool\tCreatePool\t500 Internal Server Error\t5m0.01019285s\r\n2017-04-15 15:23:00.652965 I | api: 895bd099-a903-4530-8bbf-0e7a2f91cd45\tGET\t/metrics\tGetMetrics\t(start)\r\n2017-04-15 15:23:00.655343 I | api: 895bd099-a903-4530-8bbf-0e7a2f91cd45\tGET\t/metrics\tGetMetrics\t200 OK\t2.38202ms\r\n2017-04-15 15:23:05.652227 I | api: 2d9f1043-72e0-4c1b-af18-d497318fc14e\tGET\t/metrics\tGetMetrics\t(start)\r\n2017-04-15 15:23:05.656073 I | api: 2d9f1043-72e0-4c1b-af18-d497318fc14e\tGET\t/metrics\tGetMetrics\t200 OK\t3.891765ms\r\n2017-04-15 15:23:10.655544 I | api: cde774ad-07c5-46e8-8fee-d84d37c101ca\tGET\t/metrics\tGetMetrics\t(start)\r\n2017-04-15 15:23:10.663114 I | api: cde774ad-07c5-46e8-8fee-d84d37c101ca\tGET\t/metrics\tGetMetrics\t200 OK\t7.57575ms\r\n2017-04-15 15:23:15.673726 I | api: a29f9d72-0ea5-462d-b1bb-3c845c942b2e\tGET\t/metrics\tGetMetrics\t(start)\r\n2017-04-15 15:23:15.686239 I | api: a29f9d72-0ea5-462d-b1bb-3c845c942b2e\tGET\t/metrics\tGetMetrics\t200 OK\t12.45735ms\r\n2017-04-15 15:23:20.651477 I | api: a55fa7c2-0620-4c12-b5c0-23e811f6834f\tGET\t/metrics\tGetMetrics\t(start)\r\n2017-04-15 15:23:20.663685 I | api: a55fa7c2-0620-4c12-b5c0-23e811f6834f\tGET\t/metrics\tGetMetrics\t200 OK\t12.21069ms\r\n2017-04-15 15:23:25.681739 I | api: f252034f-0b9e-40d7-aedd-2604005baedc\tGET\t/metrics\tGetMetrics\t(start)\r\n2017-04-15 15:23:25.685323 I | api: f252034f-0b9e-40d7-aedd-2604005baedc\tGET\t/metrics\tGetMetrics\t200 OK\t3.593654ms\r\n2017-04-15 15:23:30.665981 I | api: 1a431ca4-08bb-433c-abf0-5539e76d9c48\tGET\t/metrics\tGetMetrics\t(start)\r\n2017-04-15 15:23:30.668636 I | api: 1a431ca4-08bb-433c-abf0-5539e76d9c48\tGET\t/metrics\tGetMetrics\t200 OK\t2.664765ms\r\n```\r\n\r\nHere is the logs from the 3 mons from around the time of the crash: https://gist.github.com/sajal/d1cbb8503267af6ac8214f13b3d5247c\r\n",
  "closed_at": "2017-06-06T19:50:20Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/1048514?v=4",
    "events_url": "https://api.github.com/users/travisn/events{/privacy}",
    "followers_url": "https://api.github.com/users/travisn/followers",
    "following_url": "https://api.github.com/users/travisn/following{/other_user}",
    "gists_url": "https://api.github.com/users/travisn/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/travisn",
    "id": 1048514,
    "login": "travisn",
    "node_id": "MDQ6VXNlcjEwNDg1MTQ=",
    "organizations_url": "https://api.github.com/users/travisn/orgs",
    "received_events_url": "https://api.github.com/users/travisn/received_events",
    "repos_url": "https://api.github.com/users/travisn/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/travisn/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/travisn/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/travisn"
  },
  "comments": 4,
  "comments_url": "https://api.github.com/repos/rook/rook/issues/579/comments",
  "created_at": "2017-04-15T15:29:15Z",
  "events_url": "https://api.github.com/repos/rook/rook/issues/579/events",
  "html_url": "https://github.com/rook/rook/issues/579",
  "id": 221954843,
  "labels": [
    {
      "color": "00aaaa",
      "default": false,
      "description": null,
      "id": 479820581,
      "name": "operator",
      "node_id": "MDU6TGFiZWw0Nzk4MjA1ODE=",
      "url": "https://api.github.com/repos/rook/rook/labels/operator"
    },
    {
      "color": "5522ee",
      "default": false,
      "description": "",
      "id": 626631231,
      "name": "reliability",
      "node_id": "MDU6TGFiZWw2MjY2MzEyMzE=",
      "url": "https://api.github.com/repos/rook/rook/labels/reliability"
    }
  ],
  "labels_url": "https://api.github.com/repos/rook/rook/issues/579/labels{/name}",
  "locked": false,
  "milestone": {
    "closed_at": "2017-08-09T16:20:34Z",
    "closed_issues": 56,
    "created_at": "2017-04-19T19:42:57Z",
    "creator": {
      "avatar_url": "https://avatars3.githubusercontent.com/u/1463491?v=4",
      "events_url": "https://api.github.com/users/bassam/events{/privacy}",
      "followers_url": "https://api.github.com/users/bassam/followers",
      "following_url": "https://api.github.com/users/bassam/following{/other_user}",
      "gists_url": "https://api.github.com/users/bassam/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/bassam",
      "id": 1463491,
      "login": "bassam",
      "node_id": "MDQ6VXNlcjE0NjM0OTE=",
      "organizations_url": "https://api.github.com/users/bassam/orgs",
      "received_events_url": "https://api.github.com/users/bassam/received_events",
      "repos_url": "https://api.github.com/users/bassam/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/bassam/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bassam/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/bassam"
    },
    "description": "Rook still in alpha. MON and OSD Reliability - survive restarts and pod failures. Backup of the cluster config and data required to recover it. Publish documentation to rook.io. RBD works on all Kubernetes deployments (without any host changes). Upgrade to Ceph Luminous. Long-haul testing infra. TPRs for object store and file system. Initial Rook Upgrade support.\r\n",
    "due_on": null,
    "html_url": "https://github.com/rook/rook/milestone/5",
    "id": 2467556,
    "labels_url": "https://api.github.com/repos/rook/rook/milestones/5/labels",
    "node_id": "MDk6TWlsZXN0b25lMjQ2NzU1Ng==",
    "number": 5,
    "open_issues": 0,
    "state": "closed",
    "title": "0.5",
    "updated_at": "2017-08-09T16:20:34Z",
    "url": "https://api.github.com/repos/rook/rook/milestones/5"
  },
  "node_id": "MDU6SXNzdWUyMjE5NTQ4NDM=",
  "number": 579,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/rook/rook",
  "state": "closed",
  "title": "Operator not replacing dead mons",
  "updated_at": "2017-06-14T14:38:58Z",
  "url": "https://api.github.com/repos/rook/rook/issues/579",
  "user": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/25007?v=4",
    "events_url": "https://api.github.com/users/sajal/events{/privacy}",
    "followers_url": "https://api.github.com/users/sajal/followers",
    "following_url": "https://api.github.com/users/sajal/following{/other_user}",
    "gists_url": "https://api.github.com/users/sajal/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/sajal",
    "id": 25007,
    "login": "sajal",
    "node_id": "MDQ6VXNlcjI1MDA3",
    "organizations_url": "https://api.github.com/users/sajal/orgs",
    "received_events_url": "https://api.github.com/users/sajal/received_events",
    "repos_url": "https://api.github.com/users/sajal/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/sajal/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/sajal/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/sajal"
  }
}