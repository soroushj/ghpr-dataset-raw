{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "NONE",
  "body": "<!-- **Are you in the right place?**\r\n1. For issues or feature requests, please create an issue in this repository.\r\n2. For general technical and non-technical questions, we are happy to help you on our [Rook.io Slack](https://Rook-io.slack.com).\r\n3. Did you already search the existing open issues for anything similar? -->\r\n\r\n**Is this a bug report or feature request?**\r\n* Bug Report\r\n\r\n**Deviation from expected behavior:**\r\n\r\nMon remains on a down host for extended period of time.\r\n\r\n**Expected behavior:**\r\n\r\nMon should be moved to a new host after 5 minutes (or default) of health checking.\r\n\r\n**How to reproduce it (minimal and precise):**\r\n<!-- Please let us know any circumstances for reproduction of your bug. -->\r\n\r\nDisabling scheduling on a node containing a mon, note that after 5 minutes it hasn't been rescheduled.\r\n\r\n**Environment**:\r\n* OS (e.g. from /etc/os-release): CentOS 7\r\n* Kernel (e.g. `uname -a`): 3.10.0\r\n* Cloud provider or hardware configuration: vmware\r\n* Rook version (use `rook version` inside of a Rook Pod): v0.8.3\r\n* Kubernetes version (use `kubectl version`): 1.11.3\r\n* Kubernetes cluster type (e.g. Tectonic, GKE, OpenShift): Pharos\r\n* Storage backend status (e.g. for Ceph use `ceph health` in the [Rook Ceph toolbox](https://rook.io/docs/Rook/master/toolbox.html)): \r\n\r\nToolbox is unresponsive, from UI:\r\n![image](https://user-images.githubusercontent.com/616428/48000942-0917a300-e0d5-11e8-9577-87d9c9e505da.png)\r\n![image](https://user-images.githubusercontent.com/616428/48000956-0fa61a80-e0d5-11e8-88a3-edf6a5737b3c.png)\r\n![image](https://user-images.githubusercontent.com/616428/48000968-1cc30980-e0d5-11e8-9c84-ce114ed95279.png)\r\n\r\n\r\n----\r\n\r\n```\r\nPS C:\\Users\\jhaddad> kubectl get nodes\r\nNAME           STATUS                        ROLES     AGE       VERSION\r\nfsicentk8s01   Ready                         master    23d       v1.11.3\r\nfsicentk8s02   Ready                         master    23d       v1.11.3\r\nfsicentk8s03   Ready                         master    23d       v1.11.3\r\nfsicentk8s04   Ready                         worker    23d       v1.11.3\r\nfsicentk8s05   Ready                         worker    23d       v1.11.3\r\nfsicentk8s06   Ready                         worker    23d       v1.11.3\r\nfsicentk8s07   NotReady,SchedulingDisabled   worker    2d        v1.11.3\r\n```\r\n\r\n```\r\nPS C:\\Users\\jhaddad> kubectl -n rook-ceph get pod -l app=rook-ceph-mon\r\nNAME                    READY     STATUS    RESTARTS   AGE\r\nrook-ceph-mon18-6ck9h   0/1       Pending   0          1d\r\nrook-ceph-mon20-c4nxz   1/1       Running   0          1d\r\nrook-ceph-mon21-gx6tc   1/1       Running   0          1d\r\n```\r\n\r\n```\r\nPS C:\\Users\\jhaddad> kubectl -n rook-ceph describe pod/rook-ceph-mon18-6ck9h\r\nName:               rook-ceph-mon18-6ck9h\r\nNamespace:          rook-ceph\r\nPriority:           0\r\nPriorityClassName:  <none>\r\nNode:               <none>\r\nLabels:             app=rook-ceph-mon\r\n                    mon=rook-ceph-mon18\r\n                    mon_cluster=rook-ceph\r\nAnnotations:        kubernetes.io/psp=00-pharos-privileged\r\nStatus:             Pending\r\nIP:\r\nControlled By:      ReplicaSet/rook-ceph-mon18\r\nContainers:\r\n  rook-ceph-mon:\r\n    Image:      rook/ceph:v0.8.3\r\n    Port:       6790/TCP\r\n    Host Port:  0/TCP\r\n    Args:\r\n      ceph\r\n      mon\r\n      --config-dir=/var/lib/rook\r\n      --name=rook-ceph-mon18\r\n      --port=6790\r\n      --fsid=6a23586e-45d7-453e-9f86-479f51680214\r\n    Environment:\r\n      ROOK_PRIVATE_IP:             (v1:status.podIP)\r\n      ROOK_PUBLIC_IP:             10.99.131.224\r\n      ROOK_CLUSTER_NAME:          rook-ceph\r\n      ROOK_MON_ENDPOINTS:         <set to the key 'data' of config map 'rook-ceph-mon-endpoints'>  Optional: false\r\n      ROOK_MON_SECRET:            <set to the key 'mon-secret' in secret 'rook-ceph-mon'>          Optional: false\r\n      ROOK_ADMIN_SECRET:          <set to the key 'admin-secret' in secret 'rook-ceph-mon'>        Optional: false\r\n      ROOK_CEPH_CONFIG_OVERRIDE:  /etc/rook/config/override.conf\r\n    Mounts:\r\n      /etc/rook/config from rook-config-override (rw)\r\n      /var/lib/rook from rook-data (rw)\r\n      /var/run/secrets/kubernetes.io/serviceaccount from default-token-sdz4c (ro)\r\nConditions:\r\n  Type           Status\r\n  PodScheduled   False\r\nVolumes:\r\n  rook-data:\r\n    Type:          HostPath (bare host directory volume)\r\n    Path:          /var/lib/rook\r\n    HostPathType:\r\n  rook-config-override:\r\n    Type:      ConfigMap (a volume populated by a ConfigMap)\r\n    Name:      rook-config-override\r\n    Optional:  false\r\n  default-token-sdz4c:\r\n    Type:        Secret (a volume populated by a Secret)\r\n    SecretName:  default-token-sdz4c\r\n    Optional:    false\r\nQoS Class:       BestEffort\r\nNode-Selectors:  kubernetes.io/hostname=fsicentk8s07\r\nTolerations:     node.kubernetes.io/not-ready:NoExecute for 300s\r\n                 node.kubernetes.io/unreachable:NoExecute for 300s\r\nEvents:\r\n  Type     Reason            Age                  From               Message\r\n  ----     ------            ----                 ----               -------\r\n  Warning  FailedScheduling  7m (x72777 over 1d)  default-scheduler  0/7 nodes are available: 1 node(s) were unschedulable, 6 node(s) didn't match node selector.\r\n  Warning  FailedScheduling  2m (x101 over 4m)    default-scheduler  0/7 nodes are available: 1 node(s) were not ready, 1 node(s) were out of disk space, 1 node(s) were unschedulable, 6 node(s) didn't match node selec\r\ntor.\r\n```",
  "closed_at": "2019-02-12T15:44:15Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/1048514?v=4",
    "events_url": "https://api.github.com/users/travisn/events{/privacy}",
    "followers_url": "https://api.github.com/users/travisn/followers",
    "following_url": "https://api.github.com/users/travisn/following{/other_user}",
    "gists_url": "https://api.github.com/users/travisn/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/travisn",
    "id": 1048514,
    "login": "travisn",
    "node_id": "MDQ6VXNlcjEwNDg1MTQ=",
    "organizations_url": "https://api.github.com/users/travisn/orgs",
    "received_events_url": "https://api.github.com/users/travisn/received_events",
    "repos_url": "https://api.github.com/users/travisn/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/travisn/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/travisn/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/travisn"
  },
  "comments": 10,
  "comments_url": "https://api.github.com/repos/rook/rook/issues/2262/comments",
  "created_at": "2018-11-05T13:31:18Z",
  "events_url": "https://api.github.com/repos/rook/rook/issues/2262/events",
  "html_url": "https://github.com/rook/rook/issues/2262",
  "id": 377400995,
  "labels": [],
  "labels_url": "https://api.github.com/repos/rook/rook/issues/2262/labels{/name}",
  "locked": false,
  "milestone": {
    "closed_at": "2020-01-28T21:43:45Z",
    "closed_issues": 119,
    "created_at": "2018-11-21T16:40:13Z",
    "creator": {
      "avatar_url": "https://avatars0.githubusercontent.com/u/1048514?v=4",
      "events_url": "https://api.github.com/users/travisn/events{/privacy}",
      "followers_url": "https://api.github.com/users/travisn/followers",
      "following_url": "https://api.github.com/users/travisn/following{/other_user}",
      "gists_url": "https://api.github.com/users/travisn/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/travisn",
      "id": 1048514,
      "login": "travisn",
      "node_id": "MDQ6VXNlcjEwNDg1MTQ=",
      "organizations_url": "https://api.github.com/users/travisn/orgs",
      "received_events_url": "https://api.github.com/users/travisn/received_events",
      "repos_url": "https://api.github.com/users/travisn/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/travisn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/travisn/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/travisn"
    },
    "description": "",
    "due_on": null,
    "html_url": "https://github.com/rook/rook/milestone/11",
    "id": 3838796,
    "labels_url": "https://api.github.com/repos/rook/rook/milestones/11/labels",
    "node_id": "MDk6TWlsZXN0b25lMzgzODc5Ng==",
    "number": 11,
    "open_issues": 0,
    "state": "closed",
    "title": "1.0",
    "updated_at": "2020-01-28T21:43:45Z",
    "url": "https://api.github.com/repos/rook/rook/milestones/11"
  },
  "node_id": "MDU6SXNzdWUzNzc0MDA5OTU=",
  "number": 2262,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/rook/rook",
  "state": "closed",
  "title": "Mon is never rescheduled",
  "updated_at": "2020-09-16T18:35:25Z",
  "url": "https://api.github.com/repos/rook/rook/issues/2262",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/616428?v=4",
    "events_url": "https://api.github.com/users/Timer/events{/privacy}",
    "followers_url": "https://api.github.com/users/Timer/followers",
    "following_url": "https://api.github.com/users/Timer/following{/other_user}",
    "gists_url": "https://api.github.com/users/Timer/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/Timer",
    "id": 616428,
    "login": "Timer",
    "node_id": "MDQ6VXNlcjYxNjQyOA==",
    "organizations_url": "https://api.github.com/users/Timer/orgs",
    "received_events_url": "https://api.github.com/users/Timer/received_events",
    "repos_url": "https://api.github.com/users/Timer/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/Timer/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Timer/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/Timer"
  }
}