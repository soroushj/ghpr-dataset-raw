{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/4313439?v=4",
    "events_url": "https://api.github.com/users/jbw976/events{/privacy}",
    "followers_url": "https://api.github.com/users/jbw976/followers",
    "following_url": "https://api.github.com/users/jbw976/following{/other_user}",
    "gists_url": "https://api.github.com/users/jbw976/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/jbw976",
    "id": 4313439,
    "login": "jbw976",
    "node_id": "MDQ6VXNlcjQzMTM0Mzk=",
    "organizations_url": "https://api.github.com/users/jbw976/orgs",
    "received_events_url": "https://api.github.com/users/jbw976/received_events",
    "repos_url": "https://api.github.com/users/jbw976/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/jbw976/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jbw976/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/jbw976"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars2.githubusercontent.com/u/4313439?v=4",
      "events_url": "https://api.github.com/users/jbw976/events{/privacy}",
      "followers_url": "https://api.github.com/users/jbw976/followers",
      "following_url": "https://api.github.com/users/jbw976/following{/other_user}",
      "gists_url": "https://api.github.com/users/jbw976/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jbw976",
      "id": 4313439,
      "login": "jbw976",
      "node_id": "MDQ6VXNlcjQzMTM0Mzk=",
      "organizations_url": "https://api.github.com/users/jbw976/orgs",
      "received_events_url": "https://api.github.com/users/jbw976/received_events",
      "repos_url": "https://api.github.com/users/jbw976/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jbw976/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jbw976/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jbw976"
    }
  ],
  "author_association": "NONE",
  "body": "Hello,\r\n\r\nI'm trying to implement Rook in my K8S cluster, managed to use block devices through StorageClass but now i'm challenging Rook resiliency by shutting down OSD nodes.\r\nAt first when leaving dataDirHostPath: \"\" in the rook-cluster config, the osd configuration wasn't persistent so at every osd node reboot or osd pod delete/recreate, i lost the configuration of the previous osd.\r\nNow i'm using dataDirHostPath: \"/var/lib/rook-storage\" and the config is saved properly into this directory.\r\n\r\nThe problem is when i delete an osd pod, on recreating, the osd throws error because he doesn't seem to be able to access the dataDirHostPath mounted in /var/lib/rook.\r\n\r\nFrom my recreated OSD container, i have the mount point and all files as below : \r\n\r\n```\r\n/ # ls -lalh /var/lib/rook/\r\ntotal 4.0K\r\ndrwxr-xr-x 6 root root  87 Jun 14 10:33 .\r\ndrwxr-xr-x 1 root root  18 Jun 14 10:33 ..\r\ndrwxr--r-- 2 root root  45 Jun 14 10:33 bootstrap-osd\r\ndrwxr--r-- 2 root root  40 Jun 13 14:25 mon0\r\ndrwxr--r-- 2 root root  40 Jun 14 10:33 mon1\r\ndrwxr--r-- 4 root root 201 Jun 14 10:33 osd3\r\n-rw-r--r-- 1 root root 277 Jun 13 14:25 partition-scheme\r\n/ # ls -lalh /var/lib/rook/osd3/\r\ntotal 1.1G\r\ndrwxr--r-- 4 root root  201 Jun 14 10:33 .\r\ndrwxr-xr-x 6 root root   87 Jun 14 10:33 ..\r\n-rw-r--r-- 1 root root   37 Jun 14 10:33 ceph_fsid\r\ndrwxr-xr-x 4 root root   65 Jun 14 10:33 current\r\n-rw-r--r-- 1 root root   37 Jun 14 10:33 fsid\r\n-rw-r--r-- 1 root root 1.0G Jun 14 10:33 journal\r\n-rw------- 1 root root   56 Jun 14 10:33 keyring\r\n-rw-r--r-- 1 root root   21 Jun 14 10:33 magic\r\n-rw-r--r-- 1 root root    6 Jun 14 10:33 ready\r\n-rw-r--r-- 1 root root 2.0K Jun 14 10:33 rook.config\r\n-rw-r--r-- 1 root root    4 Jun 14 10:33 store_version\r\n-rw-r--r-- 1 root root   53 Jun 14 10:33 superblock\r\ndrwxr--r-- 2 root root   29 Jun 14 10:33 tmp\r\n-rw-r--r-- 1 root root   10 Jun 14 10:33 type\r\n-rw-r--r-- 1 root root    2 Jun 14 10:33 whoami\r\n```\r\n\r\nStill, OSD logs show that there is a problem when accessing these files :\r\n\r\n```\r\n2017-06-14 10:33:52.811009 I | mkfs-osd3: 2017-06-14 10:33:52.810967 e222240  0 filestore(/var/lib/rook/osd3) mount: enabling WRITEAHEAD journal mode: checkpoint is not enabled\r\n2017-06-14 10:33:52.811069 I | mkfs-osd3: 2017-06-14 10:33:52.811040 e222240 -1 journal FileJournal::_open: disabling aio for non-block journal.  Use journal_force_aio to force use of aio anyway\r\n2017-06-14 10:33:52.811990 I | mkfs-osd3: 2017-06-14 10:33:52.811920 e222240 -1 filestore(/var/lib/rook/osd3) could not find #-1:7b3f43c4:::osd_superblock:0# in index: (2) No such file or directory\r\n2017-06-14 10:33:52.839009 I | mkfs-osd3: 2017-06-14 10:33:52.838934 e222240 -1 created object store /var/lib/rook/osd3 for osd.3 fsid ee7d8f35-73a9-4176-a43c-1cc166e1ccce\r\n2017-06-14 10:33:52.839043 I | mkfs-osd3: 2017-06-14 10:33:52.838974 e222240 -1 auth: error reading file: /var/lib/rook/osd3/keyring: can't open /var/lib/rook/osd3/keyring: (2) No such file or directory\r\n2017-06-14 10:33:52.839128 I | mkfs-osd3: 2017-06-14 10:33:52.839099 e222240 -1 created new key in keyring /var/lib/rook/osd3/keyring\r\n2017-06-14 10:33:52.841620 I | mkfs-osd3: 2017-06-14 10:33:52.788249 e222240 -1 journal FileJournal::_open: disabling aio for non-block journal.  Use journal_force_aio to force use of aio anyway\r\n2017-06-14 10:33:52.841634 I | mkfs-osd3: 2017-06-14 10:33:52.811040 e222240 -1 journal FileJournal::_open: disabling aio for non-block journal.  Use journal_force_aio to force use of aio anyway\r\n2017-06-14 10:33:52.841645 I | mkfs-osd3: 2017-06-14 10:33:52.811920 e222240 -1 filestore(/var/lib/rook/osd3) could not find #-1:7b3f43c4:::osd_superblock:0# in index: (2) No such file or directory\r\n2017-06-14 10:33:52.841649 I | mkfs-osd3: 2017-06-14 10:33:52.838934 e222240 -1 created object store /var/lib/rook/osd3 for osd.3 fsid ee7d8f35-73a9-4176-a43c-1cc166e1ccce\r\n2017-06-14 10:33:52.841669 I | mkfs-osd3: 2017-06-14 10:33:52.838974 e222240 -1 auth: error reading file: /var/lib/rook/osd3/keyring: can't open /var/lib/rook/osd3/keyring: (2) No such file or directory\r\n2017-06-14 10:33:52.841676 I | mkfs-osd3: 2017-06-14 10:33:52.839099 e222240 -1 created new key in keyring /var/lib/rook/osd3/keyring\r\n2017-06-14 10:33:52.842906 E | cephosd: failed to config osd 3. failed to initialize OSD at /var/lib/rook/osd3: mon_command auth add failed: cephd: Invalid argument\r\n2017-06-14 10:33:52.842918 I | cephosd: 0/1 osd devices succeeded on this\r\n```\r\nWhat can i do to get this persistent OSD config setting? I cannot troubleshoot it myself because i have no visibility on the ceph tools used by rookd during the osd init.",
  "closed_at": "2017-06-30T22:23:23Z",
  "closed_by": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/4313439?v=4",
    "events_url": "https://api.github.com/users/jbw976/events{/privacy}",
    "followers_url": "https://api.github.com/users/jbw976/followers",
    "following_url": "https://api.github.com/users/jbw976/following{/other_user}",
    "gists_url": "https://api.github.com/users/jbw976/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/jbw976",
    "id": 4313439,
    "login": "jbw976",
    "node_id": "MDQ6VXNlcjQzMTM0Mzk=",
    "organizations_url": "https://api.github.com/users/jbw976/orgs",
    "received_events_url": "https://api.github.com/users/jbw976/received_events",
    "repos_url": "https://api.github.com/users/jbw976/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/jbw976/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jbw976/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/jbw976"
  },
  "comments": 10,
  "comments_url": "https://api.github.com/repos/rook/rook/issues/736/comments",
  "created_at": "2017-06-14T12:52:33Z",
  "events_url": "https://api.github.com/repos/rook/rook/issues/736/events",
  "html_url": "https://github.com/rook/rook/issues/736",
  "id": 235868724,
  "labels": [
    {
      "color": "5522ee",
      "default": false,
      "description": "",
      "id": 626631231,
      "name": "reliability",
      "node_id": "MDU6TGFiZWw2MjY2MzEyMzE=",
      "url": "https://api.github.com/repos/rook/rook/labels/reliability"
    }
  ],
  "labels_url": "https://api.github.com/repos/rook/rook/issues/736/labels{/name}",
  "locked": false,
  "milestone": {
    "closed_at": "2017-08-09T16:20:34Z",
    "closed_issues": 56,
    "created_at": "2017-04-19T19:42:57Z",
    "creator": {
      "avatar_url": "https://avatars3.githubusercontent.com/u/1463491?v=4",
      "events_url": "https://api.github.com/users/bassam/events{/privacy}",
      "followers_url": "https://api.github.com/users/bassam/followers",
      "following_url": "https://api.github.com/users/bassam/following{/other_user}",
      "gists_url": "https://api.github.com/users/bassam/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/bassam",
      "id": 1463491,
      "login": "bassam",
      "node_id": "MDQ6VXNlcjE0NjM0OTE=",
      "organizations_url": "https://api.github.com/users/bassam/orgs",
      "received_events_url": "https://api.github.com/users/bassam/received_events",
      "repos_url": "https://api.github.com/users/bassam/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/bassam/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bassam/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/bassam"
    },
    "description": "Rook still in alpha. MON and OSD Reliability - survive restarts and pod failures. Backup of the cluster config and data required to recover it. Publish documentation to rook.io. RBD works on all Kubernetes deployments (without any host changes). Upgrade to Ceph Luminous. Long-haul testing infra. TPRs for object store and file system. Initial Rook Upgrade support.\r\n",
    "due_on": null,
    "html_url": "https://github.com/rook/rook/milestone/5",
    "id": 2467556,
    "labels_url": "https://api.github.com/repos/rook/rook/milestones/5/labels",
    "node_id": "MDk6TWlsZXN0b25lMjQ2NzU1Ng==",
    "number": 5,
    "open_issues": 0,
    "state": "closed",
    "title": "0.5",
    "updated_at": "2017-08-09T16:20:34Z",
    "url": "https://api.github.com/repos/rook/rook/milestones/5"
  },
  "node_id": "MDU6SXNzdWUyMzU4Njg3MjQ=",
  "number": 736,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/rook/rook",
  "state": "closed",
  "title": "OSD cannot start after a pod delete",
  "updated_at": "2017-06-30T22:23:23Z",
  "url": "https://api.github.com/repos/rook/rook/issues/736",
  "user": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/5978068?v=4",
    "events_url": "https://api.github.com/users/lainra/events{/privacy}",
    "followers_url": "https://api.github.com/users/lainra/followers",
    "following_url": "https://api.github.com/users/lainra/following{/other_user}",
    "gists_url": "https://api.github.com/users/lainra/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/lainra",
    "id": 5978068,
    "login": "lainra",
    "node_id": "MDQ6VXNlcjU5NzgwNjg=",
    "organizations_url": "https://api.github.com/users/lainra/orgs",
    "received_events_url": "https://api.github.com/users/lainra/received_events",
    "repos_url": "https://api.github.com/users/lainra/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/lainra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/lainra/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/lainra"
  }
}