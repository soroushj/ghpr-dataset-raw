{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "NONE",
  "body": "<!-- **Are you in the right place?**\r\n1. For issues or feature requests, please create an issue in this repository.\r\n2. For general technical and non-technical questions, we are happy to help you on our [Rook.io Slack](https://slack.rook.io/).\r\n3. Did you already search the existing open issues for anything similar? -->\r\n\r\n**Is this a bug report or feature request?**\r\n* Bug Report\r\n\r\n**Deviation from expected behavior:**\r\n\r\n**Expected behavior:**\r\nIt is expected that OSDs would be upgraded to the newest rook version like the other rook components.\r\n\r\n**How to reproduce it (minimal and precise):**\r\n<!-- Please let us know any circumstances for reproduction of your bug. -->\r\nIn my case, I am running rook v1.3.11 with k8s 1.17.6. \r\nI have tried to upgrade to both v1.4.3 and v1.4.4 and the same problem occurred. After upgrading the operator, all the resources except the OSDs are being upgraded to the newer version.\r\nI am using both CephBlockPool and CephObjectStore. \r\n\r\n**File(s) to submit**:\r\n\r\n* Cluster CR (custom resource), typically called `cluster.yaml`, if necessary\r\n* Operator's logs, if necessary\r\n\r\n`2020-09-16 08:21:32.252318 I | cephclient: getting or creating ceph auth key \"osd.134\"\r\n2020-09-16 08:21:32.821676 E | op-osd: failed to update osd deployment 134. failed to calculate diff between current deployment \"rook-ceph-osd-134\" and newly generated one. Failed to generate strategic merge patch: The order in patch list:\r\n[map[name:POD_NAMESPACE value:rook-ceph] map[name:POD_NAMESPACE valueFrom:map[fieldRef:map[fieldPath:metadata.namespace]]] map[name:ROOK_CEPH_USERNAME valueFrom:map[secretKeyRef:map[key:ceph-username name:rook-ceph-mon]]] map[name:ROOK_CEPH_SECRET valueFrom:map[secretKeyRef:map[key:ceph-secret name:rook-ceph-mon]]] map[name:ROOK_OSDS_PER_DEVICE value:1]]\r\n doesn't match $setElementOrder list:\r\n[map[name:ROOK_NODE_NAME] map[name:ROOK_CLUSTER_ID] map[name:ROOK_PRIVATE_IP] map[name:ROOK_PUBLIC_IP] map[name:POD_NAMESPACE] map[name:ROOK_MON_ENDPOINTS] map[name:ROOK_MON_SECRET] map[name:ROOK_CEPH_USERNAME] map[name:ROOK_CEPH_SECRET] map[name:ROOK_CONFIG_DIR] map[name:ROOK_CEPH_CONFIG_OVERRIDE] map[name:ROOK_FSID] map[name:NODE_NAME] map[name:ROOK_CRUSHMAP_HOSTNAME] map[name:CEPH_VOLUME_DEBUG] map[name:CEPH_VOLUME_SKIP_RESTORECON] map[name:DM_DISABLE_UDEV] map[name:ROOK_OSDS_PER_DEVICE] map[name:ROOK_ENCRYPTED_DEVICE] map[name:TINI_SUBREAPER] map[name:CONTAINER_IMAGE] map[name:POD_NAME] map[name:POD_NAMESPACE] map[name:NODE_NAME] map[name:POD_MEMORY_LIMIT] map[name:POD_MEMORY_REQUEST] map[name:POD_CPU_LIMIT] map[name:POD_CPU_REQUEST] map[name:ROOK_OSD_UUID] map[name:ROOK_OSD_ID] map[name:ROOK_OSD_STORE_TYPE] map[name:ROOK_CEPH_MON_HOST] map[name:CEPH_ARGS]]`\r\n\r\n* Crashing pod(s) logs, if necessary\r\n\r\n To get logs, use `kubectl -n <namespace> logs <pod name>`\r\nWhen pasting logs, always surround them with backticks or use the `insert code` button from the Github UI.\r\nRead [Github documentation if you need help](https://help.github.com/en/articles/creating-and-highlighting-code-blocks).\r\n\r\n**Environment**:\r\n* OS (e.g. from /etc/os-release):\r\nNAME=\"Ubuntu\"\r\nVERSION=\"20.04.1 LTS (Focal Fossa)\"\r\n* Kernel (e.g. `uname -a`):\r\n5.4.0-42-generic\r\n* Cloud provider or hardware configuration:\r\non-prem\r\n* Rook version (use `rook version` inside of a Rook Pod):\r\nv1.3.11\r\n* Storage backend version (e.g. for ceph do `ceph -v`):\r\nceph version 14.2.10 (b340acf629a010a74d90da5782a2c5fe0b54ac20) nautilus (stable)\r\n* Kubernetes version (use `kubectl version`):\r\n1.17.6\r\n* Kubernetes cluster type (e.g. Tectonic, GKE, OpenShift):\r\non-prem\r\n* Storage backend status (e.g. for Ceph use `ceph health` in the [Rook Ceph toolbox](https://rook.io/docs/rook/master/ceph-toolbox.html)):\r\nHEALTH_OK\r\n",
  "closed_at": "2020-09-17T21:43:29Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/1048514?v=4",
    "events_url": "https://api.github.com/users/travisn/events{/privacy}",
    "followers_url": "https://api.github.com/users/travisn/followers",
    "following_url": "https://api.github.com/users/travisn/following{/other_user}",
    "gists_url": "https://api.github.com/users/travisn/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/travisn",
    "id": 1048514,
    "login": "travisn",
    "node_id": "MDQ6VXNlcjEwNDg1MTQ=",
    "organizations_url": "https://api.github.com/users/travisn/orgs",
    "received_events_url": "https://api.github.com/users/travisn/received_events",
    "repos_url": "https://api.github.com/users/travisn/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/travisn/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/travisn/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/travisn"
  },
  "comments": 3,
  "comments_url": "https://api.github.com/repos/rook/rook/issues/6268/comments",
  "created_at": "2020-09-16T15:51:14Z",
  "events_url": "https://api.github.com/repos/rook/rook/issues/6268/events",
  "html_url": "https://github.com/rook/rook/issues/6268",
  "id": 702880067,
  "labels": [
    {
      "color": "ee0000",
      "default": true,
      "description": "",
      "id": 405241115,
      "name": "bug",
      "node_id": "MDU6TGFiZWw0MDUyNDExMTU=",
      "url": "https://api.github.com/repos/rook/rook/labels/bug"
    },
    {
      "color": "ef5c55",
      "default": false,
      "description": "main ceph tag",
      "id": 479456042,
      "name": "ceph",
      "node_id": "MDU6TGFiZWw0Nzk0NTYwNDI=",
      "url": "https://api.github.com/repos/rook/rook/labels/ceph"
    },
    {
      "color": "0e8a16",
      "default": false,
      "description": "",
      "id": 908652856,
      "name": "upgrade",
      "node_id": "MDU6TGFiZWw5MDg2NTI4NTY=",
      "url": "https://api.github.com/repos/rook/rook/labels/upgrade"
    }
  ],
  "labels_url": "https://api.github.com/repos/rook/rook/issues/6268/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU3MDI4ODAwNjc=",
  "number": 6268,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/rook/rook",
  "state": "closed",
  "title": "OSDs not getting upgraded from 1.3.x to 1.4.x",
  "updated_at": "2020-09-23T12:53:08Z",
  "url": "https://api.github.com/repos/rook/rook/issues/6268",
  "user": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/37019661?v=4",
    "events_url": "https://api.github.com/users/ecusnir/events{/privacy}",
    "followers_url": "https://api.github.com/users/ecusnir/followers",
    "following_url": "https://api.github.com/users/ecusnir/following{/other_user}",
    "gists_url": "https://api.github.com/users/ecusnir/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/ecusnir",
    "id": 37019661,
    "login": "ecusnir",
    "node_id": "MDQ6VXNlcjM3MDE5NjYx",
    "organizations_url": "https://api.github.com/users/ecusnir/orgs",
    "received_events_url": "https://api.github.com/users/ecusnir/received_events",
    "repos_url": "https://api.github.com/users/ecusnir/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/ecusnir/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ecusnir/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/ecusnir"
  }
}