{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/17253992?v=4",
    "events_url": "https://api.github.com/users/rajatsing/events{/privacy}",
    "followers_url": "https://api.github.com/users/rajatsing/followers",
    "following_url": "https://api.github.com/users/rajatsing/following{/other_user}",
    "gists_url": "https://api.github.com/users/rajatsing/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/rajatsing",
    "id": 17253992,
    "login": "rajatsing",
    "node_id": "MDQ6VXNlcjE3MjUzOTky",
    "organizations_url": "https://api.github.com/users/rajatsing/orgs",
    "received_events_url": "https://api.github.com/users/rajatsing/received_events",
    "repos_url": "https://api.github.com/users/rajatsing/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/rajatsing/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rajatsing/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/rajatsing"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars2.githubusercontent.com/u/17253992?v=4",
      "events_url": "https://api.github.com/users/rajatsing/events{/privacy}",
      "followers_url": "https://api.github.com/users/rajatsing/followers",
      "following_url": "https://api.github.com/users/rajatsing/following{/other_user}",
      "gists_url": "https://api.github.com/users/rajatsing/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/rajatsing",
      "id": 17253992,
      "login": "rajatsing",
      "node_id": "MDQ6VXNlcjE3MjUzOTky",
      "organizations_url": "https://api.github.com/users/rajatsing/orgs",
      "received_events_url": "https://api.github.com/users/rajatsing/received_events",
      "repos_url": "https://api.github.com/users/rajatsing/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/rajatsing/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rajatsing/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/rajatsing"
    }
  ],
  "author_association": "NONE",
  "body": "**Is this a bug report or feature request?**\r\n<!-- Remove only one -->\r\n* Bug Report\r\n\r\n  \r\n**Bug Report**\r\n\r\nRook rewrites configs for external ceph cluster repeatedly every few seconds.\r\n\r\n**Expected behavior:**\r\n\r\nOnly rewrite configs when cluster changes.\r\n\r\n**Deviation from expected behavior:**\r\n```\r\n2020-01-17 14:03:25.162995 I | op-mon: ClusterInfo is now Empty, refilling it from status.MonMap.Mons\r\n2020-01-17 14:03:25.163036 I | op-mon: new external mon ceph5 found: 10.1.1.5:6789, adding it\r\n2020-01-17 14:03:25.163052 I | op-mon: new external mon ceph6 found: 10.1.1.6:6789, adding it\r\n2020-01-17 14:03:25.163064 I | op-mon: new external mon ceph7 found: 10.1.1.7:6789, adding it\r\n2020-01-17 14:03:25.173956 I | op-mon: saved mon endpoints to config map map[data:ceph5=10.1.1.5:6789,ceph6=10.1.1.6:6789,ceph7=10.1.1.7:6789 maxMonId:-1 mapping:{\"node\":{}} csi-cluster-config-json:[{\"clusterID\":\"rook-ceph\",\"monitors\":[\"10.1.1.5:6789\",\"10.1.1.6:6789\",\"10.1.1.7:6789\"]}]]\r\n2020-01-17 14:03:25.180472 I | cephconfig: writing config file /var/lib/rook/rook-ceph/rook-ceph.config\r\n2020-01-17 14:03:25.180747 I | cephconfig: generated admin config in /var/lib/rook/rook-ceph\r\n2020-01-17 14:04:11.090181 I | op-mon: ClusterInfo is now Empty, refilling it from status.MonMap.Mons\r\n2020-01-17 14:04:11.090223 I | op-mon: new external mon ceph5 found: 10.1.1.5:6789, adding it\r\n2020-01-17 14:04:11.090238 I | op-mon: new external mon ceph6 found: 10.1.1.6:6789, adding it\r\n2020-01-17 14:04:11.090249 I | op-mon: new external mon ceph7 found: 10.1.1.7:6789, adding it\r\n2020-01-17 14:04:11.100412 I | op-mon: saved mon endpoints to config map map[maxMonId:-1 mapping:{\"node\":{}} csi-cluster-config-json:[{\"clusterID\":\"rook-ceph\",\"monitors\":[\"10.1.1.5:6789\",\"10.1.1.6:6789\",\"10.1.1.7:6789\"]}] data:ceph5=10.1.1.5:6789,ceph6=10.1.1.6:6789,ceph7=10.1.1.7:6789]\r\n2020-01-17 14:04:11.106600 I | cephconfig: writing config file /var/lib/rook/rook-ceph/rook-ceph.config\r\n2020-01-17 14:04:11.106910 I | cephconfig: generated admin config in /var/lib/rook/rook-ceph\r\n2020-01-17 14:04:56.987005 I | op-mon: ClusterInfo is now Empty, refilling it from status.MonMap.Mons\r\n2020-01-17 14:04:56.987059 I | op-mon: new external mon ceph5 found: 10.1.1.5:6789, adding it\r\n2020-01-17 14:04:56.987075 I | op-mon: new external mon ceph6 found: 10.1.1.6:6789, adding it\r\n2020-01-17 14:04:56.987087 I | op-mon: new external mon ceph7 found: 10.1.1.7:6789, adding it\r\n2020-01-17 14:04:56.997593 I | op-mon: saved mon endpoints to config map map[csi-cluster-config-json:[{\"clusterID\":\"rook-ceph\",\"monitors\":[\"10.1.1.5:6789\",\"10.1.1.6:6789\",\"10.1.1.7:6789\"]}] data:ceph5=10.1.1.5:6789,ceph6=10.1.1.6:6789,ceph7=10.1.1.7:6789 maxMonId:-1 mapping:{\"node\":{}}]\r\n2020-01-17 14:04:57.003829 I | cephconfig: writing config file /var/lib/rook/rook-ceph/rook-ceph.config\r\n2020-01-17 14:04:57.004133 I | cephconfig: generated admin config in /var/lib/rook/rook-ceph\r\n2020-01-17 14:05:42.858947 I | op-mon: ClusterInfo is now Empty, refilling it from status.MonMap.Mons\r\n2020-01-17 14:05:42.859009 I | op-mon: new external mon ceph5 found: 10.1.1.5:6789, adding it\r\n2020-01-17 14:05:42.859028 I | op-mon: new external mon ceph6 found: 10.1.1.6:6789, adding it\r\n2020-01-17 14:05:42.859044 I | op-mon: new external mon ceph7 found: 10.1.1.7:6789, adding it\r\n2020-01-17 14:05:42.871217 I | op-mon: saved mon endpoints to config map map[csi-cluster-config-json:[{\"clusterID\":\"rook-ceph\",\"monitors\":[\"10.1.1.5:6789\",\"10.1.1.6:6789\",\"10.1.1.7:6789\"]}] data:ceph5=10.1.1.5:6789,ceph6=10.1.1.6:6789,ceph7=10.1.1.7:6789 maxMonId:-1 mapping:{\"node\":{}}]\r\n2020-01-17 14:05:42.877706 I | cephconfig: writing config file /var/lib/rook/rook-ceph/rook-ceph.config\r\n2020-01-17 14:05:42.877999 I | cephconfig: generated admin config in /var/lib/rook/rook-ceph\r\n2020-01-17 14:06:28.772799 I | op-mon: ClusterInfo is now Empty, refilling it from status.MonMap.Mons\r\n2020-01-17 14:06:28.772840 I | op-mon: new external mon ceph5 found: 10.1.1.5:6789, adding it\r\n2020-01-17 14:06:28.772855 I | op-mon: new external mon ceph6 found: 10.1.1.6:6789, adding it\r\n2020-01-17 14:06:28.772868 I | op-mon: new external mon ceph7 found: 10.1.1.7:6789, adding it\r\n2020-01-17 14:06:28.784259 I | op-mon: saved mon endpoints to config map map[mapping:{\"node\":{}} csi-cluster-config-json:[{\"clusterID\":\"rook-ceph\",\"monitors\":[\"10.1.1.7:6789\",\"10.1.1.5:6789\",\"10.1.1.6:6789\"]}] data:ceph5=10.1.1.5:6789,ceph6=10.1.1.6:6789,ceph7=10.1.1.7:6789 maxMonId:-1]\r\n2020-01-17 14:06:28.789822 I | cephconfig: writing config file /var/lib/rook/rook-ceph/rook-ceph.config\r\n2020-01-17 14:06:28.790111 I | cephconfig: generated admin config in /var/lib/rook/rook-ceph\r\n```\r\n\r\n**How to reproduce it (minimal and precise):**\r\n<!-- Please let us know any circumstances for reproduction of your bug. -->\r\n\r\nUse rook 1.2.1 with a external cluster with 3 mons.\r\n```\r\napiVersion: v1\r\nkind: Namespace\r\nmetadata:\r\n  name: {{ rook_namespace }}\r\n---\r\napiVersion: v1\r\nkind: Secret\r\nmetadata:\r\n  name: rook-ceph-mon\r\n  namespace: {{ rook_namespace }}\r\ntype: Opaque\r\ndata:\r\n  cluster-name: {{ rook_clustername | b64encode }}\r\n  fsid: {{ rook_external_fsid | b64encode }}\r\n  admin-secret: {{ rook_external_admin_secret | b64encode }}\r\n  mon-secret: {{ rook_external_mon_secret | b64encode }}\r\n---\r\napiVersion: v1\r\nkind: ConfigMap\r\nmetadata:\r\n  name: rook-ceph-mon-endpoints\r\n  namespace: {{ rook_namespace }}\r\ndata:\r\n  data: \"{{ rook_external_ceph_mon_data }}\"\r\n  mapping: \"{}\"\r\n  maxMonId: \"2\"\r\n---\r\napiVersion: ceph.rook.io/v1\r\nkind: CephCluster\r\nmetadata:\r\n  name: {{ rook_clustername }}\r\n  namespace: {{ rook_namespace }}\r\nspec:\r\n  external:\r\n    enable: true\r\n  dataDirHostPath: /var/lib/rook\r\n  # providing an image is optional, do this if you want to create other CRs (rgw, mds, nfs)\r\n  cephVersion:\r\n    image: ceph/ceph:v14.2.6 # MUST match external cluster version\r\n```\r\n**Environment**:\r\n* OS: CentOS 7\r\n* Kernel : 3.10.0-1062.9.1.el7.x86_64\r\n* Cloud provider or hardware configuration: Bare Metal\r\n* Rook version: v1.2.1\r\n* Storage backend version: ceph 14.2.6\r\n* Kubernetes version: v1.17.0\r\n* Kubernetes cluster type: Bare Metal\r\n* Storage backend status: HEALTH_OK\r\n",
  "closed_at": "2020-01-22T15:49:27Z",
  "closed_by": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/912735?v=4",
    "events_url": "https://api.github.com/users/leseb/events{/privacy}",
    "followers_url": "https://api.github.com/users/leseb/followers",
    "following_url": "https://api.github.com/users/leseb/following{/other_user}",
    "gists_url": "https://api.github.com/users/leseb/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/leseb",
    "id": 912735,
    "login": "leseb",
    "node_id": "MDQ6VXNlcjkxMjczNQ==",
    "organizations_url": "https://api.github.com/users/leseb/orgs",
    "received_events_url": "https://api.github.com/users/leseb/received_events",
    "repos_url": "https://api.github.com/users/leseb/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/leseb/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/leseb/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/leseb"
  },
  "comments": 7,
  "comments_url": "https://api.github.com/repos/rook/rook/issues/4717/comments",
  "created_at": "2020-01-17T14:23:27Z",
  "events_url": "https://api.github.com/repos/rook/rook/issues/4717/events",
  "html_url": "https://github.com/rook/rook/issues/4717",
  "id": 551443722,
  "labels": [],
  "labels_url": "https://api.github.com/repos/rook/rook/issues/4717/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU1NTE0NDM3MjI=",
  "number": 4717,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/rook/rook",
  "state": "closed",
  "title": "Ceph external cluster, repeatedly saving mon endpoints to config",
  "updated_at": "2020-01-22T15:49:27Z",
  "url": "https://api.github.com/repos/rook/rook/issues/4717",
  "user": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/1258508?v=4",
    "events_url": "https://api.github.com/users/eliaswimmer/events{/privacy}",
    "followers_url": "https://api.github.com/users/eliaswimmer/followers",
    "following_url": "https://api.github.com/users/eliaswimmer/following{/other_user}",
    "gists_url": "https://api.github.com/users/eliaswimmer/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/eliaswimmer",
    "id": 1258508,
    "login": "eliaswimmer",
    "node_id": "MDQ6VXNlcjEyNTg1MDg=",
    "organizations_url": "https://api.github.com/users/eliaswimmer/orgs",
    "received_events_url": "https://api.github.com/users/eliaswimmer/received_events",
    "repos_url": "https://api.github.com/users/eliaswimmer/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/eliaswimmer/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/eliaswimmer/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/eliaswimmer"
  }
}