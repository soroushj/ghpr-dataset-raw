{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "NONE",
  "body": "**Is this a bug report or feature request?**\r\n* Bug Report\r\n\r\n**Deviation from expected behavior:**\r\nOSD pod fails to start:\r\n\r\n```\r\n2019-09-13 12:01:40.439916 I | rookcmd: starting Rook v1.1.0 with arguments '/rook/rook ceph osd start -- --foreground --id 10 --osd-uuid 76f22a49-419f-4cdf-adfd-1de40780470d --conf /var/lib/rook/osd10/rook-ceph.config --cluster ceph --setuser ceph --setgroup ceph --setuser-match-path /var/lib/rook/osd10 --default-log-to-file false --ms-learn-addr-from-peer=false'\r\n2019-09-13 12:01:40.440034 I | rookcmd: flag values: --help=false, --log-flush-frequency=5s, --log-level=INFO, --lv-path=, --operator-image=, --osd-id=10, --osd-store-type=bluestore, --osd-uuid=76f22a49-419f-4cdf-adfd-1de40780470d, --pvc-backed-osd=false, --service-account=\r\n2019-09-13 12:01:40.440060 I | op-mon: parsing mon endpoints:\r\n2019-09-13 12:01:40.440068 W | op-mon: ignoring invalid monitor\r\n2019-09-13 12:01:40.443824 I | exec: Running command: stdbuf -oL ceph-volume lvm activate --no-systemd --bluestore 10 76f22a49-419f-4cdf-adfd-1de40780470d\r\n2019-09-13 12:01:41.124492 I | Running command: /bin/mount -t tmpfs tmpfs /var/lib/ceph/osd/ceph-10\r\n2019-09-13 12:01:41.625015 I | Running command: /usr/sbin/restorecon /var/lib/ceph/osd/ceph-10\r\n2019-09-13 12:01:42.140985 I | Running command: /bin/ceph-authtool /var/lib/ceph/osd/ceph-10/lockbox.keyring --create-keyring --name client.osd-lockbox.76f22a49-419f-4cdf-adfd-1de40780470d --add-key AQBWW3tdyopdMBAA5FhnWqIhvCMJpdput0mNQw==\r\n2019-09-13 12:01:42.697765 I |  stdout: creating /var/lib/ceph/osd/ceph-10/lockbox.keyring\r\n2019-09-13 12:01:42.697795 I | added entity client.osd-lockbox.76f22a49-419f-4cdf-adfd-1de40780470d auth(key=AQBWW3tdyopdMBAA5FhnWqIhvCMJpdput0mNQw==)\r\n2019-09-13 12:01:42.701861 I | Running command: /bin/chown -R ceph:ceph /var/lib/ceph/osd/ceph-10/lockbox.keyring\r\n2019-09-13 12:01:43.192257 I | Running command: /bin/ceph --cluster ceph --name client.osd-lockbox.76f22a49-419f-4cdf-adfd-1de40780470d --keyring /var/lib/ceph/osd/ceph-10/lockbox.keyring config-key get dm-crypt/osd/76f22a49-419f-4cdf-adfd-1de40780470d/luks\r\n2019-09-13 12:01:43.876119 I |  stderr: unable to get monitor info from DNS SRV with service name: ceph-mon\r\n2019-09-13 12:01:43.876741 I |  stderr: [errno 2] error connecting to the cluster\r\n2019-09-13 12:01:43.878542 I | -->  RuntimeError: Unable to retrieve dmcrypt secret\r\nfailed to activate osd. Failed to complete '': exit status 1.\r\n```\r\n\r\n**Expected behavior:**\r\nIt should start up normally\r\n\r\n**How to reproduce it (minimal and precise):**\r\nThe problem doesn't happen with rook 1.0, but happens in rook 1.1, the cluster needs to have disk encryption enabled for the problem to manifest. Without disk encryption everything works fine.\r\n",
  "closed_at": "2019-09-25T07:00:07Z",
  "closed_by": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/912735?v=4",
    "events_url": "https://api.github.com/users/leseb/events{/privacy}",
    "followers_url": "https://api.github.com/users/leseb/followers",
    "following_url": "https://api.github.com/users/leseb/following{/other_user}",
    "gists_url": "https://api.github.com/users/leseb/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/leseb",
    "id": 912735,
    "login": "leseb",
    "node_id": "MDQ6VXNlcjkxMjczNQ==",
    "organizations_url": "https://api.github.com/users/leseb/orgs",
    "received_events_url": "https://api.github.com/users/leseb/received_events",
    "repos_url": "https://api.github.com/users/leseb/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/leseb/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/leseb/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/leseb"
  },
  "comments": 2,
  "comments_url": "https://api.github.com/repos/rook/rook/issues/3846/comments",
  "created_at": "2019-09-13T15:52:20Z",
  "events_url": "https://api.github.com/repos/rook/rook/issues/3846/events",
  "html_url": "https://github.com/rook/rook/issues/3846",
  "id": 493399335,
  "labels": [
    {
      "color": "ee0000",
      "default": true,
      "description": "",
      "id": 405241115,
      "name": "bug",
      "node_id": "MDU6TGFiZWw0MDUyNDExMTU=",
      "url": "https://api.github.com/repos/rook/rook/labels/bug"
    },
    {
      "color": "ef5c55",
      "default": false,
      "description": "main ceph tag",
      "id": 479456042,
      "name": "ceph",
      "node_id": "MDU6TGFiZWw0Nzk0NTYwNDI=",
      "url": "https://api.github.com/repos/rook/rook/labels/ceph"
    }
  ],
  "labels_url": "https://api.github.com/repos/rook/rook/issues/3846/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU0OTMzOTkzMzU=",
  "number": 3846,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/rook/rook",
  "state": "closed",
  "title": "OSD pod fails to start when using disk encryption with rook 1.1",
  "updated_at": "2019-09-25T07:00:07Z",
  "url": "https://api.github.com/repos/rook/rook/issues/3846",
  "user": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/373249?v=4",
    "events_url": "https://api.github.com/users/rslinckx/events{/privacy}",
    "followers_url": "https://api.github.com/users/rslinckx/followers",
    "following_url": "https://api.github.com/users/rslinckx/following{/other_user}",
    "gists_url": "https://api.github.com/users/rslinckx/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/rslinckx",
    "id": 373249,
    "login": "rslinckx",
    "node_id": "MDQ6VXNlcjM3MzI0OQ==",
    "organizations_url": "https://api.github.com/users/rslinckx/orgs",
    "received_events_url": "https://api.github.com/users/rslinckx/received_events",
    "repos_url": "https://api.github.com/users/rslinckx/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/rslinckx/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rslinckx/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/rslinckx"
  }
}