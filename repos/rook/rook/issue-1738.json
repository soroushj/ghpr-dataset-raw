{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/7062400?v=4",
    "events_url": "https://api.github.com/users/rootfs/events{/privacy}",
    "followers_url": "https://api.github.com/users/rootfs/followers",
    "following_url": "https://api.github.com/users/rootfs/following{/other_user}",
    "gists_url": "https://api.github.com/users/rootfs/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/rootfs",
    "id": 7062400,
    "login": "rootfs",
    "node_id": "MDQ6VXNlcjcwNjI0MDA=",
    "organizations_url": "https://api.github.com/users/rootfs/orgs",
    "received_events_url": "https://api.github.com/users/rootfs/received_events",
    "repos_url": "https://api.github.com/users/rootfs/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/rootfs/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rootfs/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/rootfs"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars0.githubusercontent.com/u/7062400?v=4",
      "events_url": "https://api.github.com/users/rootfs/events{/privacy}",
      "followers_url": "https://api.github.com/users/rootfs/followers",
      "following_url": "https://api.github.com/users/rootfs/following{/other_user}",
      "gists_url": "https://api.github.com/users/rootfs/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/rootfs",
      "id": 7062400,
      "login": "rootfs",
      "node_id": "MDQ6VXNlcjcwNjI0MDA=",
      "organizations_url": "https://api.github.com/users/rootfs/orgs",
      "received_events_url": "https://api.github.com/users/rootfs/received_events",
      "repos_url": "https://api.github.com/users/rootfs/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/rootfs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rootfs/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/rootfs"
    }
  ],
  "author_association": "CONTRIBUTOR",
  "body": "**Bug Report**\r\n\r\nWhat happened: The OSD refuses to use some devices as it thinks it doesn't \"own\" them:\r\n```\r\n2018-05-24 14:28:11.012526 I | exec: Running command: lsblk /dev/sde --bytes --pairs --output NAME,SIZE,TYPE,PKNAME\r\n2018-05-24 14:28:11.013522 I | exec: Running command: udevadm info --query=property /dev/sde1\r\n2018-05-24 14:28:11.014429 I | exec: Running command: udevadm info --query=property /dev/sde1\r\n2018-05-24 14:28:11.015330 I | exec: Running command: udevadm info --query=property /dev/sde2\r\n2018-05-24 14:28:11.016239 I | exec: Running command: udevadm info --query=property /dev/sde2\r\n2018-05-24 14:28:11.017135 I | exec: Running command: udevadm info --query=property /dev/sde3\r\n2018-05-24 14:28:11.018040 I | exec: Running command: udevadm info --query=property /dev/sde3\r\n2018-05-24 14:28:11.018942 I | exec: Running command: udevadm info --query=property /dev/sde\r\n2018-05-24 14:28:11.019848 I | cephosd: skipping device sde that is in use (not by rook). fs: , ownPartitions: false\r\n```\r\n\r\nWhat you expected to happen: Rook realizes that it owns the devices and starts using them.\r\n\r\nHow to reproduce it (minimal and precise):\r\nTry to use devices have been used by rook previously.\r\n\r\nThe issue seems to be that `udevadm info --query=property` returns only a subset of the information required.\r\n\r\nInside the container:\r\n```root@rook-ceph-osd-xjb4z:/var/lib/rook# lsblk /dev/sde --bytes --pairs --output NAME,SIZE,TYPE,PKNAME                                             \r\nNAME=\"sde\" SIZE=\"8001563222016\" TYPE=\"disk\" PKNAME=\"\"                    \r\nNAME=\"sde1\" SIZE=\"603979776\" TYPE=\"part\" PKNAME=\"sde\"                    \r\nNAME=\"sde2\" SIZE=\"21474836480\" TYPE=\"part\" PKNAME=\"sde\"                  \r\nNAME=\"sde3\" SIZE=\"7979483340288\" TYPE=\"part\" PKNAME=\"sde\"                \r\nroot@rook-ceph-osd-xjb4z:/var/lib/rook# udevadm info --query=property /dev/sde1                                                                                                                                                                                                                      \r\nDEVNAME=/dev/sde1\r\nDEVPATH=/devices/pci0000:00/0000:00:03.2/0000:07:00.0/host0/target0:0:13/0:0:13:0/block/sde/sde1\r\nDEVTYPE=partition\r\nMAJOR=8\r\nMINOR=65\r\nSUBSYSTEM=block                                                        \r\n```\r\nOutside the container:\r\n```[root@host lib]# lsblk /dev/sde --bytes --pairs --output NAME,SIZE,TYPE,PKNAME\r\nNAME=\"sde\" SIZE=\"8001563222016\" TYPE=\"disk\" PKNAME=\"\"                                          \r\nNAME=\"sde1\" SIZE=\"603979776\" TYPE=\"part\" PKNAME=\"sde\"                                          \r\nNAME=\"sde2\" SIZE=\"21474836480\" TYPE=\"part\" PKNAME=\"sde\"                                        \r\nNAME=\"sde3\" SIZE=\"7979483340288\" TYPE=\"part\" PKNAME=\"sde\"                                      \r\n[root@host lib]# udevadm info --query=property /dev/sde1                      \r\nDEVLINKS=/dev/disk/by-id/ata-ST8000NM0055-1RM112_ZA12ETTK-part1 /dev/disk/by-id/wwn-0x5000c50091950a56-part1 /dev/disk/by-partlabel/ROOK-OSD7-WAL /dev/disk/by-partuuid/2699c584-7f46-4b29-85ba-0b430d2569d7 /dev/disk/by-path/pci-0000:07:00.0-scsi-0:0:13:0-part1\r\nDEVNAME=/dev/sde1      \r\nDEVPATH=/devices/pci0000:00/0000:00:03.2/0000:07:00.0/host0/target0:0:13/0:0:13:0/block/sde/sde1\r\nDEVTYPE=partition      \r\nID_ATA=1               \r\nID_ATA_DOWNLOAD_MICROCODE=1                    \r\nID_ATA_FEATURE_SET_PM=1                        \r\nID_ATA_FEATURE_SET_PM_ENABLED=1                \r\nID_ATA_FEATURE_SET_SECURITY=1                  \r\nID_ATA_FEATURE_SET_SECURITY_ENABLED=0          \r\nID_ATA_FEATURE_SET_SECURITY_ENHANCED_ERASE_UNIT_MIN=66226                                      \r\nID_ATA_FEATURE_SET_SECURITY_ERASE_UNIT_MIN=66226                                               \r\nID_ATA_FEATURE_SET_SMART=1                     \r\nID_ATA_FEATURE_SET_SMART_ENABLED=1             \r\nID_ATA_ROTATION_RATE_RPM=7200                  \r\nID_ATA_SATA=1          \r\nID_ATA_SATA_SIGNAL_RATE_GEN1=1                 \r\nID_ATA_SATA_SIGNAL_RATE_GEN2=1                 \r\nID_ATA_WRITE_CACHE=1   \r\nID_ATA_WRITE_CACHE_ENABLED=1                   \r\nID_BUS=ata             \r\nID_MODEL=ST8000NM0055-1RM112                   \r\nID_MODEL_ENC=ST8000NM0055-1RM112\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\r\nID_PART_ENTRY_DISK=8:64                        \r\nID_PART_ENTRY_NAME=ROOK-OSD7-WAL               \r\nID_PART_ENTRY_NUMBER=1 \r\nID_PART_ENTRY_OFFSET=2048                      \r\nID_PART_ENTRY_SCHEME=gpt                       \r\nID_PART_ENTRY_SIZE=1179648                     \r\nID_PART_ENTRY_TYPE=0fc63daf-8483-4772-8e79-3d69d8477de4                                        \r\nID_PART_ENTRY_UUID=2699c584-7f46-4b29-85ba-0b430d2569d7                                        \r\nID_PART_TABLE_TYPE=gpt \r\nID_PATH=pci-0000:07:00.0-scsi-0:0:13:0         \r\nID_PATH_TAG=pci-0000_07_00_0-scsi-0_0_13_0     \r\nID_REVISION=PA25       \r\nID_SERIAL=ST8000NM0055-1RM112_ZA12ETTK         \r\nID_SERIAL_SHORT=ZA12ETTK                       \r\nID_TYPE=disk           \r\nID_WWN=0x5000c50091950a56                      \r\nID_WWN_WITH_EXTENSION=0x5000c50091950a56       \r\nMAJOR=8                \r\nMINOR=65               \r\nSUBSYSTEM=block        \r\nTAGS=:systemd:         \r\nUSEC_INITIALIZED=431240938                     \r\n```\r\n\r\n**Environment**:\r\n* OS (e.g. from /etc/os-release): RHEL 7.3\r\n* Kernel (e.g. `uname -a`): 3.10.0-514.6.1.el7\r\n* Cloud provider or hardware configuration:\r\n* Rook version (use `rook version` inside of a Rook Pod): v0.7.0-136.gd13bc83\r\n* Kubernetes version (use `kubectl version`): 1.9.3\r\n* Kubernetes cluster type (e.g. Tectonic, GKE, OpenShift): open source on-prem\r\n* Ceph status: HEALTH_WARN Reduced data availability: 800 pgs inactive (since no devices are available)\r\n",
  "closed_at": "2018-05-26T20:26:47Z",
  "closed_by": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/4313439?v=4",
    "events_url": "https://api.github.com/users/jbw976/events{/privacy}",
    "followers_url": "https://api.github.com/users/jbw976/followers",
    "following_url": "https://api.github.com/users/jbw976/following{/other_user}",
    "gists_url": "https://api.github.com/users/jbw976/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/jbw976",
    "id": 4313439,
    "login": "jbw976",
    "node_id": "MDQ6VXNlcjQzMTM0Mzk=",
    "organizations_url": "https://api.github.com/users/jbw976/orgs",
    "received_events_url": "https://api.github.com/users/jbw976/received_events",
    "repos_url": "https://api.github.com/users/jbw976/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/jbw976/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jbw976/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/jbw976"
  },
  "comments": 1,
  "comments_url": "https://api.github.com/repos/rook/rook/issues/1738/comments",
  "created_at": "2018-05-24T15:29:51Z",
  "events_url": "https://api.github.com/repos/rook/rook/issues/1738/events",
  "html_url": "https://github.com/rook/rook/issues/1738",
  "id": 326175223,
  "labels": [
    {
      "color": "ee0000",
      "default": true,
      "description": "",
      "id": 405241115,
      "name": "bug",
      "node_id": "MDU6TGFiZWw0MDUyNDExMTU=",
      "url": "https://api.github.com/repos/rook/rook/labels/bug"
    },
    {
      "color": "ef5c55",
      "default": false,
      "description": "main ceph tag",
      "id": 479456042,
      "name": "ceph",
      "node_id": "MDU6TGFiZWw0Nzk0NTYwNDI=",
      "url": "https://api.github.com/repos/rook/rook/labels/ceph"
    },
    {
      "color": "00aaaa",
      "default": false,
      "description": "daemons are rook executables which aren't primary backend operators; code in the pkg/daemon path",
      "id": 496388704,
      "name": "daemon",
      "node_id": "MDU6TGFiZWw0OTYzODg3MDQ=",
      "url": "https://api.github.com/repos/rook/rook/labels/daemon"
    }
  ],
  "labels_url": "https://api.github.com/repos/rook/rook/issues/1738/labels{/name}",
  "locked": false,
  "milestone": {
    "closed_at": "2020-01-28T21:43:40Z",
    "closed_issues": 62,
    "created_at": "2017-11-06T17:57:26Z",
    "creator": {
      "avatar_url": "https://avatars3.githubusercontent.com/u/1463491?v=4",
      "events_url": "https://api.github.com/users/bassam/events{/privacy}",
      "followers_url": "https://api.github.com/users/bassam/followers",
      "following_url": "https://api.github.com/users/bassam/following{/other_user}",
      "gists_url": "https://api.github.com/users/bassam/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/bassam",
      "id": 1463491,
      "login": "bassam",
      "node_id": "MDQ6VXNlcjE0NjM0OTE=",
      "organizations_url": "https://api.github.com/users/bassam/orgs",
      "received_events_url": "https://api.github.com/users/bassam/received_events",
      "repos_url": "https://api.github.com/users/bassam/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/bassam/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bassam/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/bassam"
    },
    "description": "* Multiple storage backends\r\n  * Full design\r\n  * Refactor code base and repositories to enable\r\n  * Consider support for Minio, potentially early support for other backends time permitting\r\n* Switch CRDs to API Aggregation\r\n* Run on arbitrary PVs\r\n* Remove Rook API and CLI\r\n* Migrate CI and release pipelines to a solution hosted by the CNCF\r\n* Run with Least Privileged and possibly without privileged containers\r\n* Shutdown / restart issues\r\n* Support Kubernetes 1.7+ only\r\n* Ceph features and improvements\r\n  * Adding/removing disks (lifecycle issues, failures, 1 OSD per pod, etc.)\r\n  * Placement group balancer support (ceph-mgr module)\r\n  * Mon reliability (restarts, failing over too fast, ip changes, etc.)\r\n  * Mimic support",
    "due_on": null,
    "html_url": "https://github.com/rook/rook/milestone/8",
    "id": 2891896,
    "labels_url": "https://api.github.com/repos/rook/rook/milestones/8/labels",
    "node_id": "MDk6TWlsZXN0b25lMjg5MTg5Ng==",
    "number": 8,
    "open_issues": 0,
    "state": "closed",
    "title": "0.8",
    "updated_at": "2020-01-28T21:43:40Z",
    "url": "https://api.github.com/repos/rook/rook/milestones/8"
  },
  "node_id": "MDU6SXNzdWUzMjYxNzUyMjM=",
  "number": 1738,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/rook/rook",
  "state": "closed",
  "title": "Rook OSD doesn't use devices that it \"owns\"",
  "updated_at": "2018-05-26T20:26:47Z",
  "url": "https://api.github.com/repos/rook/rook/issues/1738",
  "user": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/1381651?v=4",
    "events_url": "https://api.github.com/users/benceszikora/events{/privacy}",
    "followers_url": "https://api.github.com/users/benceszikora/followers",
    "following_url": "https://api.github.com/users/benceszikora/following{/other_user}",
    "gists_url": "https://api.github.com/users/benceszikora/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/benceszikora",
    "id": 1381651,
    "login": "benceszikora",
    "node_id": "MDQ6VXNlcjEzODE2NTE=",
    "organizations_url": "https://api.github.com/users/benceszikora/orgs",
    "received_events_url": "https://api.github.com/users/benceszikora/received_events",
    "repos_url": "https://api.github.com/users/benceszikora/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/benceszikora/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/benceszikora/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/benceszikora"
  }
}