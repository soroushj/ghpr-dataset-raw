{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "CONTRIBUTOR",
  "body": "**Is this a bug report or feature request?**\r\n* Bug Report\r\n\r\n**Deviation from expected behavior:**\r\nMGR starts on host port 8443 with ssl enabled\r\n\r\n**Expected behavior:**\r\nMGR starts on host port 8080 with ssl disabled\r\n\r\n**How to reproduce it (minimal and precise):**\r\n<!-- Please let us know any circumstances for reproduction of your bug. -->\r\n\r\n```\r\n  mon:\r\n    count: 5\r\n    allowMultiplePerNode: false\r\n  network:\r\n    hostNetwork: true\r\n  rbdMirroring:\r\n    workers: 3\r\n  dashboard:\r\n    enabled: true\r\n    # serve the dashboard under a subpath (useful when you are accessing the dashboard via a reverse proxy)\r\n    # urlPrefix: /ceph-dashboard\r\n    # serve the dashboard at the given port.\r\n    port: 8080\r\n    # # serve the dashboard using SSL\r\n    ssl: false\r\n```\r\n\r\nThe Pod is configured correct:\r\n```\r\nContainers:\r\n  mgr:\r\n    Container ID:  docker://966b435ba899337cb641a6e47b916831e3b18bbfdae38f8b5c522dfc9216b32f\r\n    Image:         ceph/ceph:v14.2\r\n    Image ID:      docker-pullable://ceph/ceph@sha256:550d45fbdd3625bec5681389ab68e267a1da0318e19aa0045684d511b872ae5b\r\n    Ports:         6800/TCP, 9283/TCP, 8080/TCP\r\n    Host Ports:    6800/TCP, 9283/TCP, 8080/TCP\r\n    Command:\r\n      ceph-mgr\r\n    Args:\r\n      --fsid=6b9e803d-0aa2-4528-a406-3392785e7dbf\r\n      --keyring=/etc/ceph/keyring-store/keyring\r\n      --log-to-stderr=true\r\n      --err-to-stderr=true\r\n      --mon-cluster-log-to-stderr=true\r\n      --log-stderr-prefix=debug \r\n      --mon-host=$(ROOK_CEPH_MON_HOST)\r\n      --mon-initial-members=$(ROOK_CEPH_MON_INITIAL_MEMBERS)\r\n      --id=a\r\n      --foreground\r\n```\r\n\r\nHowever the mgr listens on port 8443:\r\n```\r\n[22/Mar/2019:08:25:03] ENGINE Serving on 172.22.253.88:9283\r\n[22/Mar/2019:08:25:03] ENGINE Bus STARTED\r\n[22/Mar/2019:08:25:03] ENGINE Bus STARTING\r\n[22/Mar/2019:08:25:03] ENGINE Started monitor thread '_TimeoutMonitor'.\r\n[22/Mar/2019:08:25:03] ENGINE Serving on 172.22.253.88:8443\r\n[22/Mar/2019:08:25:03] ENGINE Bus STARTED\r\n```\r\n\r\nSee curl:\r\n```\r\ncurl -X HEAD -v --insecure https://172.22.253.88:8443\r\nWarning: Setting custom HTTP method to HEAD with -X/--request may not work the \r\nWarning: way you want. Consider using -I/--head instead.\r\n* Rebuilt URL to: https://172.22.253.88:8443/\r\n*   Trying 172.22.253.88...\r\n* TCP_NODELAY set\r\n* Connected to 172.22.253.88 (172.22.253.88) port 8443 (#0)\r\n* ALPN, offering h2\r\n* ALPN, offering http/1.1\r\n* successfully set certificate verify locations:\r\n*   CAfile: /etc/ssl/certs/ca-certificates.crt\r\n  CApath: /etc/ssl/certs\r\n* TLSv1.2 (OUT), TLS handshake, Client hello (1):\r\n* TLSv1.2 (IN), TLS handshake, Server hello (2):\r\n* TLSv1.2 (IN), TLS handshake, Certificate (11):\r\n* TLSv1.2 (IN), TLS handshake, Server key exchange (12):\r\n* TLSv1.2 (IN), TLS handshake, Server finished (14):\r\n* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):\r\n* TLSv1.2 (OUT), TLS change cipher, Client hello (1):\r\n* TLSv1.2 (OUT), TLS handshake, Finished (20):\r\n* TLSv1.2 (IN), TLS handshake, Finished (20):\r\n* SSL connection using TLSv1.2 / ECDHE-RSA-AES256-GCM-SHA384\r\n* ALPN, server did not agree to a protocol\r\n* Server certificate:\r\n*  subject: O=IT; CN=ceph-dashboard\r\n*  start date: Mar 22 08:05:05 2019 GMT\r\n*  expire date: Mar 19 08:05:05 2029 GMT\r\n*  issuer: O=IT; CN=ceph-dashboard\r\n*  SSL certificate verify result: self signed certificate (18), continuing anyway.\r\n> HEAD / HTTP/1.1\r\n> Host: 172.22.253.88:8443\r\n> User-Agent: curl/7.58.0\r\n> Accept: */*\r\n> \r\n< HTTP/1.1 200 OK\r\n```\r\n\r\n```\r\ncurl -X HEAD -v --insecure https://172.22.253.88:8080\r\nWarning: Setting custom HTTP method to HEAD with -X/--request may not work the \r\nWarning: way you want. Consider using -I/--head instead.\r\n* Rebuilt URL to: https://172.22.253.88:8080/\r\n*   Trying 172.22.253.88...\r\n* TCP_NODELAY set\r\n* connect to 172.22.253.88 port 8080 failed: Connection refused\r\n* Failed to connect to 172.22.253.88 port 8080: Connection refused\r\n* Closing connection 0\r\ncurl: (7) Failed to connect to 172.22.253.88 port 8080: Connection refused\r\n\r\n```\r\n\r\n\r\n**Environment:**\r\nOS (e.g. from /etc/os-release):\r\nhostNetwork: true\r\nKernel (e.g. uname -a):\r\n4.14.96-coreos\r\nCloud provider or hardware configuration:\r\nbare-metal / vmware\r\nRook version (use rook version inside of a Rook Pod):\r\n v0.9.0-323.g2447520\r\nKubernetes version (use kubectl version):\r\nClient Version: version.Info{Major:\"1\", Minor:\"13\", GitVersion:\"v1.13.4\", GitCommit:\"c27b913fddd1a6c480c229191a087698aa92f0b1\", GitTreeState:\"clean\", BuildDate:\"2019-02-28T13:37:52Z\", GoVersion:\"go1.11.5\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\nServer Version: version.Info{Major:\"1\", Minor:\"13\", GitVersion:\"v1.13.4\", GitCommit:\"c27b913fddd1a6c480c229191a087698aa92f0b1\", GitTreeState:\"clean\", BuildDate:\"2019-02-28T13:30:26Z\", GoVersion:\"go1.11.5\", Compiler:\"gc\", Platform:\"linux/amd64\"}",
  "closed_at": "2019-04-24T20:44:21Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/1048514?v=4",
    "events_url": "https://api.github.com/users/travisn/events{/privacy}",
    "followers_url": "https://api.github.com/users/travisn/followers",
    "following_url": "https://api.github.com/users/travisn/following{/other_user}",
    "gists_url": "https://api.github.com/users/travisn/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/travisn",
    "id": 1048514,
    "login": "travisn",
    "node_id": "MDQ6VXNlcjEwNDg1MTQ=",
    "organizations_url": "https://api.github.com/users/travisn/orgs",
    "received_events_url": "https://api.github.com/users/travisn/received_events",
    "repos_url": "https://api.github.com/users/travisn/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/travisn/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/travisn/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/travisn"
  },
  "comments": 2,
  "comments_url": "https://api.github.com/repos/rook/rook/issues/2875/comments",
  "created_at": "2019-03-22T08:41:19Z",
  "events_url": "https://api.github.com/repos/rook/rook/issues/2875/events",
  "html_url": "https://github.com/rook/rook/issues/2875",
  "id": 424099616,
  "labels": [
    {
      "color": "ee0000",
      "default": true,
      "description": "",
      "id": 405241115,
      "name": "bug",
      "node_id": "MDU6TGFiZWw0MDUyNDExMTU=",
      "url": "https://api.github.com/repos/rook/rook/labels/bug"
    }
  ],
  "labels_url": "https://api.github.com/repos/rook/rook/issues/2875/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU0MjQwOTk2MTY=",
  "number": 2875,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/rook/rook",
  "state": "closed",
  "title": "master - Wrong ssl and port config on mgr",
  "updated_at": "2019-04-24T20:44:21Z",
  "url": "https://api.github.com/repos/rook/rook/issues/2875",
  "user": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/100767?v=4",
    "events_url": "https://api.github.com/users/mmack/events{/privacy}",
    "followers_url": "https://api.github.com/users/mmack/followers",
    "following_url": "https://api.github.com/users/mmack/following{/other_user}",
    "gists_url": "https://api.github.com/users/mmack/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/mmack",
    "id": 100767,
    "login": "mmack",
    "node_id": "MDQ6VXNlcjEwMDc2Nw==",
    "organizations_url": "https://api.github.com/users/mmack/orgs",
    "received_events_url": "https://api.github.com/users/mmack/received_events",
    "repos_url": "https://api.github.com/users/mmack/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/mmack/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mmack/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/mmack"
  }
}