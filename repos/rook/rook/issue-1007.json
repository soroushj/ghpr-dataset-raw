{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/4313439?v=4",
    "events_url": "https://api.github.com/users/jbw976/events{/privacy}",
    "followers_url": "https://api.github.com/users/jbw976/followers",
    "following_url": "https://api.github.com/users/jbw976/following{/other_user}",
    "gists_url": "https://api.github.com/users/jbw976/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/jbw976",
    "id": 4313439,
    "login": "jbw976",
    "node_id": "MDQ6VXNlcjQzMTM0Mzk=",
    "organizations_url": "https://api.github.com/users/jbw976/orgs",
    "received_events_url": "https://api.github.com/users/jbw976/received_events",
    "repos_url": "https://api.github.com/users/jbw976/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/jbw976/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jbw976/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/jbw976"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars2.githubusercontent.com/u/4313439?v=4",
      "events_url": "https://api.github.com/users/jbw976/events{/privacy}",
      "followers_url": "https://api.github.com/users/jbw976/followers",
      "following_url": "https://api.github.com/users/jbw976/following{/other_user}",
      "gists_url": "https://api.github.com/users/jbw976/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jbw976",
      "id": 4313439,
      "login": "jbw976",
      "node_id": "MDQ6VXNlcjQzMTM0Mzk=",
      "organizations_url": "https://api.github.com/users/jbw976/orgs",
      "received_events_url": "https://api.github.com/users/jbw976/received_events",
      "repos_url": "https://api.github.com/users/jbw976/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jbw976/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jbw976/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jbw976"
    }
  ],
  "author_association": "NONE",
  "body": "Hello,\r\n\r\nI've deployed rook with:\r\n\r\n```\r\n  storage:                # cluster level storage configuration and selection\r\n    useAllNodes: true\r\n    useAllDevices: true\r\n```\r\n\r\nThis worked fine with my first three nodes when it took the `sdb`s from those nodes and created a cluster fine.\r\n\r\nI then added a node with two disks that were in an `mdadm` RAID with LVM on that for the system partitions, but no spare block devices. I expected nothing to be added from Rook to this system. However to my surprise, it had decided to create one on the filesystem on the LVM:\r\n\r\n```\r\nPod:  rook-ceph-osd-l7xxq\r\nNode: node4\r\n-ne -osd3 \r\n/dev/mapper/system-root 912.1G filestore\r\n```\r\n\r\nThis is also a filestore instead of the bluestore I specified.\r\n\r\nHere are the initial logs from the container:\r\n\r\n```\r\n[WARN  tini (7)] Tini is not running as PID 1 and isn't registered as a child subreaper.\r\nZombie processes will not be re-parented to Tini, so zombie reaping won't work.\r\nTo fix the problem, use the -s option or set the environment variable TINI_SUBREAPER to register Tini as a child subreaper, or run Tini as PID 1.\r\n2017-09-23 07:29:52.475366 I | rook: starting Rook v0.5.0-105.gc3b000f with arguments '/usr/local/bin/rook osd'\r\n2017-09-23 07:29:52.475449 I | rook: flag values: --admin-secret=*****, --ceph-config-override=/etc/rook/config/override.conf, --cluster-name=rook, --config-dir=/var/lib/rook, --data-device-filter=all, --data-devices=, --data-directories=, --force-format=false, --fsid=, --help=false, --location=, --log-level=INFO, --metadata-device=, --mon-endpoints=rook-ceph-mon0=...,rook-ceph-mon1=...,rook-ceph-mon2=..., --mon-secret=*****, --node-name=node4, --osd-database-size=20480, --osd-journal-size=5120, --osd-store=bluestore, --osd-wal-size=576, --private-ipv4=**.**.**.**, --public-ipv4=**.**.**.**\r\n2017-09-23 07:29:52.475456 I | cephmon: parsing mon endpoints: rook-ceph-mon0=...,rook-ceph-mon1=...,rook-ceph-mon2=...\r\n2017-09-23 07:29:52.475472 I | proc: Running process hostname with args: [node4]\r\n2017-09-23 07:29:52.475478 I | exec: Running command: hostname node4\r\n2017-09-23 07:29:52.476658 I | cephmon: writing config file /var/lib/rook/rook/rook.config\r\n2017-09-23 07:29:52.476787 I | cephmon: generated admin config in /var/lib/rook/rook\r\n2017-09-23 07:29:52.476792 I | cephosd: discovering hardware\r\n2017-09-23 07:29:52.476840 I | exec: Running command: lsblk --all --noheadings --list --output KNAME\r\n2017-09-23 07:29:52.478614 I | exec: Running command: lsblk /dev/sda --bytes --nodeps --pairs --output SIZE,ROTA,RO,TYPE,PKNAME\r\n2017-09-23 07:29:52.479618 I | exec: Running command: sgdisk --print /dev/sda\r\n2017-09-23 07:29:52.481122 I | exec: Running command: df --output=source,fstype\r\n2017-09-23 07:29:52.481784 I | exec: Running command: lsblk /dev/sda1 --bytes --nodeps --pairs --output SIZE,ROTA,RO,TYPE,PKNAME\r\n2017-09-23 07:29:52.482685 I | exec: Running command: df --output=source,fstype\r\n2017-09-23 07:29:52.483344 I | exec: Running command: lsblk /dev/sdb --bytes --nodeps --pairs --output SIZE,ROTA,RO,TYPE,PKNAME\r\n2017-09-23 07:29:52.484289 I | exec: Running command: sgdisk --print /dev/sdb\r\n2017-09-23 07:29:52.485674 I | exec: Running command: df --output=source,fstype\r\n2017-09-23 07:29:52.486665 I | exec: Running command: lsblk /dev/sdb1 --bytes --nodeps --pairs --output SIZE,ROTA,RO,TYPE,PKNAME\r\n2017-09-23 07:29:52.487696 I | exec: Running command: df --output=source,fstype\r\n2017-09-23 07:29:52.488386 I | exec: Running command: lsblk /dev/md0 --bytes --nodeps --pairs --output SIZE,ROTA,RO,TYPE,PKNAME\r\n2017-09-23 07:29:52.489466 I | exec: Running command: lsblk /dev/md0 --bytes --nodeps --pairs --output SIZE,ROTA,RO,TYPE,PKNAME\r\n2017-09-23 07:29:52.490552 I | exec: Running command: lsblk /dev/dm-0 --bytes --nodeps --pairs --output SIZE,ROTA,RO,TYPE,PKNAME\r\n2017-09-23 07:29:52.498242 I | exec: Running command: lsblk /dev/dm-0 --bytes --nodeps --pairs --output SIZE,ROTA,RO,TYPE,PKNAME\r\n2017-09-23 07:29:52.499270 I | exec: Running command: lsblk /dev/dm-1 --bytes --nodeps --pairs --output SIZE,ROTA,RO,TYPE,PKNAME\r\n2017-09-23 07:29:52.500149 I | exec: Running command: lsblk /dev/dm-1 --bytes --nodeps --pairs --output SIZE,ROTA,RO,TYPE,PKNAME\r\n2017-09-23 07:29:52.500989 I | cephosd: creating and starting the osds\r\n2017-09-23 07:29:52.501003 I | exec: Running command: lsblk /dev/sda --bytes --pairs --output NAME,SIZE,TYPE,PKNAME\r\n2017-09-23 07:29:52.501976 I | exec: Running command: blkid /dev/sda1 -s PARTLABEL -o value\r\n2017-09-23 07:29:52.502863 I | exec: Running command: df --output=source,fstype\r\n2017-09-23 07:29:52.503524 I | cephosd: skipping device sda that is in use (not by rook). fs: , ownPartitions: false\r\n2017-09-23 07:29:52.503539 I | exec: Running command: lsblk /dev/sdb --bytes --pairs --output NAME,SIZE,TYPE,PKNAME\r\n2017-09-23 07:29:52.504511 I | exec: Running command: blkid /dev/sdb1 -s PARTLABEL -o value\r\n2017-09-23 07:29:52.540523 I | exec: Running command: df --output=source,fstype\r\n2017-09-23 07:29:52.543909 I | cephosd: skipping device sdb that is in use (not by rook). fs: , ownPartitions: false\r\n2017-09-23 07:29:52.543987 I | cephosd: configuring osd devices: &{Entries:map[]}\r\n2017-09-23 07:29:52.544086 I | cephosd: configuring osd dirs: map[/var/lib/rook:-1]\r\n2017-09-23 07:29:52.544567 I | exec: Running command: ceph osd create 155ce113-167e-43ac-8d25-cbb796811586 --cluster=rook --conf=/var/lib/rook/rook/rook.config --keyring=/var/lib/rook/rook/client.admin.keyring --format json --out-file /tmp/703787263\r\n2017-09-23 07:30:06.832755 I | cephosd: successfully created OSD 155ce113-167e-43ac-8d25-cbb796811586 with ID 3\r\n2017-09-23 07:30:06.832986 I | cephmon: writing config file /var/lib/rook/osd3/rook.config\r\n2017-09-23 07:30:06.833135 I | exec: Running command: ceph mon getmap --cluster=rook --conf=/var/lib/rook/rook/rook.config --keyring=/var/lib/rook/rook/client.admin.keyring --format json --out-file /tmp/206530642\r\n2017-09-23 07:30:07.265496 I | exec: got monmap epoch 3\r\n2017-09-23 07:30:07.265624 I | cephosd: Initializing OSD 3 file system at /var/lib/rook/osd3...\r\n2017-09-23 07:30:07.265735 I | proc: Running process ceph-osd with args: [--mkfs --mkkey --id=3 --cluster=rook --conf=/var/lib/rook/osd3/rook.config --osd-data=/var/lib/rook/osd3 --osd-uuid=155ce113-167e-43ac-8d25-cbb796811586 --monmap=/var/lib/rook/osd3/tmp/activate.monmap --osd-journal=/var/lib/rook/osd3/journal --keyring=/var/lib/rook/osd3/keyring]\r\n2017-09-23 07:30:07.265749 I | exec: Running command: ceph-osd --mkfs --mkkey --id=3 --cluster=rook --conf=/var/lib/rook/osd3/rook.config --osd-data=/var/lib/rook/osd3 --osd-uuid=155ce113-167e-43ac-8d25-cbb796811586 --monmap=/var/lib/rook/osd3/tmp/activate.monmap --osd-journal=/var/lib/rook/osd3/journal --keyring=/var/lib/rook/osd3/keyring\r\n2017-09-23 07:30:07.285315 I | mkfs-osd3: 2017-09-23 07:30:07.285245 7f74e4e92e00  0 ceph version ec053b628 (cec053b62872f1342c8ebd8bc6d5e9c21aa82a1e) luminous (rc), process (unknown), pid 86\r\n2017-09-23 07:30:07.451903 I | mkfs-osd3: 2017-09-23 07:30:07.451714 7f74e4e92e00  0 filestore(/var/lib/rook/osd3) backend generic (magic 0xef53)\r\n2017-09-23 07:30:07.720135 I | mkfs-osd3: 2017-09-23 07:30:07.719943 7f74e4e92e00 -1 journal FileJournal::_open: disabling aio for non-block journal.  Use journal_force_aio to force use of aio anyway\r\n2017-09-23 07:30:07.891906 I | mkfs-osd3: 2017-09-23 07:30:07.891742 7f74e4e92e00  0 filestore(/var/lib/rook/osd3) mkjournal(1070): created journal on /var/lib/rook/osd3/journal\r\n2017-09-23 07:30:07.950935 I | mkfs-osd3: 2017-09-23 07:30:07.950781 7f74e4e92e00  0 filestore(/var/lib/rook/osd3) backend generic (magic 0xef53)\r\n2017-09-23 07:30:07.951444 I | mkfs-osd3: 2017-09-23 07:30:07.951360 7f74e4e92e00  0 genericfilestorebackend(/var/lib/rook/osd3) detect_features: FIEMAP ioctl is disabled via 'filestore fiemap' config option\r\n2017-09-23 07:30:07.951468 I | mkfs-osd3: 2017-09-23 07:30:07.951380 7f74e4e92e00  0 genericfilestorebackend(/var/lib/rook/osd3) detect_features: SEEK_DATA/SEEK_HOLE is disabled via 'filestore seek data hole' config option\r\n2017-09-23 07:30:07.951477 I | mkfs-osd3: 2017-09-23 07:30:07.951383 7f74e4e92e00  0 genericfilestorebackend(/var/lib/rook/osd3) detect_features: splice() is disabled via 'filestore splice' config option\r\n2017-09-23 07:30:11.035478 I | mkfs-osd3: 2017-09-23 07:30:11.035358 7f74e4e92e00  0 genericfilestorebackend(/var/lib/rook/osd3) detect_features: syncfs(2) syscall fully supported (by glibc and kernel)\r\n2017-09-23 07:30:11.036002 I | mkfs-osd3: 2017-09-23 07:30:11.035933 7f74e4e92e00  0 filestore(/var/lib/rook/osd3) limited size xattrs\r\n2017-09-23 07:30:11.036451 I | mkfs-osd3: 2017-09-23 07:30:11.036389 7f74e4e92e00  0 filestore(/var/lib/rook/osd3) start omap initiation\r\n...\r\n```",
  "closed_at": "2017-10-03T23:39:31Z",
  "closed_by": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/4313439?v=4",
    "events_url": "https://api.github.com/users/jbw976/events{/privacy}",
    "followers_url": "https://api.github.com/users/jbw976/followers",
    "following_url": "https://api.github.com/users/jbw976/following{/other_user}",
    "gists_url": "https://api.github.com/users/jbw976/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/jbw976",
    "id": 4313439,
    "login": "jbw976",
    "node_id": "MDQ6VXNlcjQzMTM0Mzk=",
    "organizations_url": "https://api.github.com/users/jbw976/orgs",
    "received_events_url": "https://api.github.com/users/jbw976/received_events",
    "repos_url": "https://api.github.com/users/jbw976/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/jbw976/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jbw976/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/jbw976"
  },
  "comments": 6,
  "comments_url": "https://api.github.com/repos/rook/rook/issues/1007/comments",
  "created_at": "2017-09-23T07:48:48Z",
  "events_url": "https://api.github.com/repos/rook/rook/issues/1007/events",
  "html_url": "https://github.com/rook/rook/issues/1007",
  "id": 259991020,
  "labels": [],
  "labels_url": "https://api.github.com/repos/rook/rook/issues/1007/labels{/name}",
  "locked": false,
  "milestone": {
    "closed_at": "2018-01-02T03:49:47Z",
    "closed_issues": 86,
    "created_at": "2017-05-03T02:33:11Z",
    "creator": {
      "avatar_url": "https://avatars3.githubusercontent.com/u/1463491?v=4",
      "events_url": "https://api.github.com/users/bassam/events{/privacy}",
      "followers_url": "https://api.github.com/users/bassam/followers",
      "following_url": "https://api.github.com/users/bassam/following{/other_user}",
      "gists_url": "https://api.github.com/users/bassam/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/bassam",
      "id": 1463491,
      "login": "bassam",
      "node_id": "MDQ6VXNlcjE0NjM0OTE=",
      "organizations_url": "https://api.github.com/users/bassam/orgs",
      "received_events_url": "https://api.github.com/users/bassam/received_events",
      "repos_url": "https://api.github.com/users/bassam/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/bassam/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bassam/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/bassam"
    },
    "description": "Ceph Block storage declared Beta on K8S /\r\nKubernetes 1.8 Support /\r\nRook volume plugin support in K8S /\r\nRook agent on client nodes /\r\nRook is upgradeable /\r\nSupport for local storage (and arbitrary volumes) underneath OSD pods /\r\nSupport for public cloud environments /\r\nImproved test matrix and more test coverage /\r\nCRDs for object storage and file system",
    "due_on": null,
    "html_url": "https://github.com/rook/rook/milestone/6",
    "id": 2496353,
    "labels_url": "https://api.github.com/repos/rook/rook/milestones/6/labels",
    "node_id": "MDk6TWlsZXN0b25lMjQ5NjM1Mw==",
    "number": 6,
    "open_issues": 0,
    "state": "closed",
    "title": "0.6",
    "updated_at": "2018-01-02T03:49:47Z",
    "url": "https://api.github.com/repos/rook/rook/milestones/6"
  },
  "node_id": "MDU6SXNzdWUyNTk5OTEwMjA=",
  "number": 1007,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/rook/rook",
  "state": "closed",
  "title": "Rook creates OSD on node with no spare block devices",
  "updated_at": "2019-02-25T15:13:31Z",
  "url": "https://api.github.com/repos/rook/rook/issues/1007",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/29158971?v=4",
    "events_url": "https://api.github.com/users/jpds/events{/privacy}",
    "followers_url": "https://api.github.com/users/jpds/followers",
    "following_url": "https://api.github.com/users/jpds/following{/other_user}",
    "gists_url": "https://api.github.com/users/jpds/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/jpds",
    "id": 29158971,
    "login": "jpds",
    "node_id": "MDQ6VXNlcjI5MTU4OTcx",
    "organizations_url": "https://api.github.com/users/jpds/orgs",
    "received_events_url": "https://api.github.com/users/jpds/received_events",
    "repos_url": "https://api.github.com/users/jpds/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/jpds/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jpds/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/jpds"
  }
}