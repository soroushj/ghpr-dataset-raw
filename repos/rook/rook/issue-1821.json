{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "NONE",
  "body": "**Bug Report**\r\n\r\nWhat happened:\r\nDeployed rook according to documentation on a K8s cluster.\r\n\r\nThe discover pods fail to recognize any devices to mount, failing with the following error messages\r\n```\r\n2018-06-23 11:19:59.411001 I | rookcmd: starting Rook v0.7.0-215.g5b3eccf with arguments '/usr/local/bin/rook discover'\r\n2018-06-23 11:19:59.411105 I | rookcmd: flag values: --help=false, --log-level=INFO\r\n2018-06-23 11:20:29.412342 I | rook-discover: updating device configmap\r\n2018-06-23 11:20:29.412376 I | exec: Running command: lsblk --all --noheadings --list --output KNAME\r\n2018-06-23 11:20:29.415291 I | exec: Running command: lsblk /dev/xvda --bytes --nodeps --pairs --output SIZE,ROTA,RO,TYPE,PKNAME\r\n2018-06-23 11:20:29.417405 I | exec: Running command: sgdisk --print /dev/xvda\r\n2018-06-23 11:20:29.420584 W | inventory: skipping device xvda with an unknown uuid. Failed to complete 'get disk xvda uuid': exit status 2. Problem opening /dev/xvda for reading! Error is 1.\r\n2018-06-23 11:20:29.420605 I | exec: Running command: lsblk /dev/xvda6 --bytes --nodeps --pairs --output SIZE,ROTA,RO,TYPE,PKNAME\r\n2018-06-23 11:20:29.422206 I | exec: Running command: udevadm info --query=property /dev/xvda6\r\n2018-06-23 11:20:29.423631 I | exec: Running command: lsblk /dev/xvda4 --bytes --nodeps --pairs --output SIZE,ROTA,RO,TYPE,PKNAME\r\n2018-06-23 11:20:29.425189 I | exec: Running command: udevadm info --query=property /dev/xvda4\r\n2018-06-23 11:20:29.426684 I | exec: Running command: lsblk /dev/xvda2 --bytes --nodeps --pairs --output SIZE,ROTA,RO,TYPE,PKNAME\r\n2018-06-23 11:20:29.428240 I | exec: Running command: udevadm info --query=property /dev/xvda2\r\n2018-06-23 11:20:29.429546 I | exec: Running command: lsblk /dev/xvda9 --bytes --nodeps --pairs --output SIZE,ROTA,RO,TYPE,PKNAME\r\n2018-06-23 11:20:29.431082 I | exec: Running command: udevadm info --query=property /dev/xvda9\r\n2018-06-23 11:20:29.432744 I | exec: Running command: lsblk /dev/xvda7 --bytes --nodeps --pairs --output SIZE,ROTA,RO,TYPE,PKNAME\r\n2018-06-23 11:20:29.434872 I | exec: Running command: udevadm info --query=property /dev/xvda7\r\n2018-06-23 11:20:29.436268 I | exec: Running command: lsblk /dev/xvda3 --bytes --nodeps --pairs --output SIZE,ROTA,RO,TYPE,PKNAME\r\n2018-06-23 11:20:29.437989 I | exec: Running command: udevadm info --query=property /dev/xvda3\r\n2018-06-23 11:20:29.439368 I | exec: Running command: lsblk /dev/dm-0 --bytes --nodeps --pairs --output SIZE,ROTA,RO,TYPE,PKNAME\r\n2018-06-23 11:20:29.440892 I | exec: Running command: sgdisk --print /dev/dm-0\r\n2018-06-23 11:20:29.443675 W | inventory: skipping device dm-0 with an unknown uuid. Failed to complete 'get disk dm-0 uuid': exit status 2. Problem opening /dev/dm-0 for reading! Error is 1.\r\n2018-06-23 11:20:29.443696 I | exec: Running command: lsblk /dev/xvda1 --bytes --nodeps --pairs --output SIZE,ROTA,RO,TYPE,PKNAME\r\n2018-06-23 11:20:29.445256 I | exec: Running command: udevadm info --query=property /dev/xvda1\r\n2018-06-23 11:20:29.446607 I | exec: Running command: lsblk /dev/nvme0n1 --bytes --nodeps --pairs --output SIZE,ROTA,RO,TYPE,PKNAME\r\n2018-06-23 11:20:29.448107 I | exec: Running command: sgdisk --print /dev/nvme0n1\r\n2018-06-23 11:20:29.450761 W | inventory: skipping device nvme0n1 with an unknown uuid. Failed to complete 'get disk nvme0n1 uuid': exit status 2. Problem opening /dev/nvme0n1 for reading! Error is 1.\r\n2018-06-23 11:20:29.450780 I | rook-discover: available devices: []\r\n```\r\n\r\nexecuting the `sgdisk --print /dev/nvme0n1` manually from a node needs sudo\r\n```\r\ncore@ip-10-1-45-216 ~ $ sgdisk --print /dev/nvme0n1\r\nProblem opening /dev/nvme0n1 for reading! Error is 13.\r\nYou must run this program as root or use sudo!\r\n```\r\n```\r\ncore@ip-10-1-45-216 ~ $ sudo sgdisk --print /dev/nvme0n1\r\nCreating new GPT entries.\r\nDisk /dev/nvme0n1: 1855468750 sectors, 884.8 GiB\r\nLogical sector size: 512 bytes\r\nDisk identifier (GUID): 483A1F29-A327-473E-A687-6F693C46AF47\r\nPartition table holds up to 128 entries\r\nFirst usable sector is 34, last usable sector is 1855468716\r\nPartitions will be aligned on 2048-sector boundaries\r\nTotal free space is 1855468683 sectors (884.8 GiB)\r\n\r\nNumber  Start (sector)    End (sector)  Size       Code  Name\r\n```\r\n\r\nWhat you expected to happen:\r\nThat EBS and/or ephemeral devices would be discovered\r\n\r\n**Environment**:\r\n* OS (e.g. from /etc/os-release):\r\nNAME=\"Container Linux by CoreOS\"\r\nID=coreos\r\nVERSION=1745.5.0\r\nVERSION_ID=1745.5.0\r\nBUILD_ID=2018-05-31-0701\r\nPRETTY_NAME=\"Container Linux by CoreOS 1745.5.0 (Rhyolite)\"\r\nANSI_COLOR=\"38;5;75\"\r\nHOME_URL=\"https://coreos.com/\"\r\nBUG_REPORT_URL=\"https://issues.coreos.com\"\r\nCOREOS_BOARD=\"amd64-usr\"\r\n\r\n* Kernel (e.g. `uname -a`):\r\nLinux ip-10-1-45-216.eu-west-1.compute.internal 4.14.44-coreos-r1 #1 SMP Thu May 31 06:04:02 UTC 2018 x86_64 Intel(R) Xeon(R) CPU E5-2686 v4 @ 2.30GHz GenuineIntel GNU/Linux\r\n\r\n* Cloud provider or hardware configuration:\r\nAWS (eu-west-1)\r\n\r\n* Rook version (use `rook version` inside of a Rook Pod):\r\nrook: v0.7.0-211.gf8866e6\r\n\r\n* Kubernetes version (use `kubectl version`):\r\nKubernetes 1.9.3 \r\n\r\n* Kubernetes cluster type (e.g. Tectonic, GKE, OpenShift):\r\nDeployed using kube-aws 0.9.10\r\n\r\n* Ceph status (use `ceph health` in the [Rook toolbox](https://Rook.io/docs/Rook/master/toolbox.html)):\r\nHEALTH_OK",
  "closed_at": "2018-06-25T21:27:23Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/1048514?v=4",
    "events_url": "https://api.github.com/users/travisn/events{/privacy}",
    "followers_url": "https://api.github.com/users/travisn/followers",
    "following_url": "https://api.github.com/users/travisn/following{/other_user}",
    "gists_url": "https://api.github.com/users/travisn/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/travisn",
    "id": 1048514,
    "login": "travisn",
    "node_id": "MDQ6VXNlcjEwNDg1MTQ=",
    "organizations_url": "https://api.github.com/users/travisn/orgs",
    "received_events_url": "https://api.github.com/users/travisn/received_events",
    "repos_url": "https://api.github.com/users/travisn/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/travisn/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/travisn/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/travisn"
  },
  "comments": 2,
  "comments_url": "https://api.github.com/repos/rook/rook/issues/1821/comments",
  "created_at": "2018-06-23T18:19:53Z",
  "events_url": "https://api.github.com/repos/rook/rook/issues/1821/events",
  "html_url": "https://github.com/rook/rook/issues/1821",
  "id": 335120738,
  "labels": [],
  "labels_url": "https://api.github.com/repos/rook/rook/issues/1821/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUzMzUxMjA3Mzg=",
  "number": 1821,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/rook/rook",
  "state": "closed",
  "title": "No devices discovered",
  "updated_at": "2018-06-25T21:27:23Z",
  "url": "https://api.github.com/repos/rook/rook/issues/1821",
  "user": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/9726307?v=4",
    "events_url": "https://api.github.com/users/paalkr/events{/privacy}",
    "followers_url": "https://api.github.com/users/paalkr/followers",
    "following_url": "https://api.github.com/users/paalkr/following{/other_user}",
    "gists_url": "https://api.github.com/users/paalkr/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/paalkr",
    "id": 9726307,
    "login": "paalkr",
    "node_id": "MDQ6VXNlcjk3MjYzMDc=",
    "organizations_url": "https://api.github.com/users/paalkr/orgs",
    "received_events_url": "https://api.github.com/users/paalkr/received_events",
    "repos_url": "https://api.github.com/users/paalkr/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/paalkr/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/paalkr/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/paalkr"
  }
}