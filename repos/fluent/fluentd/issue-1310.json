{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "MEMBER",
  "body": "# Environment\r\nOS: macOS Sierra version 10.12.1\r\nruby version: ruby 2.3.0p0 (2015-12-25 revision 53290) [x86_64-darwin15]\r\nfluentd version: fluentd-0.14.8\r\n\r\n# How to reproduction\r\nI executed the process of 'Quick Start' in README.md.\r\n\r\n$ gem install fluentd\r\n$ fluentd -s conf\r\n\r\n`fluentd -s conf` generates conf/fluent.conf.\r\nfluent.conf is:\r\n```\r\n# In v1 configuration, type and id are @ prefix parameters.\r\n# @type and @id are recommended. type and id are still available for backward compatibility\r\n\r\n## built-in TCP input\r\n## $ echo <json> | fluent-cat <tag>\r\n<source>\r\n  @type forward\r\n  @id forward_input\r\n</source>\r\n\r\n## built-in UNIX socket input\r\n#<source>\r\n#  @type unix\r\n#</source>\r\n\r\n# HTTP input\r\n# http://localhost:8888/<tag>?json=<json>\r\n<source>\r\n  @type http\r\n  @id http_input\r\n\r\n  port 8888\r\n</source>\r\n\r\n## File input\r\n## read apache logs with tag=apache.access\r\n#<source>\r\n#  @type tail\r\n#  format apache\r\n#  path /var/log/httpd-access.log\r\n#  tag apache.access\r\n#</source>\r\n\r\n## Mutating event filter\r\n## Add hostname and tag fields to apache.access tag events\r\n#<filter apache.access>\r\n#  @type record_transformer\r\n#  <record>\r\n#    hostname ${hostname}\r\n#    tag ${tag}\r\n#  </record>\r\n#</filter>\r\n\r\n## Selecting event filter\r\n## Remove unnecessary events from apache prefixed tag events\r\n#<filter apache.**>\r\n#  @type grep\r\n#  include1 method GET # pass only GET in 'method' field\r\n#  exclude1 message debug # remove debug event\r\n#</filter>\r\n\r\n# Listen HTTP for monitoring\r\n# http://localhost:24220/api/plugins\r\n# http://localhost:24220/api/plugins?type=TYPE\r\n# http://localhost:24220/api/plugins?tag=MYTAG\r\n<source>\r\n  @type monitor_agent\r\n  @id monitor_agent_input\r\n\r\n  port 24220\r\n</source>\r\n\r\n# Listen DRb for debug\r\n<source>\r\n  @type debug_agent\r\n  @id debug_agent_input\r\n\r\n  bind 127.0.0.1\r\n  port 24230\r\n</source>\r\n\r\n## match tag=apache.access and write to file\r\n#<match apache.access>\r\n#  @type file\r\n#  path /var/log/fluent/access\r\n#</match>\r\n\r\n## match tag=debug.** and dump to console\r\n<match debug.**>\r\n  @type stdout\r\n  @id stdout_output\r\n</match>\r\n\r\n# match tag=system.** and forward to another fluent server\r\n<match system.**>\r\n  @type forward\r\n  @id forward_output\r\n\r\n  <server>\r\n    host 192.168.0.11\r\n  </server>\r\n  <secondary>\r\n    <server>\r\n      host 192.168.0.12\r\n    </server>\r\n  </secondary>\r\n</match>\r\n\r\n## match tag=myapp.** and forward and write to file\r\n#<match myapp.**>\r\n#  @type copy\r\n#  <store>\r\n#    @type forward\r\n#    buffer_type file\r\n#    buffer_path /var/log/fluent/myapp-forward\r\n#    retry_limit 50\r\n#    flush_interval 10s\r\n#    <server>\r\n#      host 192.168.0.13\r\n#    </server>\r\n#  </store>\r\n#  <store>\r\n#    @type file\r\n#    path /var/log/fluent/myapp\r\n#  </store>\r\n#</match>\r\n\r\n## match fluent's internal events\r\n#<match fluent.**>\r\n#  @type null\r\n#</match>\r\n\r\n## match not matched logs and write to file\r\n#<match **>\r\n#  @type file\r\n#  path /var/log/fluent/else\r\n#  compress gz\r\n#</match>\r\n\r\n## Label: For handling complex event routing\r\n#<label @STAGING>\r\n#  <match system.**>\r\n#    @type forward\r\n#    @id staging_forward_output\r\n#    <server>\r\n#      host 192.168.0.101\r\n#    </server>\r\n#  </match>\r\n#</label>\r\n````\r\n\r\n# Error\r\n\r\nError logs are:\r\n```\r\n$ 2016-11-11 18:46:07 +0900 [info]: reading config file path=\"conf/fluent.conf\"\r\n2016-11-11 18:46:07 +0900 [info]: starting fluentd-0.14.8\r\n2016-11-11 18:46:07 +0900 [info]: spawn command to main: /Users/hiroejun/.rbenv/versions/2.3.0/bin/ruby -Eascii-8bit:ascii-8bit /Users/hiroejun/.rbenv/versions/2.3.0/bin/fluentd -c conf/fluent.conf --under-supervisor\r\n2016-11-11 18:46:13 +0900 [info]: reading config file path=\"conf/fluent.conf\"\r\n2016-11-11 18:46:13 +0900 [info]: starting fluentd-0.14.8 without supervision\r\n2016-11-11 18:46:13 +0900 [info]: gem 'fluentd' version '0.14.8'\r\n2016-11-11 18:46:13 +0900 [info]: adding match pattern=\"debug.**\" type=\"stdout\"\r\n2016-11-11 18:46:13 +0900 [info]: adding match pattern=\"system.**\" type=\"forward\"\r\n2016-11-11 18:46:13 +0900 [info]: adding forwarding server '192.168.0.12:24224' host=\"192.168.0.12\" port=24224 weight=60 plugin_id=\"object:3fc7ead4663c\"\r\n2016-11-11 18:46:13 +0900 [error]: unexpected error error=\"undefined method `compress' for nil:NilClass\"\r\n2016-11-11 18:46:13 +0900 [error]: /Users/hiroejun/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/fluentd-0.14.8/lib/fluent/plugin/out_forward.rb:145:in `configure'\r\n2016-11-11 18:46:13 +0900 [error]: /Users/hiroejun/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/fluentd-0.14.8/lib/fluent/plugin/output.rb:319:in `configure'\r\n2016-11-11 18:46:13 +0900 [error]: /Users/hiroejun/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/fluentd-0.14.8/lib/fluent/plugin_helper/inject.rb:95:in `configure'\r\n2016-11-11 18:46:13 +0900 [error]: /Users/hiroejun/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/fluentd-0.14.8/lib/fluent/plugin_helper/event_emitter.rb:60:in `configure'\r\n2016-11-11 18:46:13 +0900 [error]: /Users/hiroejun/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/fluentd-0.14.8/lib/fluent/compat/output.rb:482:in `configure'\r\n2016-11-11 18:46:13 +0900 [error]: /Users/hiroejun/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/fluentd-0.14.8/lib/fluent/plugin/out_forward.rb:120:in `configure'\r\n2016-11-11 18:46:13 +0900 [error]: /Users/hiroejun/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/fluentd-0.14.8/lib/fluent/agent.rb:127:in `add_match'\r\n2016-11-11 18:46:13 +0900 [error]: /Users/hiroejun/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/fluentd-0.14.8/lib/fluent/agent.rb:70:in `block in configure'\r\n2016-11-11 18:46:13 +0900 [error]: /Users/hiroejun/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/fluentd-0.14.8/lib/fluent/agent.rb:63:in `each'\r\n2016-11-11 18:46:13 +0900 [error]: /Users/hiroejun/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/fluentd-0.14.8/lib/fluent/agent.rb:63:in `configure'\r\n2016-11-11 18:46:13 +0900 [error]: /Users/hiroejun/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/fluentd-0.14.8/lib/fluent/root_agent.rb:86:in `configure'\r\n2016-11-11 18:46:13 +0900 [error]: /Users/hiroejun/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/fluentd-0.14.8/lib/fluent/engine.rb:119:in `configure'\r\n2016-11-11 18:46:13 +0900 [error]: /Users/hiroejun/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/fluentd-0.14.8/lib/fluent/engine.rb:93:in `run_configure'\r\n2016-11-11 18:46:13 +0900 [error]: /Users/hiroejun/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/fluentd-0.14.8/lib/fluent/supervisor.rb:693:in `run_configure'\r\n2016-11-11 18:46:13 +0900 [error]: /Users/hiroejun/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/fluentd-0.14.8/lib/fluent/supervisor.rb:453:in `block in run_worker'\r\n2016-11-11 18:46:13 +0900 [error]: /Users/hiroejun/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/fluentd-0.14.8/lib/fluent/supervisor.rb:626:in `main_process'\r\n2016-11-11 18:46:13 +0900 [error]: /Users/hiroejun/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/fluentd-0.14.8/lib/fluent/supervisor.rb:449:in `run_worker'\r\n2016-11-11 18:46:13 +0900 [error]: /Users/hiroejun/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/fluentd-0.14.8/lib/fluent/command/fluentd.rb:288:in `<top (required)>'\r\n2016-11-11 18:46:13 +0900 [error]: /Users/hiroejun/.rbenv/versions/2.3.0/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55:in `require'\r\n2016-11-11 18:46:13 +0900 [error]: /Users/hiroejun/.rbenv/versions/2.3.0/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55:in `require'\r\n2016-11-11 18:46:13 +0900 [error]: /Users/hiroejun/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/fluentd-0.14.8/bin/fluentd:5:in `<top (required)>'\r\n2016-11-11 18:46:13 +0900 [error]: /Users/hiroejun/.rbenv/versions/2.3.0/bin/fluentd:23:in `load'\r\n2016-11-11 18:46:13 +0900 [error]: /Users/hiroejun/.rbenv/versions/2.3.0/bin/fluentd:23:in `<main>'\r\n2016-11-11 18:46:13 +0900 [info]: Worker 0 finished unexpectedly with status 1\r\n```\r\n\r\n# Solution Plan\r\n\r\nQuick Start works when the configure bellow is cmmented.\r\n```\r\n# match tag=system.** and forward to another fluent server\r\n<match system.**>\r\n  @type forward\r\n  @id forward_output\r\n\r\n  <server>\r\n    host 192.168.0.11\r\n  </server>\r\n  <secondary>\r\n    <server>\r\n      host 192.168.0.12\r\n    </server>\r\n  </secondary>\r\n</match>\r\n```\r\n\r\nShould we comment this configure('match tag=system.** and forward to another fluent server') by default?\r\n\r\n",
  "closed_at": "2016-11-15T09:54:27Z",
  "closed_by": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/230654?v=4",
    "events_url": "https://api.github.com/users/tagomoris/events{/privacy}",
    "followers_url": "https://api.github.com/users/tagomoris/followers",
    "following_url": "https://api.github.com/users/tagomoris/following{/other_user}",
    "gists_url": "https://api.github.com/users/tagomoris/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/tagomoris",
    "id": 230654,
    "login": "tagomoris",
    "node_id": "MDQ6VXNlcjIzMDY1NA==",
    "organizations_url": "https://api.github.com/users/tagomoris/orgs",
    "received_events_url": "https://api.github.com/users/tagomoris/received_events",
    "repos_url": "https://api.github.com/users/tagomoris/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/tagomoris/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tagomoris/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/tagomoris"
  },
  "comments": 1,
  "comments_url": "https://api.github.com/repos/fluent/fluentd/issues/1310/comments",
  "created_at": "2016-11-11T10:18:21Z",
  "events_url": "https://api.github.com/repos/fluent/fluentd/issues/1310/events",
  "html_url": "https://github.com/fluent/fluentd/issues/1310",
  "id": 188728142,
  "labels": [
    {
      "color": "e11d21",
      "default": true,
      "description": null,
      "id": 94152935,
      "name": "bug",
      "node_id": "MDU6TGFiZWw5NDE1MjkzNQ==",
      "url": "https://api.github.com/repos/fluent/fluentd/labels/bug"
    }
  ],
  "labels_url": "https://api.github.com/repos/fluent/fluentd/issues/1310/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUxODg3MjgxNDI=",
  "number": 1310,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/fluent/fluentd",
  "state": "closed",
  "title": "'Quick Start' doesn't work.",
  "updated_at": "2016-11-15T09:54:27Z",
  "url": "https://api.github.com/repos/fluent/fluentd/issues/1310",
  "user": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/1078126?v=4",
    "events_url": "https://api.github.com/users/suzukaze/events{/privacy}",
    "followers_url": "https://api.github.com/users/suzukaze/followers",
    "following_url": "https://api.github.com/users/suzukaze/following{/other_user}",
    "gists_url": "https://api.github.com/users/suzukaze/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/suzukaze",
    "id": 1078126,
    "login": "suzukaze",
    "node_id": "MDQ6VXNlcjEwNzgxMjY=",
    "organizations_url": "https://api.github.com/users/suzukaze/orgs",
    "received_events_url": "https://api.github.com/users/suzukaze/received_events",
    "repos_url": "https://api.github.com/users/suzukaze/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/suzukaze/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/suzukaze/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/suzukaze"
  }
}