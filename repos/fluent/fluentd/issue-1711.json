{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "NONE",
  "body": "TLS connection from fluent-bit when using fluentd-generated server certificate does not work. It seems that the problem is in fluentd certificate generation. See discussion and [suggested patch](https://github.com/fluent/fluent-bit/issues/350#issuecomment-335070545) in fluent/fluent-bit#350.\r\n\r\nSteps to reproduce:\r\n\r\nCreate certificate:\r\n`openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365`\r\n... accept defaults, set passphrase to `fluentd`...\r\n\r\nCreate fluentd.conf:\r\n```\r\n<source>\r\n  @type forward\r\n  port 24224\r\n  <transport tls>\r\n     ca_cert_path /fluentd/etc/cert.pem\r\n     ca_private_key_path /fluentd/etc/key.pem\r\n     ca_private_key_passphrase fluentd\r\n  </transport>\r\n  <security>\r\n    self_hostname localhost\r\n    shared_key fluentd\r\n  </security>\r\n</source>\r\n\r\n<match **>\r\n  @type stdout\r\n  <buffer>\r\n    flush_interval 1s\r\n  </buffer>\r\n</match>\r\n```\r\n\r\nRun fluentd:\r\n`docker run -p 24224:24224 -v \"$(pwd)\":/fluentd/etc -e FLUENTD_CONF=\"fluentd.conf\" fluent/fluentd:v0.14.21`\r\n\r\nRun fluent-bit:\r\n`docker run --network=host -v \"$(pwd)\":/certs fluent/fluent-bit:0.12.5  /fluent-bit/bin/fluent-bit -i random -o forward://127.0.0.1:24224 -p tls=on -p tls.verify=off -p tls.ca_file=/certs/cert.pem -p shared_key=fluentd -f 1`\r\n\r\nApplying the [patch](https://github.com/fluent/fluent-bit/issues/350#issuecomment-335070545) in fluent/fluent-bit#350 seems to make this work.\r\n",
  "closed_at": "2017-10-12T00:25:59Z",
  "closed_by": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/16928?v=4",
    "events_url": "https://api.github.com/users/repeatedly/events{/privacy}",
    "followers_url": "https://api.github.com/users/repeatedly/followers",
    "following_url": "https://api.github.com/users/repeatedly/following{/other_user}",
    "gists_url": "https://api.github.com/users/repeatedly/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/repeatedly",
    "id": 16928,
    "login": "repeatedly",
    "node_id": "MDQ6VXNlcjE2OTI4",
    "organizations_url": "https://api.github.com/users/repeatedly/orgs",
    "received_events_url": "https://api.github.com/users/repeatedly/received_events",
    "repos_url": "https://api.github.com/users/repeatedly/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/repeatedly/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/repeatedly/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/repeatedly"
  },
  "comments": 5,
  "comments_url": "https://api.github.com/repos/fluent/fluentd/issues/1711/comments",
  "created_at": "2017-10-09T06:20:08Z",
  "events_url": "https://api.github.com/repos/fluent/fluentd/issues/1711/events",
  "html_url": "https://github.com/fluent/fluentd/issues/1711",
  "id": 263794017,
  "labels": [],
  "labels_url": "https://api.github.com/repos/fluent/fluentd/issues/1711/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUyNjM3OTQwMTc=",
  "number": 1711,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/fluent/fluentd",
  "state": "closed",
  "title": "TLS connection from fluent-bit to Fluentd 0.14.21 not working",
  "updated_at": "2017-12-04T15:23:23Z",
  "url": "https://api.github.com/repos/fluent/fluentd/issues/1711",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/68196?v=4",
    "events_url": "https://api.github.com/users/mpeltonen/events{/privacy}",
    "followers_url": "https://api.github.com/users/mpeltonen/followers",
    "following_url": "https://api.github.com/users/mpeltonen/following{/other_user}",
    "gists_url": "https://api.github.com/users/mpeltonen/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/mpeltonen",
    "id": 68196,
    "login": "mpeltonen",
    "node_id": "MDQ6VXNlcjY4MTk2",
    "organizations_url": "https://api.github.com/users/mpeltonen/orgs",
    "received_events_url": "https://api.github.com/users/mpeltonen/received_events",
    "repos_url": "https://api.github.com/users/mpeltonen/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/mpeltonen/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mpeltonen/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/mpeltonen"
  }
}