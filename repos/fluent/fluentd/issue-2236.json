{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "NONE",
  "body": "[Fluentd version]\r\nv1.2.5\r\n\r\n[Environment]\r\nKubernetes\r\n\r\n[Configuration]\r\nhttps://github.com/kubernetes/kubernetes/blob/master/cluster/addons/fluentd-gcp/fluentd-gcp-configmap.yaml\r\n\r\n[Problems]\r\nWe are seeing Fluentd memory leaks with Kubernetes versions >= v1.10. After some investigation, we realized the log rotation mechanism changed from Kubernetes v1.9 and v1.10, which might trigger the memory leak. Guess the logs are rotated in a way that Fluentd does not support / handle well.\r\n\r\nSome experiment with exactly the same Fluentd version, output plugin version but different Kubernetes versions are shown below:\r\n![image](https://user-images.githubusercontent.com/5287526/50029058-b7a9e000-ffbf-11e8-84dc-225fc4d5404e.png)\r\n\r\nIs there any known limitation for log rotation mechanism that might trigger this? We report a [similar issue](https://github.com/fluent/fluentd/issues/1941#issuecomment-412689268) before, but I've verified that we are using a Fluentd version with that fix.\r\n\r\n[The log rotation manager]\r\nIn case it helps, the log rotation mechanism is https://github.com/kubernetes/kubernetes/blob/a3ccea9d8743f2ff82e41b6c2af6dc2c41dc7b10/pkg/kubelet/logs/container_log_manager.go#L150.",
  "closed_at": "2019-07-26T02:28:39Z",
  "closed_by": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/16928?v=4",
    "events_url": "https://api.github.com/users/repeatedly/events{/privacy}",
    "followers_url": "https://api.github.com/users/repeatedly/followers",
    "following_url": "https://api.github.com/users/repeatedly/following{/other_user}",
    "gists_url": "https://api.github.com/users/repeatedly/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/repeatedly",
    "id": 16928,
    "login": "repeatedly",
    "node_id": "MDQ6VXNlcjE2OTI4",
    "organizations_url": "https://api.github.com/users/repeatedly/orgs",
    "received_events_url": "https://api.github.com/users/repeatedly/received_events",
    "repos_url": "https://api.github.com/users/repeatedly/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/repeatedly/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/repeatedly/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/repeatedly"
  },
  "comments": 48,
  "comments_url": "https://api.github.com/repos/fluent/fluentd/issues/2236/comments",
  "created_at": "2018-12-14T21:52:55Z",
  "events_url": "https://api.github.com/repos/fluent/fluentd/issues/2236/events",
  "html_url": "https://github.com/fluent/fluentd/issues/2236",
  "id": 391291898,
  "labels": [],
  "labels_url": "https://api.github.com/repos/fluent/fluentd/issues/2236/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUzOTEyOTE4OTg=",
  "number": 2236,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/fluent/fluentd",
  "state": "closed",
  "title": "Fluentd memory leak in Kubernetes with \"buffer_type file\"",
  "updated_at": "2019-07-26T02:28:39Z",
  "url": "https://api.github.com/repos/fluent/fluentd/issues/2236",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/5287526?v=4",
    "events_url": "https://api.github.com/users/qingling128/events{/privacy}",
    "followers_url": "https://api.github.com/users/qingling128/followers",
    "following_url": "https://api.github.com/users/qingling128/following{/other_user}",
    "gists_url": "https://api.github.com/users/qingling128/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/qingling128",
    "id": 5287526,
    "login": "qingling128",
    "node_id": "MDQ6VXNlcjUyODc1MjY=",
    "organizations_url": "https://api.github.com/users/qingling128/orgs",
    "received_events_url": "https://api.github.com/users/qingling128/received_events",
    "repos_url": "https://api.github.com/users/qingling128/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/qingling128/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/qingling128/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/qingling128"
  }
}