{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "NONE",
  "body": "Check [CONTRIBUTING guideline](https://github.com/fluent/fluentd/blob/master/CONTRIBUTING.md) first and here is the list to help us investigate the problem.\r\n\r\n**Is your feature request related to a problem? Please describe.**\r\n\r\nI have 2 managed k8s clusters with individual fluentd services and want to forward some logs from cluster_1 to cluster_2. I can't use the `forward` protocol because the ingress does not allow raw TCP forwarding.\r\n\r\nInstead I tried to use `out_http` in cluster_1 and `in_http` in cluster_2, since HTTP based ingress configurations are easy to do. But I couldn't find a working configuration, all failed with one of:\r\n- `400 Bad Request\\nReceived event is not json`\r\n- `400 Bad Request\\n'json' or 'msgpack' parameter is required`\r\n- Server: `incoming event is invalid: path=/some.tag params={\"json\":\"{\\\"hello\\\":\\\"world\\\",\\\"num\\\":18}\\n{\\\"hello\\\":\\\"world\\\",\\\"num\\\":19}\\n\",...}`\r\n\r\n**Describe the solution you'd like**\r\n\r\nThere should be an easy configuration to allow using http to forward events between 2 fluentd instances.\r\nI see 2 possible solutions:\r\n- add an option to `out_http` to optionally wrap (json) events in an (json) array\r\n- add an option to `in_http`/`parse_json` to be able to handle the json lines format used by `out_http`\r\n\r\n**Describe alternatives you've considered**\r\n\r\nDeclare the `out_http -> in_http` case to be out of scope. In that case there should be some mention of it in the docs, to save the next person time. Two plugins which communicate over HTTP but can't talk to one another is very counter-intuitive in my opinion. \r\n\r\n**Additional context**\r\nConfiguration for reproducing the problem.\r\n```\r\n# sending side\r\n<source>\r\n  @type dummy\r\n  dummy {\"hello\":\"world\"}\r\n  auto_increment_key num\r\n  tag kube.test.tag\r\n</source>\r\n\r\n<match **>\r\n  @type http\r\n  endpoint http://localhost:9881/$tag\r\n  open_timeout 2\r\n  #content_type application/json #results in 'invalid event' if uncommented\r\n  <format>\r\n    @type json\r\n  </format>\r\n  <buffer>\r\n    flush_interval 2s\r\n  </buffer>\r\n</match>\r\n```\r\n\r\n```\r\n# receiving side\r\n<source>\r\n  @type http\r\n  port 9881\r\n  bind 0.0.0.0\r\n  <parse> # comment out for 'json parameter required'\r\n    @type json\r\n  </parse>\r\n</source>\r\n<match **>\r\n  @type stdout\r\n</match>\r\n```",
  "closed_at": "2020-05-07T13:25:10Z",
  "closed_by": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/16928?v=4",
    "events_url": "https://api.github.com/users/repeatedly/events{/privacy}",
    "followers_url": "https://api.github.com/users/repeatedly/followers",
    "following_url": "https://api.github.com/users/repeatedly/following{/other_user}",
    "gists_url": "https://api.github.com/users/repeatedly/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/repeatedly",
    "id": 16928,
    "login": "repeatedly",
    "node_id": "MDQ6VXNlcjE2OTI4",
    "organizations_url": "https://api.github.com/users/repeatedly/orgs",
    "received_events_url": "https://api.github.com/users/repeatedly/received_events",
    "repos_url": "https://api.github.com/users/repeatedly/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/repeatedly/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/repeatedly/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/repeatedly"
  },
  "comments": 7,
  "comments_url": "https://api.github.com/repos/fluent/fluentd/issues/2909/comments",
  "created_at": "2020-03-24T16:24:32Z",
  "events_url": "https://api.github.com/repos/fluent/fluentd/issues/2909/events",
  "html_url": "https://github.com/fluent/fluentd/issues/2909",
  "id": 587092578,
  "labels": [],
  "labels_url": "https://api.github.com/repos/fluent/fluentd/issues/2909/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU1ODcwOTI1Nzg=",
  "number": 2909,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/fluent/fluentd",
  "state": "closed",
  "title": "Use out_http to send logs to in_http",
  "updated_at": "2020-05-07T13:25:10Z",
  "url": "https://api.github.com/repos/fluent/fluentd/issues/2909",
  "user": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/6450303?v=4",
    "events_url": "https://api.github.com/users/Gellardo/events{/privacy}",
    "followers_url": "https://api.github.com/users/Gellardo/followers",
    "following_url": "https://api.github.com/users/Gellardo/following{/other_user}",
    "gists_url": "https://api.github.com/users/Gellardo/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/Gellardo",
    "id": 6450303,
    "login": "Gellardo",
    "node_id": "MDQ6VXNlcjY0NTAzMDM=",
    "organizations_url": "https://api.github.com/users/Gellardo/orgs",
    "received_events_url": "https://api.github.com/users/Gellardo/received_events",
    "repos_url": "https://api.github.com/users/Gellardo/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/Gellardo/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Gellardo/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/Gellardo"
  }
}