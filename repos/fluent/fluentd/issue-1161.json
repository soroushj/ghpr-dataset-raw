{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "NONE",
  "body": "I got this error in fluentd 0.14.\n\n```\n20:29:12 fluentd.1   | 2016-08-14 20:29:12 +0000 [warn]: emit transaction failed: error_class=NoMethodError error=\"undefined method `+' for nil:NilClass\" tag=\"store.access.uwsgi.api-gateway-dev\"\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/fluentd-0.14.2/lib/fluent/plugin/output.rb:862:in `submit_flush_once'\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/fluentd-0.14.2/lib/fluent/plugin/output.rb:533:in `emit_buffered'\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/fluentd-0.14.2/lib/fluent/plugin/output.rb:511:in `emit_events'\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/fluentd-0.14.2/lib/fluent/plugin/out_copy.rb:38:in `block in process'\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/fluentd-0.14.2/lib/fluent/plugin/out_copy.rb:37:in `each'\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/fluentd-0.14.2/lib/fluent/plugin/out_copy.rb:37:in `process'\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/fluentd-0.14.2/lib/fluent/plugin/multi_output.rb:85:in `emit_sync'\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/fluent-plugin-forest-0.3.1/lib/fluent/plugin/out_forest.rb:172:in `emit'\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/fluentd-0.14.2/lib/fluent/compat/output.rb:194:in `process'\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/fluentd-0.14.2/lib/fluent/plugin/bare_output.rb:53:in `emit_sync'\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/fluentd-0.14.2/lib/fluent/event_router.rb:90:in `emit_stream'\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/fluentd-0.14.2/lib/fluent/event_router.rb:81:in `emit'\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/fluent-plugin-rewrite-tag-filter-1.5.5/lib/fluent/plugin/out_rewrite_tag_filter.rb:75:in `block in emit'\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/fluentd-0.14.2/lib/fluent/event.rb:186:in `block in each'\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/fluentd-0.14.2/lib/fluent/event.rb:185:in `each'\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/fluentd-0.14.2/lib/fluent/event.rb:185:in `each'\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/fluent-plugin-rewrite-tag-filter-1.5.5/lib/fluent/plugin/out_rewrite_tag_filter.rb:72:in `emit'\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/fluentd-0.14.2/lib/fluent/compat/output.rb:157:in `process'\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/fluentd-0.14.2/lib/fluent/plugin/output.rb:520:in `emit_sync'\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/fluentd-0.14.2/lib/fluent/event_router.rb:154:in `emit_events'\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/fluentd-0.14.2/lib/fluent/event_router.rb:90:in `emit_stream'\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/fluentd-0.14.2/lib/fluent/plugin/in_forward.rb:176:in `on_message'\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/fluentd-0.14.2/lib/fluent/plugin/in_forward.rb:296:in `call'\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/fluentd-0.14.2/lib/fluent/plugin/in_forward.rb:296:in `block in on_read_msgpack'\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/fluentd-0.14.2/lib/fluent/plugin/in_forward.rb:295:in `feed_each'\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/fluentd-0.14.2/lib/fluent/plugin/in_forward.rb:295:in `on_read_msgpack'\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/fluentd-0.14.2/lib/fluent/plugin/in_forward.rb:281:in `call'\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/fluentd-0.14.2/lib/fluent/plugin/in_forward.rb:281:in `on_read'\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/cool.io-1.4.4/lib/cool.io/io.rb:123:in `on_readable'\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/cool.io-1.4.4/lib/cool.io/io.rb:186:in `on_readable'\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/cool.io-1.4.4/lib/cool.io/loop.rb:88:in `run_once'\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/cool.io-1.4.4/lib/cool.io/loop.rb:88:in `run'\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: /usr/local/bundle/gems/fluentd-0.14.2/lib/fluent/plugin/in_forward.rb:117:in `run'\n20:29:12 fluentd.1   | 2016-08-14 20:29:12 +0000 [warn]: emit transaction failed: error_class=NoMethodError error=\"undefined method `+' for nil:NilClass\" tag=\"access.uwsgi\"\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: suppressed same stacktrace\n20:29:12 fluentd.1   | 2016-08-14 20:29:12 +0000 [error]: forward error error=#<NoMethodError: undefined method `+' for nil:NilClass> error_class=NoMethodError\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [error]: suppressed same stacktrace\n20:29:12 fluentd.1   | 2016-08-14 20:29:12 +0000 [warn]: emit transaction failed: error_class=NoMethodError error=\"undefined method `+' for nil:NilClass\" tag=\"store.access.uwsgi.api-gateway-dev\"\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: suppressed same stacktrace\n20:29:12 fluentd.1   | 2016-08-14 20:29:12 +0000 [warn]: emit transaction failed: error_class=NoMethodError error=\"undefined method `+' for nil:NilClass\" tag=\"access.uwsgi\"\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [warn]: suppressed same stacktrace\n20:29:12 fluentd.1   | 2016-08-14 20:29:12 +0000 [error]: forward error error=#<NoMethodError: undefined method `+' for nil:NilClass> error_class=NoMethodError\n20:29:12 fluentd.1   |   2016-08-14 20:29:12 +0000 [error]: suppressed same stacktrace\n20:29:14 fluentd.1   | 2016-08-14 20:29:14 +0000 [warn]: emit transaction failed: error_class=NoMethodError error=\"undefined method `+' for nil:NilClass\" tag=\"store.access.uwsgi.api-gateway-dev\"\n20:29:14 fluentd.1   |   2016-08-14 20:29:14 +0000 [warn]: suppressed same stacktrace\n```\n\nThis error did not occur in Fluentd 0.12.26.\n## Config\n\nconfiguration is like this.\n\n```\n<source>\n  @type forward\n  port 24224\n  bind 0.0.0.0\n</source>\n\n<match access.**>\n  @type rewrite_tag_filter\n  rewriterule1 app_name ^(.+)$ store.${tag}.$1\n</match>\n\n<match store.access.**>\n  @type forest\n  subtype copy\n  <template>\n    <store>\n      @type s3\n      ...\n    </store>\n    <store>\n      @type elasticsearch\n      ...\n    </store>\n  </template>\n</match>\n```\n## environment\n\nRunning in Docker container.\n\n```\nFROM ruby:2.3\n\nRUN gem install foreman oj && \\\n    gem install fluentd -v 0.14.2 && \\\n    gem install fluent-plugin-ua-parser fluent-plugin-geoip-filter fluent-plugin-ignore-filter \\\n                fluent-plugin-forest fluent-plugin-s3 fluent-plugin-elasticsearch fluent-plugin-rewrite-tag-filter \\\n                fluent-plugin-sentry fluent-plugin-parser fluent-plugin-record-reformer && \\\n    gem install fluent-plugin-bigquery -v 0.2.16\n```\n\n```\nroot@a93c9fd549b6:/app# ruby -v\nruby 2.3.1p112 (2016-04-26 revision 54768) [x86_64-linux]\nroot@a93c9fd549b6:/app# gem list\n\n*** LOCAL GEMS ***\n\nactivesupport (5.0.0.1)\naddressable (2.4.0)\naws-sdk (2.5.3)\naws-sdk-core (2.5.3)\naws-sdk-resources (2.5.3)\nbigdecimal (default: 1.2.8)\nbundler (1.12.5)\nconcurrent-ruby (1.0.2)\ncool.io (1.4.4)\ndid_you_mean (1.0.0)\nelasticsearch (2.0.0)\nelasticsearch-api (2.0.0)\nelasticsearch-transport (2.0.0)\nexcon (0.51.0)\nfaraday (0.9.2)\nfluent-mixin-config-placeholders (0.4.0)\nfluent-mixin-plaintextformatter (0.2.6)\nfluent-plugin-bigquery (0.2.16)\nfluent-plugin-buffer-lightening (0.0.2)\nfluent-plugin-elasticsearch (1.5.0)\nfluent-plugin-forest (0.3.1)\nfluent-plugin-geoip-filter (0.3.0)\nfluent-plugin-ignore-filter (1.1.0)\nfluent-plugin-parser (0.6.1)\nfluent-plugin-record-reformer (0.8.1)\nfluent-plugin-rewrite-tag-filter (1.5.5)\nfluent-plugin-s3 (0.7.0)\nfluent-plugin-sentry (0.0.5)\nfluent-plugin-ua-parser (1.1.0)\nfluentd (0.14.2, 0.12.27)\nforeman (0.82.0)\ngeoip (1.6.2)\ngoogle-api-client (0.9.11)\ngoogleauth (0.5.1)\nhttp_parser.rb (0.6.0)\nhttpclient (2.8.1)\nhurley (0.2)\ni18n (0.7.0)\nio-console (default: 0.4.5)\njmespath (1.3.1)\njson (default: 1.8.3)\njwt (1.5.4)\nlittle-plugger (1.1.4)\nlogging (2.1.0)\nlru_redux (1.1.0)\nltsv (0.1.0)\nmemoist (0.14.0)\nmime-types (3.1)\nmime-types-data (3.2016.0521)\nminitest (5.8.3)\nmsgpack (1.0.0, 0.5.12)\nmulti_json (1.12.1)\nmultipart-post (2.0.0)\nnet-telnet (0.1.1)\noj (2.17.1)\nos (0.9.6)\npower_assert (0.2.6)\npsych (default: 2.0.17)\nrake (10.4.2)\nrdoc (default: 4.2.1)\nrepresentable (2.3.0)\nretriable (2.1.0)\nrubygems-update (2.6.6)\nsentry-raven (0.15.6)\nserverengine (1.6.4)\nsigdump (0.2.4)\nsignet (0.7.3)\nstring-scrub (0.0.5)\nstrptime (0.1.8)\ntest-unit (3.1.5)\nthor (0.19.1)\nthread_safe (0.3.5)\ntzinfo (1.2.2)\ntzinfo-data (1.2016.6)\nuber (0.0.15)\nuser_agent_parser (2.3.0)\nuuidtools (2.1.5)\nyajl-ruby (1.2.1)\n```\n",
  "closed_at": "2016-09-28T09:15:14Z",
  "closed_by": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/230654?v=4",
    "events_url": "https://api.github.com/users/tagomoris/events{/privacy}",
    "followers_url": "https://api.github.com/users/tagomoris/followers",
    "following_url": "https://api.github.com/users/tagomoris/following{/other_user}",
    "gists_url": "https://api.github.com/users/tagomoris/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/tagomoris",
    "id": 230654,
    "login": "tagomoris",
    "node_id": "MDQ6VXNlcjIzMDY1NA==",
    "organizations_url": "https://api.github.com/users/tagomoris/orgs",
    "received_events_url": "https://api.github.com/users/tagomoris/received_events",
    "repos_url": "https://api.github.com/users/tagomoris/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/tagomoris/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tagomoris/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/tagomoris"
  },
  "comments": 5,
  "comments_url": "https://api.github.com/repos/fluent/fluentd/issues/1161/comments",
  "created_at": "2016-08-15T03:38:44Z",
  "events_url": "https://api.github.com/repos/fluent/fluentd/issues/1161/events",
  "html_url": "https://github.com/fluent/fluentd/issues/1161",
  "id": 171103045,
  "labels": [
    {
      "color": "e11d21",
      "default": true,
      "description": null,
      "id": 94152935,
      "name": "bug",
      "node_id": "MDU6TGFiZWw5NDE1MjkzNQ==",
      "url": "https://api.github.com/repos/fluent/fluentd/labels/bug"
    },
    {
      "color": "009800",
      "default": false,
      "description": null,
      "id": 146493149,
      "name": "v0.14",
      "node_id": "MDU6TGFiZWwxNDY0OTMxNDk=",
      "url": "https://api.github.com/repos/fluent/fluentd/labels/v0.14"
    }
  ],
  "labels_url": "https://api.github.com/repos/fluent/fluentd/issues/1161/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUxNzExMDMwNDU=",
  "number": 1161,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/fluent/fluentd",
  "state": "closed",
  "title": "Error: \"undefined method `+' for nil:NilClass\" in plugin/output.rb",
  "updated_at": "2016-09-28T09:15:14Z",
  "url": "https://api.github.com/repos/fluent/fluentd/issues/1161",
  "user": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/507733?v=4",
    "events_url": "https://api.github.com/users/bungoume/events{/privacy}",
    "followers_url": "https://api.github.com/users/bungoume/followers",
    "following_url": "https://api.github.com/users/bungoume/following{/other_user}",
    "gists_url": "https://api.github.com/users/bungoume/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/bungoume",
    "id": 507733,
    "login": "bungoume",
    "node_id": "MDQ6VXNlcjUwNzczMw==",
    "organizations_url": "https://api.github.com/users/bungoume/orgs",
    "received_events_url": "https://api.github.com/users/bungoume/received_events",
    "repos_url": "https://api.github.com/users/bungoume/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/bungoume/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bungoume/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/bungoume"
  }
}