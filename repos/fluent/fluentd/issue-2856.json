{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/5616899?v=4",
    "events_url": "https://api.github.com/users/ganmacs/events{/privacy}",
    "followers_url": "https://api.github.com/users/ganmacs/followers",
    "following_url": "https://api.github.com/users/ganmacs/following{/other_user}",
    "gists_url": "https://api.github.com/users/ganmacs/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/ganmacs",
    "id": 5616899,
    "login": "ganmacs",
    "node_id": "MDQ6VXNlcjU2MTY4OTk=",
    "organizations_url": "https://api.github.com/users/ganmacs/orgs",
    "received_events_url": "https://api.github.com/users/ganmacs/received_events",
    "repos_url": "https://api.github.com/users/ganmacs/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/ganmacs/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ganmacs/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/ganmacs"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars0.githubusercontent.com/u/5616899?v=4",
      "events_url": "https://api.github.com/users/ganmacs/events{/privacy}",
      "followers_url": "https://api.github.com/users/ganmacs/followers",
      "following_url": "https://api.github.com/users/ganmacs/following{/other_user}",
      "gists_url": "https://api.github.com/users/ganmacs/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ganmacs",
      "id": 5616899,
      "login": "ganmacs",
      "node_id": "MDQ6VXNlcjU2MTY4OTk=",
      "organizations_url": "https://api.github.com/users/ganmacs/orgs",
      "received_events_url": "https://api.github.com/users/ganmacs/received_events",
      "repos_url": "https://api.github.com/users/ganmacs/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ganmacs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ganmacs/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ganmacs"
    }
  ],
  "author_association": "NONE",
  "body": "**Describe the bug**\r\nThe syslog parser is including the hostname and ident as part of the time field\r\n\r\n**To Reproduce**\r\nWe are sending syslog messages in rfc3164 format but with timestamps in \"%Y-%m-%dT%H:%M:%SZ\" format eg:\r\n\r\n```\r\n<14>2020-02-25T10:37:41Z podname-v1-5cc4869f45-sd7fr servicename[1089]: {\\\"level\\\":\\\"info\\\",\\\"msg\\\":\\\"http: TLS handshake error from\u00a0127.0.0.1:59100: tls: failed to verify client's certificate: x509: certificate signed by unknown authority\\\\n\\\",\\\"Version\\\":\\\"0.0.1\\\",\\\"Caller File\\\":\\\"/usr/local/go/src/log/log.go\\\",\\\"Caller Line\\\":172}\r\n```\r\n\r\nThe logs as they appear in stdout include the hostname and ident as part of the date field. The syslog parser does not appear to be parsing the date correctly. eg:\r\nlogs we are seeing:\r\n```\r\n2020-03-03 10:14:29.000000000 +0000 syslog.user.info: {\"time\":\"2020-03-03T10:14:29Z podname-v1-5cc4869f45-kqf2g servicename[260]:\",\"host\":\"{\\\"level\\\":\\\"info\\\",\\\"msg\\\":\\\"http:\",\"ident\":\"TLS\",\"message\":\"41282: tls: failed to verify client's certificate: x509: certificate signed by unknown authority\\\\n\\\",\\\"Version\\\":\\\"0.0.1\\\",\\\"Caller File\\\":\\\"/usr/local/go/src/log/log.go\\\",\\\"Caller Line\\\":172}\"}\r\n```\r\n\r\n--\r\n\r\n**Expected behavior**\r\nThe delimiter for the end of the timestamp field should be recognised and the timestamp/host and ident fields should be parsed seperately.\r\n\r\n**Your Environment**\r\nRuning in kubernetes pods\r\n\r\nfluentd-1.3.3 from gcr.io/google-containers/fluentd-elasticsearch:v2.4.0 image which is the latest version available\r\n\r\n**Your Configuration**\r\n\r\n```\r\n<match fluent.**>\r\n    @type null\r\n  </match>\r\n  <source>\r\n    @type syslog\r\n    port 10514\r\n    bind \"0.0.0.0\"\r\n    tag \"syslog\"\r\n    <parse>\r\n      @type \"syslog\"\r\n      keep_time_key true\r\n      with_priority true\r\n      message_format rfc3164\r\n      time_format \"%Y-%m-%dT%H:%M:%SZ\"\r\n    </parse>\r\n  </source>\r\n  <source>\r\n    @type syslog\r\n    port 24224\r\n    bind \"0.0.0.0\"\r\n    protocol_type tcp\r\n    tag \"syslog\"\r\n    <parse>\r\n      @type \"syslog\"\r\n      keep_time_key true\r\n      with_priority true\r\n      message_format rfc3164\r\n      time_format \"%Y-%m-%dT%H:%M:%SZ\"\r\n    </parse>\r\n  </source>\r\n  <match **>\r\n    @type stdout\r\n    <buffer>\r\n      @type \"memory\"\r\n      flush_interval 1s\r\n    </buffer>\r\n  </match>\r\n  <match syslog.**>\r\n    @type elasticsearch\r\n    log_level info\r\n    include_tag_key true\r\n    host \"elasticsearch\"\r\n    port 9200\r\n    logstash_format true\r\n    buffer_chunk_limit 2M\r\n    buffer_queue_limit 8\r\n    flush_interval 5s\r\n    max_retry_wait 30\r\n    disable_retry_limit\r\n    num_threads 2\r\n    <buffer>\r\n      flush_thread_count 2\r\n      flush_interval 5s\r\n      retry_forever\r\n      retry_max_interval 30\r\n      chunk_limit_size 2M\r\n      queue_limit_length 8\r\n    </buffer>\r\n  </match>\r\n```\r\n\r\n**Your Error Log**\r\n\r\n```\r\n$ kubectl logs -n logging fluentd-es-6f9d5c58dc-twxwz\r\n2020-03-03 10:14:28 +0000 [info]: starting fluentd-1.3.3 without supervision pid=1 ruby=\"2.3.3\"\r\n2020-03-03 10:14:28 +0000 [info]: gem 'fluent-plugin-concat' version '2.3.0'\r\n2020-03-03 10:14:28 +0000 [info]: gem 'fluent-plugin-detect-exceptions' version '0.0.11'\r\n2020-03-03 10:14:28 +0000 [info]: gem 'fluent-plugin-elasticsearch' version '3.0.2'\r\n2020-03-03 10:14:28 +0000 [info]: gem 'fluent-plugin-kubernetes_metadata_filter' version '2.1.6'\r\n2020-03-03 10:14:28 +0000 [info]: gem 'fluent-plugin-multi-format-parser' version '1.0.0'\r\n2020-03-03 10:14:28 +0000 [info]: gem 'fluent-plugin-prometheus' version '1.3.0'\r\n2020-03-03 10:14:28 +0000 [info]: gem 'fluent-plugin-systemd' version '1.0.1'\r\n2020-03-03 10:14:28 +0000 [info]: gem 'fluentd' version '1.3.3'\r\n2020-03-03 10:14:28 +0000 [info]: adding match pattern=\"fluent.**\" type=\"null\"\r\n2020-03-03 10:14:28 +0000 [info]: adding match pattern=\"**\" type=\"stdout\"\r\n2020-03-03 10:14:28 +0000 [info]: adding match pattern=\"syslog.**\" type=\"elasticsearch\"\r\n2020-03-03 10:14:28 +0000 [warn]: 'log_level' is deprecated parameter name. use '@log_level' instead.\r\n2020-03-03 10:14:28 +0000 [warn]: 'log_level' is deprecated parameter name. use '@log_level' instead.\r\n2020-03-03 10:14:28 +0000 [info]: 'flush_interval' is configured at out side of <buffer>. 'flush_mode' is set to 'interval' to keep existing behaviour\r\n2020-03-03 10:14:28 +0000 [warn]: Could not connect Elasticsearch or obtain version. Assuming Elasticsearch 5.\r\n2020-03-03 10:14:28 +0000 [info]: adding source type=\"syslog\"\r\n2020-03-03 10:14:28 +0000 [info]: adding source type=\"syslog\"\r\n2020-03-03 10:14:28 +0000 [info]: using configuration file: <ROOT>\r\n  <match fluent.**>\r\n    @type null\r\n  </match>\r\n  <source>\r\n    @type syslog\r\n    port 10514\r\n    bind \"0.0.0.0\"\r\n    tag \"syslog\"\r\n    <parse>\r\n      @type \"syslog\"\r\n      keep_time_key true\r\n      with_priority true\r\n      message_format rfc3164\r\n      time_format \"%Y-%m-%dT%H:%M:%SZ\"\r\n    </parse>\r\n  </source>\r\n  <source>\r\n    @type syslog\r\n    port 24224\r\n    bind \"0.0.0.0\"\r\n    protocol_type tcp\r\n    tag \"syslog\"\r\n    <parse>\r\n      @type \"syslog\"\r\n      keep_time_key true\r\n      with_priority true\r\n      message_format rfc3164\r\n      time_format \"%Y-%m-%dT%H:%M:%SZ\"\r\n    </parse>\r\n  </source>\r\n  <match **>\r\n    @type stdout\r\n    <buffer>\r\n      @type \"memory\"\r\n      flush_interval 1s\r\n    </buffer>\r\n  </match>\r\n  <match syslog.**>\r\n    @type elasticsearch\r\n    log_level info\r\n    include_tag_key true\r\n    host \"elasticsearch\"\r\n    port 9200\r\n    logstash_format true\r\n    buffer_chunk_limit 2M\r\n    buffer_queue_limit 8\r\n    flush_interval 5s\r\n    max_retry_wait 30\r\n    disable_retry_limit\r\n    num_threads 2\r\n    <buffer>\r\n      flush_thread_count 2\r\n      flush_interval 5s\r\n      retry_forever\r\n      retry_max_interval 30\r\n      chunk_limit_size 2M\r\n      queue_limit_length 8\r\n    </buffer>\r\n  </match>\r\n</ROOT>\r\n2020-03-03 10:14:28 +0000 [info]: starting fluentd worker pid=1 ppid=0 worker=0\r\n2020-03-03 10:14:28 +0000 [info]: listening syslog socket on 0.0.0.0:24224 with tcp\r\n2020-03-03 10:14:28 +0000 [info]: listening syslog socket on 0.0.0.0:10514 with udp\r\n2020-03-03 10:14:28 +0000 [info]: fluentd worker is now running worker=0\r\n2020-03-03 10:14:29.000000000 +0000 syslog.user.info: {\"time\":\"2020-03-03T10:14:29Z podname-v1-5cc4869f45-kqf2g servicename[260]:\",\"host\":\"{\\\"level\\\":\\\"info\\\",\\\"msg\\\":\\\"http:\",\"ident\":\"TLS\",\"message\":\"41282: tls: failed to verify client's certificate: x509: certificate signed by unknown authority\\\\n\\\",\\\"Version\\\":\\\"0.0.1\\\",\\\"Caller File\\\":\\\"/usr/local/go/src/log/log.go\\\",\\\"Caller Line\\\":172}\"}\r\n```\r\n\r\n**Additional context**\r\n",
  "closed_at": "2020-03-24T03:00:03Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/5616899?v=4",
    "events_url": "https://api.github.com/users/ganmacs/events{/privacy}",
    "followers_url": "https://api.github.com/users/ganmacs/followers",
    "following_url": "https://api.github.com/users/ganmacs/following{/other_user}",
    "gists_url": "https://api.github.com/users/ganmacs/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/ganmacs",
    "id": 5616899,
    "login": "ganmacs",
    "node_id": "MDQ6VXNlcjU2MTY4OTk=",
    "organizations_url": "https://api.github.com/users/ganmacs/orgs",
    "received_events_url": "https://api.github.com/users/ganmacs/received_events",
    "repos_url": "https://api.github.com/users/ganmacs/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/ganmacs/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ganmacs/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/ganmacs"
  },
  "comments": 5,
  "comments_url": "https://api.github.com/repos/fluent/fluentd/issues/2856/comments",
  "created_at": "2020-03-03T10:29:11Z",
  "events_url": "https://api.github.com/repos/fluent/fluentd/issues/2856/events",
  "html_url": "https://github.com/fluent/fluentd/issues/2856",
  "id": 574566470,
  "labels": [
    {
      "color": "e11d21",
      "default": true,
      "description": null,
      "id": 94152935,
      "name": "bug",
      "node_id": "MDU6TGFiZWw5NDE1MjkzNQ==",
      "url": "https://api.github.com/repos/fluent/fluentd/labels/bug"
    }
  ],
  "labels_url": "https://api.github.com/repos/fluent/fluentd/issues/2856/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU1NzQ1NjY0NzA=",
  "number": 2856,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/fluent/fluentd",
  "state": "closed",
  "title": "FluentD syslog parser problem",
  "updated_at": "2020-03-24T03:00:03Z",
  "url": "https://api.github.com/repos/fluent/fluentd/issues/2856",
  "user": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/33087508?v=4",
    "events_url": "https://api.github.com/users/radekgs/events{/privacy}",
    "followers_url": "https://api.github.com/users/radekgs/followers",
    "following_url": "https://api.github.com/users/radekgs/following{/other_user}",
    "gists_url": "https://api.github.com/users/radekgs/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/radekgs",
    "id": 33087508,
    "login": "radekgs",
    "node_id": "MDQ6VXNlcjMzMDg3NTA4",
    "organizations_url": "https://api.github.com/users/radekgs/orgs",
    "received_events_url": "https://api.github.com/users/radekgs/received_events",
    "repos_url": "https://api.github.com/users/radekgs/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/radekgs/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/radekgs/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/radekgs"
  }
}