{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "NONE",
  "body": "fluentd fails when using --no-supervisor option at UNIXSocket.new in `serverengine/socket_manager_unix.rb`. This error may be caused by plugin/in_forward.rb because environment variable `SERVERENGINE_SOCKETMANAGER_PATH` is empty when no supervisor mode.\n\nhttps://github.com/fluent/fluentd/blob/master/lib/fluent/plugin/in_forward.rb#L62\n## Steps to Reproduce\n\nJust start fluentd with --no-supervisor with below configuration.\n## fluentd or td-agent version.\n- fluentd 0.14.0\n## Environment information, e.g. OS.\n- OS: OS X 10.11.5\n- Ruby: ruby 2.2.0\n## Configuration and Logs\n\n```\n% fluentd --no-supervisor -c test/fluentd.conf\n2016-06-04 20:13:03 +0900 [info]: reading config file path=\"test/fluentd.conf\"\n2016-06-04 20:13:03 +0900 [info]: starting fluentd-0.14.0 without supervision\n2016-06-04 20:13:03 +0900 [info]: gem 'fluentd' version '0.14.0'\n2016-06-04 20:13:03 +0900 [info]: adding match pattern=\"test.**\" type=\"stdout\"\n2016-06-04 20:13:03 +0900 [info]: adding source type=\"forward\"\n2016-06-04 20:13:03 +0900 [info]: using configuration file: <ROOT>\n  <source>\n    @type forward\n    port 24224\n  </source>\n  <match test.**>\n    @type stdout\n  </match>\n</ROOT>\n2016-06-04 20:13:03 +0900 [info]: listening fluent socket on 0.0.0.0:24224\n\n2016-06-04 20:13:03 +0900 [error]: unexpected error error_class=TypeError error=\"no implicit conversion of nil into String\"\n  2016-06-04 20:13:03 +0900 [error]: /Users/mizutani/.rbenv/versions/2.2.0/lib/ruby/gems/2.2.0/gems/serverengine-1.6.4/lib/serverengine/socket_manager_unix.rb:27:in `initialize'\n  2016-06-04 20:13:03 +0900 [error]: /Users/mizutani/.rbenv/versions/2.2.0/lib/ruby/gems/2.2.0/gems/serverengine-1.6.4/lib/serverengine/socket_manager_unix.rb:27:in `new'\n  2016-06-04 20:13:03 +0900 [error]: /Users/mizutani/.rbenv/versions/2.2.0/lib/ruby/gems/2.2.0/gems/serverengine-1.6.4/lib/serverengine/socket_manager_unix.rb:27:in `connect_peer'\n  2016-06-04 20:13:03 +0900 [error]: /Users/mizutani/.rbenv/versions/2.2.0/lib/ruby/gems/2.2.0/gems/serverengine-1.6.4/lib/serverengine/socket_manager.rb:30:in `listen_tcp'\n  2016-06-04 20:13:03 +0900 [error]: /Users/mizutani/.rbenv/versions/2.2.0/lib/ruby/gems/2.2.0/gems/fluentd-0.14.0/lib/fluent/plugin/in_forward.rb:100:in `listen'\n  2016-06-04 20:13:03 +0900 [error]: /Users/mizutani/.rbenv/versions/2.2.0/lib/ruby/gems/2.2.0/gems/fluentd-0.14.0/lib/fluent/plugin/in_forward.rb:68:in `start'\n  2016-06-04 20:13:03 +0900 [error]: /Users/mizutani/.rbenv/versions/2.2.0/lib/ruby/gems/2.2.0/gems/fluentd-0.14.0/lib/fluent/compat/call_super_mixin.rb:42:in `start'\n  2016-06-04 20:13:03 +0900 [error]: /Users/mizutani/.rbenv/versions/2.2.0/lib/ruby/gems/2.2.0/gems/fluentd-0.14.0/lib/fluent/root_agent.rb:138:in `block in start'\n  2016-06-04 20:13:03 +0900 [error]: /Users/mizutani/.rbenv/versions/2.2.0/lib/ruby/gems/2.2.0/gems/fluentd-0.14.0/lib/fluent/root_agent.rb:127:in `block (2 levels) in lifecycle'\n  2016-06-04 20:13:03 +0900 [error]: /Users/mizutani/.rbenv/versions/2.2.0/lib/ruby/gems/2.2.0/gems/fluentd-0.14.0/lib/fluent/root_agent.rb:126:in `each'\n  2016-06-04 20:13:03 +0900 [error]: /Users/mizutani/.rbenv/versions/2.2.0/lib/ruby/gems/2.2.0/gems/fluentd-0.14.0/lib/fluent/root_agent.rb:126:in `block in lifecycle'\n  2016-06-04 20:13:03 +0900 [error]: /Users/mizutani/.rbenv/versions/2.2.0/lib/ruby/gems/2.2.0/gems/fluentd-0.14.0/lib/fluent/root_agent.rb:113:in `each'\n  2016-06-04 20:13:03 +0900 [error]: /Users/mizutani/.rbenv/versions/2.2.0/lib/ruby/gems/2.2.0/gems/fluentd-0.14.0/lib/fluent/root_agent.rb:113:in `lifecycle'\n  2016-06-04 20:13:03 +0900 [error]: /Users/mizutani/.rbenv/versions/2.2.0/lib/ruby/gems/2.2.0/gems/fluentd-0.14.0/lib/fluent/root_agent.rb:137:in `start'\n  2016-06-04 20:13:03 +0900 [error]: /Users/mizutani/.rbenv/versions/2.2.0/lib/ruby/gems/2.2.0/gems/fluentd-0.14.0/lib/fluent/engine.rb:211:in `start'\n  2016-06-04 20:13:03 +0900 [error]: /Users/mizutani/.rbenv/versions/2.2.0/lib/ruby/gems/2.2.0/gems/fluentd-0.14.0/lib/fluent/engine.rb:175:in `run'\n  2016-06-04 20:13:03 +0900 [error]: /Users/mizutani/.rbenv/versions/2.2.0/lib/ruby/gems/2.2.0/gems/fluentd-0.14.0/lib/fluent/supervisor.rb:580:in `run_engine'\n  2016-06-04 20:13:03 +0900 [error]: /Users/mizutani/.rbenv/versions/2.2.0/lib/ruby/gems/2.2.0/gems/fluentd-0.14.0/lib/fluent/supervisor.rb:382:in `block in run_worker'\n  2016-06-04 20:13:03 +0900 [error]: /Users/mizutani/.rbenv/versions/2.2.0/lib/ruby/gems/2.2.0/gems/fluentd-0.14.0/lib/fluent/supervisor.rb:509:in `call'\n  2016-06-04 20:13:03 +0900 [error]: /Users/mizutani/.rbenv/versions/2.2.0/lib/ruby/gems/2.2.0/gems/fluentd-0.14.0/lib/fluent/supervisor.rb:509:in `main_process'\n  2016-06-04 20:13:03 +0900 [error]: /Users/mizutani/.rbenv/versions/2.2.0/lib/ruby/gems/2.2.0/gems/fluentd-0.14.0/lib/fluent/supervisor.rb:378:in `run_worker'\n  2016-06-04 20:13:03 +0900 [error]: /Users/mizutani/.rbenv/versions/2.2.0/lib/ruby/gems/2.2.0/gems/fluentd-0.14.0/lib/fluent/command/fluentd.rb:266:in `<top (required)>'\n  2016-06-04 20:13:03 +0900 [error]: /Users/mizutani/.rbenv/versions/2.2.0/lib/ruby/2.2.0/rubygems/core_ext/kernel_require.rb:69:in `require'\n  2016-06-04 20:13:03 +0900 [error]: /Users/mizutani/.rbenv/versions/2.2.0/lib/ruby/2.2.0/rubygems/core_ext/kernel_require.rb:69:in `require'\n  2016-06-04 20:13:03 +0900 [error]: /Users/mizutani/.rbenv/versions/2.2.0/lib/ruby/gems/2.2.0/gems/fluentd-0.14.0/bin/fluentd:5:in `<top (required)>'\n  2016-06-04 20:13:03 +0900 [error]: /Users/mizutani/.rbenv/versions/2.2.0/bin/fluentd:23:in `load'\n  2016-06-04 20:13:03 +0900 [error]: /Users/mizutani/.rbenv/versions/2.2.0/bin/fluentd:23:in `<main>'\n2016-06-04 20:13:03 +0900 [error]: unexpected error error=\"no implicit conversion of nil into String\"\n  2016-06-04 20:13:03 +0900 [error]: suppressed same stacktrace\n```\n",
  "closed_at": "2016-06-20T13:11:55Z",
  "closed_by": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/230654?v=4",
    "events_url": "https://api.github.com/users/tagomoris/events{/privacy}",
    "followers_url": "https://api.github.com/users/tagomoris/followers",
    "following_url": "https://api.github.com/users/tagomoris/following{/other_user}",
    "gists_url": "https://api.github.com/users/tagomoris/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/tagomoris",
    "id": 230654,
    "login": "tagomoris",
    "node_id": "MDQ6VXNlcjIzMDY1NA==",
    "organizations_url": "https://api.github.com/users/tagomoris/orgs",
    "received_events_url": "https://api.github.com/users/tagomoris/received_events",
    "repos_url": "https://api.github.com/users/tagomoris/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/tagomoris/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tagomoris/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/tagomoris"
  },
  "comments": 2,
  "comments_url": "https://api.github.com/repos/fluent/fluentd/issues/1027/comments",
  "created_at": "2016-06-04T11:36:04Z",
  "events_url": "https://api.github.com/repos/fluent/fluentd/issues/1027/events",
  "html_url": "https://github.com/fluent/fluentd/issues/1027",
  "id": 158500837,
  "labels": [
    {
      "color": "e11d21",
      "default": true,
      "description": null,
      "id": 94152935,
      "name": "bug",
      "node_id": "MDU6TGFiZWw5NDE1MjkzNQ==",
      "url": "https://api.github.com/repos/fluent/fluentd/labels/bug"
    },
    {
      "color": "009800",
      "default": false,
      "description": null,
      "id": 146493149,
      "name": "v0.14",
      "node_id": "MDU6TGFiZWwxNDY0OTMxNDk=",
      "url": "https://api.github.com/repos/fluent/fluentd/labels/v0.14"
    }
  ],
  "labels_url": "https://api.github.com/repos/fluent/fluentd/issues/1027/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUxNTg1MDA4Mzc=",
  "number": 1027,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/fluent/fluentd",
  "state": "closed",
  "title": "error when using --no-supervisor option",
  "updated_at": "2016-06-20T13:11:55Z",
  "url": "https://api.github.com/repos/fluent/fluentd/issues/1027",
  "user": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/605953?v=4",
    "events_url": "https://api.github.com/users/m-mizutani/events{/privacy}",
    "followers_url": "https://api.github.com/users/m-mizutani/followers",
    "following_url": "https://api.github.com/users/m-mizutani/following{/other_user}",
    "gists_url": "https://api.github.com/users/m-mizutani/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/m-mizutani",
    "id": 605953,
    "login": "m-mizutani",
    "node_id": "MDQ6VXNlcjYwNTk1Mw==",
    "organizations_url": "https://api.github.com/users/m-mizutani/orgs",
    "received_events_url": "https://api.github.com/users/m-mizutani/received_events",
    "repos_url": "https://api.github.com/users/m-mizutani/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/m-mizutani/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/m-mizutani/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/m-mizutani"
  }
}