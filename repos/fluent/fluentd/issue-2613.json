{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "NONE",
  "body": "**Describe the bug**\r\nWhen a plugin defines a `send` method, it causes a failure during plugin lifecycle operations because it overrides [`Object.send`](https://ruby-doc.org/core-2.4.5/Object.html#method-i-send) which is used in [`root_agent.rb`](https://github.com/fluent/fluentd/blob/a2a164e782d919da5044cc2fd8235e7d9dc12780/lib/fluent/root_agent.rb#L280). \r\n\r\nThis caused an issue in the New Relic output plugin ([link](https://github.com/newrelic/newrelic-fluentd-output/pull/9))\r\n\r\nThis should be fairly easily fixable by using `Object.__send__` instead of `Object.send` (as suggested by the Ruby docs).\r\n\r\n**To Reproduce**\r\n1) Create a plugin with a `send` method like the New Relic output plugin did that takes a non-symbol argument\r\n2) Shut down fluentd\r\n3) Examine logs for stacktrace\r\n\r\n**Expected behavior**\r\nShutdown still works correctly\r\n\r\n**Your Environment**\r\n\r\n- Fluentd or td-agent version: Tested on Fluentd 1.3.3 and 1.7.1\r\n- Operating system: CentOS 7\r\n- Kernel version: 3.10.0-862.11.6.el7.x86_64\r\n\r\n**Your Configuration**\r\n\r\n```\r\n <ROOT>\r\n  <source>\r\n    @type syslog\r\n    bind \"0.0.0.0\"\r\n    port 5140\r\n    tag \"e8475b22-48cf-4ae9-a92c-854960028d31.syslog\"\r\n    protocol_type tcp\r\n  </source>\r\n  <match e8475b22-48cf-4ae9-a92c-854960028d31.**>\r\n    @type record_reformer\r\n    tag \"${tag_suffix[1]}\"\r\n    <record>\r\n      bindplane_source_name Test Newrelic Syslog\r\n      bindplane_source_id e8475b22-48cf-4ae9-a92c-854960028d31\r\n      bindplane_source_type syslog\r\n    </record>\r\n  </match>\r\n  <match **>\r\n    @type newrelic\r\n    api_key \"<redacted>\"\r\n  </match>\r\n</ROOT>\r\n\r\n```\r\n\r\n**Your Error Log**\r\n\r\n```\r\n2019-09-10 10:32:26 -0400 [info]: starting fluentd-1.7.1 pid=5463 ruby=\"2.4.5\"\r\n2019-09-10 10:32:26 -0400 [info]: spawn command to main:  cmdline=[\"/opt/bluemedora/bindplane-log-agent/embedded/bin/ruby\", \"-Eascii-8bit:ascii-8bit\", \"/opt/bluemedora/bindplane-log-agent/embedded/bin/fluentd\", \"--log\", \"/var/log/bindplane-log-agent/bindplane-fluentd.log\", \"--daemon\", \"/var/run/bindplane-fluentd/bindplane-fluentd.pid\", \"--log-rotate-age\", \"5\", \"--log-rotate-size\", \"10485760\", \"--under-supervisor\"]\r\n2019-09-10 10:32:26 -0400 [info]: gem 'fluent-plugin-newrelic' version '1.1.1'\r\n2019-09-10 10:32:26 -0400 [info]: gem 'fluent-plugin-record-reformer' version '0.9.1'\r\n2019-09-10 10:32:26 -0400 [info]: gem 'fluentd' version '1.7.1'\r\n2019-09-10 10:32:26 -0400 [info]: adding match pattern=\"e8475b22-48cf-4ae9-a92c-854960028d31.**\" type=\"record_reformer\"\r\n2019-09-10 10:32:26 -0400 [info]: adding match pattern=\"**\" type=\"newrelic\"\r\n2019-09-10 10:32:26 -0400 [info]: adding source type=\"syslog\"\r\n2019-09-10 10:32:26 -0400 [warn]: #0 'protocol_type' parameter is deprecated: use transport directive\r\n2019-09-10 10:32:26 -0400 [warn]: parameter 'concurrent_requests' in <match **>\r\n  @type newrelic\r\n  api_key \"hd4LQ08bCP5KJy0ClJ1iZ5ZQYCS149M9\"\r\n  concurrent_requests 4\r\n</match> is not used.\r\n2019-09-10 10:32:26 -0400 [info]: #0 starting fluentd worker pid=5473 ppid=5468 worker=0\r\n2019-09-10 10:32:26 -0400 [info]: #0 listening syslog socket on 0.0.0.0:5140 with tcp\r\n2019-09-10 10:32:26 -0400 [info]: #0 fluentd worker is now running worker=0\r\n2019-09-10 11:33:36 -0400 [info]: Received graceful stop\r\n2019-09-10 11:33:36 -0400 [info]: Received graceful stop\r\n2019-09-10 11:33:36 -0400 [info]: #0 fluentd worker is now stopping worker=0\r\n2019-09-10 11:33:36 -0400 [info]: #0 shutting down fluentd worker worker=0\r\n2019-09-10 11:33:36 -0400 [warn]: #0 unexpected error while calling stop on output plugin plugin=Fluent::Plugin::NewrelicOutput plugin_id=\"object:1650094\" error_class=NoMethodError error=\"undefined method `bytesize' for :stopped?:Symbol\"\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http/generic_request.rb:183:in `send_request_with_body'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http/generic_request.rb:121:in `exec'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1444:in `block in transport_request'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1443:in `catch'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1443:in `transport_request'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1416:in `request'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1409:in `block in request'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:877:in `start'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1407:in `request'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluent-plugin-newrelic-1.1.1/lib/fluent/plugin/out_newrelic.rb:128:in `send'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/root_agent.rb:243:in `block (2 levels) in shutdown'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/root_agent.rb:192:in `block (2 levels) in lifecycle'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/root_agent.rb:191:in `each'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/root_agent.rb:191:in `block in lifecycle'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/root_agent.rb:178:in `each'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/root_agent.rb:178:in `lifecycle'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/root_agent.rb:240:in `block in shutdown'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/root_agent.rb:294:in `shutdown'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/engine.rb:278:in `shutdown'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/engine.rb:247:in `run'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/supervisor.rb:808:in `run_engine'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/supervisor.rb:551:in `block in run_worker'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/supervisor.rb:733:in `main_process'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/supervisor.rb:546:in `run_worker'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/command/fluentd.rb:320:in `<top (required)>'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/bin/fluentd:8:in `<top (required)>'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/bin/fluentd:23:in `load'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/bin/fluentd:23:in `<main>'\r\n2019-09-10 11:33:36 -0400 [info]: #0 shutting down input plugin type=:syslog plugin_id=\"object:15f5658\"\r\n2019-09-10 11:33:36 -0400 [info]: #0 shutting down output plugin type=:record_reformer plugin_id=\"object:162b500\"\r\n2019-09-10 11:33:36 -0400 [warn]: #0 unexpected error while preparing shutdown on output plugin plugin=Fluent::Plugin::NewrelicOutput plugin_id=\"object:1650094\" error_class=NoMethodError error=\"undefined method `bytesize' for :before_shutdown?:Symbol\"\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http/generic_request.rb:183:in `send_request_with_body'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http/generic_request.rb:121:in `exec'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1444:in `block in transport_request'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1443:in `catch'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1443:in `transport_request'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1416:in `request'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1409:in `block in request'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:877:in `start'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1407:in `request'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluent-plugin-newrelic-1.1.1/lib/fluent/plugin/out_newrelic.rb:128:in `send'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/root_agent.rb:273:in `block (3 levels) in shutdown'\r\n2019-09-10 11:33:36 -0400 [info]: #0 shutting down output plugin type=:newrelic plugin_id=\"object:1650094\"\r\n2019-09-10 11:33:36 -0400 [warn]: #0 unexpected error while shutting down on output plugin plugin=Fluent::Plugin::NewrelicOutput plugin_id=\"object:1650094\" error_class=NoMethodError error=\"undefined method `bytesize' for :shutdown?:Symbol\"\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http/generic_request.rb:183:in `send_request_with_body'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http/generic_request.rb:121:in `exec'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1444:in `block in transport_request'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1443:in `catch'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1443:in `transport_request'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1416:in `request'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1409:in `block in request'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:877:in `start'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1407:in `request'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluent-plugin-newrelic-1.1.1/lib/fluent/plugin/out_newrelic.rb:128:in `send'\r\n  2019-09-10 11:33:36 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/root_agent.rb:280:in `block (3 levels) in shutdown'\r\n2019-09-10 11:33:37 -0400 [warn]: #0 unexpected error while calling after_shutdown on output plugin plugin=Fluent::Plugin::NewrelicOutput plugin_id=\"object:1650094\" error_class=NoMethodError error=\"undefined method `bytesize' for :after_shutdown?:Symbol\"\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http/generic_request.rb:183:in `send_request_with_body'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http/generic_request.rb:121:in `exec'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1444:in `block in transport_request'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1443:in `catch'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1443:in `transport_request'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1416:in `request'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1409:in `block in request'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:877:in `start'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1407:in `request'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluent-plugin-newrelic-1.1.1/lib/fluent/plugin/out_newrelic.rb:128:in `send'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/root_agent.rb:243:in `block (2 levels) in shutdown'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/root_agent.rb:192:in `block (2 levels) in lifecycle'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/root_agent.rb:191:in `each'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/root_agent.rb:191:in `block in lifecycle'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/root_agent.rb:178:in `each'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/root_agent.rb:178:in `lifecycle'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/root_agent.rb:240:in `block in shutdown'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/root_agent.rb:299:in `shutdown'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/engine.rb:278:in `shutdown'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/engine.rb:247:in `run'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/supervisor.rb:808:in `run_engine'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/supervisor.rb:551:in `block in run_worker'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/supervisor.rb:733:in `main_process'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/supervisor.rb:546:in `run_worker'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/command/fluentd.rb:320:in `<top (required)>'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/bin/fluentd:8:in `<top (required)>'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/bin/fluentd:23:in `load'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/bin/fluentd:23:in `<main>'\r\n2019-09-10 11:33:37 -0400 [warn]: #0 unexpected error while closing on output plugin plugin=Fluent::Plugin::NewrelicOutput plugin_id=\"object:1650094\" error_class=NoMethodError error=\"undefined method `bytesize' for :closed?:Symbol\"\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http/generic_request.rb:183:in `send_request_with_body'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http/generic_request.rb:121:in `exec'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1444:in `block in transport_request'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1443:in `catch'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1443:in `transport_request'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1416:in `request'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1409:in `block in request'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:877:in `start'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1407:in `request'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluent-plugin-newrelic-1.1.1/lib/fluent/plugin/out_newrelic.rb:128:in `send'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/root_agent.rb:283:in `block (3 levels) in shutdown'\r\n2019-09-10 11:33:37 -0400 [warn]: #0 unexpected error while calling terminate on output plugin plugin=Fluent::Plugin::NewrelicOutput plugin_id=\"object:1650094\" error_class=NoMethodError error=\"undefined method `bytesize' for :terminated?:Symbol\"\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http/generic_request.rb:183:in `send_request_with_body'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http/generic_request.rb:121:in `exec'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1444:in `block in transport_request'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1443:in `catch'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1443:in `transport_request'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1416:in `request'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1409:in `block in request'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:877:in `start'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/net/http.rb:1407:in `request'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluent-plugin-newrelic-1.1.1/lib/fluent/plugin/out_newrelic.rb:128:in `send'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/root_agent.rb:243:in `block (2 levels) in shutdown'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/root_agent.rb:192:in `block (2 levels) in lifecycle'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/root_agent.rb:191:in `each'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/root_agent.rb:191:in `block in lifecycle'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/root_agent.rb:178:in `each'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/root_agent.rb:178:in `lifecycle'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/root_agent.rb:240:in `block in shutdown'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/root_agent.rb:303:in `shutdown'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/engine.rb:278:in `shutdown'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/engine.rb:247:in `run'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/supervisor.rb:808:in `run_engine'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/supervisor.rb:551:in `block in run_worker'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/supervisor.rb:733:in `main_process'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/supervisor.rb:546:in `run_worker'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/command/fluentd.rb:320:in `<top (required)>'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/bin/fluentd:8:in `<top (required)>'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/bin/fluentd:23:in `load'\r\n  2019-09-10 11:33:37 -0400 [warn]: #0 /opt/bluemedora/bindplane-log-agent/embedded/bin/fluentd:23:in `<main>'\r\n2019-09-10 11:33:37 -0400 [warn]: #0 thread doesn't exit correctly (killed or other reason) plugin=Fluent::Plugin::NewrelicOutput title=:enqueue_thread thread=#<Thread:0x0000000001f04d20@enqueue_thread@/opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/plugin_helper/thread.rb:70 aborting> error=nil\r\n2019-09-10 11:33:37 -0400 [warn]: #0 thread doesn't exit correctly (killed or other reason) plugin=Fluent::Plugin::NewrelicOutput title=:flush_thread_0 thread=#<Thread:0x0000000001f05248@flush_thread_0@/opt/bluemedora/bindplane-log-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.7.1/lib/fluent/plugin_helper/thread.rb:70 aborting> error=nil\r\n2019-09-10 11:33:37 -0400 [info]: Worker 0 finished with status 0\r\n```\r\n\r\n",
  "closed_at": "2019-09-11T08:34:35Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/5616899?v=4",
    "events_url": "https://api.github.com/users/ganmacs/events{/privacy}",
    "followers_url": "https://api.github.com/users/ganmacs/followers",
    "following_url": "https://api.github.com/users/ganmacs/following{/other_user}",
    "gists_url": "https://api.github.com/users/ganmacs/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/ganmacs",
    "id": 5616899,
    "login": "ganmacs",
    "node_id": "MDQ6VXNlcjU2MTY4OTk=",
    "organizations_url": "https://api.github.com/users/ganmacs/orgs",
    "received_events_url": "https://api.github.com/users/ganmacs/received_events",
    "repos_url": "https://api.github.com/users/ganmacs/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/ganmacs/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ganmacs/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/ganmacs"
  },
  "comments": 1,
  "comments_url": "https://api.github.com/repos/fluent/fluentd/issues/2613/comments",
  "created_at": "2019-09-10T16:12:47Z",
  "events_url": "https://api.github.com/repos/fluent/fluentd/issues/2613/events",
  "html_url": "https://github.com/fluent/fluentd/issues/2613",
  "id": 491770127,
  "labels": [
    {
      "color": "e11d21",
      "default": true,
      "description": null,
      "id": 94152935,
      "name": "bug",
      "node_id": "MDU6TGFiZWw5NDE1MjkzNQ==",
      "url": "https://api.github.com/repos/fluent/fluentd/labels/bug"
    }
  ],
  "labels_url": "https://api.github.com/repos/fluent/fluentd/issues/2613/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU0OTE3NzAxMjc=",
  "number": 2613,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/fluent/fluentd",
  "state": "closed",
  "title": "Defining a `send` method on a plugin causes failure on shutdown",
  "updated_at": "2019-09-11T08:34:35Z",
  "url": "https://api.github.com/repos/fluent/fluentd/issues/2613",
  "user": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/12631702?v=4",
    "events_url": "https://api.github.com/users/camdencheek/events{/privacy}",
    "followers_url": "https://api.github.com/users/camdencheek/followers",
    "following_url": "https://api.github.com/users/camdencheek/following{/other_user}",
    "gists_url": "https://api.github.com/users/camdencheek/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/camdencheek",
    "id": 12631702,
    "login": "camdencheek",
    "node_id": "MDQ6VXNlcjEyNjMxNzAy",
    "organizations_url": "https://api.github.com/users/camdencheek/orgs",
    "received_events_url": "https://api.github.com/users/camdencheek/received_events",
    "repos_url": "https://api.github.com/users/camdencheek/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/camdencheek/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/camdencheek/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/camdencheek"
  }
}