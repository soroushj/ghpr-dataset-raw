{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "CONTRIBUTOR",
  "body": "Here is an example:\r\n\r\n- fluentd version: 59d96759253c3894d7a7d398f2647f218ffdae18\r\n- OS: macOS 10.13.4\r\n\r\n```\r\n% bundle exec ./bin/fluentd -c ./fluent.conf --log /tmp/fluent.log --log-rotate-age 1 --log-rotate-size 1024 &\r\n[1] 4387\r\n% kill -USR1 4387\r\nUnexpected error wrong number of arguments (given 2, expected 0..1)\r\n  /Users/arabiki/.anyenv/envs/rbenv/versions/2.4.2/lib/ruby/2.4.0/logger.rb:715:in `reopen'\r\n  /Users/arabiki/ghq/src/github.com/fluent/fluentd/lib/fluent/supervisor.rb:364:in `reopen!'\r\n  /Users/arabiki/ghq/src/github.com/fluent/fluentd/lib/fluent/supervisor.rb:163:in `supervisor_sigusr1_handler'\r\n  /Users/arabiki/ghq/src/github.com/fluent/fluentd/lib/fluent/supervisor.rb:137:in `block in install_supervisor_signal_handlers'\r\n  /Users/arabiki/.anyenv/envs/rbenv/versions/2.4.2/lib/ruby/gems/2.4.0/gems/serverengine-2.0.6/lib/serverengine/process_manager.rb:252:in `select'\r\n  /Users/arabiki/.anyenv/envs/rbenv/versions/2.4.2/lib/ruby/gems/2.4.0/gems/serverengine-2.0.6/lib/serverengine/process_manager.rb:252:in `tick'\r\n  /Users/arabiki/.anyenv/envs/rbenv/versions/2.4.2/lib/ruby/gems/2.4.0/gems/serverengine-2.0.6/lib/serverengine/multi_spawn_server.rb:91:in `wait_tick'\r\n  /Users/arabiki/.anyenv/envs/rbenv/versions/2.4.2/lib/ruby/gems/2.4.0/gems/serverengine-2.0.6/lib/serverengine/multi_worker_server.rb:60:in `run'\r\n  /Users/arabiki/.anyenv/envs/rbenv/versions/2.4.2/lib/ruby/gems/2.4.0/gems/serverengine-2.0.6/lib/serverengine/multi_spawn_server.rb:57:in `run'\r\n  /Users/arabiki/.anyenv/envs/rbenv/versions/2.4.2/lib/ruby/gems/2.4.0/gems/serverengine-2.0.6/lib/serverengine/server.rb:123:in `main'\r\n  /Users/arabiki/.anyenv/envs/rbenv/versions/2.4.2/lib/ruby/gems/2.4.0/gems/serverengine-2.0.6/lib/serverengine/daemon.rb:119:in `main'\r\n  /Users/arabiki/.anyenv/envs/rbenv/versions/2.4.2/lib/ruby/gems/2.4.0/gems/serverengine-2.0.6/lib/serverengine/daemon.rb:68:in `run'\r\n  /Users/arabiki/ghq/src/github.com/fluent/fluentd/lib/fluent/supervisor.rb:606:in `supervise'\r\n  /Users/arabiki/ghq/src/github.com/fluent/fluentd/lib/fluent/supervisor.rb:476:in `run_supervisor'\r\n  /Users/arabiki/ghq/src/github.com/fluent/fluentd/lib/fluent/command/fluentd.rb:310:in `<top (required)>'\r\n  /Users/arabiki/ghq/src/github.com/fluent/fluentd/bin/fluentd:8:in `require'\r\n  /Users/arabiki/ghq/src/github.com/fluent/fluentd/bin/fluentd:8:in `<top (required)>'\r\n  /Users/arabiki/.anyenv/envs/rbenv/versions/2.4.2/lib/ruby/site_ruby/2.4.0/bundler/cli/exec.rb:75:in `load'\r\n  /Users/arabiki/.anyenv/envs/rbenv/versions/2.4.2/lib/ruby/site_ruby/2.4.0/bundler/cli/exec.rb:75:in `kernel_load'\r\n  /Users/arabiki/.anyenv/envs/rbenv/versions/2.4.2/lib/ruby/site_ruby/2.4.0/bundler/cli/exec.rb:28:in `run'\r\n  /Users/arabiki/.anyenv/envs/rbenv/versions/2.4.2/lib/ruby/site_ruby/2.4.0/bundler/cli.rb:424:in `exec'\r\n  /Users/arabiki/.anyenv/envs/rbenv/versions/2.4.2/lib/ruby/site_ruby/2.4.0/bundler/vendor/thor/lib/thor/command.rb:27:in `run'\r\n  /Users/arabiki/.anyenv/envs/rbenv/versions/2.4.2/lib/ruby/site_ruby/2.4.0/bundler/vendor/thor/lib/thor/invocation.rb:126:in `invoke_command'\r\n  /Users/arabiki/.anyenv/envs/rbenv/versions/2.4.2/lib/ruby/site_ruby/2.4.0/bundler/vendor/thor/lib/thor.rb:387:in `dispatch'\r\n  /Users/arabiki/.anyenv/envs/rbenv/versions/2.4.2/lib/ruby/site_ruby/2.4.0/bundler/cli.rb:27:in `dispatch'\r\n  /Users/arabiki/.anyenv/envs/rbenv/versions/2.4.2/lib/ruby/site_ruby/2.4.0/bundler/vendor/thor/lib/thor/base.rb:466:in `start'\r\n  /Users/arabiki/.anyenv/envs/rbenv/versions/2.4.2/lib/ruby/site_ruby/2.4.0/bundler/cli.rb:18:in `start'\r\n  /Users/arabiki/.anyenv/envs/rbenv/versions/2.4.2/bin/bundle:30:in `block in <main>'\r\n  /Users/arabiki/.anyenv/envs/rbenv/versions/2.4.2/lib/ruby/site_ruby/2.4.0/bundler/friendly_errors.rb:122:in `with_friendly_errors'\r\n  /Users/arabiki/.anyenv/envs/rbenv/versions/2.4.2/bin/bundle:22:in `<main>'\r\n[arabiki@MBP-3:~/ghq/src/github.com/fluent/fluentd]\r\n%\r\n[1]  + exit 1     bundle exec ./bin/fluentd -c ./fluent.conf --log /tmp/fluent.log  1  1024\r\n\r\n```\r\n\r\nI've tried to fix the error by the following change:\r\n\r\n```diff\r\ndiff --git a/lib/fluent/log.rb b/lib/fluent/log.rb\r\nindex 097216c3..30108510 100644\r\n--- a/lib/fluent/log.rb\r\n+++ b/lib/fluent/log.rb\r\n@@ -625,5 +625,12 @@ module Fluent\r\n         super\r\n       end\r\n     end\r\n+\r\n+    def reopen(path, mode)\r\n+      if mode != 'a'\r\n+        raise \"Unsupported mode: #{mode}\"\r\n+      end\r\n+      super(path)\r\n+    end\r\n   end\r\n end\r\n```\r\n\r\nHowever, I found another error...\r\n\r\n```\r\n% bundle exec ./bin/fluentd -c ./fluent.conf --log /tmp/fluent.log --log-rotate-age 1 --log-rotate-size 1024 &\r\n[1] 5731\r\n% kill -USR1 5731\r\nUnexpected error can't be called from trap context\r\n  /Users/arabiki/.anyenv/envs/rbenv/versions/2.4.2/lib/ruby/2.4.0/monitor.rb:187:in `lock'\r\n  /Users/arabiki/.anyenv/envs/rbenv/versions/2.4.2/lib/ruby/2.4.0/monitor.rb:187:in `mon_enter'\r\n  /Users/arabiki/.anyenv/envs/rbenv/versions/2.4.2/lib/ruby/2.4.0/monitor.rb:212:in `mon_synchronize'\r\n  /Users/arabiki/.anyenv/envs/rbenv/versions/2.4.2/lib/ruby/2.4.0/logger.rb:719:in `reopen'\r\n  /Users/arabiki/ghq/src/github.com/fluent/fluentd/lib/fluent/log.rb:633:in `reopen'\r\n  /Users/arabiki/ghq/src/github.com/fluent/fluentd/lib/fluent/supervisor.rb:364:in `reopen!'\r\n  /Users/arabiki/ghq/src/github.com/fluent/fluentd/lib/fluent/supervisor.rb:163:in `supervisor_sigusr1_handler'\r\n  /Users/arabiki/ghq/src/github.com/fluent/fluentd/lib/fluent/supervisor.rb:137:in `block in install_supervisor_signal_handlers'\r\n(snip)\r\n```",
  "closed_at": "2018-04-27T11:36:39Z",
  "closed_by": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/16928?v=4",
    "events_url": "https://api.github.com/users/repeatedly/events{/privacy}",
    "followers_url": "https://api.github.com/users/repeatedly/followers",
    "following_url": "https://api.github.com/users/repeatedly/following{/other_user}",
    "gists_url": "https://api.github.com/users/repeatedly/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/repeatedly",
    "id": 16928,
    "login": "repeatedly",
    "node_id": "MDQ6VXNlcjE2OTI4",
    "organizations_url": "https://api.github.com/users/repeatedly/orgs",
    "received_events_url": "https://api.github.com/users/repeatedly/received_events",
    "repos_url": "https://api.github.com/users/repeatedly/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/repeatedly/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/repeatedly/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/repeatedly"
  },
  "comments": 1,
  "comments_url": "https://api.github.com/repos/fluent/fluentd/issues/1951/comments",
  "created_at": "2018-04-17T20:11:54Z",
  "events_url": "https://api.github.com/repos/fluent/fluentd/issues/1951/events",
  "html_url": "https://github.com/fluent/fluentd/issues/1951",
  "id": 315212892,
  "labels": [
    {
      "color": "e11d21",
      "default": true,
      "description": null,
      "id": 94152935,
      "name": "bug",
      "node_id": "MDU6TGFiZWw5NDE1MjkzNQ==",
      "url": "https://api.github.com/repos/fluent/fluentd/labels/bug"
    }
  ],
  "labels_url": "https://api.github.com/repos/fluent/fluentd/issues/1951/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUzMTUyMTI4OTI=",
  "number": 1951,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/fluent/fluentd",
  "state": "closed",
  "title": "fluentd exits on SIGUSR1 if its logrotate feature is enabled",
  "updated_at": "2018-04-27T11:36:39Z",
  "url": "https://api.github.com/repos/fluent/fluentd/issues/1951",
  "user": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/508822?v=4",
    "events_url": "https://api.github.com/users/abicky/events{/privacy}",
    "followers_url": "https://api.github.com/users/abicky/followers",
    "following_url": "https://api.github.com/users/abicky/following{/other_user}",
    "gists_url": "https://api.github.com/users/abicky/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/abicky",
    "id": 508822,
    "login": "abicky",
    "node_id": "MDQ6VXNlcjUwODgyMg==",
    "organizations_url": "https://api.github.com/users/abicky/orgs",
    "received_events_url": "https://api.github.com/users/abicky/received_events",
    "repos_url": "https://api.github.com/users/abicky/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/abicky/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/abicky/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/abicky"
  }
}