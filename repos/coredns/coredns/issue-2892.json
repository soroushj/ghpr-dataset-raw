{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "NONE",
  "body": "I am writing plugins for coredns, when I read `plugin.Handler` comment, it says\r\n\r\n> If ServeDNS writes to the response body, it should return a status\r\n> code. If the status code is not one of the following:\r\n> \r\n> * SERVFAIL (dns.RcodeServerFailure)\r\n> \r\n> * REFUSED (dns.RecodeRefused)\r\n> \r\n> * FORMERR (dns.RcodeFormatError)\r\n> \r\n> * NOTIMP (dns.RcodeNotImplemented)\r\n> \r\n> CoreDNS assumes no reply has yet been written. All other response\r\n> codes signal other handlers above it that the response message is\r\n> already written, and that they should not write to it also.\r\n> \r\n> If ServeDNS encounters an error, it should return the error value\r\n> so it can be logged by designated error-handling plugin.\r\n> \r\n> If writing a response after calling another ServeDNS method, the\r\n> returned rcode SHOULD be used when writing the response.\r\n> \r\n> If handling errors after calling another ServeDNS method, the\r\n> returned error value SHOULD be logged or handled accordingly.\r\n> \r\n> Otherwise, return values should be propagated down the plugin\r\n> chain by returning them unchanged.\r\n\r\nit confuses me: if B is the next plugin of A, when A call `plugin.NextOrFailure` and then gets the `(rcode, err)`. if B works fine, it should return `(0, nil)`, but for A, it means B doesn't write the response to the writer which A gives B, and A doesn't know how to find out B's repsonse and write it to the writer.\r\n\r\nI think it should be:\r\n\r\n> if status code is one of the following, CoreDNS assumes no reply has yet been written.\r\n\r\nwhich means if B works fine, return `(0, nil)`, it should write the response to the writer and then A got the return values and knows B works fine and have written the response to the writer.",
  "closed_at": "2019-06-17T19:01:06Z",
  "closed_by": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/353371?v=4",
    "events_url": "https://api.github.com/users/miekg/events{/privacy}",
    "followers_url": "https://api.github.com/users/miekg/followers",
    "following_url": "https://api.github.com/users/miekg/following{/other_user}",
    "gists_url": "https://api.github.com/users/miekg/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/miekg",
    "id": 353371,
    "login": "miekg",
    "node_id": "MDQ6VXNlcjM1MzM3MQ==",
    "organizations_url": "https://api.github.com/users/miekg/orgs",
    "received_events_url": "https://api.github.com/users/miekg/received_events",
    "repos_url": "https://api.github.com/users/miekg/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/miekg/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/miekg/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/miekg"
  },
  "comments": 3,
  "comments_url": "https://api.github.com/repos/coredns/coredns/issues/2892/comments",
  "created_at": "2019-06-17T13:13:34Z",
  "events_url": "https://api.github.com/repos/coredns/coredns/issues/2892/events",
  "html_url": "https://github.com/coredns/coredns/issues/2892",
  "id": 456927589,
  "labels": [
    {
      "color": "d4c5f9",
      "default": false,
      "description": null,
      "id": 615851645,
      "name": "plugin",
      "node_id": "MDU6TGFiZWw2MTU4NTE2NDU=",
      "url": "https://api.github.com/repos/coredns/coredns/labels/plugin"
    },
    {
      "color": "cc317c",
      "default": true,
      "description": null,
      "id": 343986371,
      "name": "question",
      "node_id": "MDU6TGFiZWwzNDM5ODYzNzE=",
      "url": "https://api.github.com/repos/coredns/coredns/labels/question"
    }
  ],
  "labels_url": "https://api.github.com/repos/coredns/coredns/issues/2892/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU0NTY5Mjc1ODk=",
  "number": 2892,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/coredns/coredns",
  "state": "closed",
  "title": "a doubt about the comment about plugin.Handler",
  "updated_at": "2019-06-17T19:01:06Z",
  "url": "https://api.github.com/repos/coredns/coredns/issues/2892",
  "user": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/10096425?v=4",
    "events_url": "https://api.github.com/users/Sherlock-Holo/events{/privacy}",
    "followers_url": "https://api.github.com/users/Sherlock-Holo/followers",
    "following_url": "https://api.github.com/users/Sherlock-Holo/following{/other_user}",
    "gists_url": "https://api.github.com/users/Sherlock-Holo/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/Sherlock-Holo",
    "id": 10096425,
    "login": "Sherlock-Holo",
    "node_id": "MDQ6VXNlcjEwMDk2NDI1",
    "organizations_url": "https://api.github.com/users/Sherlock-Holo/orgs",
    "received_events_url": "https://api.github.com/users/Sherlock-Holo/received_events",
    "repos_url": "https://api.github.com/users/Sherlock-Holo/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/Sherlock-Holo/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Sherlock-Holo/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/Sherlock-Holo"
  }
}