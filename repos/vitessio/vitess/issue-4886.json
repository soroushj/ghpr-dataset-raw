{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "MEMBER",
  "body": "## Feature Description\r\nThe ability to recover data in vitess to a (past) point in time. \r\nIt should be possible to have multiple recovery requests active at the same time.\r\nIt should also be possible to recover across sharding actions, i.e., you should be able to recover to a time when there were two shards even though at present there are four.\r\n\r\n## Use Case(s)\r\n- accidental deletion of data\r\n- corruption of data due to application bugs\r\n\r\n## Preconditions\r\n- there should be a backup that was taken before the desired point in time (PIT)\r\n- there should be continuous binlogs from the backup time to the desired PIT\r\n\r\n## Proposed design\r\n### Create a new keyspace\r\nWe will add the ability to create a new type of keyspace called a `Snapshot` keyspace. The normal keyspaces will have the (unimaginative) type of `Normal`. When a snapshot keyspace is created, a time is assigned to it, which is the time you want to recover to. The time will be in UTC. Snapshot keyspaces are always created off a `base` keyspace. \r\n\r\n### Start VTTablets\r\nVTTablets will be started with their init_keyspace command-line-param set to the newly created snapshot keyspace. They will look for the most recent usable backup of the base keyspace (and specified -init_shard) that is earlier than the snapshot time and restore from that.\r\n\r\nIt is the responsibility of the operator to provide the correct -init_shard value while starting up vttablets.\r\n\r\nThe timestamp of the backup that was used for restoring will be saved in the local_metadata table along with the position (GTID) that was restored.\r\n\r\n### VTGate routing\r\nVTGate will automatically exclude tablets belonging to snapshot keyspaces from query routing unless they are specifically addressed using `use ks` or by using queries of the form `select ... from ks.table`\r\n\r\n### VSchema\r\nThe base keyspace's vschema will be copied over to the new snapshot keyspace as a default. If desired this can be overwritten by the operator. Care needs to be taken to set `require_explicit_routing` to true when modifying a snapshot keyspace's vschema.\r\n\r\n### Applying Binlogs\r\nhttps://github.com/vitessio/vitess/issues/6267",
  "closed_at": "2020-07-18T20:31:44Z",
  "closed_by": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/388311?v=4",
    "events_url": "https://api.github.com/users/deepthi/events{/privacy}",
    "followers_url": "https://api.github.com/users/deepthi/followers",
    "following_url": "https://api.github.com/users/deepthi/following{/other_user}",
    "gists_url": "https://api.github.com/users/deepthi/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/deepthi",
    "id": 388311,
    "login": "deepthi",
    "node_id": "MDQ6VXNlcjM4ODMxMQ==",
    "organizations_url": "https://api.github.com/users/deepthi/orgs",
    "received_events_url": "https://api.github.com/users/deepthi/received_events",
    "repos_url": "https://api.github.com/users/deepthi/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/deepthi/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/deepthi/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/deepthi"
  },
  "comments": 4,
  "comments_url": "https://api.github.com/repos/vitessio/vitess/issues/4886/comments",
  "created_at": "2019-05-28T20:36:40Z",
  "events_url": "https://api.github.com/repos/vitessio/vitess/issues/4886/events",
  "html_url": "https://github.com/vitessio/vitess/issues/4886",
  "id": 449465497,
  "labels": [
    {
      "color": "c2e0c6",
      "default": false,
      "description": "",
      "id": 1642972305,
      "name": "Component: Backup",
      "node_id": "MDU6TGFiZWwxNjQyOTcyMzA1",
      "url": "https://api.github.com/repos/vitessio/vitess/labels/Component:%20Backup"
    },
    {
      "color": "84b6eb",
      "default": false,
      "description": null,
      "id": 45388297,
      "name": "Type: Feature Request",
      "node_id": "MDU6TGFiZWw0NTM4ODI5Nw==",
      "url": "https://api.github.com/repos/vitessio/vitess/labels/Type:%20Feature%20Request"
    }
  ],
  "labels_url": "https://api.github.com/repos/vitessio/vitess/issues/4886/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU0NDk0NjU0OTc=",
  "number": 4886,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/vitessio/vitess",
  "state": "closed",
  "title": "Point in time recovery (PITR)",
  "updated_at": "2020-10-07T00:03:14Z",
  "url": "https://api.github.com/repos/vitessio/vitess/issues/4886",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/388311?v=4",
    "events_url": "https://api.github.com/users/deepthi/events{/privacy}",
    "followers_url": "https://api.github.com/users/deepthi/followers",
    "following_url": "https://api.github.com/users/deepthi/following{/other_user}",
    "gists_url": "https://api.github.com/users/deepthi/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/deepthi",
    "id": 388311,
    "login": "deepthi",
    "node_id": "MDQ6VXNlcjM4ODMxMQ==",
    "organizations_url": "https://api.github.com/users/deepthi/orgs",
    "received_events_url": "https://api.github.com/users/deepthi/received_events",
    "repos_url": "https://api.github.com/users/deepthi/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/deepthi/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/deepthi/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/deepthi"
  }
}