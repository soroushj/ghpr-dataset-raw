{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/489643?v=4",
    "events_url": "https://api.github.com/users/dkhenry/events{/privacy}",
    "followers_url": "https://api.github.com/users/dkhenry/followers",
    "following_url": "https://api.github.com/users/dkhenry/following{/other_user}",
    "gists_url": "https://api.github.com/users/dkhenry/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/dkhenry",
    "id": 489643,
    "login": "dkhenry",
    "node_id": "MDQ6VXNlcjQ4OTY0Mw==",
    "organizations_url": "https://api.github.com/users/dkhenry/orgs",
    "received_events_url": "https://api.github.com/users/dkhenry/received_events",
    "repos_url": "https://api.github.com/users/dkhenry/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/dkhenry/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dkhenry/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/dkhenry"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars2.githubusercontent.com/u/489643?v=4",
      "events_url": "https://api.github.com/users/dkhenry/events{/privacy}",
      "followers_url": "https://api.github.com/users/dkhenry/followers",
      "following_url": "https://api.github.com/users/dkhenry/following{/other_user}",
      "gists_url": "https://api.github.com/users/dkhenry/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/dkhenry",
      "id": 489643,
      "login": "dkhenry",
      "node_id": "MDQ6VXNlcjQ4OTY0Mw==",
      "organizations_url": "https://api.github.com/users/dkhenry/orgs",
      "received_events_url": "https://api.github.com/users/dkhenry/received_events",
      "repos_url": "https://api.github.com/users/dkhenry/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/dkhenry/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dkhenry/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/dkhenry"
    }
  ],
  "author_association": "COLLABORATOR",
  "body": "We're having regular issues in Kubernetes when we restart the stateful set for our Zookeeper cluster. This means the service resolves to new IP addresses. Unfortunately Vitess contains code that resolves the DNS names to IP addresses at upstart and then never refresh them ever again without a restart.\r\n\r\nThis is the code (go/vt/topo/zk2topo/zk_conn.go:386):\r\n```\r\n// resolveZkAddr takes a comma-separated list of host:port addresses,\r\n// and resolves the host to replace it with the IP address.\r\n// If a resolution fails, the host is skipped.\r\n// If no host can be resolved, an error is returned.\r\n// This is different from the Zookeeper library, that insists on resolving\r\n// *all* hosts successfully before it starts.\r\nfunc resolveZkAddr(zkAddr string) ([]string, error) {\r\n\tparts := strings.Split(zkAddr, \",\")\r\n\tresolved := make([]string, 0, len(parts))\r\n\tfor _, part := range parts {\r\n\t\t// The Zookeeper client cannot handle IPv6 addresses before version 3.4.x.\r\n\t\tif r, err := netutil.ResolveIPv4Addrs(part); err != nil {\r\n\t\t\tlog.Warningf(\"cannot resolve %v, will not use it: %v\", part, err)\r\n\t\t} else {\r\n\t\t\tresolved = append(resolved, r...)\r\n\t\t}\r\n\t}\r\n\tif len(resolved) == 0 {\r\n\t\treturn nil, fmt.Errorf(\"no valid address found in %v\", zkAddr)\r\n\t}\r\n\treturn resolved, nil\r\n}\r\n```\r\n\r\nThis code has already caused us one major outage (run `git blame` to see how). Can we just get rid of it?",
  "closed_at": "2019-07-08T18:44:58Z",
  "closed_by": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/388311?v=4",
    "events_url": "https://api.github.com/users/deepthi/events{/privacy}",
    "followers_url": "https://api.github.com/users/deepthi/followers",
    "following_url": "https://api.github.com/users/deepthi/following{/other_user}",
    "gists_url": "https://api.github.com/users/deepthi/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/deepthi",
    "id": 388311,
    "login": "deepthi",
    "node_id": "MDQ6VXNlcjM4ODMxMQ==",
    "organizations_url": "https://api.github.com/users/deepthi/orgs",
    "received_events_url": "https://api.github.com/users/deepthi/received_events",
    "repos_url": "https://api.github.com/users/deepthi/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/deepthi/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/deepthi/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/deepthi"
  },
  "comments": 7,
  "comments_url": "https://api.github.com/repos/vitessio/vitess/issues/4454/comments",
  "created_at": "2018-12-13T16:58:13Z",
  "events_url": "https://api.github.com/repos/vitessio/vitess/issues/4454/events",
  "html_url": "https://github.com/vitessio/vitess/issues/4454",
  "id": 390770619,
  "labels": [],
  "labels_url": "https://api.github.com/repos/vitessio/vitess/issues/4454/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUzOTA3NzA2MTk=",
  "number": 4454,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/vitessio/vitess",
  "state": "closed",
  "title": "Zookeeper DNS names are never refreshed without a restart",
  "updated_at": "2019-07-08T18:44:58Z",
  "url": "https://api.github.com/repos/vitessio/vitess/issues/4454",
  "user": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/11489?v=4",
    "events_url": "https://api.github.com/users/tirsen/events{/privacy}",
    "followers_url": "https://api.github.com/users/tirsen/followers",
    "following_url": "https://api.github.com/users/tirsen/following{/other_user}",
    "gists_url": "https://api.github.com/users/tirsen/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/tirsen",
    "id": 11489,
    "login": "tirsen",
    "node_id": "MDQ6VXNlcjExNDg5",
    "organizations_url": "https://api.github.com/users/tirsen/orgs",
    "received_events_url": "https://api.github.com/users/tirsen/received_events",
    "repos_url": "https://api.github.com/users/tirsen/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/tirsen/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tirsen/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/tirsen"
  }
}