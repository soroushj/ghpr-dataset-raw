{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "MEMBER",
  "body": "Fixes #5502\r\n\r\nThis embeds the my.cnf files for a MySQL flavor, as well as the init_db.sql file. \r\n\r\nThe examples have also been modified to search for vitess binaries in the PATH, and no longer specify an init-db file. They can now completely standalone from the vitess root, as long as the binaries are in the path:\r\n\r\n```\r\n$ mv examples/local ~/vitess-examples\r\n$ cd ~/vitess-examples/\r\n$ ./101_initial_cluster.sh \r\nadd /vitess/global\r\nadd /vitess/zone1\r\nadd zone1 CellInfo\r\netcd start done...\r\nStarting vtctld...\r\nAccess vtctld web UI at http://ryzen:15000\r\nSend commands with: vtctlclient -server ryzen:15999 ...\r\nStarting MySQL for tablet zone1-0000000100...\r\nStarting MySQL for tablet zone1-0000000101...\r\nStarting MySQL for tablet zone1-0000000102...\r\nStarting vttablet for zone1-0000000100...\r\nAccess tablet zone1-0000000100 at http://ryzen:15100/debug/status\r\nStarting vttablet for zone1-0000000101...\r\nAccess tablet zone1-0000000101 at http://ryzen:15101/debug/status\r\nStarting vttablet for zone1-0000000102...\r\nAccess tablet zone1-0000000102 at http://ryzen:15102/debug/status\r\nWaiting for tablets to be listening...\r\nHTTP/1.1 200 OK\r\nDate: Fri, 03 Jan 2020 23:45:04 GMT\r\nContent-Type: text/html; charset=utf-8\r\n\r\nHTTP/1.1 200 OK\r\nDate: Fri, 03 Jan 2020 23:45:04 GMT\r\nContent-Type: text/html; charset=utf-8\r\n\r\nHTTP/1.1 200 OK\r\nDate: Fri, 03 Jan 2020 23:45:04 GMT\r\nContent-Type: text/html; charset=utf-8\r\n\r\nTablets up!\r\nW0103 16:45:04.720428   19305 main.go:64] W0103 23:45:04.719741 reparent.go:185] master-elect tablet zone1-0000000100 is not the shard master, proceeding anyway as -force was used\r\nW0103 16:45:04.720616   19305 main.go:64] W0103 23:45:04.720030 reparent.go:191] master-elect tablet zone1-0000000100 is not a master in the shard, proceeding anyway as -force was used\r\nNew VSchema object:\r\n{\r\n  \"tables\": {\r\n    \"corder\": {\r\n\r\n    },\r\n    \"customer\": {\r\n\r\n    },\r\n    \"product\": {\r\n\r\n    }\r\n  }\r\n}\r\nIf this is not what you expected, check the input data (as JSON parsing will skip unexpected fields).\r\nWaiting for vtgate to be up...\r\nvtgate is up!\r\nAccess vtgate at http://ryzen:15001/debug/status\r\n```\r\n\r\nThe linter also reported that the contains function and mycnfTemplateFile variable of mysqld.go are unused.\r\n\r\nI introduced DefaultVtRoot so that there will not be an error if `VTROOT` is not defined. This means that if you want to use hooks, you will need to set a `VTROOT`, unless you are okay with the default of `/usr/local/vitess/vthook` (eventually I'd like to move binary instructions to use /usr/local/vitess as the install PATH similar to how golang installs.. it's not important to switch right now, and I could have equally specified /dev/null.)\r\n\r\nIn #5502 @enisoc commented that he was concerned that embedding init_db.sql creates a security risk. In this implementation, it is still possible to overwrite with a new init_db.sql file.. so it is possible to deploy securely. \r\n\r\nSigned-off-by: Morgan Tocker <tocker@gmail.com>",
  "closed_at": "2020-01-11T08:39:20Z",
  "closed_by": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/589370?v=4",
    "events_url": "https://api.github.com/users/sougou/events{/privacy}",
    "followers_url": "https://api.github.com/users/sougou/followers",
    "following_url": "https://api.github.com/users/sougou/following{/other_user}",
    "gists_url": "https://api.github.com/users/sougou/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/sougou",
    "id": 589370,
    "login": "sougou",
    "node_id": "MDQ6VXNlcjU4OTM3MA==",
    "organizations_url": "https://api.github.com/users/sougou/orgs",
    "received_events_url": "https://api.github.com/users/sougou/received_events",
    "repos_url": "https://api.github.com/users/sougou/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/sougou/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/sougou/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/sougou"
  },
  "comments": 4,
  "comments_url": "https://api.github.com/repos/vitessio/vitess/issues/5654/comments",
  "created_at": "2020-01-03T21:25:33Z",
  "events_url": "https://api.github.com/repos/vitessio/vitess/issues/5654/events",
  "html_url": "https://github.com/vitessio/vitess/pull/5654",
  "id": 545170350,
  "labels": [],
  "labels_url": "https://api.github.com/repos/vitessio/vitess/issues/5654/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDExOlB1bGxSZXF1ZXN0MzU5MTI4MDY4",
  "number": 5654,
  "performed_via_github_app": null,
  "pull_request": {
    "diff_url": "https://github.com/vitessio/vitess/pull/5654.diff",
    "html_url": "https://github.com/vitessio/vitess/pull/5654",
    "patch_url": "https://github.com/vitessio/vitess/pull/5654.patch",
    "url": "https://api.github.com/repos/vitessio/vitess/pulls/5654"
  },
  "repository_url": "https://api.github.com/repos/vitessio/vitess",
  "state": "closed",
  "title": "Embed mycnf files and init_db",
  "updated_at": "2020-01-15T17:55:14Z",
  "url": "https://api.github.com/repos/vitessio/vitess/issues/5654",
  "user": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/57982?v=4",
    "events_url": "https://api.github.com/users/morgo/events{/privacy}",
    "followers_url": "https://api.github.com/users/morgo/followers",
    "following_url": "https://api.github.com/users/morgo/following{/other_user}",
    "gists_url": "https://api.github.com/users/morgo/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/morgo",
    "id": 57982,
    "login": "morgo",
    "node_id": "MDQ6VXNlcjU3OTgy",
    "organizations_url": "https://api.github.com/users/morgo/orgs",
    "received_events_url": "https://api.github.com/users/morgo/received_events",
    "repos_url": "https://api.github.com/users/morgo/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/morgo/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/morgo/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/morgo"
  }
}