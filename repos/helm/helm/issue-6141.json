{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/393494?v=4",
    "events_url": "https://api.github.com/users/jdolitsky/events{/privacy}",
    "followers_url": "https://api.github.com/users/jdolitsky/followers",
    "following_url": "https://api.github.com/users/jdolitsky/following{/other_user}",
    "gists_url": "https://api.github.com/users/jdolitsky/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/jdolitsky",
    "id": 393494,
    "login": "jdolitsky",
    "node_id": "MDQ6VXNlcjM5MzQ5NA==",
    "organizations_url": "https://api.github.com/users/jdolitsky/orgs",
    "received_events_url": "https://api.github.com/users/jdolitsky/received_events",
    "repos_url": "https://api.github.com/users/jdolitsky/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/jdolitsky/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jdolitsky/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/jdolitsky"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars3.githubusercontent.com/u/393494?v=4",
      "events_url": "https://api.github.com/users/jdolitsky/events{/privacy}",
      "followers_url": "https://api.github.com/users/jdolitsky/followers",
      "following_url": "https://api.github.com/users/jdolitsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/jdolitsky/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jdolitsky",
      "id": 393494,
      "login": "jdolitsky",
      "node_id": "MDQ6VXNlcjM5MzQ5NA==",
      "organizations_url": "https://api.github.com/users/jdolitsky/orgs",
      "received_events_url": "https://api.github.com/users/jdolitsky/received_events",
      "repos_url": "https://api.github.com/users/jdolitsky/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jdolitsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jdolitsky/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jdolitsky"
    }
  ],
  "author_association": "MEMBER",
  "body": "Currently, charts stored in a registry are divided into the following 2 layers:\r\n\r\n- `application/vnd.cncf.helm.chart.meta.layer.v1+json`\r\n-  `application/vnd.cncf.helm.chart.content.layer.v1+tar`\r\n\r\nIdeally, metadata should be stored on the manifest config as annotations. Additionally, the charts layers should be a collections of the components that compose a chart, for example:\r\n\r\n- README.md -> `application/vnd.cncf.helm.chart.readme.layer.v1+md`\r\n- values.yaml -> `application/vnd.cncf.helm.chart.values.layer.v1+yaml`\r\n- templates/NOTES.txt -> `application/vnd.cncf.helm.chart.notes.layer.v1+txt`\r\n- templates/_helpers.tpl -> `application/vnd.cncf.helm.chart.helpers.layer.v1+tpl`\r\n- templates/*.yaml -> `application/vnd.cncf.helm.chart.template.layer.v1+yaml`\r\n- templates/tests/*.yaml -> `application/vnd.cncf.helm.chart.test.layer.v1+yaml`\r\n\r\n---\r\n\r\nA current Helm 3 manifest (alpha2) looks like the following:\r\n```json\r\n{\r\n  \"schemaVersion\": 2,\r\n  \"config\": {\r\n    \"mediaType\": \"application/vnd.cncf.helm.config.v1+json\",\r\n    \"digest\": \"sha256:44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a\",\r\n    \"size\": 2\r\n  },\r\n  \"layers\": [\r\n    {\r\n      \"mediaType\": \"application/vnd.cncf.helm.chart.meta.layer.v1+json\",\r\n      \"digest\": \"sha256:4204a6f7d3dc3b6214a0b3af6d2977f517b5c2da70120c9ed1c4f4188d005eff\",\r\n      \"size\": 617,\r\n      \"annotations\": {\r\n        \"org.opencontainers.image.title\": \"chart-meta.json\"\r\n      }\r\n    },\r\n    {\r\n      \"mediaType\": \"application/vnd.cncf.helm.chart.content.layer.v1+tar\",\r\n      \"digest\": \"sha256:4d85513409ca6ac4657aa7d47708426606368c424216633b99057e93e9a84277\",\r\n      \"size\": 12448,\r\n      \"annotations\": {\r\n        \"org.opencontainers.image.title\": \"chart-content.tgz\",\r\n        \"sh.helm.chart.name\": \"wordpress\",\r\n        \"sh.helm.chart.version\": \"7.0.1\"\r\n      }\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\nUsing the following script to upload a sample wordpress chart with ORAS:\r\n```bash\r\necho '{}' > config.json\r\nruby -ryaml -rjson -e 'puts JSON.pretty_generate({\"$config\" => YAML.load(ARGF)})' \\\r\n    < Chart.yaml > annotations.json\r\n\r\noras push \\\r\n    --manifest-config config.json:application/vnd.cncf.helm.config.v1+json \\\r\n    localhost:5000/stable/wordpress:7.0.1 \\\r\n    README.md:application/vnd.cncf.helm.chart.readme.layer.v1+md \\\r\n    values.yaml:application/vnd.cncf.helm.chart.values.layer.v1+yaml \\\r\n    templates/NOTES.txt:application/vnd.cncf.helm.chart.notes.layer.v1+txt \\\r\n    templates/_helpers.tpl:application/vnd.cncf.helm.chart.helpers.layer.v1+tpl \\\r\n    templates/deployment.yaml:application/vnd.cncf.helm.chart.template.layer.v1+yaml \\\r\n    templates/ingress.yaml:application/vnd.cncf.helm.chart.template.layer.v1+yaml \\\r\n    templates/pvc.yaml:application/vnd.cncf.helm.chart.template.layer.v1+yaml \\\r\n    templates/tests/test-mariadb-connection.yaml:application/vnd.cncf.helm.chart.test.layer.v1+yaml\r\n```\r\n\r\nResults in a manifest like the following:\r\n```json\r\n{\r\n  \"schemaVersion\": 2,\r\n  \"config\": {\r\n    \"mediaType\": \"application/vnd.cncf.helm.config.v1+json\",\r\n    \"digest\": \"sha256:ca3d163bab055381827226140568f3bef7eaac187cebd76878e0b63e9e442356\",\r\n    \"size\": 3,\r\n    \"annotations\": {\r\n      \"apiVersion\": \"v1\",\r\n      \"appVersion\": \"5.2.2\",\r\n      \"description\": \"Web publishing platform for building blogs and websites.\",\r\n      \"engine\": \"gotpl\",\r\n      \"home\": \"http://www.wordpress.com/\",\r\n      \"icon\": \"https://bitnami.com/assets/stacks/wordpress/img/wordpress-stack-220x234.png\",\r\n      \"name\": \"wordpress\",\r\n      \"version\": \"7.0.1\"\r\n    }\r\n  },\r\n  \"layers\": [\r\n    {\r\n      \"mediaType\": \"application/vnd.cncf.helm.chart.readme.layer.v1+md\",\r\n      \"digest\": \"sha256:3c0bb73e83ded64c77c31eb853326c60c6f224a44dab4b6bbed132101d00a419\",\r\n      \"size\": 28481,\r\n      \"annotations\": {\r\n        \"org.opencontainers.image.title\": \"README.md\"\r\n      }\r\n    },\r\n    {\r\n      \"mediaType\": \"application/vnd.cncf.helm.chart.values.layer.v1+yaml\",\r\n      \"digest\": \"sha256:22fa5a9164970e9a86eeda82148348d02462570b4d9e4e57836e2073db0d208c\",\r\n      \"size\": 12555,\r\n      \"annotations\": {\r\n        \"org.opencontainers.image.title\": \"values.yaml\"\r\n      }\r\n    },\r\n    {\r\n      \"mediaType\": \"application/vnd.cncf.helm.chart.notes.layer.v1+txt\",\r\n      \"digest\": \"sha256:f3ff0f21d57595bb9ee3e8af66de48982a78d921a8789c81bcd2db5cd0307c7a\",\r\n      \"size\": 2442,\r\n      \"annotations\": {\r\n        \"org.opencontainers.image.title\": \"templates/NOTES.txt\"\r\n      }\r\n    },\r\n    {\r\n      \"mediaType\": \"application/vnd.cncf.helm.chart.helpers.layer.v1+tpl\",\r\n      \"digest\": \"sha256:57c052d50d68e53bcf4b8e8d54f33371ca45ef3ec659dbb5c84ea60141f427c9\",\r\n      \"size\": 4204,\r\n      \"annotations\": {\r\n        \"org.opencontainers.image.title\": \"templates/_helpers.tpl\"\r\n      }\r\n    },\r\n    {\r\n      \"mediaType\": \"application/vnd.cncf.helm.chart.template.layer.v1+yaml\",\r\n      \"digest\": \"sha256:669e2db698e355fd5126e3e1ddb0233a9ccb86e4ab85c192689be2bb21028266\",\r\n      \"size\": 7765,\r\n      \"annotations\": {\r\n        \"org.opencontainers.image.title\": \"templates/deployment.yaml\"\r\n      }\r\n    },\r\n    {\r\n      \"mediaType\": \"application/vnd.cncf.helm.chart.template.layer.v1+yaml\",\r\n      \"digest\": \"sha256:c03a2f4731c1426be994b8cb07b1507f67e283d40aeb653df5122b1b110c1f08\",\r\n      \"size\": 911,\r\n      \"annotations\": {\r\n        \"org.opencontainers.image.title\": \"templates/ingress.yaml\"\r\n      }\r\n    },\r\n    {\r\n      \"mediaType\": \"application/vnd.cncf.helm.chart.template.layer.v1+yaml\",\r\n      \"digest\": \"sha256:dbc0b9b9cad1360a83cf799cf943b6172dbc0627c9d56f84e39061d12007fc32\",\r\n      \"size\": 752,\r\n      \"annotations\": {\r\n        \"org.opencontainers.image.title\": \"templates/pvc.yaml\"\r\n      }\r\n    },\r\n    {\r\n      \"mediaType\": \"application/vnd.cncf.helm.chart.test.layer.v1+yaml\",\r\n      \"digest\": \"sha256:8fd048e1787d60d2eee4de5027a6ce5a10ae7ee4f38e91518738af5e210c34dd\",\r\n      \"size\": 1033,\r\n      \"annotations\": {\r\n        \"org.opencontainers.image.title\": \"templates/tests/test-mariadb-connection.yaml\"\r\n      }\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\nI'm not sure the best way to store dependent charts in `charts/` directory... I'm also not sure if nested annotations are supported (for things such as \"maintainers\" array). We can stringify/flatten if necessary.\r\n\r\n The alternative to all this is to store everything in a single layer, `application/vnd.cncf.helm.chart.content.layer.v1+tar` - but still push the meta into annotations.\r\n\r\nThe OPA project is also going in direction of storing individual bundle files as layers. Please see this issue for more details: https://github.com/open-policy-agent/opa/issues/1413\r\n\r\ncc @reasonerjt from Project Harbor - thoughts on this approach?",
  "closed_at": "2019-08-13T16:08:17Z",
  "closed_by": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/393494?v=4",
    "events_url": "https://api.github.com/users/jdolitsky/events{/privacy}",
    "followers_url": "https://api.github.com/users/jdolitsky/followers",
    "following_url": "https://api.github.com/users/jdolitsky/following{/other_user}",
    "gists_url": "https://api.github.com/users/jdolitsky/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/jdolitsky",
    "id": 393494,
    "login": "jdolitsky",
    "node_id": "MDQ6VXNlcjM5MzQ5NA==",
    "organizations_url": "https://api.github.com/users/jdolitsky/orgs",
    "received_events_url": "https://api.github.com/users/jdolitsky/received_events",
    "repos_url": "https://api.github.com/users/jdolitsky/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/jdolitsky/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jdolitsky/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/jdolitsky"
  },
  "comments": 12,
  "comments_url": "https://api.github.com/repos/helm/helm/issues/6141/comments",
  "created_at": "2019-08-01T15:20:31Z",
  "events_url": "https://api.github.com/repos/helm/helm/issues/6141/events",
  "html_url": "https://github.com/helm/helm/issues/6141",
  "id": 475744269,
  "labels": [
    {
      "color": "e82969",
      "default": false,
      "description": "Issues and Pull Requests related to the major version v3",
      "id": 926755770,
      "name": "v3.x",
      "node_id": "MDU6TGFiZWw5MjY3NTU3NzA=",
      "url": "https://api.github.com/repos/helm/helm/labels/v3.x"
    }
  ],
  "labels_url": "https://api.github.com/repos/helm/helm/issues/6141/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU0NzU3NDQyNjk=",
  "number": 6141,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/helm/helm",
  "state": "closed",
  "title": "Helm 3: OCI - Move metadata to manifest annotations, expand layers",
  "updated_at": "2019-08-13T16:08:18Z",
  "url": "https://api.github.com/repos/helm/helm/issues/6141",
  "user": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/393494?v=4",
    "events_url": "https://api.github.com/users/jdolitsky/events{/privacy}",
    "followers_url": "https://api.github.com/users/jdolitsky/followers",
    "following_url": "https://api.github.com/users/jdolitsky/following{/other_user}",
    "gists_url": "https://api.github.com/users/jdolitsky/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/jdolitsky",
    "id": 393494,
    "login": "jdolitsky",
    "node_id": "MDQ6VXNlcjM5MzQ5NA==",
    "organizations_url": "https://api.github.com/users/jdolitsky/orgs",
    "received_events_url": "https://api.github.com/users/jdolitsky/received_events",
    "repos_url": "https://api.github.com/users/jdolitsky/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/jdolitsky/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jdolitsky/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/jdolitsky"
  }
}