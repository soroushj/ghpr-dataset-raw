{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/1497123?v=4",
    "events_url": "https://api.github.com/users/michelleN/events{/privacy}",
    "followers_url": "https://api.github.com/users/michelleN/followers",
    "following_url": "https://api.github.com/users/michelleN/following{/other_user}",
    "gists_url": "https://api.github.com/users/michelleN/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/michelleN",
    "id": 1497123,
    "login": "michelleN",
    "node_id": "MDQ6VXNlcjE0OTcxMjM=",
    "organizations_url": "https://api.github.com/users/michelleN/orgs",
    "received_events_url": "https://api.github.com/users/michelleN/received_events",
    "repos_url": "https://api.github.com/users/michelleN/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/michelleN/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/michelleN/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/michelleN"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars0.githubusercontent.com/u/1497123?v=4",
      "events_url": "https://api.github.com/users/michelleN/events{/privacy}",
      "followers_url": "https://api.github.com/users/michelleN/followers",
      "following_url": "https://api.github.com/users/michelleN/following{/other_user}",
      "gists_url": "https://api.github.com/users/michelleN/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/michelleN",
      "id": 1497123,
      "login": "michelleN",
      "node_id": "MDQ6VXNlcjE0OTcxMjM=",
      "organizations_url": "https://api.github.com/users/michelleN/orgs",
      "received_events_url": "https://api.github.com/users/michelleN/received_events",
      "repos_url": "https://api.github.com/users/michelleN/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/michelleN/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michelleN/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/michelleN"
    }
  ],
  "author_association": "NONE",
  "body": "When there's a blank line at the top of the test pod yaml template, tiller crashes on 'helm test' run.\r\n\r\nHere's the problomatic (and rendered) yaml file:\r\n```\r\n(blank line)\r\n---\r\napiVersion: v1\r\nkind: Pod\r\nmetadata:\r\n  name: \"keystone-tempest-test\"\r\n  annotations:\r\n    \"helm.sh/hook\": test-success\r\nspec:\r\n  containers:\r\n...\r\n```\r\nIf I run 'helm test' command, the following error is shown.\r\n```\r\nroot@att-helm:~/workspace/openstack-helm# helm test keystone\r\nError: transport is closing\r\nroot@att-helm:~/workspace/openstack-helm# helm test keystone\r\nError: could not find a ready tiller pod\r\n```\r\nThe tiller pod log says:\r\n```\r\nroot@att-helm:~# kubectl logs tiller-deploy-3210613906-djz5c -n kube-system\r\nStarting Tiller v2.2.3\r\nGRPC listening on :44134\r\nProbes listening on :44135\r\nStorage driver is ConfigMap\r\n2017/03/22 07:22:15 storage.go:133: Getting release history for 'keystone'\r\npanic: runtime error: invalid memory address or nil pointer dereference\r\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x0 pc=0xd44c8a]\r\n\r\ngoroutine 46 [running]:\r\npanic(0x156c840, 0xc42000a030)\r\n\t/usr/local/go/src/runtime/panic.go:500 +0x1a1\r\nk8s.io/helm/pkg/releasetesting.newTest(0xc42044b400, 0x0, 0x4110f8, 0x40, 0x161d1e0)\r\n\t/home/ubuntu/.go_workspace/src/k8s.io/helm/pkg/releasetesting/test_suite.go:174 +0x11a\r\nk8s.io/helm/pkg/releasetesting.(*TestSuite).Run(0xc4203f9f40, 0xc420587b90, 0x0, 0x0)\r\n\t/home/ubuntu/.go_workspace/src/k8s.io/helm/pkg/releasetesting/test_suite.go:72 +0x9a\r\nk8s.io/helm/pkg/tiller.(*ReleaseServer).RunReleaseTest(0xc42021ad00, 0xc42040b8a0, 0x1ff05c0, 0xc4204082e0, 0x0, 0x18)\r\n\t/home/ubuntu/.go_workspace/src/k8s.io/helm/pkg/tiller/release_server.go:1100 +0x244\r\nk8s.io/helm/pkg/proto/hapi/services._ReleaseService_RunReleaseTest_Handler(0x16c8d20, 0xc42021ad00, 0x1fefcc0, 0xc420089440, 0xc4202becb8, 0x4110f8)\r\n\t/home/ubuntu/.go_workspace/src/k8s.io/helm/pkg/proto/hapi/services/tiller.pb.go:928 +0x117\r\nk8s.io/helm/pkg/tiller.newStreamInterceptor.func1(0x16c8d20, 0xc42021ad00, 0x1fefcc0, 0xc420089440, 0xc42040b840, 0x17e0aa0, 0xc4202d5400, 0x4111d8)\r\n\t/home/ubuntu/.go_workspace/src/k8s.io/helm/pkg/tiller/server.go:63 +0x112\r\nk8s.io/helm/vendor/google.golang.org/grpc.(*Server).processStreamingRPC(0xc4200d3080, 0x1ff0740, 0xc4200893b0, 0xc4200cb1d0, 0xc42043a720, 0x2035960, 0xc42029ff20, 0x0, 0x0)\r\n\t/home/ubuntu/.go_workspace/src/k8s.io/helm/vendor/google.golang.org/grpc/server.go:723 +0x2b6\r\nk8s.io/helm/vendor/google.golang.org/grpc.(*Server).handleStream(0xc4200d3080, 0x1ff0740, 0xc4200893b0, 0xc4200cb1d0, 0xc42029ff20)\r\n\t/home/ubuntu/.go_workspace/src/k8s.io/helm/vendor/google.golang.org/grpc/server.go:800 +0xc36\r\nk8s.io/helm/vendor/google.golang.org/grpc.(*Server).serveStreams.func1.1(0xc420408140, 0xc4200d3080, 0x1ff0740, 0xc4200893b0, 0xc4200cb1d0)\r\n\t/home/ubuntu/.go_workspace/src/k8s.io/helm/vendor/google.golang.org/grpc/server.go:449 +0xab\r\ncreated by k8s.io/helm/vendor/google.golang.org/grpc.(*Server).serveStreams.func1\r\n\t/home/ubuntu/.go_workspace/src/k8s.io/helm/vendor/google.golang.org/grpc/server.go:450 +0xa3\r\n```\r\n\r\nThis issue only takes place with 'helm test' command. \r\nIf I remove the '\"helm.sh/hook\": test-success' from the above yaml file so that the pod can be launched by 'helm install' command, it just worked fine without any error.\r\n\r\nTest Environment\r\n- Helm version: 2.2.3\r\n- OS: Ubuntu 16.04\r\n",
  "closed_at": "2017-05-02T19:17:48Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/1497123?v=4",
    "events_url": "https://api.github.com/users/michelleN/events{/privacy}",
    "followers_url": "https://api.github.com/users/michelleN/followers",
    "following_url": "https://api.github.com/users/michelleN/following{/other_user}",
    "gists_url": "https://api.github.com/users/michelleN/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/michelleN",
    "id": 1497123,
    "login": "michelleN",
    "node_id": "MDQ6VXNlcjE0OTcxMjM=",
    "organizations_url": "https://api.github.com/users/michelleN/orgs",
    "received_events_url": "https://api.github.com/users/michelleN/received_events",
    "repos_url": "https://api.github.com/users/michelleN/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/michelleN/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/michelleN/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/michelleN"
  },
  "comments": 5,
  "comments_url": "https://api.github.com/repos/helm/helm/issues/2158/comments",
  "created_at": "2017-03-22T07:50:58Z",
  "events_url": "https://api.github.com/repos/helm/helm/issues/2158/events",
  "html_url": "https://github.com/helm/helm/issues/2158",
  "id": 215979739,
  "labels": [],
  "labels_url": "https://api.github.com/repos/helm/helm/issues/2158/labels{/name}",
  "locked": false,
  "milestone": {
    "closed_at": "2017-05-02T22:39:47Z",
    "closed_issues": 42,
    "created_at": "2017-03-16T18:40:07Z",
    "creator": {
      "avatar_url": "https://avatars1.githubusercontent.com/u/89193?v=4",
      "events_url": "https://api.github.com/users/technosophos/events{/privacy}",
      "followers_url": "https://api.github.com/users/technosophos/followers",
      "following_url": "https://api.github.com/users/technosophos/following{/other_user}",
      "gists_url": "https://api.github.com/users/technosophos/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/technosophos",
      "id": 89193,
      "login": "technosophos",
      "node_id": "MDQ6VXNlcjg5MTkz",
      "organizations_url": "https://api.github.com/users/technosophos/orgs",
      "received_events_url": "https://api.github.com/users/technosophos/received_events",
      "repos_url": "https://api.github.com/users/technosophos/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/technosophos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/technosophos/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/technosophos"
    },
    "description": "The focus of this milestone is _reliability_, along with the migration to Kubernetes 1.6.",
    "due_on": "2017-05-01T07:00:00Z",
    "html_url": "https://github.com/helm/helm/milestone/34",
    "id": 2391560,
    "labels_url": "https://api.github.com/repos/helm/helm/milestones/34/labels",
    "node_id": "MDk6TWlsZXN0b25lMjM5MTU2MA==",
    "number": 34,
    "open_issues": 0,
    "state": "closed",
    "title": "2.4.0 - Features",
    "updated_at": "2017-05-02T22:39:47Z",
    "url": "https://api.github.com/repos/helm/helm/milestones/34"
  },
  "node_id": "MDU6SXNzdWUyMTU5Nzk3Mzk=",
  "number": 2158,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/helm/helm",
  "state": "closed",
  "title": "tiller crashes on 'helm test' run when there's blank line in test pod yaml",
  "updated_at": "2017-05-02T19:17:48Z",
  "url": "https://api.github.com/repos/helm/helm/issues/2158",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/2811509?v=4",
    "events_url": "https://api.github.com/users/robertchoi80/events{/privacy}",
    "followers_url": "https://api.github.com/users/robertchoi80/followers",
    "following_url": "https://api.github.com/users/robertchoi80/following{/other_user}",
    "gists_url": "https://api.github.com/users/robertchoi80/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/robertchoi80",
    "id": 2811509,
    "login": "robertchoi80",
    "node_id": "MDQ6VXNlcjI4MTE1MDk=",
    "organizations_url": "https://api.github.com/users/robertchoi80/orgs",
    "received_events_url": "https://api.github.com/users/robertchoi80/received_events",
    "repos_url": "https://api.github.com/users/robertchoi80/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/robertchoi80/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/robertchoi80/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/robertchoi80"
  }
}