{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "NONE",
  "body": "I have a fresh 1.9.6 Azure AKS cluster (one node). Ran a `helm init --upgrade --force-upgrade` against it to get it to 2.9.0, admittedly without checking whether there was a tiller on it before. I have set `KUBECONFIG` to the configuration file of this cluster, and made sure I can connect to it. Everything works, but `helm` does not, or better `helm version` works, but apparently nothing else.\r\n\r\nI have tried this with helm 2.9.0 (on macOS) and 2.8.2 (on Linux/in Docker), and both behave the same; so this may or may not be an issue with AKS, or with helm, or possibly both. The error messages come from tiller, so that's why I file an issue here: \r\n\r\n```\r\n$ kubectl version\r\nClient Version: version.Info{Major:\"1\", Minor:\"9\", GitVersion:\"v1.9.3\", GitCommit:\"d2835416544f298c919e2ead3be3d0864b52323b\", GitTreeState:\"clean\", BuildDate:\"2018-02-09T21:51:54Z\", GoVersion:\"go1.9.4\", Compiler:\"gc\", Platform:\"darwin/amd64\"}\r\nServer Version: version.Info{Major:\"1\", Minor:\"9\", GitVersion:\"v1.9.6\", GitCommit:\"9f8ebd171479bec0ada837d7ee641dec2f8c6dd1\", GitTreeState:\"clean\", BuildDate:\"2018-03-21T15:13:31Z\", GoVersion:\"go1.9.3\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\n\r\n$ helm version\r\nClient: &version.Version{SemVer:\"v2.9.0\", GitCommit:\"f6025bb9ee7daf9fee0026541c90a6f557a3e0bc\", GitTreeState:\"clean\"}\r\nServer: &version.Version{SemVer:\"v2.9.0\", GitCommit:\"f6025bb9ee7daf9fee0026541c90a6f557a3e0bc\", GitTreeState:\"clean\"}\r\n\r\n$ helm ls\r\nError: Get http://localhost:8080/api/v1/namespaces/kube-system/configmaps?labelSelector=OWNER%!D(MISSING)TILLER: dial tcp [::1]:8080: connect: connection refused\r\n```\r\n\r\nChecking logs:\r\n\r\n```\r\n$ kubectl logs -n kube-system tiller-deploy-f7bd48bf-tfk8p \r\n[main] 2018/04/27 14:26:58 Starting Tiller v2.9.0 (tls=false)\r\n[main] 2018/04/27 14:26:58 GRPC listening on :44134\r\n[main] 2018/04/27 14:26:58 Probes listening on :44135\r\n[main] 2018/04/27 14:26:58 Storage driver is ConfigMap\r\n[main] 2018/04/27 14:26:58 Max history per release is 0\r\n[storage] 2018/04/27 14:27:36 listing all releases with filter\r\n[storage/driver] 2018/04/27 14:27:36 list: failed to list: Get http://localhost:8080/api/v1/namespaces/kube-system/configmaps?labelSelector=OWNER%3DTILLER: dial tcp [::1]:8080: connect: connection refused\r\n```\r\n\r\nAnd the env vars:\r\n\r\n```\r\n$ kubectl exec -n kube-system tiller-deploy-f7bd48bf-tfk8p -- env\r\nPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\r\nHOSTNAME=tiller-deploy-f7bd48bf-tfk8p\r\nTILLER_NAMESPACE=kube-system\r\nTILLER_HISTORY_MAX=0\r\nKUBERNETES_DASHBOARD_SERVICE_HOST=10.0.88.104\r\nKUBERNETES_DASHBOARD_SERVICE_PORT=80\r\nKUBERNETES_DASHBOARD_PORT=tcp://10.0.88.104:80\r\nKUBE_DNS_PORT_53_UDP_ADDR=10.0.0.10\r\nKUBERNETES_SERVICE_PORT_HTTPS=443\r\nHEAPSTER_SERVICE_HOST=10.0.52.123\r\nHEAPSTER_PORT_80_TCP_ADDR=10.0.52.123\r\nKUBE_DNS_PORT=udp://10.0.0.10:53\r\nKUBE_DNS_PORT_53_TCP=tcp://10.0.0.10:53\r\nTILLER_DEPLOY_PORT_44134_TCP=tcp://10.0.239.195:44134\r\nKUBE_DNS_SERVICE_PORT=53\r\nKUBE_DNS_PORT_53_UDP=udp://10.0.0.10:53\r\nKUBERNETES_DASHBOARD_PORT_80_TCP_ADDR=10.0.88.104\r\nKUBERNETES_SERVICE_PORT=443\r\nHEAPSTER_SERVICE_PORT=80\r\nHEAPSTER_PORT_80_TCP_PORT=80\r\nKUBE_DNS_SERVICE_HOST=10.0.0.10\r\nKUBE_DNS_PORT_53_TCP_PROTO=tcp\r\nTILLER_DEPLOY_PORT_44134_TCP_ADDR=10.0.239.195\r\nTILLER_DEPLOY_PORT_44134_TCP_PORT=44134\r\nKUBERNETES_PORT_443_TCP=tcp://10.0.0.1:443\r\nHEAPSTER_PORT_80_TCP_PROTO=tcp\r\nKUBE_DNS_SERVICE_PORT_DNS=53\r\nKUBE_DNS_PORT_53_UDP_PORT=53\r\nKUBE_DNS_PORT_53_TCP_ADDR=10.0.0.10\r\nTILLER_DEPLOY_PORT_44134_TCP_PROTO=tcp\r\nKUBERNETES_PORT_443_TCP_PROTO=tcp\r\nKUBERNETES_PORT_443_TCP_PORT=443\r\nHEAPSTER_PORT=tcp://10.0.52.123:80\r\nHEAPSTER_PORT_80_TCP=tcp://10.0.52.123:80\r\nKUBE_DNS_PORT_53_TCP_PORT=53\r\nKUBERNETES_DASHBOARD_PORT_80_TCP=tcp://10.0.88.104:80\r\nKUBERNETES_DASHBOARD_PORT_80_TCP_PORT=80\r\nTILLER_DEPLOY_PORT=tcp://10.0.239.195:44134\r\nTILLER_DEPLOY_SERVICE_PORT_TILLER=44134\r\nKUBERNETES_SERVICE_HOST=10.0.0.1\r\nKUBE_DNS_SERVICE_PORT_DNS_TCP=53\r\nKUBERNETES_DASHBOARD_PORT_80_TCP_PROTO=tcp\r\nTILLER_DEPLOY_SERVICE_PORT=44134\r\nKUBERNETES_PORT=tcp://10.0.0.1:443\r\nKUBERNETES_PORT_443_TCP_ADDR=10.0.0.1\r\nKUBE_DNS_PORT_53_UDP_PROTO=udp\r\nTILLER_DEPLOY_SERVICE_HOST=10.0.239.195\r\nHOME=/tmp\r\n```\r\n\r\nIdeas? This felt like a very vanilla use case.",
  "closed_at": "2018-04-30T12:53:07Z",
  "closed_by": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/1360539?v=4",
    "events_url": "https://api.github.com/users/bacongobbler/events{/privacy}",
    "followers_url": "https://api.github.com/users/bacongobbler/followers",
    "following_url": "https://api.github.com/users/bacongobbler/following{/other_user}",
    "gists_url": "https://api.github.com/users/bacongobbler/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/bacongobbler",
    "id": 1360539,
    "login": "bacongobbler",
    "node_id": "MDQ6VXNlcjEzNjA1Mzk=",
    "organizations_url": "https://api.github.com/users/bacongobbler/orgs",
    "received_events_url": "https://api.github.com/users/bacongobbler/received_events",
    "repos_url": "https://api.github.com/users/bacongobbler/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/bacongobbler/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bacongobbler/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/bacongobbler"
  },
  "comments": 12,
  "comments_url": "https://api.github.com/repos/helm/helm/issues/3985/comments",
  "created_at": "2018-04-27T14:34:27Z",
  "events_url": "https://api.github.com/repos/helm/helm/issues/3985/events",
  "html_url": "https://github.com/helm/helm/issues/3985",
  "id": 318433044,
  "labels": [
    {
      "color": "cc317c",
      "default": false,
      "description": null,
      "id": 269212356,
      "name": "question/support",
      "node_id": "MDU6TGFiZWwyNjkyMTIzNTY=",
      "url": "https://api.github.com/repos/helm/helm/labels/question/support"
    }
  ],
  "labels_url": "https://api.github.com/repos/helm/helm/issues/3985/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUzMTg0MzMwNDQ=",
  "number": 3985,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/helm/helm",
  "state": "closed",
  "title": "Cannot connect to tiller using helm v2.9.0: Error: Get http://localhost:8080/api/v1/namespaces/kube-system/configmaps?labelSelector=OWNER%!D(MISSING)TILLER: dial tcp [::1]:8080: connect: connection refused",
  "updated_at": "2018-07-18T19:43:50Z",
  "url": "https://api.github.com/repos/helm/helm/issues/3985",
  "user": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/7326883?v=4",
    "events_url": "https://api.github.com/users/DonMartin76/events{/privacy}",
    "followers_url": "https://api.github.com/users/DonMartin76/followers",
    "following_url": "https://api.github.com/users/DonMartin76/following{/other_user}",
    "gists_url": "https://api.github.com/users/DonMartin76/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/DonMartin76",
    "id": 7326883,
    "login": "DonMartin76",
    "node_id": "MDQ6VXNlcjczMjY4ODM=",
    "organizations_url": "https://api.github.com/users/DonMartin76/orgs",
    "received_events_url": "https://api.github.com/users/DonMartin76/received_events",
    "repos_url": "https://api.github.com/users/DonMartin76/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/DonMartin76/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/DonMartin76/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/DonMartin76"
  }
}