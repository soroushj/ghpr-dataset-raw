{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/4294228?v=4",
    "events_url": "https://api.github.com/users/thomastaylor312/events{/privacy}",
    "followers_url": "https://api.github.com/users/thomastaylor312/followers",
    "following_url": "https://api.github.com/users/thomastaylor312/following{/other_user}",
    "gists_url": "https://api.github.com/users/thomastaylor312/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/thomastaylor312",
    "id": 4294228,
    "login": "thomastaylor312",
    "node_id": "MDQ6VXNlcjQyOTQyMjg=",
    "organizations_url": "https://api.github.com/users/thomastaylor312/orgs",
    "received_events_url": "https://api.github.com/users/thomastaylor312/received_events",
    "repos_url": "https://api.github.com/users/thomastaylor312/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/thomastaylor312/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/thomastaylor312/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/thomastaylor312"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars2.githubusercontent.com/u/4294228?v=4",
      "events_url": "https://api.github.com/users/thomastaylor312/events{/privacy}",
      "followers_url": "https://api.github.com/users/thomastaylor312/followers",
      "following_url": "https://api.github.com/users/thomastaylor312/following{/other_user}",
      "gists_url": "https://api.github.com/users/thomastaylor312/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/thomastaylor312",
      "id": 4294228,
      "login": "thomastaylor312",
      "node_id": "MDQ6VXNlcjQyOTQyMjg=",
      "organizations_url": "https://api.github.com/users/thomastaylor312/orgs",
      "received_events_url": "https://api.github.com/users/thomastaylor312/received_events",
      "repos_url": "https://api.github.com/users/thomastaylor312/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/thomastaylor312/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thomastaylor312/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/thomastaylor312"
    }
  ],
  "author_association": "NONE",
  "body": "After upgrading helm/tiller to latest version 2.2.1 , tiller started to crash whenever an existing deployment with the same chart gets deployed using the --wait option.\r\n\r\n$ helm version\r\nClient: &version.Version{SemVer:\"v2.2.1\", GitCommit:\"db531fd75fb2a1fb0841a98d9e55c58c21f70f4c\", GitTreeState:\"clean\"}\r\nServer: &version.Version{SemVer:\"v2.2.1\", GitCommit:\"db531fd75fb2a1fb0841a98d9e55c58c21f70f4c\", GitTreeState:\"clean\"}\r\n\r\nSteps to reproduce:\r\n\r\n1) create a new chart and deploy  (this works)\r\nhelm install -n my-test nginx-my-0.1.1.tgz --wait --debug --timeout 60\r\n\r\n2) upgrade / rollback same version\r\nhelm upgrade my-test nginx-my-0.1.1.tgz --wait --debug --timeout 30\r\noutput:\r\nCreated tunnel using local port: '65109'\r\nSERVER: \"localhost:65109\"\r\nError: UPGRADE FAILED: transport is closing\r\n\r\n### container crashed\r\n$ helm version\r\nClient: &version.Version{SemVer:\"v2.2.1\", GitCommit:\"db531fd75fb2a1fb0841a98d9e55c58c21f70f4c\", GitTreeState:\"clean\"}\r\nError: cannot connect to Tiller\r\n\r\nAfter that the pod just crashed and it recovers, or some times I had to kill the pod manually to get it back.\r\n\r\nDo you think this is something that will be fix soon, or how long it will take to get the fix out there, I would like to have an estimate to relay in this new option. \r\nThank you!\r\n\r\n\r\n-------------\r\nTiller pod logs:\r\n\r\n2017/02/28 21:34:48 storage.go:133: Getting release history for 'my-test'\r\n2017/02/28 21:34:48 release_server.go:533: rolling back my-test (current: v2, target: v1)\r\n2017/02/28 21:34:48 storage.go:37: Getting release \"my-test\" (v1) from storage\r\n2017/02/28 21:34:48 release_server.go:913: Executing pre-rollback hooks for my-test\r\n2017/02/28 21:34:48 release_server.go:940: Hooks complete for pre-rollback my-test\r\n2017/02/28 21:34:48 client.go:393: Looks like there are no changes for nginx-my-deployment\r\n2017/02/28 21:34:48 client.go:560: beginning wait for resources with timeout of 5m0s\r\npanic: runtime error: invalid memory address or nil pointer dereference\r\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x0 pc=0x54b973]\r\n\r\ngoroutine 105 [running]:\r\npanic(0x156c840, 0xc42000a040)\r\n\t/usr/local/go/src/runtime/panic.go:500 +0x1a1\r\nk8s.io/helm/pkg/kube.(*Client).waitForResources.func1(0x14ce080, 0xc4207e4c60, 0xc420a5d5a7)\r\n\t/home/ubuntu/.go_workspace/src/k8s.io/helm/pkg/kube/client.go:588 +0xe63\r\nk8s.io/helm/vendor/k8s.io/kubernetes/pkg/util/wait.WaitFor(0xc420a2eee0, 0xc42091bb00, 0xc42006db00, 0x15daa00, 0xc420a2eee0)\r\n\t/home/ubuntu/.go_workspace/src/k8s.io/helm/vendor/k8s.io/kubernetes/pkg/util/wait/wait.go:271 +0x70\r\nk8s.io/helm/vendor/k8s.io/kubernetes/pkg/util/wait.pollInternal(0xc420a2eee0, 0xc42091bb00, 0xc420a2eee0, 0xc42091bb00)\r\n\t/home/ubuntu/.go_workspace/src/k8s.io/helm/vendor/k8s.io/kubernetes/pkg/util/wait/wait.go:187 +0x41\r\nk8s.io/helm/vendor/k8s.io/kubernetes/pkg/util/wait.Poll(0x77359400, 0x45d964b800, 0xc42091bb00, 0x0, 0x1)\r\n\t/home/ubuntu/.go_workspace/src/k8s.io/helm/vendor/k8s.io/kubernetes/pkg/util/wait/wait.go:183 +0x4d\r\nk8s.io/helm/pkg/kube.(*Client).waitForResources(0xc420435660, 0x45d964b800, 0xc4209ab408, 0x1, 0x1, 0x1, 0x0)\r\n\t/home/ubuntu/.go_workspace/src/k8s.io/helm/pkg/kube/client.go:633 +0x167\r\nk8s.io/helm/pkg/kube.(*Client).Update(0xc420435660, 0xc4203703e0, 0x1a, 0x1fd6d40, 0xc420245030, 0x1fd6d40, 0xc4202450a0, 0xc420176000, 0x12c, 0x1, ...)\r\n\t/home/ubuntu/.go_workspace/src/k8s.io/helm/pkg/kube/client.go:267 +0x4cb\r\nk8s.io/helm/pkg/tiller.(*ReleaseServer).performKubeUpdate(0xc4202e6020, 0xc420244bd0, 0xc420244fc0, 0x0, 0x12c, 0x1, 0xc4203703e0, 0x1a)\r\n\t/home/ubuntu/.go_workspace/src/k8s.io/helm/pkg/tiller/release_server.go:510 +0x22a\r\nk8s.io/helm/pkg/tiller.(*ReleaseServer).performRollback(0xc4202e6020, 0xc420244bd0, 0xc420244fc0, 0xc42012e5a0, 0x0, 0x0, 0x6)\r\n\t/home/ubuntu/.go_workspace/src/k8s.io/helm/pkg/tiller/release_server.go:480 +0x181\r\nk8s.io/helm/pkg/tiller.(*ReleaseServer).RollbackRelease(0xc4202e6020, 0x7fa9960e7ce8, 0xc42012e540, 0xc42012e5a0, 0x1ff0740, 0x18, 0x18)\r\n\t/home/ubuntu/.go_workspace/src/k8s.io/helm/pkg/tiller/release_server.go:451 +0x7d\r\nk8s.io/helm/pkg/proto/hapi/services._ReleaseService_RollbackRelease_Handler.func1(0x7fa9960e7ce8, 0xc42012e540, 0x15b09a0, 0xc42012e5a0, 0xc420266340, 0xc42043e400, 0xc420335a90, 0x4110f8)\r\n\t/home/ubuntu/.go_workspace/src/k8s.io/helm/pkg/proto/hapi/services/tiller.pb.go:900 +0xa2\r\nk8s.io/helm/pkg/tiller.newUnaryInterceptor.func1(0x7fa9960e7ce8, 0xc42012e540, 0x15b09a0, 0xc42012e5a0, 0xc4202e7420, 0xc4202e7440, 0x15, 0xc420583b38, 0x0, 0xc420583b28)\r\n\t/home/ubuntu/.go_workspace/src/k8s.io/helm/pkg/tiller/server.go:53 +0x18c\r\nk8s.io/helm/pkg/proto/hapi/services._ReleaseService_RollbackRelease_Handler(0x16c8d20, 0xc4202e6020, 0x7fa9960e7ce8, 0xc42012e540, 0xc420529770, 0x17e0a98, 0x0, 0x0, 0x2, 0x0)\r\n\t/home/ubuntu/.go_workspace/src/k8s.io/helm/pkg/proto/hapi/services/tiller.pb.go:902 +0x166\r\nk8s.io/helm/vendor/google.golang.org/grpc.(*Server).processUnaryRPC(0xc420266300, 0x1ff0740, 0xc42037c120, 0xc4203f03c0, 0xc4203ae450, 0x2037650, 0xc42012e4e0, 0x0, 0x0)\r\n\t/home/ubuntu/.go_workspace/src/k8s.io/helm/vendor/google.golang.org/grpc/server.go:638 +0xc14\r\nk8s.io/helm/vendor/google.golang.org/grpc.(*Server).handleStream(0xc420266300, 0x1ff0740, 0xc42037c120, 0xc4203f03c0, 0xc42012e4e0)\r\n\t/home/ubuntu/.go_workspace/src/k8s.io/helm/vendor/google.golang.org/grpc/server.go:796 +0x6b0\r\nk8s.io/helm/vendor/google.golang.org/grpc.(*Server).serveStreams.func1.1(0xc42043e300, 0xc420266300, 0x1ff0740, 0xc42037c120, 0xc4203f03c0)\r\n\t/home/ubuntu/.go_workspace/src/k8s.io/helm/vendor/google.golang.org/grpc/server.go:449 +0xab\r\ncreated by k8s.io/helm/vendor/google.golang.org/grpc.(*Server).serveStreams.func1\r\n\t/home/ubuntu/.go_workspace/src/k8s.io/helm/vendor/google.golang.org/grpc/server.go:450 +0xa3",
  "closed_at": "2017-03-02T23:56:35Z",
  "closed_by": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/4294228?v=4",
    "events_url": "https://api.github.com/users/thomastaylor312/events{/privacy}",
    "followers_url": "https://api.github.com/users/thomastaylor312/followers",
    "following_url": "https://api.github.com/users/thomastaylor312/following{/other_user}",
    "gists_url": "https://api.github.com/users/thomastaylor312/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/thomastaylor312",
    "id": 4294228,
    "login": "thomastaylor312",
    "node_id": "MDQ6VXNlcjQyOTQyMjg=",
    "organizations_url": "https://api.github.com/users/thomastaylor312/orgs",
    "received_events_url": "https://api.github.com/users/thomastaylor312/received_events",
    "repos_url": "https://api.github.com/users/thomastaylor312/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/thomastaylor312/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/thomastaylor312/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/thomastaylor312"
  },
  "comments": 5,
  "comments_url": "https://api.github.com/repos/helm/helm/issues/2043/comments",
  "created_at": "2017-02-28T22:05:27Z",
  "events_url": "https://api.github.com/repos/helm/helm/issues/2043/events",
  "html_url": "https://github.com/helm/helm/issues/2043",
  "id": 210915631,
  "labels": [],
  "labels_url": "https://api.github.com/repos/helm/helm/issues/2043/labels{/name}",
  "locked": false,
  "milestone": {
    "closed_at": "2017-03-09T19:35:12Z",
    "closed_issues": 2,
    "created_at": "2017-02-23T22:56:54Z",
    "creator": {
      "avatar_url": "https://avatars1.githubusercontent.com/u/89193?v=4",
      "events_url": "https://api.github.com/users/technosophos/events{/privacy}",
      "followers_url": "https://api.github.com/users/technosophos/followers",
      "following_url": "https://api.github.com/users/technosophos/following{/other_user}",
      "gists_url": "https://api.github.com/users/technosophos/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/technosophos",
      "id": 89193,
      "login": "technosophos",
      "node_id": "MDQ6VXNlcjg5MTkz",
      "organizations_url": "https://api.github.com/users/technosophos/orgs",
      "received_events_url": "https://api.github.com/users/technosophos/received_events",
      "repos_url": "https://api.github.com/users/technosophos/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/technosophos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/technosophos/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/technosophos"
    },
    "description": "Patch release on the `release-2.2` branch",
    "due_on": null,
    "html_url": "https://github.com/helm/helm/milestone/32",
    "id": 2344555,
    "labels_url": "https://api.github.com/repos/helm/helm/milestones/32/labels",
    "node_id": "MDk6TWlsZXN0b25lMjM0NDU1NQ==",
    "number": 32,
    "open_issues": 0,
    "state": "closed",
    "title": "2.2.2",
    "updated_at": "2017-03-09T19:35:12Z",
    "url": "https://api.github.com/repos/helm/helm/milestones/32"
  },
  "node_id": "MDU6SXNzdWUyMTA5MTU2MzE=",
  "number": 2043,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/helm/helm",
  "state": "closed",
  "title": "helm --wait option crash tiller server when deploying same chart.",
  "updated_at": "2017-05-18T18:27:53Z",
  "url": "https://api.github.com/repos/helm/helm/issues/2043",
  "user": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/217191?v=4",
    "events_url": "https://api.github.com/users/gerardo8a/events{/privacy}",
    "followers_url": "https://api.github.com/users/gerardo8a/followers",
    "following_url": "https://api.github.com/users/gerardo8a/following{/other_user}",
    "gists_url": "https://api.github.com/users/gerardo8a/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/gerardo8a",
    "id": 217191,
    "login": "gerardo8a",
    "node_id": "MDQ6VXNlcjIxNzE5MQ==",
    "organizations_url": "https://api.github.com/users/gerardo8a/orgs",
    "received_events_url": "https://api.github.com/users/gerardo8a/received_events",
    "repos_url": "https://api.github.com/users/gerardo8a/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/gerardo8a/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gerardo8a/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/gerardo8a"
  }
}