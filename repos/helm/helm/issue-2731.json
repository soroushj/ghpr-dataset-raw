{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "NONE",
  "body": "if there is no change in `requirements.yaml` file but SemVar results into different lock file, `helm dep up` does not replace and existing `requirements.lock` because `requirements.yaml` digest has not changed.\r\n\r\nHow to reproduce:\r\n\r\nWe have the following `requirements.yaml` file for a chart `parent1`.\r\n\r\n```\r\ndependencies:\r\n- name: child1\r\n  version: \">=1.0.0\"\r\n  repository: \"http://127.0.0.1:8879/\"\r\n- name: child2\r\n  version: \">=1.0.0\"\r\n  repository: \"http://127.0.0.1:8879/\"\r\n```\r\n\r\nWhen we run dep up for the first time it generates following lock file (assuming that we have `child1-1.0.0` and `child2-1.0.0` charts at that point)\r\n\r\n```\r\ndependencies:\r\n- name: child1\r\n  repository: http://127.0.0.1:8879/\r\n  version: 1.0.0\r\n- name: child2\r\n  repository: http://127.0.0.1:8879/\r\n  version: 1.0.0\r\ndigest: sha256:19b7f91a0fdfc44e14a86e7b3bbfbce2014e063bdc5949c2ad6a5edb113c3b77\r\ngenerated: 2017-07-27T12:00:08.036838191+05:30\r\n\r\n```\r\n\r\nNow if we release a new version of `child1` (say 1.1.0) we don't need to update our `requirements.yaml` file but we expect `helm dep up` to update `requirements.lock` file accordingly. \r\n\r\nInstead, `helm dep up` updates `/charts` folder with `child1-1.1.0` but does not update `requirements.lock` file on disk.\r\n\r\nWhen we looked into code, we figured that `requirements.lock` only get updated if `requirements.yaml` gets changed. \r\n\r\n```\r\n// Hash requirements.yaml\r\nhash, err := resolver.HashReq(req)\r\nif err != nil {\r\n         return err\r\n}\r\n\r\n// Now we need to find out which version of a chart best satisfies the\r\n// requirements the requirements.yaml\r\nlock, err := m.resolve(req, repoNames, hash)\r\nif err != nil {\r\n\treturn err\r\n}\r\n\r\n// If the lock file hasn't changed, don't write a new one.\r\noldLock, err := chartutil.LoadRequirementsLock(c)\r\nif err == nil && oldLock.Digest == lock.Digest {\r\n\treturn nil\r\n}\r\n```\r\n\r\nThis results into inconsistent state of having different charts in `/charts` directory and `requirements.lock` file. Only work around, currently, is to delete `requirements.lock` file when we do `helm dep up`\r\n\r\n",
  "closed_at": "2019-06-26T16:25:10Z",
  "closed_by": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/1360539?v=4",
    "events_url": "https://api.github.com/users/bacongobbler/events{/privacy}",
    "followers_url": "https://api.github.com/users/bacongobbler/followers",
    "following_url": "https://api.github.com/users/bacongobbler/following{/other_user}",
    "gists_url": "https://api.github.com/users/bacongobbler/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/bacongobbler",
    "id": 1360539,
    "login": "bacongobbler",
    "node_id": "MDQ6VXNlcjEzNjA1Mzk=",
    "organizations_url": "https://api.github.com/users/bacongobbler/orgs",
    "received_events_url": "https://api.github.com/users/bacongobbler/received_events",
    "repos_url": "https://api.github.com/users/bacongobbler/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/bacongobbler/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bacongobbler/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/bacongobbler"
  },
  "comments": 15,
  "comments_url": "https://api.github.com/repos/helm/helm/issues/2731/comments",
  "created_at": "2017-07-27T06:55:36Z",
  "events_url": "https://api.github.com/repos/helm/helm/issues/2731/events",
  "html_url": "https://github.com/helm/helm/issues/2731",
  "id": 245942946,
  "labels": [
    {
      "color": "cc317c",
      "default": false,
      "description": null,
      "id": 269212356,
      "name": "question/support",
      "node_id": "MDU6TGFiZWwyNjkyMTIzNTY=",
      "url": "https://api.github.com/repos/helm/helm/labels/question/support"
    }
  ],
  "labels_url": "https://api.github.com/repos/helm/helm/issues/2731/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUyNDU5NDI5NDY=",
  "number": 2731,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/helm/helm",
  "state": "closed",
  "title": "requirements.lock does not get updated on helm dep up",
  "updated_at": "2019-06-26T16:25:11Z",
  "url": "https://api.github.com/repos/helm/helm/issues/2731",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/8530966?v=4",
    "events_url": "https://api.github.com/users/azazi-sa/events{/privacy}",
    "followers_url": "https://api.github.com/users/azazi-sa/followers",
    "following_url": "https://api.github.com/users/azazi-sa/following{/other_user}",
    "gists_url": "https://api.github.com/users/azazi-sa/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/azazi-sa",
    "id": 8530966,
    "login": "azazi-sa",
    "node_id": "MDQ6VXNlcjg1MzA5NjY=",
    "organizations_url": "https://api.github.com/users/azazi-sa/orgs",
    "received_events_url": "https://api.github.com/users/azazi-sa/received_events",
    "repos_url": "https://api.github.com/users/azazi-sa/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/azazi-sa/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/azazi-sa/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/azazi-sa"
  }
}