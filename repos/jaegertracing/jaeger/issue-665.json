{
  "active_lock_reason": null,
  "assignee": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/5618424?v=4",
    "events_url": "https://api.github.com/users/pavolloffay/events{/privacy}",
    "followers_url": "https://api.github.com/users/pavolloffay/followers",
    "following_url": "https://api.github.com/users/pavolloffay/following{/other_user}",
    "gists_url": "https://api.github.com/users/pavolloffay/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/pavolloffay",
    "id": 5618424,
    "login": "pavolloffay",
    "node_id": "MDQ6VXNlcjU2MTg0MjQ=",
    "organizations_url": "https://api.github.com/users/pavolloffay/orgs",
    "received_events_url": "https://api.github.com/users/pavolloffay/received_events",
    "repos_url": "https://api.github.com/users/pavolloffay/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/pavolloffay/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/pavolloffay/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/pavolloffay"
  },
  "assignees": [
    {
      "avatar_url": "https://avatars0.githubusercontent.com/u/5618424?v=4",
      "events_url": "https://api.github.com/users/pavolloffay/events{/privacy}",
      "followers_url": "https://api.github.com/users/pavolloffay/followers",
      "following_url": "https://api.github.com/users/pavolloffay/following{/other_user}",
      "gists_url": "https://api.github.com/users/pavolloffay/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/pavolloffay",
      "id": 5618424,
      "login": "pavolloffay",
      "node_id": "MDQ6VXNlcjU2MTg0MjQ=",
      "organizations_url": "https://api.github.com/users/pavolloffay/orgs",
      "received_events_url": "https://api.github.com/users/pavolloffay/received_events",
      "repos_url": "https://api.github.com/users/pavolloffay/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/pavolloffay/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pavolloffay/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/pavolloffay"
    }
  ],
  "author_association": "MEMBER",
  "body": "While running a simple performance test and using ElasticSearch as storage I a number of \"failed to create index\" errors on the collector\r\n\r\nI did the following:\r\n-- Download elasticsearch 6.1.2 from https://www.elastic.co/downloads/elasticsearch and ran ./bin/elasticsearch\r\n-- Ran the collector with: SPAN_STORAGE_TYPE=elasticsearch go run ./cmd/collector/main.go --collector.queue-size=3000000 --es.bulk.size=10000000 --es.bulk.workers=10 --es.bulk.flush-interval=1s \r\n-- git clone git@github.com:Hawkular-QE/jaeger-standalone-performance-tests.git\r\n-- DELAY=10 THREAD_COUNT=10 ELASTICSEARCH_HOST=localhost SPAN_STORAGE_TYPE=elasticsearch USE_AGENT_OR_COLLECTOR=collector DURATION_IN_MINUTES=1 mvn clean -Dtest=SimpleTest#createTracesTest test\r\n\r\nIn one particular case the test failed as it created 59040 spans but only found 58943 in elasticsearch.  For each of the missing spans the collector produced a pair of the following error messages.\r\n\r\n`{\"level\":\"error\",\"ts\":1516890288.1260505,\"caller\":\"spanstore/writer.go:190\",\"msg\":\"Failed to create index\",\"trace_id\":\"b36e3fa8b97bb7c6\",\"span_id\":\"b36e3fa8b97bb7c6\",\"error\":\"elastic: Error 400 (Bad Request): index [jaeger-span-2018-01-25/xcVS2i4VQh6fZ8LsytrXgw] already exists [type=resource_already_exists_exception]\",\"stacktrace\":\"github.com/jaegertracing/jaeger/plugin/storage/es/spanstore.(*SpanWriter).logError\\n\\t/home/kearls/go/src/github.com/jaegertracing/jaeger/plugin/storage/es/spanstore/writer.go:190\\ngithub.com/jaegertracing/jaeger/plugin/storage/es/spanstore.(*SpanWriter).createIndex\\n\\t/home/kearls/go/src/github.com/jaegertracing/jaeger/plugin/storage/es/spanstore/writer.go:152\\ngithub.com/jaegertracing/jaeger/plugin/storage/es/spanstore.(*SpanWriter).WriteSpan\\n\\t/home/kearls/go/src/github.com/jaegertracing/jaeger/plugin/storage/es/spanstore/writer.go:123\\ngithub.com/jaegertracing/jaeger/cmd/collector/app.(*spanProcessor).saveSpan\\n\\t/home/kearls/go/src/github.com/jaegertracing/jaeger/cmd/collector/app/span_processor.go:102\\ngithub.com/jaegertracing/jaeger/cmd/collector/app.(*spanProcessor).(github.com/jaegertracing/jaeger/cmd/collector/app.saveSpan)-fm\\n\\t/home/kearls/go/src/github.com/jaegertracing/jaeger/cmd/collector/app/span_processor.go:89\\ngithub.com/jaegertracing/jaeger/cmd/collector/app.ChainedProcessSpan.func1\\n\\t/home/kearls/go/src/github.com/jaegertracing/jaeger/cmd/collector/app/model_consumer.go:32\\ngithub.com/jaegertracing/jaeger/cmd/collector/app.(*spanProcessor).processItemFromQueue\\n\\t/home/kearls/go/src/github.com/jaegertracing/jaeger/cmd/collector/app/span_processor.go:126\\ngithub.com/jaegertracing/jaeger/cmd/collector/app.NewSpanProcessor.func1\\n\\t/home/kearls/go/src/github.com/jaegertracing/jaeger/cmd/collector/app/span_processor.go:57\\ngithub.com/jaegertracing/jaeger/pkg/queue.(*BoundedQueue).StartConsumers.func1\\n\\t/home/kearls/go/src/github.com/jaegertracing/jaeger/pkg/queue/bounded_queue.go:65\"}\r\n{\"level\":\"error\",\"ts\":1516890288.1261024,\"caller\":\"app/span_processor.go:103\",\"msg\":\"Failed to save span\",\"error\":\"Failed to create index: elastic: Error 400 (Bad Request): index [jaeger-span-2018-01-25/xcVS2i4VQh6fZ8LsytrXgw] already exists [type=resource_already_exists_exception]\",\"errorVerbose\":\"elastic: Error 400 (Bad Request): index [jaeger-span-2018-01-25/xcVS2i4VQh6fZ8LsytrXgw] already exists [type=resource_already_exists_exception]\\nFailed to create index\\ngithub.com/jaegertracing/jaeger/plugin/storage/es/spanstore.(*SpanWriter).logError\\n\\t/home/kearls/go/src/github.com/jaegertracing/jaeger/plugin/storage/es/spanstore/writer.go:191\\ngithub.com/jaegertracing/jaeger/plugin/storage/es/spanstore.(*SpanWriter).createIndex\\n\\t/home/kearls/go/src/github.com/jaegertracing/jaeger/plugin/storage/es/spanstore/writer.go:152\\ngithub.com/jaegertracing/jaeger/plugin/storage/es/spanstore.(*SpanWriter).WriteSpan\\n\\t/home/kearls/go/src/github.com/jaegertracing/jaeger/plugin/storage/es/spanstore/writer.go:123\\ngithub.com/jaegertracing/jaeger/cmd/collector/app.(*spanProcessor).saveSpan\\n\\t/home/kearls/go/src/github.com/jaegertracing/jaeger/cmd/collector/app/span_processor.go:102\\ngithub.com/jaegertracing/jaeger/cmd/collector/app.(*spanProcessor).(github.com/jaegertracing/jaeger/cmd/collector/app.saveSpan)-fm\\n\\t/home/kearls/go/src/github.com/jaegertracing/jaeger/cmd/collector/app/span_processor.go:89\\ngithub.com/jaegertracing/jaeger/cmd/collector/app.ChainedProcessSpan.func1\\n\\t/home/kearls/go/src/github.com/jaegertracing/jaeger/cmd/collector/app/model_consumer.go:32\\ngithub.com/jaegertracing/jaeger/cmd/collector/app.(*spanProcessor).processItemFromQueue\\n\\t/home/kearls/go/src/github.com/jaegertracing/jaeger/cmd/collector/app/span_processor.go:126\\ngithub.com/jaegertracing/jaeger/cmd/collector/app.NewSpanProcessor.func1\\n\\t/home/kearls/go/src/github.com/jaegertracing/jaeger/cmd/collector/app/span_processor.go:57\\ngithub.com/jaegertracing/jaeger/pkg/queue.(*BoundedQueue).StartConsumers.func1\\n\\t/home/kearls/go/src/github.com/jaegertracing/jaeger/pkg/queue/bounded_queue.go:65\\nruntime.goexit\\n\\t/usr/lib/go-1.8/src/runtime/asm_amd64.s:2197\",\"stacktrace\":\"github.com/jaegertracing/jaeger/cmd/collector/app.(*spanProcessor).saveSpan\\n\\t/home/kearls/go/src/github.com/jaegertracing/jaeger/cmd/collector/app/span_processor.go:103\\ngithub.com/jaegertracing/jaeger/cmd/collector/app.(*spanProcessor).(github.com/jaegertracing/jaeger/cmd/collector/app.saveSpan)-fm\\n\\t/home/kearls/go/src/github.com/jaegertracing/jaeger/cmd/collector/app/span_processor.go:89\\ngithub.com/jaegertracing/jaeger/cmd/collector/app.ChainedProcessSpan.func1\\n\\t/home/kearls/go/src/github.com/jaegertracing/jaeger/cmd/collector/app/model_consumer.go:32\\ngithub.com/jaegertracing/jaeger/cmd/collector/app.(*spanProcessor).processItemFromQueue\\n\\t/home/kearls/go/src/github.com/jaegertracing/jaeger/cmd/collector/app/span_processor.go:126\\ngithub.com/jaegertracing/jaeger/cmd/collector/app.NewSpanProcessor.func1\\n\\t/home/kearls/go/src/github.com/jaegertracing/jaeger/cmd/collector/app/span_processor.go:57\\ngithub.com/jaegertracing/jaeger/pkg/queue.(*BoundedQueue).StartConsumers.func1\\n\\t/home/kearls/go/src/github.com/jaegertracing/jaeger/pkg/queue/bounded_queue.go:65\"}`\r\n\r\n",
  "closed_at": "2018-07-09T14:22:17Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/5618424?v=4",
    "events_url": "https://api.github.com/users/pavolloffay/events{/privacy}",
    "followers_url": "https://api.github.com/users/pavolloffay/followers",
    "following_url": "https://api.github.com/users/pavolloffay/following{/other_user}",
    "gists_url": "https://api.github.com/users/pavolloffay/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/pavolloffay",
    "id": 5618424,
    "login": "pavolloffay",
    "node_id": "MDQ6VXNlcjU2MTg0MjQ=",
    "organizations_url": "https://api.github.com/users/pavolloffay/orgs",
    "received_events_url": "https://api.github.com/users/pavolloffay/received_events",
    "repos_url": "https://api.github.com/users/pavolloffay/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/pavolloffay/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/pavolloffay/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/pavolloffay"
  },
  "comments": 13,
  "comments_url": "https://api.github.com/repos/jaegertracing/jaeger/issues/665/comments",
  "created_at": "2018-01-25T14:33:50Z",
  "events_url": "https://api.github.com/repos/jaegertracing/jaeger/issues/665/events",
  "html_url": "https://github.com/jaegertracing/jaeger/issues/665",
  "id": 291590223,
  "labels": [
    {
      "color": "ee0701",
      "default": true,
      "description": null,
      "id": 358839838,
      "name": "bug",
      "node_id": "MDU6TGFiZWwzNTg4Mzk4Mzg=",
      "url": "https://api.github.com/repos/jaegertracing/jaeger/labels/bug"
    },
    {
      "color": "a985fc",
      "default": false,
      "description": "",
      "id": 978918110,
      "name": "storage",
      "node_id": "MDU6TGFiZWw5Nzg5MTgxMTA=",
      "url": "https://api.github.com/repos/jaegertracing/jaeger/labels/storage"
    }
  ],
  "labels_url": "https://api.github.com/repos/jaegertracing/jaeger/issues/665/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUyOTE1OTAyMjM=",
  "number": 665,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/jaegertracing/jaeger",
  "state": "closed",
  "title": "Failed to create index/resource already exists creating spans when using ElasticSearch",
  "updated_at": "2018-07-09T14:22:20Z",
  "url": "https://api.github.com/repos/jaegertracing/jaeger/issues/665",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/1008872?v=4",
    "events_url": "https://api.github.com/users/kevinearls/events{/privacy}",
    "followers_url": "https://api.github.com/users/kevinearls/followers",
    "following_url": "https://api.github.com/users/kevinearls/following{/other_user}",
    "gists_url": "https://api.github.com/users/kevinearls/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/kevinearls",
    "id": 1008872,
    "login": "kevinearls",
    "node_id": "MDQ6VXNlcjEwMDg4NzI=",
    "organizations_url": "https://api.github.com/users/kevinearls/orgs",
    "received_events_url": "https://api.github.com/users/kevinearls/received_events",
    "repos_url": "https://api.github.com/users/kevinearls/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/kevinearls/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/kevinearls/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/kevinearls"
  }
}