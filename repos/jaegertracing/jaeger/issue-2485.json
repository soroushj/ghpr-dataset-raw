{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "MEMBER",
  "body": "**Describe the bug**\r\n\r\nOTEL Badger exporter fails to read/deserialize data\r\n\r\n```\r\n2020-09-17T14:27:25.099+0200\tERROR\trecoveryhandler/zap.go:33\tinvalid Go type model.TraceID for field jaeger.api_v2.Span.trace_id\r\ngithub.com/jaegertracing/jaeger/pkg/recoveryhandler.zapRecoveryWrapper.Println\r\n\t/home/ploffay/projects/jaegertracing/jaeger/pkg/recoveryhandler/zap.go:33\r\ngithub.com/gorilla/handlers.recoveryHandler.log\r\n\t/home/ploffay/projects/golang/pkg/mod/github.com/gorilla/handlers@v1.4.2/recovery.go:83\r\ngithub.com/gorilla/handlers.recoveryHandler.ServeHTTP.func1\r\n\t/home/ploffay/projects/golang/pkg/mod/github.com/gorilla/handlers@v1.4.2/recovery.go:74\r\nruntime.gopanic\r\n\t/home/ploffay/bin/go/src/runtime/panic.go:969\r\ngoogle.golang.org/protobuf/internal/impl.newSingularConverter\r\n\t/home/ploffay/projects/golang/pkg/mod/google.golang.org/protobuf@v1.25.0/internal/impl/convert.go:143\r\ngoogle.golang.org/protobuf/internal/impl.NewConverter\r\n\t/home/ploffay/projects/golang/pkg/mod/google.golang.org/protobuf@v1.25.0/internal/impl/convert.go:60\r\ngoogle.golang.org/protobuf/internal/impl.fieldInfoForScalar\r\n\t/home/ploffay/projects/golang/pkg/mod/google.golang.org/protobuf@v1.25.0/internal/impl/message_reflect_field.go:234\r\ngoogle.golang.org/protobuf/internal/impl.(*MessageInfo).makeKnownFieldsFunc\r\n\t/home/ploffay/projects/golang/pkg/mod/google.golang.org/protobuf@v1.25.0/internal/impl/message_reflect.go:67\r\ngoogle.golang.org/protobuf/internal/impl.(*MessageInfo).makeReflectFuncs\r\n\t/home/ploffay/projects/golang/pkg/mod/google.golang.org/protobuf@v1.25.0/internal/impl/message_reflect.go:36\r\ngoogle.golang.org/protobuf/internal/impl.(*MessageInfo).initOnce\r\n\t/home/ploffay/projects/golang/pkg/mod/google.golang.org/protobuf@v1.25.0/internal/impl/message.go:90\r\ngoogle.golang.org/protobuf/internal/impl.(*MessageInfo).init\r\n\t/home/ploffay/projects/golang/pkg/mod/google.golang.org/protobuf@v1.25.0/internal/impl/message.go:72\r\ngoogle.golang.org/protobuf/internal/impl.(*messageReflectWrapper).ProtoMethods\r\n\t/home/ploffay/projects/golang/pkg/mod/google.golang.org/protobuf@v1.25.0/internal/impl/message_reflect_gen.go:150\r\ngoogle.golang.org/protobuf/proto.protoMethods\r\n\t/home/ploffay/projects/golang/pkg/mod/google.golang.org/protobuf@v1.25.0/proto/proto_methods.go:18\r\ngoogle.golang.org/protobuf/proto.UnmarshalOptions.unmarshal\r\n\t/home/ploffay/projects/golang/pkg/mod/google.golang.org/protobuf@v1.25.0/proto/decode.go:80\r\ngoogle.golang.org/protobuf/proto.UnmarshalOptions.UnmarshalState\r\n\t/home/ploffay/projects/golang/pkg/mod/google.golang.org/protobuf@v1.25.0/proto/decode.go:64\r\ngithub.com/golang/protobuf/proto.UnmarshalMerge\r\n\t/home/ploffay/projects/golang/pkg/mod/github.com/golang/protobuf@v1.4.2/proto/wire.go:67\r\ngithub.com/golang/protobuf/proto.Unmarshal\r\n\t/home/ploffay/projects/golang/pkg/mod/github.com/golang/protobuf@v1.4.2/proto/wire.go:58\r\ngithub.com/jaegertracing/jaeger/plugin/storage/badger/spanstore.decodeValue\r\n\t/home/ploffay/projects/jaegertracing/jaeger/plugin/storage/badger/spanstore/reader.go:104\r\ngithub.com/jaegertracing/jaeger/plugin/storage/badger/spanstore.(*TraceReader).getTraces.func1\r\n\t/home/ploffay/projects/jaegertracing/jaeger/plugin/storage/badger/spanstore/reader.go:141\r\ngithub.com/dgraph-io/badger.(*DB).View\r\n\t/home/ploffay/projects/golang/pkg/mod/github.com/dgraph-io/badger@v1.5.3/transaction.go:567\r\ngithub.com/jaegertracing/jaeger/plugin/storage/badger/spanstore.(*TraceReader).getTraces\r\n\t/home/ploffay/projects/jaegertracing/jaeger/plugin/storage/badger/spanstore/reader.go:123\r\ngithub.com/jaegertracing/jaeger/plugin/storage/badger/spanstore.(*TraceReader).FindTraces\r\n\t/home/ploffay/projects/jaegertracing/jaeger/plugin/storage/badger/spanstore/reader.go:462\r\ngithub.com/jaegertracing/jaeger/cmd/query/app/querysvc.QueryService.FindTraces\r\n\t/home/ploffay/projects/jaegertracing/jaeger/cmd/query/app/querysvc/query_service.go:95\r\ngithub.com/jaegertracing/jaeger/cmd/query/app.(*APIHandler).search\r\n\t/home/ploffay/projects/jaegertracing/jaeger/cmd/query/app/http_handler.go:222\r\nnet/http.HandlerFunc.ServeHTTP\r\n\t/home/ploffay/bin/go/src/net/http/server.go:2012\r\ngithub.com/opentracing-contrib/go-stdlib/nethttp.MiddlewareFunc.func5\r\n\t/home/ploffay/projects/golang/pkg/mod/github.com/opentracing-contrib/go-stdlib@v0.0.0-20190519235532-cf7a6c988dc9/nethttp/server.go:140\r\nnet/http.HandlerFunc.ServeHTTP\r\n\t/home/ploffay/bin/go/src/net/http/server.go:2012\r\nnet/http.HandlerFunc.ServeHTTP\r\n\t/home/ploffay/bin/go/src/net/http/server.go:2012\r\ngithub.com/gorilla/mux.(*Router).ServeHTTP\r\n\t/home/ploffay/projects/golang/pkg/mod/github.com/gorilla/mux@v1.7.4/mux.go:210\r\ngithub.com/jaegertracing/jaeger/cmd/query/app.additionalHeadersHandler.func1\r\n\t/home/ploffay/projects/jaegertracing/jaeger/cmd/query/app/additional_headers_handler.go:28\r\nnet/http.HandlerFunc.ServeHTTP\r\n\t/home/ploffay/bin/go/src/net/http/server.go:2012\r\ngithub.com/gorilla/handlers.CompressHandlerLevel.func1\r\n\t/home/ploffay/projects/golang/pkg/mod/github.com/gorilla/handlers@v1.4.2/compress.go:148\r\nnet/http.HandlerFunc.ServeHTTP\r\n\t/home/ploffay/bin/go/src/net/http/server.go:2012\r\ngithub.com/gorilla/handlers.recoveryHandler.ServeHTTP\r\n\t/home/ploffay/projects/golang/pkg/mod/github.com/gorilla/handlers@v1.4.2/recovery.go:78\r\nnet/http.serverHandler.ServeHTTP\r\n\t/home/ploffay/bin/go/src/net/http/server.go:2807\r\nnet/http.(*conn).serve\r\n\t/home/ploffay/bin/go/src/net/http/server.go:1895\r\ngoroutine 274 [running]:\r\nruntime/debug.Stack(0xe1a6c2, 0xc000882840, 0xc0003ceff0)\r\n\t/home/ploffay/bin/go/src/runtime/debug/stack.go:24 +0x9d\r\nruntime/debug.PrintStack()\r\n\t/home/ploffay/bin/go/src/runtime/debug/stack.go:16 +0x22\r\ngithub.com/gorilla/handlers.recoveryHandler.log(0x3f5bf20, 0xc000c9c100, 0x3f5a960, 0xc000882840, 0x1, 0xc007e7c020, 0x1, 0x1)\r\n\t/home/ploffay/projects/golang/pkg/mod/github.com/gorilla/handlers@v1.4.2/recovery.go:89 +0x6e\r\ngithub.com/gorilla/handlers.recoveryHandler.ServeHTTP.func1(0x3fad460, 0xc00018c9a0, 0x3f5bf20, 0xc000c9c100, 0x3f5a960, 0xc000882840, 0x1)\r\n\t/home/ploffay/projects/golang/pkg/mod/github.com/gorilla/handlers@v1.4.2/recovery.go:74 +0xda\r\npanic(0x2bd4a80, 0xc000a8df70)\r\n\t/home/ploffay/bin/go/src/runtime/panic.go:969 +0x166\r\ngoogle.golang.org/protobuf/internal/impl.newSingularConverter(0x40112e0, 0x2ffba00, 0x40111c0, 0xc000897500, 0xc0001bca70, 0x30)\r\n\t/home/ploffay/projects/golang/pkg/mod/google.golang.org/protobuf@v1.25.0/internal/impl/convert.go:143 +0xff5\r\ngoogle.golang.org/protobuf/internal/impl.NewConverter(0x40112e0, 0x2ffba00, 0x40111c0, 0xc000897500, 0x2, 0x30)\r\n\t/home/ploffay/projects/golang/pkg/mod/google.golang.org/protobuf@v1.25.0/internal/impl/convert.go:60 +0xd9\r\ngoogle.golang.org/protobuf/internal/impl.fieldInfoForScalar(0x40111c0, 0xc000897500, 0x2dfba89, 0x7, 0x0, 0x0, 0x40112e0, 0x2ffba00, 0x2dfba92, 0x5b, ...)\r\n\t/home/ploffay/projects/golang/pkg/mod/google.golang.org/protobuf@v1.25.0/internal/impl/message_reflect_field.go:234 +0x110\r\ngoogle.golang.org/protobuf/internal/impl.(*MessageInfo).makeKnownFieldsFunc(0xc00042b900, 0xe0, 0xffffffffffffffff, 0xc8, 0xffffffffffffffff, 0xc000c5a8a0, 0xc000c5a8d0, 0xc000c5a900, 0xc000c5a930)\r\n\t/home/ploffay/projects/golang/pkg/mod/google.golang.org/protobuf@v1.25.0/internal/impl/message_reflect.go:67 +0x938\r\ngoogle.golang.org/protobuf/internal/impl.(*MessageInfo).makeReflectFuncs(0xc00042b900, 0x40112e0, 0x3295f60, 0xe0, 0xffffffffffffffff, 0xc8, 0xffffffffffffffff, 0xc000c5a8a0, 0xc000c5a8d0, 0xc000c5a900, ...)\r\n\t/home/ploffay/projects/golang/pkg/mod/google.golang.org/protobuf@v1.25.0/internal/impl/message_reflect.go:36 +0x63\r\ngoogle.golang.org/protobuf/internal/impl.(*MessageInfo).initOnce(0xc00042b900)\r\n\t/home/ploffay/projects/golang/pkg/mod/google.golang.org/protobuf@v1.25.0/internal/impl/message.go:90 +0x182\r\ngoogle.golang.org/protobuf/internal/impl.(*MessageInfo).init(0xc00042b900)\r\n\t/home/ploffay/projects/golang/pkg/mod/google.golang.org/protobuf@v1.25.0/internal/impl/message.go:72 +0x3c\r\ngoogle.golang.org/protobuf/internal/impl.(*messageReflectWrapper).ProtoMethods(0xc000a8db70, 0xc000bbc101)\r\n\t/home/ploffay/projects/golang/pkg/mod/google.golang.org/protobuf@v1.25.0/internal/impl/message_reflect_gen.go:150 +0x2f\r\ngoogle.golang.org/protobuf/proto.protoMethods(...)\r\n\t/home/ploffay/projects/golang/pkg/mod/google.golang.org/protobuf@v1.25.0/proto/proto_methods.go:18\r\ngoogle.golang.org/protobuf/proto.UnmarshalOptions.unmarshal(0x101, 0x3f75900, 0xc0000c38f0, 0xc000b59000, 0x7dc, 0x800, 0x40034c0, 0xc000a8db70, 0x5b5e238, 0x203000, ...)\r\n\t/home/ploffay/projects/golang/pkg/mod/google.golang.org/protobuf@v1.25.0/proto/decode.go:80 +0x7f\r\ngoogle.golang.org/protobuf/proto.UnmarshalOptions.UnmarshalState(...)\r\n\t/home/ploffay/projects/golang/pkg/mod/google.golang.org/protobuf@v1.25.0/proto/decode.go:64\r\ngithub.com/golang/protobuf/proto.UnmarshalMerge(0xc000b59000, 0x7dc, 0x800, 0x3f9d6a0, 0xc000bbc1e0, 0x801, 0xc000bbc1e0)\r\n\t/home/ploffay/projects/golang/pkg/mod/github.com/golang/protobuf@v1.4.2/proto/wire.go:67 +0x19b\r\ngithub.com/golang/protobuf/proto.Unmarshal(0xc000b59000, 0x7dc, 0x800, 0x3f9d6a0, 0xc000bbc1e0, 0xc0006d1000, 0x19)\r\n\t/home/ploffay/projects/golang/pkg/mod/github.com/golang/protobuf@v1.4.2/proto/wire.go:58 +0x67\r\ngithub.com/jaegertracing/jaeger/plugin/storage/badger/spanstore.decodeValue(0xc000b59000, 0x7dc, 0x800, 0x2, 0xc000b59000, 0x7dc, 0x800)\r\n\t/home/ploffay/projects/jaegertracing/jaeger/plugin/storage/badger/spanstore/reader.go:104 +0x85\r\ngithub.com/jaegertracing/jaeger/plugin/storage/badger/spanstore.(*TraceReader).getTraces.func1(0xc007d32360, 0x0, 0x0)\r\n\t/home/ploffay/projects/jaegertracing/jaeger/plugin/storage/badger/spanstore/reader.go:141 +0x1e0\r\ngithub.com/dgraph-io/badger.(*DB).View(0xc000012600, 0xc0062632c0, 0x0, 0x0)\r\n\t/home/ploffay/projects/golang/pkg/mod/github.com/dgraph-io/badger@v1.5.3/transaction.go:567 +0x9d\r\ngithub.com/jaegertracing/jaeger/plugin/storage/badger/spanstore.(*TraceReader).getTraces(0xc000591190, 0xc0069663c0, 0x1, 0x14, 0xc0069663c0, 0x1, 0x14, 0x0, 0x0)\r\n\t/home/ploffay/projects/jaegertracing/jaeger/plugin/storage/badger/spanstore/reader.go:123 +0x1e4\r\ngithub.com/jaegertracing/jaeger/plugin/storage/badger/spanstore.(*TraceReader).FindTraces(0xc000591190, 0x3fb8f60, 0xc000909ef0, 0xc007d32240, 0x0, 0x190, 0x203000, 0x203000, 0x1)\r\n\t/home/ploffay/projects/jaegertracing/jaeger/plugin/storage/badger/spanstore/reader.go:462 +0xb6\r\ngithub.com/jaegertracing/jaeger/cmd/query/app/querysvc.QueryService.FindTraces(...)\r\n\t/home/ploffay/projects/jaegertracing/jaeger/cmd/query/app/querysvc/query_service.go:95\r\ngithub.com/jaegertracing/jaeger/cmd/query/app.(*APIHandler).search(0xc000770870, 0x3faf2a0, 0xc007d378b0, 0xc0008a1500)\r\n\t/home/ploffay/projects/jaegertracing/jaeger/cmd/query/app/http_handler.go:222 +0x62b\r\nnet/http.HandlerFunc.ServeHTTP(0xc00062eb80, 0x3faf2a0, 0xc007d378b0, 0xc0008a1500)\r\n\t/home/ploffay/bin/go/src/net/http/server.go:2012 +0x44\r\ngithub.com/opentracing-contrib/go-stdlib/nethttp.MiddlewareFunc.func5(0x3f9cda0, 0xc007d377c0, 0xc0008a1300)\r\n\t/home/ploffay/projects/golang/pkg/mod/github.com/opentracing-contrib/go-stdlib@v0.0.0-20190519235532-cf7a6c988dc9/nethttp/server.go:140 +0x5d1\r\nnet/http.HandlerFunc.ServeHTTP(0xc00030c450, 0x3f9cda0, 0xc007d377c0, 0xc0008a1300)\r\n\t/home/ploffay/bin/go/src/net/http/server.go:2012 +0x44\r\nnet/http.HandlerFunc.ServeHTTP(0xc00069db40, 0x3f9cda0, 0xc007d377c0, 0xc0008a1300)\r\n\t/home/ploffay/bin/go/src/net/http/server.go:2012 +0x44\r\ngithub.com/gorilla/mux.(*Router).ServeHTTP(0xc0002c4480, 0x3f9cda0, 0xc007d377c0, 0xc000153700)\r\n\t/home/ploffay/projects/golang/pkg/mod/github.com/gorilla/mux@v1.7.4/mux.go:210 +0xe2\r\ngithub.com/jaegertracing/jaeger/cmd/query/app.additionalHeadersHandler.func1(0x3f9cda0, 0xc007d377c0, 0xc000153700)\r\n\t/home/ploffay/projects/jaegertracing/jaeger/cmd/query/app/additional_headers_handler.go:28 +0x190\r\nnet/http.HandlerFunc.ServeHTTP(0xc000c9c0e0, 0x3f9cda0, 0xc007d377c0, 0xc000153700)\r\n\t/home/ploffay/bin/go/src/net/http/server.go:2012 +0x44\r\ngithub.com/gorilla/handlers.CompressHandlerLevel.func1(0x3fad460, 0xc00018c9a0, 0xc000153700)\r\n\t/home/ploffay/projects/golang/pkg/mod/github.com/gorilla/handlers@v1.4.2/compress.go:148 +0x17b\r\nnet/http.HandlerFunc.ServeHTTP(0xc000c9c100, 0x3fad460, 0xc00018c9a0, 0xc000153700)\r\n\t/home/ploffay/bin/go/src/net/http/server.go:2012 +0x44\r\ngithub.com/gorilla/handlers.recoveryHandler.ServeHTTP(0x3f5bf20, 0xc000c9c100, 0x3f5a960, 0xc000882840, 0x1, 0x3fad460, 0xc00018c9a0, 0xc000153700)\r\n\t/home/ploffay/projects/golang/pkg/mod/github.com/gorilla/handlers@v1.4.2/recovery.go:78 +0xce\r\nnet/http.serverHandler.ServeHTTP(0xc00018c1c0, 0x3fad460, 0xc00018c9a0, 0xc000153700)\r\n\t/home/ploffay/bin/go/src/net/http/server.go:2807 +0xa3\r\nnet/http.(*conn).serve(0xc000890140, 0x3fb8ea0, 0xc000127800)\r\n\t/home/ploffay/bin/go/src/net/http/server.go:1895 +0x86c\r\ncreated by net/http.(*Server).Serve\r\n\t/home/ploffay/bin/go/src/net/http/server.go:2933 +0x35c\r\n```\r\n\r\n**To Reproduce**\r\n```\r\nSPAN_STORAGE_TYPE=badger go run -tags ui ./cmd/all-in-one/main.go\r\n```\r\n\r\nThen open UI and refresh to generate some data from the query service. The exception should appear in logs.\r\n\r\n**Version (please complete the following information):**\r\n\r\nlatest master\r\n\r\n",
  "closed_at": "2020-09-17T16:14:58Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/5618424?v=4",
    "events_url": "https://api.github.com/users/pavolloffay/events{/privacy}",
    "followers_url": "https://api.github.com/users/pavolloffay/followers",
    "following_url": "https://api.github.com/users/pavolloffay/following{/other_user}",
    "gists_url": "https://api.github.com/users/pavolloffay/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/pavolloffay",
    "id": 5618424,
    "login": "pavolloffay",
    "node_id": "MDQ6VXNlcjU2MTg0MjQ=",
    "organizations_url": "https://api.github.com/users/pavolloffay/orgs",
    "received_events_url": "https://api.github.com/users/pavolloffay/received_events",
    "repos_url": "https://api.github.com/users/pavolloffay/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/pavolloffay/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/pavolloffay/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/pavolloffay"
  },
  "comments": 1,
  "comments_url": "https://api.github.com/repos/jaegertracing/jaeger/issues/2485/comments",
  "created_at": "2020-09-17T12:33:58Z",
  "events_url": "https://api.github.com/repos/jaegertracing/jaeger/issues/2485/events",
  "html_url": "https://github.com/jaegertracing/jaeger/issues/2485",
  "id": 703545954,
  "labels": [
    {
      "color": "5319e7",
      "default": false,
      "description": "",
      "id": 1965406717,
      "name": "area/otel",
      "node_id": "MDU6TGFiZWwxOTY1NDA2NzE3",
      "url": "https://api.github.com/repos/jaegertracing/jaeger/labels/area/otel"
    },
    {
      "color": "ee0701",
      "default": true,
      "description": null,
      "id": 358839838,
      "name": "bug",
      "node_id": "MDU6TGFiZWwzNTg4Mzk4Mzg=",
      "url": "https://api.github.com/repos/jaegertracing/jaeger/labels/bug"
    },
    {
      "color": "006b75",
      "default": false,
      "description": "Issues related to badger storage",
      "id": 1409870215,
      "name": "storage/badger",
      "node_id": "MDU6TGFiZWwxNDA5ODcwMjE1",
      "url": "https://api.github.com/repos/jaegertracing/jaeger/labels/storage/badger"
    }
  ],
  "labels_url": "https://api.github.com/repos/jaegertracing/jaeger/issues/2485/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU3MDM1NDU5NTQ=",
  "number": 2485,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/jaegertracing/jaeger",
  "state": "closed",
  "title": "OTEL Badger exporter fails to read/deserialize data",
  "updated_at": "2020-09-17T16:14:58Z",
  "url": "https://api.github.com/repos/jaegertracing/jaeger/issues/2485",
  "user": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/5618424?v=4",
    "events_url": "https://api.github.com/users/pavolloffay/events{/privacy}",
    "followers_url": "https://api.github.com/users/pavolloffay/followers",
    "following_url": "https://api.github.com/users/pavolloffay/following{/other_user}",
    "gists_url": "https://api.github.com/users/pavolloffay/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/pavolloffay",
    "id": 5618424,
    "login": "pavolloffay",
    "node_id": "MDQ6VXNlcjU2MTg0MjQ=",
    "organizations_url": "https://api.github.com/users/pavolloffay/orgs",
    "received_events_url": "https://api.github.com/users/pavolloffay/received_events",
    "repos_url": "https://api.github.com/users/pavolloffay/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/pavolloffay/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/pavolloffay/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/pavolloffay"
  }
}