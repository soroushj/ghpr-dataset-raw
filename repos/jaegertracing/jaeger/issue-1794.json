{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "NONE",
  "body": "## Requirement - what kind of business use case are you trying to solve?\r\nThe all-in-one image seems to start with an error, causing confusion\r\n\r\n## Problem - what in Jaeger blocks you from solving the requirement?\r\n\r\nThe error seems to be gRPC never announcing it comes back online after transient failure\r\n## Proposal - what do you suggest to solve the problem or improve the existing situation?\r\n\r\nIf the gRPC logs are fixable, i.e. there is some reason the READY is never printed, that can be re-shown.  \r\nOtherwise, starting the container-internal services in the correct order and/or making them wait for each other would solve the problem\r\n\r\n```\r\n$ docker run -it --rm --name jaeger \\\r\n  --net=host \\\r\n  jaegertracing/all-in-one:1.13 --log-level=debug\r\n2019/09/11 09:41:44 maxprocs: Leaving GOMAXPROCS=4: CPU quota undefined\r\n{\"level\":\"info\",\"ts\":1568194904.9064102,\"caller\":\"flags/service.go:115\",\"msg\":\"Mounting metrics handler on admin server\",\"route\":\"/metrics\"}\r\n{\"level\":\"info\",\"ts\":1568194904.9066496,\"caller\":\"flags/admin.go:108\",\"msg\":\"Mounting health check on admin server\",\"route\":\"/\"}\r\n{\"level\":\"info\",\"ts\":1568194904.9067447,\"caller\":\"flags/admin.go:114\",\"msg\":\"Starting admin HTTP server\",\"http-port\":14269}\r\n{\"level\":\"info\",\"ts\":1568194904.9068332,\"caller\":\"flags/admin.go:100\",\"msg\":\"Admin server started\",\"http-port\":14269,\"health-status\":\"unavailable\"}\r\n{\"level\":\"info\",\"ts\":1568194904.910164,\"caller\":\"memory/factory.go:55\",\"msg\":\"Memory storage initialized\",\"configuration\":{\"MaxTraces\":0}}\r\n{\"level\":\"info\",\"ts\":1568194904.9103458,\"caller\":\"static/strategy_store.go:79\",\"msg\":\"No sampling strategies provided, using defaults\"}\r\n{\"level\":\"info\",\"ts\":1568194904.9139445,\"caller\":\"grpc/builder.go:75\",\"msg\":\"Agent requested insecure grpc connection to collector(s)\"}\r\n{\"level\":\"info\",\"ts\":1568194904.9140205,\"caller\":\"grpc/clientconn.go:242\",\"msg\":\"parsed scheme: \\\"\\\"\",\"system\":\"grpc\",\"grpc_log\":true}\r\n{\"level\":\"info\",\"ts\":1568194904.9140964,\"caller\":\"grpc/clientconn.go:248\",\"msg\":\"scheme \\\"\\\" not registered, fallback to default scheme\",\"system\":\"grpc\",\"grpc_log\":true}\r\n{\"level\":\"info\",\"ts\":1568194904.9141681,\"caller\":\"grpc/resolver_conn_wrapper.go:113\",\"msg\":\"ccResolverWrapper: sending update to cc: {[{127.0.0.1:14250 0  <nil>}] }\",\"system\":\"grpc\",\"grpc_log\":true}\r\n{\"level\":\"info\",\"ts\":1568194904.914391,\"caller\":\"base/balancer.go:76\",\"msg\":\"base.baseBalancer: got new resolver state: {[{127.0.0.1:14250 0  <nil>}] }\",\"system\":\"grpc\",\"grpc_log\":true}\r\n{\"level\":\"info\",\"ts\":1568194904.914446,\"caller\":\"base/balancer.go:130\",\"msg\":\"base.baseBalancer: handle SubConn state change: 0xc00030e080, CONNECTING\",\"system\":\"grpc\",\"grpc_log\":true}\r\n{\"level\":\"info\",\"ts\":1568194904.9148405,\"caller\":\"grpc/clientconn.go:1139\",\"msg\":\"grpc: addrConn.createTransport failed to connect to {127.0.0.1:14250 0  <nil>}. Err :connection error: desc = \\\"transport: Error while dialing dial tcp 127.0.0.1:14250: connect: connection refused\\\". Reconnecting...\",\"system\":\"grpc\",\"grpc_log\":true}\r\n{\"level\":\"info\",\"ts\":1568194904.9157476,\"caller\":\"base/balancer.go:130\",\"msg\":\"base.baseBalancer: handle SubConn state change: 0xc00030e080, TRANSIENT_FAILURE\",\"system\":\"grpc\",\"grpc_log\":true}\r\n```\r\nSee the last three lines above. See below for lack of READY from gRPC (i.e. it reconnected)\r\n```\r\n{\"level\":\"info\",\"ts\":1568194904.9162838,\"caller\":\"all-in-one/main.go:198\",\"msg\":\"Starting agent\"}\r\n{\"level\":\"info\",\"ts\":1568194904.9165218,\"caller\":\"app/agent.go:68\",\"msg\":\"Starting jaeger-agent HTTP server\",\"http-port\":5778}\r\n{\"level\":\"info\",\"ts\":1568194904.9227703,\"caller\":\"all-in-one/main.go:241\",\"msg\":\"Starting jaeger-collector TChannel server\",\"port\":14267}\r\n{\"level\":\"info\",\"ts\":1568194904.9228954,\"caller\":\"grpcserver/grpc_server.go:64\",\"msg\":\"Starting jaeger-collector gRPC server\",\"grpc-port\":\"14250\"}\r\n{\"level\":\"info\",\"ts\":1568194904.9230096,\"caller\":\"all-in-one/main.go:259\",\"msg\":\"Starting jaeger-collector HTTP server\",\"http-port\":14268}\r\n{\"level\":\"info\",\"ts\":1568194904.923073,\"caller\":\"querysvc/query_service.go:130\",\"msg\":\"Archive storage not created\",\"reason\":\"archive storage not supported\"}\r\n{\"level\":\"info\",\"ts\":1568194904.9238057,\"caller\":\"all-in-one/main.go:341\",\"msg\":\"Archive storage not initialized\"}\r\n{\"level\":\"info\",\"ts\":1568194904.9246495,\"caller\":\"healthcheck/handler.go:129\",\"msg\":\"Health Check state change\",\"status\":\"ready\"}\r\n{\"level\":\"info\",\"ts\":1568194904.924709,\"caller\":\"app/server.go:111\",\"msg\":\"Starting HTTP server\",\"port\":16686}\r\n{\"level\":\"info\",\"ts\":1568194904.9247801,\"caller\":\"app/server.go:124\",\"msg\":\"Starting GRPC server\",\"port\":16686}\r\n{\"level\":\"info\",\"ts\":1568194904.924805,\"caller\":\"app/server.go:134\",\"msg\":\"Starting CMUX server\",\"port\":16686}\r\n```\r\nSide note: this occurs at least on 1.13, 1.14 and latest",
  "closed_at": "2019-09-12T09:48:41Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/5618424?v=4",
    "events_url": "https://api.github.com/users/pavolloffay/events{/privacy}",
    "followers_url": "https://api.github.com/users/pavolloffay/followers",
    "following_url": "https://api.github.com/users/pavolloffay/following{/other_user}",
    "gists_url": "https://api.github.com/users/pavolloffay/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/pavolloffay",
    "id": 5618424,
    "login": "pavolloffay",
    "node_id": "MDQ6VXNlcjU2MTg0MjQ=",
    "organizations_url": "https://api.github.com/users/pavolloffay/orgs",
    "received_events_url": "https://api.github.com/users/pavolloffay/received_events",
    "repos_url": "https://api.github.com/users/pavolloffay/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/pavolloffay/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/pavolloffay/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/pavolloffay"
  },
  "comments": 4,
  "comments_url": "https://api.github.com/repos/jaegertracing/jaeger/issues/1794/comments",
  "created_at": "2019-09-12T07:28:21Z",
  "events_url": "https://api.github.com/repos/jaegertracing/jaeger/issues/1794/events",
  "html_url": "https://github.com/jaegertracing/jaeger/issues/1794",
  "id": 492633838,
  "labels": [],
  "labels_url": "https://api.github.com/repos/jaegertracing/jaeger/issues/1794/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU0OTI2MzM4Mzg=",
  "number": 1794,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/jaegertracing/jaeger",
  "state": "closed",
  "title": "All-in-one docker container shows confusing logs",
  "updated_at": "2019-09-12T09:48:41Z",
  "url": "https://api.github.com/repos/jaegertracing/jaeger/issues/1794",
  "user": {
    "avatar_url": "https://avatars1.githubusercontent.com/u/48314306?v=4",
    "events_url": "https://api.github.com/users/Kyle-sandeman-mrdfood/events{/privacy}",
    "followers_url": "https://api.github.com/users/Kyle-sandeman-mrdfood/followers",
    "following_url": "https://api.github.com/users/Kyle-sandeman-mrdfood/following{/other_user}",
    "gists_url": "https://api.github.com/users/Kyle-sandeman-mrdfood/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/Kyle-sandeman-mrdfood",
    "id": 48314306,
    "login": "Kyle-sandeman-mrdfood",
    "node_id": "MDQ6VXNlcjQ4MzE0MzA2",
    "organizations_url": "https://api.github.com/users/Kyle-sandeman-mrdfood/orgs",
    "received_events_url": "https://api.github.com/users/Kyle-sandeman-mrdfood/received_events",
    "repos_url": "https://api.github.com/users/Kyle-sandeman-mrdfood/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/Kyle-sandeman-mrdfood/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Kyle-sandeman-mrdfood/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/Kyle-sandeman-mrdfood"
  }
}