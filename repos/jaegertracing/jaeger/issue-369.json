{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "CONTRIBUTOR",
  "body": "With a local single node ES cluster if I start Jaeger collector and query to use Elasticsearch as backend with following options:\r\n```\r\n-span-storage.type=elasticsearch --es.num-shards=1 --es.num-replicas=0 --es.server-urls=http://jaeger-es:9200 --dependency-storage.type=elasticsearch\r\n```\r\n\r\nUpon checking output of localhost:9200/_cluster/health?pretty\r\n```\r\n{\r\n  \"cluster_name\" : \"jaeger-cluster\",\r\n  \"status\" : \"yellow\",\r\n  \"timed_out\" : false,\r\n  \"number_of_nodes\" : 1,\r\n  \"number_of_data_nodes\" : 1,\r\n  \"active_primary_shards\" : 4,\r\n  \"active_shards\" : 4,\r\n  \"relocating_shards\" : 0,\r\n  \"initializing_shards\" : 0,\r\n  \"unassigned_shards\" : 4,\r\n  \"delayed_unassigned_shards\" : 0,\r\n  \"number_of_pending_tasks\" : 0,\r\n  \"number_of_in_flight_fetch\" : 0,\r\n  \"task_max_waiting_in_queue_millis\" : 0,\r\n  \"active_shards_percent_as_number\" : 50.0\r\n}\r\n```\r\nES cluster health check shows status 'yellow' and you will notice active_primary_shards=4 and unassigned_shards=4, which means some indexes are configured with value replicas=1, this can be confirmed by checking output of :\r\n\r\nhttp://localhost:9200/jaeger-span-2017-09-02/_settings?pretty\r\n```\r\n{\r\n  \"jaeger-span-2017-09-02\" : {\r\n    \"settings\" : {\r\n      \"index\" : {\r\n        \"mapping\" : {\r\n          \"nested_fields\" : {\r\n            \"limit\" : \"50\"\r\n          }\r\n        },\r\n        \"number_of_shards\" : \"1\",\r\n        \"provided_name\" : \"jaeger-span-2017-09-02\",\r\n        \"mapper\" : {\r\n          \"dynamic\" : \"false\"\r\n        },\r\n        \"creation_date\" : \"1504368267533\",\r\n        \"requests\" : {\r\n          \"cache\" : {\r\n            \"enable\" : \"true\"\r\n          }\r\n        },\r\n        \"number_of_replicas\" : \"1\",\r\n        \"uuid\" : \"AkWNKfQSRlCa9pIoxilj5g\",\r\n        \"version\" : {\r\n          \"created\" : \"5050299\"\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\nThis confirms that when creating indexes `number_of_repliacas` is getting set to 1, when it should have been set to 0. \r\nThis is a problem when running a single node ES cluster where we want replicas to be set to 0 intentionally.\r\n",
  "closed_at": "2018-03-26T16:52:18Z",
  "closed_by": {
    "avatar_url": "https://avatars0.githubusercontent.com/u/5618424?v=4",
    "events_url": "https://api.github.com/users/pavolloffay/events{/privacy}",
    "followers_url": "https://api.github.com/users/pavolloffay/followers",
    "following_url": "https://api.github.com/users/pavolloffay/following{/other_user}",
    "gists_url": "https://api.github.com/users/pavolloffay/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/pavolloffay",
    "id": 5618424,
    "login": "pavolloffay",
    "node_id": "MDQ6VXNlcjU2MTg0MjQ=",
    "organizations_url": "https://api.github.com/users/pavolloffay/orgs",
    "received_events_url": "https://api.github.com/users/pavolloffay/received_events",
    "repos_url": "https://api.github.com/users/pavolloffay/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/pavolloffay/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/pavolloffay/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/pavolloffay"
  },
  "comments": 1,
  "comments_url": "https://api.github.com/repos/jaegertracing/jaeger/issues/369/comments",
  "created_at": "2017-09-02T16:24:25Z",
  "events_url": "https://api.github.com/repos/jaegertracing/jaeger/issues/369/events",
  "html_url": "https://github.com/jaegertracing/jaeger/issues/369",
  "id": 254821353,
  "labels": [],
  "labels_url": "https://api.github.com/repos/jaegertracing/jaeger/issues/369/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWUyNTQ4MjEzNTM=",
  "number": 369,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/jaegertracing/jaeger",
  "state": "closed",
  "title": "ES replicas defaults to 1 even when specifying --es.num-replicas=0 when starting collector and query",
  "updated_at": "2018-03-26T16:52:18Z",
  "url": "https://api.github.com/repos/jaegertracing/jaeger/issues/369",
  "user": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/13206972?v=4",
    "events_url": "https://api.github.com/users/bharat-p/events{/privacy}",
    "followers_url": "https://api.github.com/users/bharat-p/followers",
    "following_url": "https://api.github.com/users/bharat-p/following{/other_user}",
    "gists_url": "https://api.github.com/users/bharat-p/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/bharat-p",
    "id": 13206972,
    "login": "bharat-p",
    "node_id": "MDQ6VXNlcjEzMjA2OTcy",
    "organizations_url": "https://api.github.com/users/bharat-p/orgs",
    "received_events_url": "https://api.github.com/users/bharat-p/received_events",
    "repos_url": "https://api.github.com/users/bharat-p/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/bharat-p/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bharat-p/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/bharat-p"
  }
}