{
  "active_lock_reason": null,
  "assignee": null,
  "assignees": [],
  "author_association": "MEMBER",
  "body": "**Describe the bug**\r\nI faced https://github.com/open-telemetry/opentelemetry-collector/issues/1227 some time ago, and while reviewing #2337, I noticed that we have the same pattern in Jaeger:\r\n\r\nhttps://github.com/jaegertracing/jaeger/blob/02d45678ec9079ee91e19ad901ab7592aa4de085/cmd/query/app/server.go#L138-L145\r\n\r\nBasically, when gRPC is behind TLS, `cmux` can't determine the headers before doing the TLS handshake, and the TLS handshake happens at the gRPC layer. The end result is that all calls end up going to the HTTP handler when a client is attempting to establish a gRPC TLS connection.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Not reproducible at the moment, as there's a bug preventing the TLS flags from being exposed for gRPC in the Query component.\r\n\r\nA possible solution is mentioned here in a follow-up issue at OpenTelemetry Collector: https://github.com/open-telemetry/opentelemetry-collector/issues/1256#issuecomment-654975422",
  "closed_at": "2020-09-11T07:59:38Z",
  "closed_by": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/13387?v=4",
    "events_url": "https://api.github.com/users/jpkrohling/events{/privacy}",
    "followers_url": "https://api.github.com/users/jpkrohling/followers",
    "following_url": "https://api.github.com/users/jpkrohling/following{/other_user}",
    "gists_url": "https://api.github.com/users/jpkrohling/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/jpkrohling",
    "id": 13387,
    "login": "jpkrohling",
    "node_id": "MDQ6VXNlcjEzMzg3",
    "organizations_url": "https://api.github.com/users/jpkrohling/orgs",
    "received_events_url": "https://api.github.com/users/jpkrohling/received_events",
    "repos_url": "https://api.github.com/users/jpkrohling/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/jpkrohling/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jpkrohling/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/jpkrohling"
  },
  "comments": 12,
  "comments_url": "https://api.github.com/repos/jaegertracing/jaeger/issues/2338/comments",
  "created_at": "2020-07-09T09:17:15Z",
  "events_url": "https://api.github.com/repos/jaegertracing/jaeger/issues/2338/events",
  "html_url": "https://github.com/jaegertracing/jaeger/issues/2338",
  "id": 653904018,
  "labels": [
    {
      "color": "ee0701",
      "default": true,
      "description": null,
      "id": 358839838,
      "name": "bug",
      "node_id": "MDU6TGFiZWwzNTg4Mzk4Mzg=",
      "url": "https://api.github.com/repos/jaegertracing/jaeger/labels/bug"
    },
    {
      "color": "17017c",
      "default": false,
      "description": "",
      "id": 1500679037,
      "name": "hacktoberfest",
      "node_id": "MDU6TGFiZWwxNTAwNjc5MDM3",
      "url": "https://api.github.com/repos/jaegertracing/jaeger/labels/hacktoberfest"
    }
  ],
  "labels_url": "https://api.github.com/repos/jaegertracing/jaeger/issues/2338/labels{/name}",
  "locked": false,
  "milestone": null,
  "node_id": "MDU6SXNzdWU2NTM5MDQwMTg=",
  "number": 2338,
  "performed_via_github_app": null,
  "repository_url": "https://api.github.com/repos/jaegertracing/jaeger",
  "state": "closed",
  "title": "gRPC with TLS doesn't work with cmux in mixed mode",
  "updated_at": "2020-09-11T12:32:46Z",
  "url": "https://api.github.com/repos/jaegertracing/jaeger/issues/2338",
  "user": {
    "avatar_url": "https://avatars2.githubusercontent.com/u/13387?v=4",
    "events_url": "https://api.github.com/users/jpkrohling/events{/privacy}",
    "followers_url": "https://api.github.com/users/jpkrohling/followers",
    "following_url": "https://api.github.com/users/jpkrohling/following{/other_user}",
    "gists_url": "https://api.github.com/users/jpkrohling/gists{/gist_id}",
    "gravatar_id": "",
    "html_url": "https://github.com/jpkrohling",
    "id": 13387,
    "login": "jpkrohling",
    "node_id": "MDQ6VXNlcjEzMzg3",
    "organizations_url": "https://api.github.com/users/jpkrohling/orgs",
    "received_events_url": "https://api.github.com/users/jpkrohling/received_events",
    "repos_url": "https://api.github.com/users/jpkrohling/repos",
    "site_admin": false,
    "starred_url": "https://api.github.com/users/jpkrohling/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jpkrohling/subscriptions",
    "type": "User",
    "url": "https://api.github.com/users/jpkrohling"
  }
}